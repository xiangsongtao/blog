{"componentChunkName":"component---src-templates-blog-post-js","path":"/imgLazyloadJS/","result":{"data":{"site":{"siteMetadata":{"title":"Attila","cover":"/background/1.jpg","description":"Thoughts, stories and ideas.","keywords":["烈风裘的博客","X-Blog","Attila","Gatsby","前端成长记录"],"tagCover":"/background/5.jpg","archiveCover":"/background/escape-flight.png","siteUrl":"https://xiangst0816.github.io/blog","logo":"","navigation":true,"subscribe":true}},"allAuthorJson":{"totalCount":2,"edges":[{"node":{"id":"烈风裘","bio":"一往无前, 直到云开雾散!","avatar":"/avatar/me.jpeg","cover":"/background/photo-1503197979108-c824168d51a8.jpeg","github":"https://github.com/xiangsongtao","twitter":"","zhihu":"","weibo":"","facebook":"","website":"https://xiangsongtao.github.io/blog/","location":"HangZhou, China"}},{"node":{"id":"WALL-E","bio":"还有要清理的吗?","avatar":"/avatar/cleaner.jpg","cover":"","github":null,"twitter":null,"zhihu":null,"weibo":null,"facebook":null,"website":null,"location":"Earth"}}]},"master":{"id":"烈风裘","bio":"一往无前, 直到云开雾散!","avatar":"/avatar/me.jpeg","cover":"/background/photo-1503197979108-c824168d51a8.jpeg","github":"https://github.com/xiangsongtao","twitter":"","zhihu":"","weibo":"","facebook":"","website":"https://xiangsongtao.github.io/blog/","location":"HangZhou, China"},"currentPost":{"html":"<blockquote>\n<p>我这是用的是这个插件<strong>jquery.lazyload.js</strong>,<a href=\"http://blog.csdn.net/zzqw199012/article/details/18707473\" target=\"_target\" rel=\"nofollow\">关于介绍也很多了</a>,我这里就只见上干货，就说怎么用开始，不过还是先介绍下他是干什么的，怎么干的。</p>\n</blockquote>\n<h2 id=\"1-做什么的\" style=\"position:relative;\"><a href=\"#1-%E5%81%9A%E4%BB%80%E4%B9%88%E7%9A%84\" aria-label=\"1 做什么的 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. 做什么的</h2>\n<p><strong>图片延迟加载</strong>，等<strong>滚到图片的位置时才加载</strong>，后面的图片先不加载，故能<strong>避免卡顿</strong>，需要加载图片的时候，图片进行下载，等加载完毕后才出现，<strong>消除出现半幅图</strong>的情况（改善用户体验）</p>\n<h2 id=\"2-怎么干的\" style=\"position:relative;\"><a href=\"#2-%E6%80%8E%E4%B9%88%E5%B9%B2%E7%9A%84\" aria-label=\"2 怎么干的 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. 怎么干的</h2>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>lazy<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">data-original</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>img/example.jpg<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">width</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>640<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">height</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>480<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span></code></pre></div>\n<ul>\n<li><strong>data-original</strong>:这个是真正要交加载的图片；</li>\n<li><strong>src</strong>：这个是占位图片，默认是 grey.gif，高度只有 1px；自动添加的。你不管。</li>\n<li><strong>height</strong>：<strong>这个并不是必须设定</strong>，如果没设定导致图片都堆到一起被看到，则启动加载（我测试过，没设定尺寸），so，你知道该怎么做，把图片包起来隔开。</li>\n</ul>\n<p>引入 jquery：</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>jquery.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>jquery.lazyload.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>在 main.js 中写上：</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\">$(\"img.lazy\").lazyload();</code></pre></div>\n<p>这个例子我在<a href=\"https://github.com/xiangsongtao/HTML5-WebAPP-template\" target=\"_target\" rel=\"nofollow\">HTML5-WebAPP-template</a>这里用到过了，你可以尝试下。</p>\n<p><strong>如果使用的 requirejs 的话，这样做：</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">/*如果将包通过bower引入的话,会自动在paths中添加的 */</span>\nrequire<span class=\"token punctuation\">.</span><span class=\"token function\">config</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  paths<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    bootstrap<span class=\"token operator\">:</span> <span class=\"token string\">\"../../bower_components/bootstrap/dist/js/bootstrap\"</span><span class=\"token punctuation\">,</span>\n    domReady<span class=\"token operator\">:</span> <span class=\"token string\">\"vendor/domReady.min\"</span><span class=\"token punctuation\">,</span>\n    jquery<span class=\"token operator\">:</span> <span class=\"token string\">\"../../bower_components/jquery/dist/jquery\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"jquery.scrollstop\"</span><span class=\"token operator\">:</span>\n      <span class=\"token string\">\"../../bower_components/jquery_lazyload/jquery.scrollstop\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"jquery.lazyload\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"../../bower_components/jquery_lazyload/jquery.lazyload\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  shim<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"jquery.lazyload\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"jquery\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">\"jquery.scrollstop\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"jquery\"</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">//先加载jquery插件及require和domReady模块</span>\n<span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n  <span class=\"token string\">\"require\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"jquery\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"domReady\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"jquery.lazyload\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"jquery.scrollstop\"</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">require<span class=\"token punctuation\">,</span> $<span class=\"token punctuation\">,</span> domReady</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">//之后通过require模块加载其余部分,当然这也是懒加载的方法</span>\n  <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">\"app\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"test\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">app<span class=\"token punctuation\">,</span> test</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">domReady</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">app</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"img.lazy\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">lazyload</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"3-说下其他功能\" style=\"position:relative;\"><a href=\"#3-%E8%AF%B4%E4%B8%8B%E5%85%B6%E4%BB%96%E5%8A%9F%E8%83%BD\" aria-label=\"3 说下其他功能 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. 说下其他功能</h2>\n<h3 id=\"31-设置加载阈值\" style=\"position:relative;\"><a href=\"#31-%E8%AE%BE%E7%BD%AE%E5%8A%A0%E8%BD%BD%E9%98%88%E5%80%BC\" aria-label=\"31 设置加载阈值 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3.1 设置加载阈值</h3>\n<blockquote>\n<p>之前是“看到图片就加载”，现在是快到图片多少“<strong>阈值</strong>”的时候加载-提前一个距离加载。懂了不？</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"img.lazy\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">lazyload</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">//还有200px就出现在屏幕上了，现在加载</span>\n  threshold<span class=\"token operator\">:</span> <span class=\"token number\">200</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3 id=\"32-使用-jquery-的事件触发-img-加载\" style=\"position:relative;\"><a href=\"#32-%E4%BD%BF%E7%94%A8-jquery-%E7%9A%84%E4%BA%8B%E4%BB%B6%E8%A7%A6%E5%8F%91-img-%E5%8A%A0%E8%BD%BD\" aria-label=\"32 使用 jquery 的事件触发 img 加载 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3.2 使用 jquery 的事件触发 img 加载</h3>\n<blockquote>\n<p>之前是自动，现在<strong>根据事件触发加载</strong>，例如 click，mouseover。。。。。自定义事件也行。</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"img.lazy\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">lazyload</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  event<span class=\"token operator\">:</span> <span class=\"token string\">\"click\"</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>自定义事件触发：sport 时间 5s 后触发 img 加载</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"img.lazy\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">lazyload</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    event<span class=\"token operator\">:</span> <span class=\"token string\">\"sporty\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">$</span><span class=\"token punctuation\">(</span>window<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"load\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> timeout <span class=\"token operator\">=</span> <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"img.lazy\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">trigger</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"sporty\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3 id=\"33-使用-img-显现效果\" style=\"position:relative;\"><a href=\"#33-%E4%BD%BF%E7%94%A8-img-%E6%98%BE%E7%8E%B0%E6%95%88%E6%9E%9C\" aria-label=\"33 使用 img 显现效果 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3.3 使用 img 显现效果</h3>\n<blockquote>\n<p>img 下载好了后，用什么方式显现的问题，简单。应该使用的是 jquery 的动画，默认是用 show(),估估计能替换成别的动画库。</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"img.lazy\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">lazyload</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  effect<span class=\"token operator\">:</span> <span class=\"token string\">\"fadeIn\"</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3 id=\"34-如果-img-在一个-scroll-容器中（图片在带滚动条的容器里）\" style=\"position:relative;\"><a href=\"#34-%E5%A6%82%E6%9E%9C-img-%E5%9C%A8%E4%B8%80%E4%B8%AA-scroll-%E5%AE%B9%E5%99%A8%E4%B8%AD%EF%BC%88%E5%9B%BE%E7%89%87%E5%9C%A8%E5%B8%A6%E6%BB%9A%E5%8A%A8%E6%9D%A1%E7%9A%84%E5%AE%B9%E5%99%A8%E9%87%8C%EF%BC%89\" aria-label=\"34 如果 img 在一个 scroll 容器中（图片在带滚动条的容器里） permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3.4 如果 img 在一个 scroll 容器中（图片在带滚动条的容器里）</h3>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">#container</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">height</span><span class=\"token punctuation\">:</span> 600px<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">overflow</span><span class=\"token punctuation\">:</span> scroll<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"img.lazy\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">lazyload</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  container<span class=\"token operator\">:</span> <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"#container\"</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3 id=\"35-如果-img-不是呈现队列的形式布局的\" style=\"position:relative;\"><a href=\"#35-%E5%A6%82%E6%9E%9C-img-%E4%B8%8D%E6%98%AF%E5%91%88%E7%8E%B0%E9%98%9F%E5%88%97%E7%9A%84%E5%BD%A2%E5%BC%8F%E5%B8%83%E5%B1%80%E7%9A%84\" aria-label=\"35 如果 img 不是呈现队列的形式布局的 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3.5 如果 img 不是呈现队列的形式布局的</h3>\n<blockquote>\n<p>这句话的意思是，我们默认：图片的出现顺序是与 dom 的结构顺序是一致的。可是有些时髦的布局会将当前该出现的 img 放到很远的地方，所以这个插件为了保证这个图片能够显示出来，就会在后面去找（如果找不到这个图片就在页显示不出来了），看能不能找到这个图片，就是这个值“failure_limit”，如果你的布局非常奇葩，那么，将这个值设为 “所有使用 lazy 功能的图片的总和”，这样，这个奇葩的图片就跑不掉了！呵呵。理解了不？</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"img.lazy\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">lazyload</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">//向后找10个单位img</span>\n  failure_limit<span class=\"token operator\">:</span> <span class=\"token number\">10</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3 id=\"36-如果图片不可见怎么办\" style=\"position:relative;\"><a href=\"#36-%E5%A6%82%E6%9E%9C%E5%9B%BE%E7%89%87%E4%B8%8D%E5%8F%AF%E8%A7%81%E6%80%8E%E4%B9%88%E5%8A%9E\" aria-label=\"36 如果图片不可见怎么办 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3.6 如果图片不可见怎么办</h3>\n<blockquote>\n<p>跳过不可见的图片（Invisible）</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"img.lazy\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">lazyload</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  skip_invisible<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>","timeToRead":5,"wordCount":{"paragraphs":26,"sentences":26,"words":130},"fields":{"slug":"/imgLazyloadJS/","relativePath":"2015/2015-12-10---imgLazyloadJS/index.md"},"excerpt":"我这是用的是这个插件jquery.lazyload.js,关于介绍也很多了,我这里就只见上干货，就说怎么用开始，不过还是先介绍下他是干什么的，怎么干的。…","frontmatter":{"title":"imgLazyloadJS","date":"10 Dec 2015","tags":["JavaScript"],"cover":"","comments":true,"author":"烈风裘"}},"nextPost":{"html":"<blockquote>\n<p>第一次看官网的说明真是一头雾水,再次学习的时候感觉思路清晰很多,因此在这总结.</p>\n</blockquote>\n<h2 id=\"为什么使用-requirejs\" style=\"position:relative;\"><a href=\"#%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BD%BF%E7%94%A8-requirejs\" aria-label=\"为什么使用 requirejs permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>为什么使用 requirejs?</h2>\n<p><strong>下面是我认为的原因:</strong></p>\n<ol>\n<li>代码逻辑复杂需要模块化管理;</li>\n<li>在 js 文件中引入其他 js 文件的代码只能通过标签<code class=\"language-text\">&lt;script&gt;</code></li>\n<li>提升网页打开速度需要减少调用外部的 js 标签<code class=\"language-text\">&lt;script&gt;</code></li>\n</ol>\n<p>接下来我就从怎么使用开始吧.</p>\n<h2 id=\"需要在-html-代码中添加-requirejs-的code-classlanguage-textltscriptgtcode标签\" style=\"position:relative;\"><a href=\"#%E9%9C%80%E8%A6%81%E5%9C%A8-html-%E4%BB%A3%E7%A0%81%E4%B8%AD%E6%B7%BB%E5%8A%A0-requirejs-%E7%9A%84code-classlanguage-textltscriptgtcode%E6%A0%87%E7%AD%BE\" aria-label=\"需要在 html 代码中添加 requirejs 的code classlanguage textltscriptgtcode标签 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>需要在 html 代码中添加 requirejs 的<code class=\"language-text\">&lt;script&gt;</code>标签</h2>\n<p><strong>两种方式都行:</strong><br>\n<code class=\"language-text\">&lt;script data-main=&quot;scripts/main.js&quot; src=&quot;scripts/require.js&quot;&gt;&lt;/script&gt;</code><br>\n<code class=\"language-text\">&lt;script data-main=&quot;scripts/main&quot; src=&quot;scripts/require.js&quot;&gt;&lt;/script&gt;</code></p>\n<ol>\n<li>将标签添加在<code class=\"language-text\">&lt;body&gt;</code>的末尾</li>\n<li>指定 js 文件的主入口位置<code class=\"language-text\">main.js</code></li>\n<li>指定<code class=\"language-text\">require.js</code>文件位置</li>\n</ol>\n<h2 id=\"配置-mainjs-文件\" style=\"position:relative;\"><a href=\"#%E9%85%8D%E7%BD%AE-mainjs-%E6%96%87%E4%BB%B6\" aria-label=\"配置 mainjs 文件 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>配置 main.js 文件</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">**目录结构**\nwww/\n----index.html\n----js/\n--------app/\n------------sub.js\n------------inventory.js\n------------cart\n--------lib/\n------------jquery.js\n------------canvas.js\n--------main.js</code></pre></div>\n<hr>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">requirejs.config({\n\t//默认路径\n\tbaseUrl: &#39;js/lib&#39;,\n\n\t//在baseUrl默认路径的基础上,加载app.js文件,他现在\n\t//在lib文件夹的上级目录中(与js目录同级),不能再app后\n\t//加上js后缀!!!\n\t//在baseUrl目录下可以不用在paths中写明.例如canvas\n\tpaths: {\n    \tmain: &#39;../main&#39;,\n    \tjquery: &#39;jquery.1.1.min&#39;,\n    \tsub: &#39;../app/sub&#39;,\n    \tinventory.js: &#39;../app/inventory.js&#39;,\n    \tcart: &#39;../app/cart&#39;,\n\n\t}\n});\n\n// 主入口\n//前面是依赖的模块数组(也可以是模块的位置url), 后面是对应的**调用名字**(已经对位)\nrequirejs([&#39;jquery&#39;, &#39;canvas&#39;, &#39;app/sub&#39;],\nfunction     ($,      canvas,     sub) {\n\t//你的逻辑代码\n\t//sub.color;\n\t//sub(value);\n\t});</code></pre></div>\n<h2 id=\"定义模块-subjs\" style=\"position:relative;\"><a href=\"#%E5%AE%9A%E4%B9%89%E6%A8%A1%E5%9D%97-subjs\" aria-label=\"定义模块 subjs permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>定义模块 sub.js</h2>\n<h3 id=\"1-如果只含有键值对的模块\" style=\"position:relative;\"><a href=\"#1-%E5%A6%82%E6%9E%9C%E5%8F%AA%E5%90%AB%E6%9C%89%E9%94%AE%E5%80%BC%E5%AF%B9%E7%9A%84%E6%A8%A1%E5%9D%97\" aria-label=\"1 如果只含有键值对的模块 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. 如果只含有键值对的模块</h3>\n<p><strong>from sub.js</strong>\ndefine(function () {\n//做一些初始设置\n//return 出去的就是 sub 模块提供的信息\n//此处为一个 object\nreturn {\ncolor: “black”,\nsize: “unisize”\n}\n});</p>\n<h3 id=\"2-如果存在依赖的键值对的模块\" style=\"position:relative;\"><a href=\"#2-%E5%A6%82%E6%9E%9C%E5%AD%98%E5%9C%A8%E4%BE%9D%E8%B5%96%E7%9A%84%E9%94%AE%E5%80%BC%E5%AF%B9%E7%9A%84%E6%A8%A1%E5%9D%97\" aria-label=\"2 如果存在依赖的键值对的模块 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. 如果存在依赖的键值对的模块</h3>\n<p><strong>from sub.js</strong>\n//可 requirejs 一样,前面是*.js 的 path(前面已定义),后面是回调函数(传入\n//对应的变量名)\ndefine([“cart”, “inventory”], function(cart, inventory) {\n//return 模块\nreturn {\ncolor: “blue”,\nsize: “large”,\naddToCart: function() {\ninventory.decrement(this);\ncart.add(this);\n}\n}\n}\n);</p>\n<h3 id=\"3-返回函数的模块\" style=\"position:relative;\"><a href=\"#3-%E8%BF%94%E5%9B%9E%E5%87%BD%E6%95%B0%E7%9A%84%E6%A8%A1%E5%9D%97\" aria-label=\"3 返回函数的模块 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. 返回函数的模块</h3>\n<p><strong>from sub.js</strong>\n//和上面一样\ndefine([“cart”, “inventory”], function(cart, inventory) {\n//return 模块\nreturn function(color){\ncolor: “color”,\nsize: “large”,\naddToCart: function() {\ninventory.decrement(this);\ncart.add(this);\n}\n}\n}\n}\n);</p>\n<h3 id=\"4-包装-commonjs-的代码\" style=\"position:relative;\"><a href=\"#4-%E5%8C%85%E8%A3%85-commonjs-%E7%9A%84%E4%BB%A3%E7%A0%81\" aria-label=\"4 包装 commonjs 的代码 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. 包装 CommonJS 的代码</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">**from sub.js**\n//\ndefine(function(require, exports, module) {\n\t//require需要的模块a和b,和上面一样的用法\n    var a = require(&#39;a&#39;),\n        b = require(&#39;b&#39;);\n\n    //Return CommonJS的结果\n    return function () {};\n\t}\n);</code></pre></div>\n<h3 id=\"5不建议在模块内部对模块直接命名\" style=\"position:relative;\"><a href=\"#5%E4%B8%8D%E5%BB%BA%E8%AE%AE%E5%9C%A8%E6%A8%A1%E5%9D%97%E5%86%85%E9%83%A8%E5%AF%B9%E6%A8%A1%E5%9D%97%E7%9B%B4%E6%8E%A5%E5%91%BD%E5%90%8D\" aria-label=\"5不建议在模块内部对模块直接命名 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5.不建议在模块内部对模块直接命名</h3>\n<p>// “foo/title” 这样的命名不建议,\ndefine(“foo/title”,\n[“my/cart”, “my/inventory”],\nfunction(cart, inventory) {\n//Define foo/title object in here.\n}\n);</p>\n<p>其他注意事项</p>\n<hr>\n<h4 id=\"1一个文件一个模块\" style=\"position:relative;\"><a href=\"#1%E4%B8%80%E4%B8%AA%E6%96%87%E4%BB%B6%E4%B8%80%E4%B8%AA%E6%A8%A1%E5%9D%97\" aria-label=\"1一个文件一个模块 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1.一个文件一个模块</h4>\n<h4 id=\"2-在-define-内部再次引用模块的情况\" style=\"position:relative;\"><a href=\"#2-%E5%9C%A8-define-%E5%86%85%E9%83%A8%E5%86%8D%E6%AC%A1%E5%BC%95%E7%94%A8%E6%A8%A1%E5%9D%97%E7%9A%84%E6%83%85%E5%86%B5\" aria-label=\"2 在 define 内部再次引用模块的情况 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. 在 define 内部再次引用模块的情况</h4>\n<p><strong>需要将”require”本身作为一个依赖注入到模块中</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">define([&quot;require&quot;, &quot;./relative/name&quot;], function(require) {\n\tvar mod = require(&quot;./relative/name&quot;);\n});</code></pre></div>\n<h4 id=\"3-生成相对于模块的-url-地址\" style=\"position:relative;\"><a href=\"#3-%E7%94%9F%E6%88%90%E7%9B%B8%E5%AF%B9%E4%BA%8E%E6%A8%A1%E5%9D%97%E7%9A%84-url-%E5%9C%B0%E5%9D%80\" aria-label=\"3 生成相对于模块的 url 地址 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. 生成相对于模块的 URL 地址</h4>\n<p><strong>需要将”require”本身作为一个依赖注入到模块中</strong>, 结果的 url 不需要加.js 后缀</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">define([&quot;require&quot;], function(require) {\n\tvar cssUrl = require.toUrl(&quot;./style.css&quot;);\n});</code></pre></div>\n<h2 id=\"循环依赖\" style=\"position:relative;\"><a href=\"#%E5%BE%AA%E7%8E%AF%E4%BE%9D%E8%B5%96\" aria-label=\"循环依赖 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>循环依赖</h2>\n<p>循环依赖(a 依赖 b，b 同时依赖 a),则在这种情形下当 b 调用 a 模块时，它会得到一个 undefined 的 a, 解决办法如下,将 require 作为依赖注入进来.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">//Inside b.js:\ndefine([&quot;require&quot;, &quot;a&quot;],\n\tfunction(require, a) {\n    \t//在这种情形下当b调用a模块时，它会得到一个undefined的a,\n    \treturn function(title) {\n    \t\t//调用a中的doSomething()函数\n        \treturn require(&quot;a&quot;).doSomething();\n    \t}\n\t}\n);</code></pre></div>\n<h2 id=\"jsonp-服务依赖-官网的翻译真烂\" style=\"position:relative;\"><a href=\"#jsonp-%E6%9C%8D%E5%8A%A1%E4%BE%9D%E8%B5%96-%E5%AE%98%E7%BD%91%E7%9A%84%E7%BF%BB%E8%AF%91%E7%9C%9F%E7%83%82\" aria-label=\"jsonp 服务依赖 官网的翻译真烂 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>JSONP 服务依赖-官网的翻译真烂</h2>\n<p>仅支持返回值类型为 JSON object 的 JSONP 服务，其他返回类型如数组、字串、数字等都不能支持。<br>\n为了在 RequireJS 中使用 JSON 服务，需要指定一个 callback 参数,这里使用”defineFn”。这意味着你可将 JSONP URL 获取到的值看成是一个模块(返回的是一个函数 defineFn(jsonValue))。\nrequire([“http://example.com/api/data.json?callback=defineFn”],\nfunction (data) {\n//这里的 data 就是返回的 defineFn(jsonValue)\nconsole.log(data);\n}\n);</p>\n<h2 id=\"requirejs-的机制\" style=\"position:relative;\"><a href=\"#requirejs-%E7%9A%84%E6%9C%BA%E5%88%B6\" aria-label=\"requirejs 的机制 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>requirejs 的机制</h2>\n<p>RequireJS 使用 head.appendChild()将每一个依赖加载为一个 script 标签。\nRequireJS 等待所有的依赖加载完毕，计算出模块定义函数正确调用顺序，然后依次调用它们。</p>\n<h2 id=\"requirejsconfig-的配置\" style=\"position:relative;\"><a href=\"#requirejsconfig-%E7%9A%84%E9%85%8D%E7%BD%AE\" aria-label=\"requirejsconfig 的配置 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>requirejs.config 的配置</h2>\n<ul>\n<li><strong>baseUrl</strong> ：所有模块的查找根路径。</li>\n<li><strong>paths</strong> ：path 映射那些不直接放置于 baseUrl 下的模块名。设置 path 时起始位置是相对于 baseUrl 的，除非该 path 设置以”/“开头或含有 URL 协议（如 http:）。</li>\n<li>\n<p><strong>shim</strong>: 将 shim 定义模块设置为全局可用(类似于 path 的作用),设定该模块的依赖项,但不加载该依赖, 只是到用到 shim 定义模块时才加载依赖项, 类似于插件而存在</p>\n<p>  \t\trequirejs.config({\npath: {\njquery:“jquery”,\nunderscore:“underscore”\n},\nshim: {\n‘backbone’: {\ndeps: [‘underscore’, ‘jquery’],\nexports: ‘Backbone’\n},\n‘underscore’: {\nexports: ’_’\n},\n‘foo’: {\ndeps: [‘bar’],\nexports: ‘Foo’,\ninit: function (bar) {\nreturn this.Foo.noConflict();\n}\n}</p>\n<p>}\n});\ndefine([‘backbone’], function (Backbone) {\nreturn Backbone.Model.extend({});\n});\n**Backbone 强制依赖于 Underscore.js,非强制依赖于 jQuery/Zepto.故 **</p>\n</li>\n<li>shim 配置<strong>仅设置了代码的依赖关系</strong>，想要实际加载 shim 指定的或涉及的模块，仍然需要一个常规的 require/define 调用。设置 shim 本身不会触发代码的加载。</li>\n<li>成为 shim 脚本依赖的三个可选条件: - 使用其他”shim”模块作为 shim 脚本的依赖， - 在调用 define()之前定义了全局变量(如 jQuery 或 lodash)的 AMD 库, 这样调用不会出错(例如将 jquery 先在 path 中声明)。 - CMD 库</li>\n<li>\n<p><strong>map</strong>:对于给定的模块前缀，使用一个不同的模块 ID 来加载该模块。<br>\n该手段对于某些大型项目很重要：如有两类模块需要使用不同版本的”foo”，但它们之间仍需要一定的协同。 在那些基于上下文的多版本实现中很难做到这一点。而且，paths 配置仅用于为模块 ID 设置 root paths，而不是为了将一个模块 ID 映射到另一个。</p>\n<p>  \trequirejs.config({\nmap: {\n‘some/newmodule’: {\n‘foo’: ‘foo1.2’\n},\n‘some/oldmodule’: {\n‘foo’: ‘foo1.0’\n}\n}\n});</p>\n</li>\n</ul>\n<p>当“some/newmodule”调用了“require(‘foo’)”，它将获取到 foo1.2.js 文件；<br>\n而当“some/oldmodule”调用“`require(‘foo’)”时它将获取到 foo1.0.js。</p>\n<ul>\n<li>\n<p><strong>config</strong>:<strong>将配置信息向下传给一个模块</strong>。这些配置往往是 application 级别的信息，需要一个手段将它们向下传递给模块。在 RequireJS 中，基于 requirejs.config()的 config 配置项来实现。要获取这些信息的模块可以<strong>加载特殊的依赖“module”</strong>，并调用<strong>module.config()</strong>。</p>\n<p>  \trequirejs.config({</p>\n<p>config: {\n‘bar’: {\nsize: ‘large’\n},\n‘baz’: {\ncolor: ‘blue’\n}\n}\n});\n//调用 config 的内容\ndefine([‘module’], function (module) {\n//Will be the value ‘blue’\nvar color = module.config().color;\n});\n//commonJS 模式\ndefine(function (require, exports, module) {\n//Will be the value ‘large’\nvar color = module.config().size;\n});</p>\n</li>\n</ul>\n<p>版本支持, requirejs 延迟加载, 依赖注入!!!</p>\n<hr>\n<blockquote>\n<p><strong>require 函数</strong>的变态用法,直接上代码, 记住 require(或者 requirejs, 两个一样)是个函数.</p>\n</blockquote>\n<p>var reqOne = require.config({\ncontext: “version1”,\nbaseUrl: “version1”\n});</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">\treqOne([&quot;require&quot;, &quot;alpha&quot;, &quot;beta&quot;,],function(require,   alpha,   beta) {</code></pre></div>\n<p>log(“alpha version is: ” + alpha.version); //prints 1\nlog(“beta version is: ” + beta.version); //prints 1</p>\n<p>setTimeout(function() {\n//延迟加载,需要在前面依赖’require’\nrequire([“omega”],function(omega) {\nlog(“version1 omega loaded with version: ” +omega.version);\n//prints 1\n}\n);\n}, 100);\n});</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">\tvar reqTwo = require.config({\n  \t\tcontext: &quot;version2&quot;,\n  \t\tbaseUrl: &quot;version2&quot;\n\t});\n\n\treqTwo([&quot;require&quot;, &quot;alpha&quot;, &quot;beta&quot;],function(require,   alpha,   beta) {</code></pre></div>\n<p>log(“alpha version is: ” + alpha.version); //prints 2\nlog(“beta version is: ” + beta.version); //prints 2</p>\n<p>setTimeout(function() {\n//延迟加载,需要在前面依赖’require’\nrequire([“omega”],function(omega) {\nlog(“version2 omega loaded with version: ” +omega.version);\n//prints 2\n}\n);\n}, 100);\n});</p>\n<p>如果没有指定“require”依赖，则很可能会出现错误。</p>\n<p>paths 备错配置</p>\n<hr>\n<p>paths 配置如下:</p>\n<p>paths: {\njquery: [\n‘http://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min’,\n/如果没找到 CDN 则加载下面位置的 jquery\n‘lib/jquery’\n]\n}</p>\n<p>页面加载控制及 DOM Ready 事件监听</p>\n<hr>\n<p>需要与 DOM 交互的工作应等待 DOM Ready。现代的浏览器通过 DOMContentLoaded 事件来知会。但是，不是所有的浏览器都支持 DOMContentLoaded。<strong>domReady 模块</strong>实现了一个跨浏览器的方法来判定何时 DOM 已经 ready。下载并在你的项目中如此用它：</p>\n<p>require([‘domReady’], function (domReady) {\ndomReady(function () {\n//Dom ready 后调才执行这里的函数\n//需要操作 DOM 的代码放置在这里\n});\n});\n//ps,可以用下面的结构,与主结构分开,避免耗时导致其他 js 不执行\nvar reqDOM = requirejs.config({…});\nreqDOM([‘domReady’],function(domReady){\ndomReady(function () {\n//Dom ready 后调才执行这里的函数\n//需要操作 DOM 的代码放置在这里\n});\n});</p>\n<h2 id=\"requirejs-require-define-的区别\" style=\"position:relative;\"><a href=\"#requirejs-require-define-%E7%9A%84%E5%8C%BA%E5%88%AB\" aria-label=\"requirejs require define 的区别 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>requirejs, require, define 的区别</h2>\n<blockquote>\n<p>requirejs, require 两个使用起来完全一样, 也找不到区别的方法…<br>\nrequirejs.config()或者 require.config()</p>\n</blockquote>\n<p>define 和 require 在依赖处理和回调执行上都是一样的，不一样的地方是<strong>define 的回调函数需要有 return 语句返回模块对象</strong>，这样 define 定义的模块才能被其他模块引用；<strong>require 的回调函数不需要 return 语句</strong>。</p>\n<blockquote>\n<p>著作权归作者所有。<br>\n商业转载请联系作者获得授权，非商业转载请注明出处。<br>\n作者：Xin You<br>\n链接：<a href=\"http://www.zhihu.com/question/21260764/answer/50194362\" target=\"_target\" rel=\"nofollow\">http://www.zhihu.com/question/21260764/answer/50194362</a><br>\n来源：知乎</p>\n</blockquote>\n<p>所以,<strong>define 定义 require 加载使用，这个理解是对的。</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">define([require,path/myMod1,path/moMod2], function(require){\n\tvar mod1 = require(&#39;path/myMod1&#39;), mod2 = require(&#39;path/myMod2&#39;);\n})\n\n其实逻辑上类似于\n\ndefine([require], function(require){\n\tvar mod1 = require(&#39;path/myMod1&#39;), mod2 = require(&#39;path/myMod2&#39;);\n})\n\n你只是把参数丢了而已，所以这样也行\n\ndefine([require,path/myMod1,path/moMod2], function(require){\n\tvar mod1 = arguments[1], mod2 = arguments[2];\n})\n\n所以，可以这么用\n\ndefine([require,path/myMod1,path/moMod2], function(require,mod1,mod2){\n\t// 这里 mod1 和 mod2 都准备好了，还可以用require继续加载别的\n})\n\n或者，改成你看到的那些例子\n\ndefine([path/myMod1,path/moMod2], function(mod1,mod2){\n})\n\n\n\n所以\n\ndefine([&#39;jquery.validate&#39;], function(validate){\n\t// 这里可以用validate，但是用不了jquery了？\n})\n\n这样本质上并没有问题，只不过你引用了这个插件，必然也是想用jquery的而不只是validate，\n\n所以\n\ndefine([&#39;jquery&#39;, &#39;jquery.validate&#39;], function(jquery, validate){\n\t// 这样才有jquery\n})\n\n像你一开始那样使用也行\n\ndefine([&#39;require&#39;, &#39;jquery.validate&#39;], function(require, validate){\n\tvar jquery = require(&#39;jquery&#39;);\n})</code></pre></div>","timeToRead":11,"wordCount":{"paragraphs":57,"sentences":57,"words":616},"fields":{"slug":"/RequireJS/","relativePath":"2015/2015-12-10---RequireJS/index.md"},"excerpt":"第一次看官网的说明真是一头雾水,再次学习的时候感觉思路清晰很多,因此在这总结. 为什么使用 requirejs? 下面是我认为的原因: 代码逻辑复杂需要模块化管理; 在 js 文件中引入其他 js…","frontmatter":{"title":"RequireJS","date":"10 Dec 2015","tags":["RequireJS"],"cover":"","comments":true,"author":"烈风裘"}},"prevPost":{"html":"<p>本总结是对《高性能 JavaScript》这本书的总结也是记录笔记,加深我对 JavaScript 的认识及实践技巧。</p>\n<h2 id=\"一、脚本的加载和执行\" style=\"position:relative;\"><a href=\"#%E4%B8%80%E3%80%81%E8%84%9A%E6%9C%AC%E7%9A%84%E5%8A%A0%E8%BD%BD%E5%92%8C%E6%89%A7%E8%A1%8C\" aria-label=\"一、脚本的加载和执行 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>一、脚本的加载和执行</h2>\n<p>一般来说，JavaScript 代码的执行会阻塞浏览器进行的其他程序，比如用户界面绘制。每次遇到<code class=\"language-text\">&lt;script&gt;</code>后，,页面都必须停下来等待代码下载并执行，然后再继续解析和渲染页面。在这期间，页面渲染和用户交互是完全被阻塞的，例如页面出现长时间的白屏。解决方案如下：</p>\n<ol>\n<li>将<code class=\"language-text\">&lt;script&gt;</code>放在<code class=\"language-text\">&lt;/body&gt;</code>之前，确保脚被执行前页面已完成渲染。</li>\n<li><code class=\"language-text\">&lt;script&gt;</code>标签越少越好，可以考虑用 gulp 任务合并。因为 HTTP 请求会带来额外的性能开销。</li>\n<li>内嵌脚本如果在<code class=\"language-text\">&lt;link&gt;</code>之后会导致页面阻塞去等待样式表的下载。这样能获得最精准的样式信息，但是会阻塞其他任务。（不建议，但 hack 除外）</li>\n<li>\n<p>使用无阻塞下载的方式</p>\n<ul>\n<li><strong>延迟脚本：</strong><br>\n在<code class=\"language-text\">&lt;script&gt;</code>标签中使用 defer 属性，该属性指明此脚本不会修改 DOM，因此可以安全的延迟执行。（async 属性也用于异步加载脚本，区别在于其加载完成后自动执行，而 defer 需要页面完成后才执行）</li>\n<li><strong>使用 XHR 对象下载 JavaScript 代码并注入到页面中</strong><br>\n主要的局限是只能在同域中请求 js 文件，也不能从 CDN 获取 js 文件。</li>\n<li><strong>动态脚本（推荐）：</strong><br>\n动态创建<code class=\"language-text\">&lt;script&gt;</code>元素并下载执行。即在 window 对象的 load 事件出发后再下载脚本。<br>\n可自己实现(如下)，也可使用类库:<a href=\"http://github.com/rgrove/lazyload/\" target=\"_target\" rel=\"nofollow\">lazyload</a>、<a href=\"http://labjs.com\" target=\"_target\" rel=\"nofollow\">LABjs</a>。</li>\n</ul>\n</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">/**\n * @title: addTags动态加载js标签\n * @params:\n * tagUrl: js资源的数组\n * eachLoadedCB: 每个资源加载完毕的回调\n * allLoadedCB: 所有资源加载完毕的回调\n * */\nfunction addTags(tagUrl, eachLoadedCB, allLoadedCB) {\n\n    if (!(tagUrl instanceof Array)) {\n        alert(&quot;first arguments must be array of urls&quot;);\n        return false;\n    }\n    var totalResource = tagUrl.length;\n    var restResource = totalResource;\n    var downLoadPercent;\n    for (var i = 0, len = tagUrl.length; len &gt; i; i++) {\n        //标签对象\n        var _TagObjs;\n        if (/.js$/.test(tagUrl[i])) {\n            _TagObjs = document.createElement(&quot;script&quot;);\n            _TagObjs.setAttribute(&#39;type&#39;, &#39;text/javascript&#39;);\n            _TagObjs.setAttribute(&#39;src&#39;, tagUrl[i]);\n            head.appendChild(_TagObjs);\n        }\n        if(_TagObjs.readyState){\n            //IE\n            _TagObjs.onreadystatechange = function () {\n                if(_TagObjs.readyState == &quot;loaded&quot; || _TagObjs.readyState == &quot;complete&quot;){\n                    _TagObjs.onreadystatechange = null;\n                    restResource--;\n                    downLoadPercent = Math.round((totalResource - restResource) / totalResource * 100);\n                    !!eachLoadedCB &amp;&amp; eachLoadedCB(totalResource, restResource, downLoadPercent);\n                    !!!restResource &amp;&amp; allLoadedCB &amp;&amp; allLoadedCB();\n                }\n            }\n        }else{\n            _TagObjs.onload = function () {\n                restResource--;\n                downLoadPercent = Math.round((totalResource - restResource) / totalResource * 100);\n                !!eachLoadedCB &amp;&amp; eachLoadedCB(totalResource, restResource, downLoadPercent);\n                !!!restResource &amp;&amp; allLoadedCB &amp;&amp; allLoadedCB();\n            };\n        }\n\n    }\n}\n\n\n/**\n * 使用\n * */\naddTags([&quot;core.js&quot;,&quot;lib.js&quot;],function (t,r,d) {\n    alert(&quot;total:&quot;+t+&quot;,rest:&quot;+r+&quot;,percent:&quot;+d);\n},function () {\n    alert(&quot;all loaded&quot;)\n})</code></pre></div>\n<h2 id=\"二、数据存储\" style=\"position:relative;\"><a href=\"#%E4%BA%8C%E3%80%81%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8\" aria-label=\"二、数据存储 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>二、数据存储</h2>\n<p>JavaScript 的四种基本的数据存取位置，比较简单，这里只是简单列举：</p>\n<ul>\n<li>字面量 （最快）</li>\n<li>本地变量 （var 创建）（最快）</li>\n<li>数组元素 （最慢）</li>\n<li>对象成员（最慢）</li>\n</ul>\n<h3 id=\"作用域链\" style=\"position:relative;\"><a href=\"#%E4%BD%9C%E7%94%A8%E5%9F%9F%E9%93%BE\" aria-label=\"作用域链 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>作用域链</h3>\n<p>找了一张图：\n<img src=\"http://img.my.csdn.net/uploads/201304/04/1365082234_1223.png\" alt=\"作用域链\"></p>\n<ul>\n<li>函数执行都会创建自己的执行环境，且执行环境都有自己的作用域链，用于解析标识符。函数运行时的变量对象会放在作用域链的顶端。当执行环境被销毁，此对象也随之销毁。故，在函数执行过程中，每遇到变量，都会经历一次标识符解析过程以决定从哪儿获取存储数据。---> <strong>藏的越深，找的越慢！</strong></li>\n<li>作用域链的末尾是全局变量对象，故<strong>搜索该变量的过程必须遍历整个作用域链！</strong>一般是讲此全局变量缓存的到局部变量中。</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">function init(){\n\tvar a = document;\n\tvar b = a.body;\n\tb.getElementByTagName(&quot;a&quot;);\n}</code></pre></div>\n<ul>\n<li>改变作用域链的方式有： - with(不建议使用，可使用局部变量替换) - try catch (可用)<br>\ntry 内函数的作用域对象放在首位，catch 内函数的作用域对象放在第二位。catch 执行完毕，作用域链就返回到之前的状态。<strong>建议将 catch 内的处理逻辑由专门的函数处理，由于只有一条执行语句，且没有局部变量的访问，作用域链的临时改变不会影响代码性能。</strong></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">try{\n\tmethod();\n} catch(e){\n\thandleErr(e);\n}</code></pre></div>\n<h3 id=\"闭包、作用域和内存\" style=\"position:relative;\"><a href=\"#%E9%97%AD%E5%8C%85%E3%80%81%E4%BD%9C%E7%94%A8%E5%9F%9F%E5%92%8C%E5%86%85%E5%AD%98\" aria-label=\"闭包、作用域和内存 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>闭包、作用域和内存</h3>\n<ul>\n<li>闭包会造成更多的内存开销</li>\n<li>闭包会放在作用域链的顶端，第二层是活动对象的作用域，也就是说，闭包的存在会频繁的出现跨作用域访问标识符的情况，每次访问都会带来性能损失，解救方案：将常用的跨作用域的变量存储到局部变量中，然后直接访问局部变量。</li>\n</ul>\n<h3 id=\"原型链\" style=\"position:relative;\"><a href=\"#%E5%8E%9F%E5%9E%8B%E9%93%BE\" aria-label=\"原型链 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>原型链</h3>\n<ul>\n<li>Javascript 中的对象是基于原型的。</li>\n<li>所有的对象都是 Object 的实例。</li>\n<li>实例继承了原型链中的所有成员，故原型决定了实例的类型！</li>\n</ul>\n<p>浏览器中的原型链结构:\n<img src=\"http://images.cnitblog.com/blog/543993/201401/211448230160.jpg\" alt=\"浏览器中的原型链结构\"></p>\n<ul>\n<li>嵌套的对象成员会显著的影响性能，访问的速度也越慢,例如：<br>\nwindow.location.href.toString() > window.location.href > location.href</li>\n<li>缓存对象的成员，如果多次访问的话。</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"vara = location;\"><pre class=\"language-vara = location;\"><code class=\"language-vara = location;\">\ta.href;\n\t....</code></pre></div>\n<ul>\n<li>属性和方法越深，访问的速度也越慢</li>\n</ul>\n<h2 id=\"三、dom-编程\" style=\"position:relative;\"><a href=\"#%E4%B8%89%E3%80%81dom-%E7%BC%96%E7%A8%8B\" aria-label=\"三、dom 编程 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>三、DOM 编程</h2>\n<ul>\n<li>减少 DOM 的访问次数，把运算留在 JS 端处理。</li>\n<li>遍历数组的速度快于遍历集合是速度，故将 HTML 集合转化为数组在进行处理会更高效。</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">function toArray(coll){\n\tfor(var i = 0,a = [],len = coll.length;i&lt;len;i++){\n\t\ta[i] = coll[i];\n\t}\n\treturn a;\n}\n\nvar coll = document.getElementsByTagName(&quot;div&quot;);\nvar ar = toArray(coll);</code></pre></div>\n<ul>\n<li>建议使用 querySlectorAll()方法</li>\n</ul>\n<h3 id=\"重绘和重排\" style=\"position:relative;\"><a href=\"#%E9%87%8D%E7%BB%98%E5%92%8C%E9%87%8D%E6%8E%92\" aria-label=\"重绘和重排 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>重绘和重排</h3>\n<ul>\n<li>重排：reflow，重新计算元素几何属性，重新构造渲染树，代价很高；</li>\n<li>重绘： repaint，代价相对较小。</li>\n</ul>\n<p>故：</p>\n<ul>\n<li>批量修改 DOM</li>\n<li>批量改变样式（ele.style.cssText = \"\"）</li>\n<li>使元素脱离文档流，避免大部分文档重排： - 动画元素绝对定位，脱离文档流</li>\n</ul>\n<h3 id=\"事件委托\" style=\"position:relative;\"><a href=\"#%E4%BA%8B%E4%BB%B6%E5%A7%94%E6%89%98\" aria-label=\"事件委托 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>事件委托</h3>\n<p>大量元素绑定相同处理事件的时候，将事件绑定到 document 上，通过冒泡事件捕获并处理</p>\n<h2 id=\"四、算法和流程控制\" style=\"position:relative;\"><a href=\"#%E5%9B%9B%E3%80%81%E7%AE%97%E6%B3%95%E5%92%8C%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6\" aria-label=\"四、算法和流程控制 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>四、算法和流程控制</h2>\n<ul>\n<li>for, while, do- while，性能相当，灵活使用</li>\n<li>避免使用 for-in，除非遍历对象的数量不确定。</li>\n<li>switch 和 if-else 灵活使用</li>\n<li>出现栈溢出，可能是因为使用了递归，将递归改为迭代可以避免。因为运行一个循环比反复调用一个函数的开销要少的多。</li>\n</ul>\n<h2 id=\"五、字符串和正则表达式\" style=\"position:relative;\"><a href=\"#%E4%BA%94%E3%80%81%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%92%8C%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F\" aria-label=\"五、字符串和正则表达式 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>五、字符串和正则表达式</h2>\n<ul>\n<li>使用+和+=操作字符串，避免不必要的中间字符串</li>\n<li>正则，待续</li>\n</ul>\n<h2 id=\"六、快速响应用户界面\" style=\"position:relative;\"><a href=\"#%E5%85%AD%E3%80%81%E5%BF%AB%E9%80%9F%E5%93%8D%E5%BA%94%E7%94%A8%E6%88%B7%E7%95%8C%E9%9D%A2\" aria-label=\"六、快速响应用户界面 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>六、快速响应用户界面</h2>\n<ul>\n<li>js 任务不可超过 100ms</li>\n<li>使用 settimeout 将长时间的 js 放入队列中异步执行，不阻碍 ui 进程。</li>\n<li>可以使用 web works</li>\n</ul>\n<h2 id=\"七、ajax\" style=\"position:relative;\"><a href=\"#%E4%B8%83%E3%80%81ajax\" aria-label=\"七、ajax permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>七、AJAX</h2>\n<ul>\n<li>减少请求次数</li>\n</ul>\n<h2 id=\"八、编程实践\" style=\"position:relative;\"><a href=\"#%E5%85%AB%E3%80%81%E7%BC%96%E7%A8%8B%E5%AE%9E%E8%B7%B5\" aria-label=\"八、编程实践 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>八、编程实践</h2>\n<ul>\n<li>避免双重求值（使用 eval()和 Function()运行字符串代码）</li>\n<li>Object 和 Array 使用直接量，而不是 new</li>\n<li>环境判断的函数应该使用延迟加载技术（Lazy Loading）或者条件预加载技术（Conditional Advance Loading），即，环境确定后，用该环境下的函数替换主函数</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">//延迟加载技术（Lazy Loading）\n//第一次执行判断环境，之后修改addHandler函数并执行\nfunctin addHandler(x){\n\tif(isThisEnvironment){\n\t\taddHandler = function(x){}\n\t}else{\n\t\taddHandler = function(x){}\n\t}\n\taddHandler(x);\n}</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">//条件预加载技术（Conditional Advance Loading）\n//脚本加载期间检测，并修改addHandler函数；\nvar addHandler = isThisEnvironment?function(x){}:function(x){};</code></pre></div>\n<ul>\n<li>使用 js 原生提供的方法（Math）</li>\n<li>使用位操作</li>\n</ul>\n<h2 id=\"九、构建高性能-js-应用\" style=\"position:relative;\"><a href=\"#%E4%B9%9D%E3%80%81%E6%9E%84%E5%BB%BA%E9%AB%98%E6%80%A7%E8%83%BD-js-%E5%BA%94%E7%94%A8\" aria-label=\"九、构建高性能 js 应用 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>九、构建高性能 js 应用</h2>\n<ul>\n<li>合并多个 JavaScript 文件，减少 HTTP 请求数</li>\n<li><strong>非必须的脚本延迟加载</strong></li>\n<li>JavaScript 压缩，方法：ugify、js 重构（GCC）</li>\n<li>启用 gzip</li>\n<li>manifest 缓存技术，包含 manifest 的 html 也会被缓存</li>\n<li>CDN</li>\n<li>文件名增加 MD5 值防止缓存更新问题</li>\n</ul>\n<h2 id=\"10、工具\" style=\"position:relative;\"><a href=\"#10%E3%80%81%E5%B7%A5%E5%85%B7\" aria-label=\"10、工具 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>10、工具</h2>\n<ul>\n<li>分类：性能分析+网络分析</li>\n<li>浏览器的开发工具</li>\n<li>Fidder/postman/Charles Proxy</li>\n</ul>","timeToRead":8,"wordCount":{"paragraphs":78,"sentences":78,"words":322},"fields":{"slug":"/gao-xing-neng-nai-JavaScript-shi-jian/","relativePath":"2016/2016-05-21---gao-xing-neng-nai-JavaScript-shi-jian/index.md"},"excerpt":"本总结是对《高性能 JavaScript》这本书的总结也是记录笔记,加深我对 JavaScript 的认识及实践技巧。 一、脚本的加载和执行 一般来说，JavaScript…","frontmatter":{"title":"高性能JavaScript实践总结","date":"21 May 2016","tags":["JavaScript","读书笔记"],"cover":"","comments":true,"author":"烈风裘"}}},"pageContext":{"curr":"/imgLazyloadJS/","prev":"/gao-xing-neng-nai-JavaScript-shi-jian/","next":"/RequireJS/"}},"staticQueryHashes":["3240721340","63159454"]}