{"componentChunkName":"component---src-templates-blog-post-js","path":"/TypeScript/","result":{"data":{"site":{"siteMetadata":{"title":"Attila","cover":"/background/1.jpg","description":"Thoughts, stories and ideas.","keywords":["烈风裘的博客","X-Blog","Attila","Gatsby","前端成长记录"],"tagCover":"/background/5.jpg","archiveCover":"/background/escape-flight.png","siteUrl":"https://xiangst0816.github.io/blog","logo":"","navigation":true,"subscribe":true}},"allAuthorJson":{"totalCount":2,"edges":[{"node":{"id":"烈风裘","bio":"一往无前, 直到云开雾散!","avatar":"/avatar/avatar.png","cover":"/background/photo-1503197979108-c824168d51a8.jpeg","github":"https://github.com/xiangst0816","twitter":"","zhihu":"","weibo":"","facebook":"","website":"https://xiangst0816.github.io/blog/","location":"HangZhou, China"}},{"node":{"id":"WALL-E","bio":"还有要清理的吗?","avatar":"/avatar/cleaner.jpg","cover":"","github":null,"twitter":null,"zhihu":null,"weibo":null,"facebook":null,"website":null,"location":"Earth"}}]},"master":{"id":"烈风裘","bio":"一往无前, 直到云开雾散!","avatar":"/avatar/avatar.png","cover":"/background/photo-1503197979108-c824168d51a8.jpeg","github":"https://github.com/xiangst0816","twitter":"","zhihu":"","weibo":"","facebook":"","website":"https://xiangst0816.github.io/blog/","location":"HangZhou, China"},"currentPost":{"html":"<blockquote>\n<p>代码详解 + 备忘记录</p>\n</blockquote>\n<h2 id=\"基础类型\" style=\"position:relative;\"><a href=\"#%E5%9F%BA%E7%A1%80%E7%B1%BB%E5%9E%8B\" aria-label=\"基础类型 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>基础类型</h2>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// 布尔</span>\n<span class=\"token keyword\">let</span> isDone<span class=\"token operator\">:</span> boolean <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// 数字</span>\n<span class=\"token keyword\">let</span> decLiteral<span class=\"token operator\">:</span> number <span class=\"token operator\">=</span> <span class=\"token number\">6</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">let</span> hexLiteral<span class=\"token operator\">:</span> number <span class=\"token operator\">=</span> <span class=\"token number\">0xf00d</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">let</span> binaryLiteral<span class=\"token operator\">:</span> number <span class=\"token operator\">=</span> <span class=\"token number\">0b1010</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">let</span> octalLiteral<span class=\"token operator\">:</span> number <span class=\"token operator\">=</span> <span class=\"token number\">0o744</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// 字符串</span>\n<span class=\"token keyword\">let</span> name<span class=\"token operator\">:</span> string <span class=\"token operator\">=</span> <span class=\"token string\">\"bob\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// 数组</span>\n<span class=\"token keyword\">let</span> list<span class=\"token operator\">:</span> number<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">let</span> list<span class=\"token operator\">:</span> Array<span class=\"token operator\">&lt;</span>number<span class=\"token operator\">></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 数组泛型，Array&lt;元素类型></span>\n<span class=\"token keyword\">let</span> list<span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span>string <span class=\"token operator\">|</span> number<span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'name'</span><span class=\"token punctuation\">]</span>\n<span class=\"token keyword\">let</span> list<span class=\"token operator\">:</span> any<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'name'</span><span class=\"token punctuation\">]</span>\n<span class=\"token comment\">// 对象</span>\n<span class=\"token keyword\">let</span> obj<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>foo<span class=\"token operator\">:</span><span class=\"token string\">'foo'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// 元组类型, 限定了值的pattern: 两个元素, 第一个是string, 第二个是number</span>\n<span class=\"token keyword\">let</span> x<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>string<span class=\"token punctuation\">,</span> number<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// 多类型</span>\n<span class=\"token keyword\">let</span> x<span class=\"token operator\">:</span> string <span class=\"token operator\">|</span> number<span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// 枚举</span>\n<span class=\"token keyword\">enum</span> Color <span class=\"token punctuation\">{</span>Red <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> Green<span class=\"token punctuation\">,</span> Blue<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">let</span> cRed<span class=\"token operator\">:</span> Color <span class=\"token operator\">=</span> Color<span class=\"token punctuation\">.</span>Red<span class=\"token punctuation\">;</span> <span class=\"token comment\">// 1</span>\n<span class=\"token keyword\">let</span> colorName<span class=\"token operator\">:</span> string <span class=\"token operator\">=</span> Color<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Green</span>\n<span class=\"token comment\">// Any</span>\n<span class=\"token keyword\">let</span> notSure<span class=\"token operator\">:</span> any <span class=\"token operator\">=</span> <span class=\"token number\">4</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// Void 表示没有任何类型, 多用于函数返回</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">warnUser</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token keyword\">void</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">alert</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"This is my warning message\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">// Null 和 Undefined, 常用在联合类型, 一般不建议使用</span>\n<span class=\"token keyword\">let</span> u<span class=\"token operator\">:</span> <span class=\"token keyword\">undefined</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">let</span> n<span class=\"token operator\">:</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// Never, 表示的是那些永不存在的值的类型</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">error</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">message<span class=\"token operator\">:</span> string</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> never <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// 返回never的函数必须存在无法达到的终点</span>\n    <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span>message<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">// 类型断言</span>\n<span class=\"token operator\">-</span> “尖括号”语法\n<span class=\"token keyword\">let</span> someValue<span class=\"token operator\">:</span> any <span class=\"token operator\">=</span> <span class=\"token string\">\"this is a string\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">let</span> strLength<span class=\"token operator\">:</span> number <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">&lt;</span>string<span class=\"token operator\">></span>someValue<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span>\n<span class=\"token operator\">-</span> <span class=\"token keyword\">as</span>语法\n<span class=\"token keyword\">let</span> someValue<span class=\"token operator\">:</span> any <span class=\"token operator\">=</span> <span class=\"token string\">\"this is a string\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">let</span> strLength<span class=\"token operator\">:</span> number <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>someValue <span class=\"token keyword\">as</span> string<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// 解构模式标记类型</span>\n<span class=\"token keyword\">let</span> <span class=\"token punctuation\">{</span>a<span class=\"token punctuation\">,</span> b<span class=\"token punctuation\">}</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>a<span class=\"token operator\">:</span> string<span class=\"token punctuation\">,</span> b<span class=\"token operator\">:</span> number<span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> o<span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"变量声明\" style=\"position:relative;\"><a href=\"#%E5%8F%98%E9%87%8F%E5%A3%B0%E6%98%8E\" aria-label=\"变量声明 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>变量声明</h2>\n<ul>\n<li>尽量使用<code class=\"language-text\">let</code>, ‘const’替换<code class=\"language-text\">var</code></li>\n<li>解构和 es6 相同, 注意: <code class=\"language-text\">默认值 + 类型 + 解构</code> 的组合写法</li>\n</ul>\n<h2 id=\"接口\" style=\"position:relative;\"><a href=\"#%E6%8E%A5%E5%8F%A3\" aria-label=\"接口 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>接口</h2>\n<blockquote>\n<p>TypeScript 的核心原则之一是对值所具有的结构进行类型检查。</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// 可选属性</span>\n<span class=\"token keyword\">interface</span> <span class=\"token class-name\">SquareConfig</span> <span class=\"token punctuation\">{</span>\n  color<span class=\"token operator\">?</span><span class=\"token operator\">:</span> string<span class=\"token punctuation\">;</span>\n  width<span class=\"token operator\">?</span><span class=\"token operator\">:</span> number<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">// 只读属性</span>\n<span class=\"token keyword\">interface</span> <span class=\"token class-name\">Point</span> <span class=\"token punctuation\">{</span>\n    readonly x<span class=\"token operator\">:</span> number<span class=\"token punctuation\">;</span>\n    readonly y<span class=\"token operator\">:</span> number<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">// 额外的属性</span>\n<span class=\"token keyword\">interface</span> <span class=\"token class-name\">SquareConfig</span> <span class=\"token punctuation\">{</span>\n    color<span class=\"token operator\">?</span><span class=\"token operator\">:</span> string<span class=\"token punctuation\">;</span>\n    width<span class=\"token operator\">?</span><span class=\"token operator\">:</span> number<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">[</span>propName<span class=\"token operator\">:</span> string<span class=\"token punctuation\">]</span><span class=\"token operator\">:</span> any<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">// 函数类型, 定义调用签名, 只做类型检查(不是函数名)</span>\n<span class=\"token keyword\">interface</span> <span class=\"token class-name\">SearchFunc</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token punctuation\">(</span>source<span class=\"token operator\">:</span> string<span class=\"token punctuation\">,</span> subString<span class=\"token operator\">:</span> string<span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> boolean<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">// 可索引的类型</span>\n<span class=\"token keyword\">interface</span> <span class=\"token class-name\">StringArray</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token punctuation\">[</span>index<span class=\"token operator\">:</span> number<span class=\"token punctuation\">]</span><span class=\"token operator\">:</span> string<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">// 类类型</span>\n<span class=\"token keyword\">interface</span> <span class=\"token class-name\">ClockInterface</span> <span class=\"token punctuation\">{</span>\n    currentTime<span class=\"token operator\">:</span> Date<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">new</span> <span class=\"token punctuation\">(</span>hour<span class=\"token operator\">:</span> number<span class=\"token punctuation\">,</span> minute<span class=\"token operator\">:</span> number<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">setTime</span><span class=\"token punctuation\">(</span>d<span class=\"token operator\">:</span> Date<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Clock</span> <span class=\"token keyword\">implements</span> <span class=\"token class-name\">ClockInterface</span> <span class=\"token punctuation\">{</span>\n    currentTime<span class=\"token operator\">:</span> Date<span class=\"token punctuation\">;</span>\n    <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">h<span class=\"token operator\">:</span> number<span class=\"token punctuation\">,</span> m<span class=\"token operator\">:</span> number</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token punctuation\">}</span>\n    <span class=\"token function\">setTime</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">d<span class=\"token operator\">:</span> Date</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>currentTime <span class=\"token operator\">=</span> d<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">// 继承接口</span>\n<span class=\"token keyword\">interface</span> <span class=\"token class-name\">Shape</span> <span class=\"token punctuation\">{</span>\n    color<span class=\"token operator\">:</span> string<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">interface</span> <span class=\"token class-name\">Square</span> <span class=\"token punctuation\">{</span>\n    sideLength<span class=\"token operator\">:</span> number<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">interface</span> <span class=\"token class-name\">Foo</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Square</span><span class=\"token punctuation\">,</span> Shape <span class=\"token punctuation\">{</span>\n    FooLength<span class=\"token operator\">:</span> number<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">// 接口集成类(未写)</span></code></pre></div>\n<h2 id=\"类\" style=\"position:relative;\"><a href=\"#%E7%B1%BB\" aria-label=\"类 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>类</h2>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// 类</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Greeter</span> <span class=\"token punctuation\">{</span>\n    greeting<span class=\"token operator\">:</span> string<span class=\"token punctuation\">;</span>\n    <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">message<span class=\"token operator\">:</span> string</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>greeting <span class=\"token operator\">=</span> message<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token function\">greet</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token string\">\"Hello, \"</span> <span class=\"token operator\">+</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>greeting<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">let</span> greeter <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Greeter</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"world\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// 继承</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Animal</span> <span class=\"token punctuation\">{</span>\n    name<span class=\"token operator\">:</span>string<span class=\"token punctuation\">;</span>\n    <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">theName<span class=\"token operator\">:</span> string</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span> theName<span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n    <span class=\"token function\">move</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">distanceInMeters<span class=\"token operator\">:</span> number <span class=\"token operator\">=</span> <span class=\"token number\">0</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>name<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> moved </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>distanceInMeters<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">m.</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Snake</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Animal</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">name<span class=\"token operator\">:</span> string</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n    <span class=\"token function\">move</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">distanceInMeters <span class=\"token operator\">=</span> <span class=\"token number\">5</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Slithering...\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">super</span><span class=\"token punctuation\">.</span><span class=\"token function\">move</span><span class=\"token punctuation\">(</span>distanceInMeters<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">// 公共，私有与受保护的修饰符</span>\n<span class=\"token comment\">// 默认public</span>\n<span class=\"token comment\">// private 只在'当前类'的内部访问</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Animal</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">private</span> name<span class=\"token operator\">:</span> string<span class=\"token punctuation\">;</span>\n    <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">theName<span class=\"token operator\">:</span> string</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span> theName<span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">// protected 只在'当前类及其子类'的内部访问</span>\n<span class=\"token comment\">// 如果构造函数也可以被标记成protected, 意味着这个类不能实例化, 只能由子类实例化</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Person</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">protected</span> name<span class=\"token operator\">:</span> string<span class=\"token punctuation\">;</span>\n    <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">name<span class=\"token operator\">:</span> string</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span> name<span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">// readonly修饰符 只读, 只能在构造函数中被初始化</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Octopus</span> <span class=\"token punctuation\">{</span>\n    readonly name<span class=\"token operator\">:</span> string<span class=\"token punctuation\">;</span>\n    readonly numberOfLegs<span class=\"token operator\">:</span> number <span class=\"token operator\">=</span> <span class=\"token number\">8</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">constructor</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">theName<span class=\"token operator\">:</span> string</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span> theName<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">// 存取器(拦截器)</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Employee</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">private</span> _fullName<span class=\"token operator\">:</span> string<span class=\"token punctuation\">;</span>\n\n    <span class=\"token keyword\">get</span> <span class=\"token function\">fullName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> string <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_fullName<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">set</span> <span class=\"token function\">fullName</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">newName<span class=\"token operator\">:</span> string</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>passcode <span class=\"token operator\">&amp;&amp;</span> passcode <span class=\"token operator\">==</span> <span class=\"token string\">\"secret passcode\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>_fullName <span class=\"token operator\">=</span> newName<span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n        <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n            console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Error: Unauthorized update of employee!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">// 静态属性: 这些属性存在于类本身上面而不是类的实例上, 通过Grid.访问</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Grid</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">static</span> origin <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>x<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span> y<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">calculateDistanceFromOrigin</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">point<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>x<span class=\"token operator\">:</span> number<span class=\"token punctuation\">;</span> y<span class=\"token operator\">:</span> number<span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">let</span> xDist <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>point<span class=\"token punctuation\">.</span>x <span class=\"token operator\">-</span> Grid<span class=\"token punctuation\">.</span>origin<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">let</span> yDist <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>point<span class=\"token punctuation\">.</span>y <span class=\"token operator\">-</span> Grid<span class=\"token punctuation\">.</span>origin<span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">sqrt</span><span class=\"token punctuation\">(</span>xDist <span class=\"token operator\">*</span> xDist <span class=\"token operator\">+</span> yDist <span class=\"token operator\">*</span> yDist<span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>scale<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token function\">constructor</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token keyword\">public</span> scale<span class=\"token operator\">:</span> number</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">let</span> grid1 <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Grid</span><span class=\"token punctuation\">(</span><span class=\"token number\">1.0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// 1x scale</span>\n<span class=\"token keyword\">let</span> grid2 <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Grid</span><span class=\"token punctuation\">(</span><span class=\"token number\">5.0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// 5x scale</span>\n\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>grid1<span class=\"token punctuation\">.</span><span class=\"token function\">calculateDistanceFromOrigin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>x<span class=\"token operator\">:</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> y<span class=\"token operator\">:</span> <span class=\"token number\">10</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>grid2<span class=\"token punctuation\">.</span><span class=\"token function\">calculateDistanceFromOrigin</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>x<span class=\"token operator\">:</span> <span class=\"token number\">10</span><span class=\"token punctuation\">,</span> y<span class=\"token operator\">:</span> <span class=\"token number\">10</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// 抽象类</span>\n<span class=\"token comment\">// 构造函数</span>\n<span class=\"token comment\">// 把类当做接口使用</span></code></pre></div>\n<h2 id=\"函数\" style=\"position:relative;\"><a href=\"#%E5%87%BD%E6%95%B0\" aria-label=\"函数 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>函数</h2>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// 函数类型</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">x<span class=\"token operator\">:</span> number<span class=\"token punctuation\">,</span> y<span class=\"token operator\">:</span> number</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> number <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> x <span class=\"token operator\">+</span> y<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">// 可选参数和默认参数</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">buildName</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">firstName<span class=\"token operator\">:</span> string<span class=\"token punctuation\">,</span> lastName<span class=\"token operator\">?</span><span class=\"token operator\">:</span> string</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">buildName</span><span class=\"token punctuation\">(</span>firstName<span class=\"token operator\">:</span> string<span class=\"token punctuation\">,</span> lastName <span class=\"token operator\">=</span> <span class=\"token string\">\"Smith\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">// 剩余参数</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">buildName</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">firstName<span class=\"token operator\">:</span> string<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span>restOfName<span class=\"token operator\">:</span> string<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> firstName <span class=\"token operator\">+</span> <span class=\"token string\">\" \"</span> <span class=\"token operator\">+</span> restOfName<span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token string\">\" \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">// this参数</span>\n<span class=\"token comment\">// noImplicitThis标记: 提供指定类型的this假参数</span>\n<span class=\"token comment\">// this参数在回调函数里: 将this类型设置为void避免函数内部使用this</span>\n\n<span class=\"token comment\">// 重载</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">pickCard</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">x<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>suit<span class=\"token operator\">:</span> string<span class=\"token punctuation\">;</span> card<span class=\"token operator\">:</span> number<span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span></span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> number<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">pickCard</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">x<span class=\"token operator\">:</span> number</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>suit<span class=\"token operator\">:</span> string<span class=\"token punctuation\">;</span> card<span class=\"token operator\">:</span> number<span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">pickCard</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">x</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> any <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// Check to see if we're working with an object/array</span>\n    <span class=\"token comment\">// if so, they gave us the deck and we'll pick the card</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> x <span class=\"token operator\">==</span> <span class=\"token string\">\"object\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">let</span> pickedCard <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> x<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> pickedCard<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token comment\">// Otherwise just let them pick the card</span>\n    <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> x <span class=\"token operator\">==</span> <span class=\"token string\">\"number\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">let</span> pickedSuit <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>x <span class=\"token operator\">/</span> <span class=\"token number\">13</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span> suit<span class=\"token operator\">:</span> suits<span class=\"token punctuation\">[</span>pickedSuit<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> card<span class=\"token operator\">:</span> x <span class=\"token operator\">%</span> <span class=\"token number\">13</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"泛型\" style=\"position:relative;\"><a href=\"#%E6%B3%9B%E5%9E%8B\" aria-label=\"泛型 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>泛型</h2>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// 定义类型变量T</span>\n<span class=\"token keyword\">function</span> identity<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token operator\">></span><span class=\"token punctuation\">(</span>arg<span class=\"token operator\">:</span> <span class=\"token constant\">T</span><span class=\"token punctuation\">)</span><span class=\"token operator\">:</span> <span class=\"token constant\">T</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> arg<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","timeToRead":4,"wordCount":{"paragraphs":10,"sentences":10,"words":17},"fields":{"slug":"/TypeScript/","relativePath":"2017/2017-08-07---TypeScript/index.md"},"excerpt":"代码详解 + 备忘记录 基础类型 变量声明 尽量使用, ‘const’替换 解构和 es6 相同, 注意:  的组合写法 接口 TypeScript 的核心原则之一是对值所具有的结构进行类型检查。 类 函数 泛型","frontmatter":{"title":"TypeScript","date":"07 Aug 2017","tags":["TypeScript"],"cover":"","comments":true,"author":"烈风裘"}},"nextPost":{"html":"<p>这个词我第一次是在<a href=\"http://ionicframework.com/docs/native/deeplinks/\" target=\"_target\" rel=\"nofollow\">IONIC Deeplinks</a>中看到的，它表示在 H5 中使用一个链接（URL Scheme 或者 Universal Links）就能打开我们指定的 App。这样的需求可以参考下面的流程图：</p>\n<p><figure class=\"gatsby-resp-image-figure\" style=\"\">\n    <span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 465px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 141.9047619047619%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAcCAIAAADuuAg3AAAACXBIWXMAAAsSAAALEgHS3X78AAAB/klEQVQ4y5XV2W7aUBAGYL//u4EEF4AElCrs0LCEfUv61aNajrGpOhdHx+NZ/n8WO/n6Lp+plGo+Pj6m0+mvvzIajZLL5XI8Hk+nU97h8XjQX6/XfCA2y+Xy/f19Mpms1+vFYpFEGKr9fn+/3108bjab1WrFlJFH0W+3G2t6Ztvt9nA40CfCzGYz5263O5/PEWuSytvbG2wR1yvO8/k8g+2e0AovUoF8JMlrWI7HY5kwn6WSVBUMQ5zzr0DjgMtwOATnT8EKtSXoASI8uwAcQen5IwzwIZWkkNZJK4PAaMOJOX9RlM3FmSEqwiZqLudgMOCvSBk0F6/iMdiVOIdIrpAZHG6GBOx8aUtgM2o0Gu12u9frNZtNDQdVkVAVTqmQr4RNwhpnl0AYQwKOWOWZ86IqhrQws4XmlTgHePB05eullGfWkpgH6/HfzmqmWroVE/o8SOXOYadOsTCFVf135vDXmDzn/Eciu5Q7GwaEdQX+Wyoe+/0+Lt1uF6JKZy2BudVqmZNoNeb412q1er1ufoxAJK/sc2EljSc4ojizFlQ6M8pXK7aCxKjE/JTD5hmfC5xjDePDZM/g94qmsmBe/0zFRR4QxqnEwmiE6K9gW734hmScaU6puHh81WdNDs7Pv4FX+6ykP1LRWGds/+d3qXRm3el0DANn5cmcnzP/Bu0gWRc7IOvuAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"交互说明\"\n        title=\"交互说明\"\n        src=\"/blog/static/75a6a4144213c78b2e982259bbe40f2c/44d73/deeplinks.png\"\n        srcset=\"/blog/static/75a6a4144213c78b2e982259bbe40f2c/e1650/deeplinks.png 210w,\n/blog/static/75a6a4144213c78b2e982259bbe40f2c/8cae7/deeplinks.png 420w,\n/blog/static/75a6a4144213c78b2e982259bbe40f2c/44d73/deeplinks.png 465w\"\n        sizes=\"(max-width: 465px) 100vw, 465px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span>\n    <figcaption class=\"gatsby-resp-image-figcaption\">交互说明</figcaption>\n  </figure></p>\n<p>因此，结合这个需求，我介绍下<strong>DeepLinks 的概念和交互设计</strong>。</p>\n<h2 id=\"deeplinks-的概念\" style=\"position:relative;\"><a href=\"#deeplinks-%E7%9A%84%E6%A6%82%E5%BF%B5\" aria-label=\"deeplinks 的概念 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>DeepLinks 的概念</h2>\n<p>在 H5 中点击链接跳转到 App 可以使用两个方式实现：<strong>URL Scheme 或者 Universal Links</strong>，URL Scheme 较为通用，Universal Links 为 IOS9.0+系统专属。</p>\n<h3 id=\"url-scheme\" style=\"position:relative;\"><a href=\"#url-scheme\" aria-label=\"url scheme permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>URL Scheme</h3>\n<p>简单地说，就是使用这样的连接<code class=\"language-text\">mycoolapp://path?foo=bar</code>开启你的 App，例如：</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>mycoolapp://<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Open my app<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>mycoolapp://somepath<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Open my app<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>mycoolapp://somepath?foo=bar<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Open my app<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>mycoolapp://?foo=bar<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Open my app<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>或者来一个真实的案例：</p>\n<blockquote>\n<p>使用手机模式在<strong>外部浏览器</strong>中打开，且安装了<code class=\"language-text\">知乎</code>或者<code class=\"language-text\">网易新闻</code>，否则点击会报错或者没反应。</p>\n</blockquote>\n<ul>\n<li>知乎: 《JS 判断 APP 是否安装?》 - <a href=\"zhihu://questions/34831949?utm_campaign=ge19&#x26;utm_content=m_banner\" target=\"_target\" rel=\"nofollow\">在「知乎」中打开</a></li>\n<li>网易新闻: 《刘强东力挺顺丰：我相信王卫为人，质疑菜鸟违法》 - <a href=\"newsapp://doc/CLU0M6DS00097U7R?s=sps_ulink&#x26;ss=sps_article\" target=\"_target\" rel=\"nofollow\">在「网易新闻」中打开</a></li>\n</ul>\n<h4 id=\"1-给-ios-的建议\" style=\"position:relative;\"><a href=\"#1-%E7%BB%99-ios-%E7%9A%84%E5%BB%BA%E8%AE%AE\" aria-label=\"1 给 ios 的建议 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. 给 IOS 的建议</h4>\n<p>上面的这种方式对全系的 Android 和 IOS 系统都适用，但是对于 IOS9.0+在 Safari 中会存在以下问题（以知乎为例）：</p>\n<p>在 Safari 中点击链接会弹出<code class=\"language-text\">在“知乎”中打开？</code>的提示，且 JS 脚本此时不会中断，如果设置了<code class=\"language-text\">setTimeout</code>等操作则完全达不到预期，因为不知道用户什么时候会点击<code class=\"language-text\">打开</code>还是<code class=\"language-text\">取消</code>。</p>\n<p>因此，建议使用<strong>Universal Links</strong>式。当用户安装了 App 则流畅的跳转到 App 中，如果没安装则进入<strong>Universal Links</strong>所指向的位置，一般是下载中转页。</p>\n<h4 id=\"2-给-android-的建议\" style=\"position:relative;\"><a href=\"#2-%E7%BB%99-android-%E7%9A%84%E5%BB%BA%E8%AE%AE\" aria-label=\"2 给 android 的建议 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. 给 Android 的建议</h4>\n<p>这个问题和 IOS9.0+在 Safari 中出现的问题相同，一些安卓机会有<code class=\"language-text\">ActionSheet</code>弹出提示是否进入 App 等选项，因此也会出现<code class=\"language-text\">setTimeout</code>失效的问题。目前「知乎」的方式是：第一次尝试使用<strong>URL Scheme</strong>，1000ms 后 H5 跳转到下载中转页而不做其他处理。</p>\n<h4 id=\"3-微信、微博、qq、支付宝等壳子会拦截-url-scheme\" style=\"position:relative;\"><a href=\"#3-%E5%BE%AE%E4%BF%A1%E3%80%81%E5%BE%AE%E5%8D%9A%E3%80%81qq%E3%80%81%E6%94%AF%E4%BB%98%E5%AE%9D%E7%AD%89%E5%A3%B3%E5%AD%90%E4%BC%9A%E6%8B%A6%E6%88%AA-url-scheme\" aria-label=\"3 微信、微博、qq、支付宝等壳子会拦截 url scheme permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. 微信、微博、QQ、支付宝等壳子会拦截 URL Scheme</h4>\n<p>拦截的意思是点击了这样的链接会毫无反应，上面的示例链接可以在微信中体验下。但是 IOS9.0+使用<code class=\"language-text\">Universal Links</code>的方式上述平台是无法拦截的。因此，对于安卓用户只能跳转到<strong>下载中转页</strong>再做后续动作。</p>\n<h4 id=\"4-url-scheme-命名规则\" style=\"position:relative;\"><a href=\"#4-url-scheme-%E5%91%BD%E5%90%8D%E8%A7%84%E5%88%99\" aria-label=\"4 url scheme 命名规则 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. URL Scheme 命名规则</h4>\n<ul>\n<li>不要使用已存在的 scheme，比如：zhihu、twitter、newsapp、fb 等</li>\n<li>使用小写字母</li>\n<li>不要使用<code class=\"language-text\">-</code>，因为安卓下会转化为<code class=\"language-text\">_</code></li>\n<li>使用一个单词且不加空格</li>\n</ul>\n<h4 id=\"5-建议\" style=\"position:relative;\"><a href=\"#5-%E5%BB%BA%E8%AE%AE\" aria-label=\"5 建议 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5. 建议</h4>\n<p>建议让 IOS 和 Android 的小伙伴提供一致规则的<strong>URL Scheme</strong>规则。</p>\n<h3 id=\"universal-links\" style=\"position:relative;\"><a href=\"#universal-links\" aria-label=\"universal links permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Universal Links</h3>\n<p>这个方法是专属 IOS9.0+的，简单来说就是一种能够方便的通过传统的 HTTP/HTTPS 链接来启动 App，使用相同的网址打开网站和 App。如果英语可以的话建议阅读下面的链接：</p>\n<ul>\n<li><a href=\"https://developer.apple.com/library/content/documentation/General/Conceptual/AppSearch/UniversalLinks.html\" target=\"_target\" rel=\"nofollow\">Universal Links on iOS</a></li>\n</ul>\n<p>当用户点击链接时，如果安装了 App 则跳转到 App；如果没安装则打开链接指向的网址。相比于<strong>URL Scheme</strong>方案具有以下优点：</p>\n<ul>\n<li><strong>Unique</strong>：因为是使用的标准 HTTP or HTTPS 链接到自己的网站，因此别的应用无法伪造</li>\n<li><strong>Secure</strong>：IOS 系统会检查放在自己服务器上的<code class=\"language-text\">apple-app-site-association</code>文件，这个文件用于关联网站和 app 之间的联动关系</li>\n<li><strong>Flexible</strong>：如果没安装应用，则点击<code class=\"language-text\">Universal Links</code>会跳转到关联的网址，可以是主页也可以是下载引导页</li>\n<li><strong>Simple</strong>：一个 URL 连接可以给 App 服务，也可是一个简单的网站</li>\n<li><strong>Private</strong>：别的应用无法拦截这个过程，也无法知道后续是开启 App 还是跳转到 Safari</li>\n</ul>\n<h4 id=\"1-这里给两个示例：\" style=\"position:relative;\"><a href=\"#1-%E8%BF%99%E9%87%8C%E7%BB%99%E4%B8%A4%E4%B8%AA%E7%A4%BA%E4%BE%8B%EF%BC%9A\" aria-label=\"1 这里给两个示例： permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. 这里给两个示例：</h4>\n<blockquote>\n<p>使用 IOS 手机在任何 webview 中打开，且安装了<code class=\"language-text\">知乎</code>或者<code class=\"language-text\">网易新闻</code>，否则点击就会进入链接指向的网站。</p>\n</blockquote>\n<ul>\n<li>知乎: 《JS 判断 APP 是否安装?》 - <a href=\"https://oia.zhihu.com/questions/34831949?utm_campaign=ge19\" target=\"_target\" rel=\"nofollow\">在「知乎」中打开</a></li>\n<li>网易新闻: 《刘强东力挺顺丰：我相信王卫为人，质疑菜鸟违法》 - <a href=\"http://m.163.com/newsapp/applinks.html?path=%2Fdoc%2FCLU0M6DS00097U7R&#x26;s=sps_ulink&#x26;ss=sps_article\" target=\"_target\" rel=\"nofollow\">在「网易新闻」中打开</a></li>\n</ul>\n<h4 id=\"2-如何获得-ios-版本\" style=\"position:relative;\"><a href=\"#2-%E5%A6%82%E4%BD%95%E8%8E%B7%E5%BE%97-ios-%E7%89%88%E6%9C%AC\" aria-label=\"2 如何获得 ios 版本 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. 如何获得 IOS 版本</h4>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> arr <span class=\"token operator\">=</span> window<span class=\"token punctuation\">.</span>navigator<span class=\"token punctuation\">.</span>userAgent<span class=\"token punctuation\">.</span><span class=\"token function\">match</span><span class=\"token punctuation\">(</span><span class=\"token regex\">/OS (\\d+)_(\\d+)?/</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> version <span class=\"token operator\">=</span> arr<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token string\">\".\"</span> <span class=\"token operator\">+</span> arr<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// -> 9.1</span></code></pre></div>\n<h3 id=\"使用何种方式触发跳转\" style=\"position:relative;\"><a href=\"#%E4%BD%BF%E7%94%A8%E4%BD%95%E7%A7%8D%E6%96%B9%E5%BC%8F%E8%A7%A6%E5%8F%91%E8%B7%B3%E8%BD%AC\" aria-label=\"使用何种方式触发跳转 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>使用何种方式触发跳转</h3>\n<p>这里有三种方式：</p>\n<ul>\n<li>iframe</li>\n<li>a 标签 href 属性</li>\n<li>window.location.href</li>\n</ul>\n<p>现在网上给的方案都是大概 1 年左右，都倾向于使用 iframe，但是像「网易新闻」和「知乎」都是使用的<code class=\"language-text\">window.location.href</code>（翻看了源码），好吧，用这个方案吧。</p>\n<blockquote>\n<p>在 IOS 的 Safari 上使用 iframe 方案点击无反应</p>\n</blockquote>\n<h2 id=\"交互设计\" style=\"position:relative;\"><a href=\"#%E4%BA%A4%E4%BA%92%E8%AE%BE%E8%AE%A1\" aria-label=\"交互设计 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>交互设计</h2>\n<p>上面的关系理清，交互就很明确了，简单的流程如下图：</p>\n<p><img src=\"http://upload-images.jianshu.io/upload_images/2036128-0c71665a8bb5b50b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" alt=\"流程图\"></p>\n<p>因为「网易新闻」和「知乎」两个平台都对<code class=\"language-text\">setTimeout</code>定时跳转没有处理，因此都会进入跳转中转页然后根据设备类型及壳子类型初始化对应的<strong>操作提示</strong>及<strong>下载链接</strong>。</p>\n<p>关于这这部分的代码，请参考我写的一个 Demo 示例： <a href=\"https://github.com/xiangsongtao/oia-page\" target=\"_target\" rel=\"nofollow\">仿「知乎」中转页项目工程</a>，如果需要对<code class=\"language-text\">setTimeout</code>处理的话，建议监听页面 hide 事件，对应的兼容库在这里：<a href=\"https://github.com/addyosmani/visibly.js\" target=\"_target\" rel=\"nofollow\">visibly.js</a>。</p>\n<h2 id=\"最后\" style=\"position:relative;\"><a href=\"#%E6%9C%80%E5%90%8E\" aria-label=\"最后 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>最后</h2>\n<ul>\n<li>向 IOS 和 Android 的开发同时搞到 URL Scheme 链接</li>\n<li>向 IOS 同事询问 Universal Links 的链接</li>\n<li>准备 OIA 页面（下载指引页）</li>\n</ul>\n<p>希望以上对你有用。</p>","timeToRead":6,"wordCount":{"paragraphs":57,"sentences":59,"words":325},"fields":{"slug":"/deepLinks/","relativePath":"2017/2017-06-03---deepLinks/index.md"},"excerpt":"这个词我第一次是在IONIC Deeplinks中看到的，它表示在 H5 中使用一个链接（URL Scheme 或者 Universal Links）就能打开我们指定的 App…","frontmatter":{"title":"deepLinks","date":"03 Jun 2017","tags":["Mobile"],"cover":"","comments":true,"author":"烈风裘"}},"prevPost":{"html":"<blockquote>\n<p>文章总结的时间是 2017/11/20</p>\n</blockquote>\n<p>本文是为了梳理 Babel 配置及使用而整理，因为看过使用 Babel 配置项目和文章，存在项目插件使用混乱、文章各种照搬、插件使用听风是雨、插件升级文章内容不再适用的问题。这里就目前最新使用的配置组合进行整理，涉及的插件包括以下三个：</p>\n<ul>\n<li>@babel/preset-env(^7.0.0-beta.32)</li>\n<li>@babel/preset-stage-x(7.0.0-beta.32), x-0,1,2,3</li>\n<li>@babel/polyfill(^7.0.0-beta.32)</li>\n</ul>\n<h2 id=\"babelpreset-env\" style=\"position:relative;\"><a href=\"#babelpreset-env\" aria-label=\"babelpreset env permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>@babel/preset-env</h2>\n<h3 id=\"特性\" style=\"position:relative;\"><a href=\"#%E7%89%B9%E6%80%A7\" aria-label=\"特性 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>特性</h3>\n<h4 id=\"替换之前所有code-classlanguage-textbabel-presets-es20xxcode插件\" style=\"position:relative;\"><a href=\"#%E6%9B%BF%E6%8D%A2%E4%B9%8B%E5%89%8D%E6%89%80%E6%9C%89code-classlanguage-textbabel-presets-es20xxcode%E6%8F%92%E4%BB%B6\" aria-label=\"替换之前所有code classlanguage textbabel presets es20xxcode插件 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>替换之前所有<code class=\"language-text\">babel-presets-es20xx</code>插件</h4>\n<blockquote>\n<p>A Babel preset that compiles ES2015+ down to ES5 by automatically determining the Babel plugins and polyfills you need based on your targeted browser or runtime environments.</p>\n</blockquote>\n<p>也就是说，这是一个能根据运行环境为代码做相应的编译，<code class=\"language-text\">@babel/preset-env</code>的推出是为了解解决个性化输出目标代码的问题，通过<code class=\"language-text\">browserslist</code>语法解析需要支持的目标环境，根据环境将源代码转义到目标代码，可以实现代码精准适配。</p>\n<p>此外，<strong><code class=\"language-text\">@babel/preset-env</code>不包含<code class=\"language-text\">state-x</code>一些列插件</strong>，只支持最新推出版本的 JavaScript 语法（state-4），关于<code class=\"language-text\">state-x</code>后面会介绍。</p>\n<p>更进一步说明，请参考<a href=\"http://2ality.com/2017/02/babel-preset-env.html\" target=\"_target\" rel=\"nofollow\">Dr. Axel Rauschmayer</a>的介绍。这个插件对特殊平台的开发有很大帮助，比如：Electron、大屏、移动端(只考虑 webkit)等。</p>\n<h4 id=\"替换code-classlanguage-textbabelplugin-transform-runtimecode的使用\" style=\"position:relative;\"><a href=\"#%E6%9B%BF%E6%8D%A2code-classlanguage-textbabelplugin-transform-runtimecode%E7%9A%84%E4%BD%BF%E7%94%A8\" aria-label=\"替换code classlanguage textbabelplugin transform runtimecode的使用 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>替换<code class=\"language-text\">@babel/plugin-transform-runtime</code>的使用</h4>\n<p><code class=\"language-text\">@babel/plugin-transform-runtime</code>插件是为了解决：</p>\n<ul>\n<li>多个文件重复引用相同 helpers（帮助函数）-> 提取运行时</li>\n<li>新 API 方法全局污染 -> 局部引入</li>\n</ul>\n<p>这个插件推荐在编写 library/module 时使用。当然，以上问题可通过设置<code class=\"language-text\">useBuiltIns</code>搞定。</p>\n<h4 id=\"支持实例方法按需引入\" style=\"position:relative;\"><a href=\"#%E6%94%AF%E6%8C%81%E5%AE%9E%E4%BE%8B%E6%96%B9%E6%B3%95%E6%8C%89%E9%9C%80%E5%BC%95%E5%85%A5\" aria-label=\"支持实例方法按需引入 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>支持实例方法按需引入</h4>\n<p>传统方式是手动从<code class=\"language-text\">core-js</code>引入需要的 ES6+特性，</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'core-js/fn/set'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'core-js/fn/array/from'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'core-js/fn/array/find-index'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">...</span>\n<span class=\"token operator\">...</span></code></pre></div>\n<p>或者一股脑全部引入：</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token string\">\"@babel/polyfill\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// or</span>\n<span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"@babel/polyfill\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>同样，以上问题可通过设置<code class=\"language-text\">useBuiltIns</code>搞定。</p>\n<h3 id=\"使用说明\" style=\"position:relative;\"><a href=\"#%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E\" aria-label=\"使用说明 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>使用说明</h3>\n<p>默认情况下，<code class=\"language-text\">@babel/preset-env</code>的效果和<code class=\"language-text\">@babel/preset-latest</code>一样，虽然上面的说明有提到 polyfills，但是也需要在配置中设置<code class=\"language-text\">useBuiltIns</code>才会生效。</p>\n<h3 id=\"主要配置\" style=\"position:relative;\"><a href=\"#%E4%B8%BB%E8%A6%81%E9%85%8D%E7%BD%AE\" aria-label=\"主要配置 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>主要配置</h3>\n<h4 id=\"targets\" style=\"position:relative;\"><a href=\"#targets\" aria-label=\"targets permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>targets</h4>\n<p><strong>设置支持环境</strong>，支持的<code class=\"language-text\">key</code>包括：chrome, opera, edge, firefox, safari, ie, ios, android, node, electron。</p>\n<p>例如：</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"presets\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">[</span>\n      <span class=\"token string\">\"@babel/env\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">{</span>\n        <span class=\"token property\">\"targets\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token property\">\"node\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"current\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token property\">\"chrome\"</span><span class=\"token operator\">:</span> <span class=\"token number\">52</span><span class=\"token punctuation\">,</span>\n          <span class=\"token property\">\"browsers\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"last 2 versions\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"safari 7\"</span><span class=\"token punctuation\">]</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>其中，<strong><code class=\"language-text\">browserslist</code>可在<code class=\"language-text\">package.json</code>中配置</strong>，这个和设置 CSS 的 Autoprefixer 一致，配置优先级如下：</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">targets.browsers &gt; package.json/browserslist</code></pre></div>\n<p>此外，<strong><code class=\"language-text\">browserslist</code>的配置满足最大匹配原则</strong>，比如需要同时支持在 IE 8 和 Chrome 55 下运行，则<code class=\"language-text\">preset-env</code>提供所有 IE 8 下需要的插件，即使 Chrome 55 可能不需要。</p>\n<h4 id=\"modules\" style=\"position:relative;\"><a href=\"#modules\" aria-label=\"modules permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>modules</h4>\n<p>选项用于模块转化规则设置，可选配置包括：“amd” | “umd” | “systemjs” | “commonjs” | false, 默认使用 “commonjs”。即，将代码中的 ES6 的<code class=\"language-text\">import</code>转为<code class=\"language-text\">require</code>。</p>\n<p>如果你当前的 webpack 构建环境是 2.x/3.x，推荐将<code class=\"language-text\">modules</code>设置为<code class=\"language-text\">false</code>，即交由 Webpack 来处理模块化，通过其 TreeShaking 特性将有效减少打包出来的 JS 文件大小。这部分参考这里的回答：<a href=\"https://www.zhihu.com/question/27917401/answer/223309781\" target=\"_target\" rel=\"nofollow\">ECMAScript 6 的模块相比 CommonJS 的 require (…)有什么优点？</a></p>\n<h4 id=\"usebuiltins\" style=\"position:relative;\"><a href=\"#usebuiltins\" aria-label=\"usebuiltins permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>useBuiltIns</h4>\n<blockquote>\n<p>A way to apply @babel/preset-env for polyfills (via @babel/polyfill).</p>\n</blockquote>\n<p>可选值包括：“usage” | “entry” | false, 默认为 false，表示不对 polyfills 处理，<strong>这个配置是引入 polyfills 的关键</strong>。</p>\n<h5 id=\"usebuiltinsusage\" style=\"position:relative;\"><a href=\"#usebuiltinsusage\" aria-label=\"usebuiltinsusage permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>“useBuiltIns”:“usage”</h5>\n<p>在文件需要的位置单独按需引入，可以保证在每个 bundler 中只引入一份。例如：</p>\n<p><strong>In</strong></p>\n<p>a.js</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">var</span> a <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>b.js</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">var</span> b <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><strong>Out (if environment doesn’t support it)</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token string\">\"core-js/modules/es6.promise\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> a <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token string\">\"core-js/modules/es6.map\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> b <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><strong>Out (if environment supports it)</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">var</span> a <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> b <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><strong>！！注意！！</strong></p>\n<p>当前模式类似于<code class=\"language-text\">@babel/plugin-transform-runtime</code>，polyfill 局部使用，制造一个沙盒环境，不造成全局污染，但是如上配置后，<strong><code class=\"language-text\">@babel/preset-env</code>能按需引入新实例方法</strong>，例如：</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token string\">\"foobar\"</span><span class=\"token punctuation\">.</span><span class=\"token function\">includes</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"foo\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>而<code class=\"language-text\">@babel/plugin-transform-runtime</code>不行，需要自行从<code class=\"language-text\">core-js</code>中按需引入。我测试的情况和下面这篇文章所说完全不一致。</p>\n<blockquote>\n<p>原文：<a href=\"https://zhuanlan.zhihu.com/p/29506685\" target=\"_target\" rel=\"nofollow\">https://zhuanlan.zhihu.com/p/29506685</a></p>\n<p>当 useBuiltIns 设置为 usage 时，Babel 会在你使用到 ES2015+ 新特性时，自动添加 babel-polyfill 的引用，并且是 partial 级别的引用。</p>\n<blockquote>\n<p>请注意： usage 的行为类似 babel-transform-runtime，不会造成全局污染，<strong>因此也会不会对类似 Array.prototype.includes() 进行 polyfill</strong>。</p>\n</blockquote>\n</blockquote>\n<h5 id=\"usebuiltinsentry\" style=\"position:relative;\"><a href=\"#usebuiltinsentry\" aria-label=\"usebuiltinsentry permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>“useBuiltIns”:“entry”</h5>\n<p>在项目入口引入一次（多次引入会报错）</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token string\">\"@babel/polyfill\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// or</span>\n<span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"@babel/polyfill\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>插件<code class=\"language-text\">@babel/preset-env</code>会将把<code class=\"language-text\">@babel/polyfill</code>根据实际需求<strong>打散</strong>，只留下必须的，例如：</p>\n<p><strong>In</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token string\">\"@babel/polyfill\"</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><strong>Out (different based on environment)</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token string\">\"core-js/modules/es6.promise\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token string\">\"core-js/modules/es7.string.pad-start\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token string\">\"core-js/modules/es7.string.pad-end\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token string\">\"core-js/modules/es7.array.includes\"</span><span class=\"token punctuation\">;</span></code></pre></div>\n<blockquote>\n<p>除了新 API，也可以是实例方法，不过最终包体积比使用<code class=\"language-text\">&quot;useBuiltIns&quot;:&quot;usage&quot;</code>大 30kb 左右（因项目而异）。</p>\n</blockquote>\n<h5 id=\"usebuiltins-false\" style=\"position:relative;\"><a href=\"#usebuiltins-false\" aria-label=\"usebuiltins false permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>“useBuiltIns”: false</h5>\n<p>不在代码中使用 polyfills，表现形式和<code class=\"language-text\">@babel/preset-latest</code>一样，当使用 ES6+语法及 API 时，在不支持的环境下会报错。</p>\n<h2 id=\"babelpreset-stage-x\" style=\"position:relative;\"><a href=\"#babelpreset-stage-x\" aria-label=\"babelpreset stage x permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>@babel/preset-stage-x</h2>\n<p>这里需要说明下 ES 特性支持的提案，不同阶段的提案支持的内容不同，其中<code class=\"language-text\">stage-4</code>阶段提案中的特性将会在未来发布。</p>\n<p>关于各个 Stage 的说明参考<a href=\"http://babeljs.io/docs/plugins#stage-x-experimental-presets\" target=\"_target\" rel=\"nofollow\">这里</a>。上面介绍的<code class=\"language-text\">@babel/preset-env</code>或者<code class=\"language-text\">@babel/preset-latest</code>就是下面提到的<code class=\"language-text\">stage-4</code>。</p>\n<blockquote>\n<p>The TC39 categorizes proposals into the following stages:</p>\n<ul>\n<li>Stage 0 - Strawman: just an idea, possible Babel plugin.</li>\n<li>Stage 1 - Proposal: this is worth working on.</li>\n<li>Stage 2 - Draft: initial spec.</li>\n<li>Stage 3 - Candidate: complete spec and initial browser implementations.</li>\n<li>Stage 4 - Finished: will be added to the next yearly release.</li>\n</ul>\n</blockquote>\n<p>Stage 的包含顺序是：<strong>左边包含右边全部特性，即 stage-0 包含右边 1 / 2 / 3 的所有插件。</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">stage-0 &gt; ~1 &gt; ~2 &gt; ~3 &gt; ~4:</code></pre></div>\n<h3 id=\"疑问\" style=\"position:relative;\"><a href=\"#%E7%96%91%E9%97%AE\" aria-label=\"疑问 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>疑问</h3>\n<h4 id=\"1-这个和code-classlanguage-textbabelpreset-envcode的区别\" style=\"position:relative;\"><a href=\"#1-%E8%BF%99%E4%B8%AA%E5%92%8Ccode-classlanguage-textbabelpreset-envcode%E7%9A%84%E5%8C%BA%E5%88%AB\" aria-label=\"1 这个和code classlanguage textbabelpreset envcode的区别 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. 这个和<code class=\"language-text\">@babel/preset-env</code>的区别</h4>\n<p><code class=\"language-text\">@babel/preset-env</code>会根据预设的浏览器兼容列表从<code class=\"language-text\">stage-4</code>选取必须的 plugin，也就是说，不引入别的<code class=\"language-text\">stage-x</code>，<code class=\"language-text\">@babel/preset-env</code>将只支持到<code class=\"language-text\">stage-4</code>。</p>\n<h3 id=\"建议\" style=\"position:relative;\"><a href=\"#%E5%BB%BA%E8%AE%AE\" aria-label=\"建议 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>建议</h3>\n<h4 id=\"1-如果是-react-用户，建议配到code-classlanguage-textbabelpreset-stage-0code\" style=\"position:relative;\"><a href=\"#1-%E5%A6%82%E6%9E%9C%E6%98%AF-react-%E7%94%A8%E6%88%B7%EF%BC%8C%E5%BB%BA%E8%AE%AE%E9%85%8D%E5%88%B0code-classlanguage-textbabelpreset-stage-0code\" aria-label=\"1 如果是 react 用户，建议配到code classlanguage textbabelpreset stage 0code permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. 如果是 React 用户，建议配到<code class=\"language-text\">@babel/preset-stage-0</code></h4>\n<p>其中的两个插件对于写 JSX 很有帮助。</p>\n<ul>\n<li>transform-do-expressions：if/else 三目运算展开</li>\n<li>transform-function-bind：this 绑定</li>\n</ul>\n<h4 id=\"2-通常使用建议配到code-classlanguage-textbabelpreset-stage-2code\" style=\"position:relative;\"><a href=\"#2-%E9%80%9A%E5%B8%B8%E4%BD%BF%E7%94%A8%E5%BB%BA%E8%AE%AE%E9%85%8D%E5%88%B0code-classlanguage-textbabelpreset-stage-2code\" aria-label=\"2 通常使用建议配到code classlanguage textbabelpreset stage 2code permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. 通常使用建议配到<code class=\"language-text\">@babel/preset-stage-2</code></h4>\n<p>插件包括：</p>\n<ul>\n<li>syntax-dynamic-import： 动态 import</li>\n<li>transform-class-properties：用于 class 的属性转化</li>\n<li>transform-object-rest-spread：用来处理 rest spread</li>\n<li>transform-async-generator-functions：用来处理 async 和 await</li>\n</ul>\n<h2 id=\"babelpolyfill\" style=\"position:relative;\"><a href=\"#babelpolyfill\" aria-label=\"babelpolyfill permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>@babel/polyfill</h2>\n<p>这个插件是对<a href=\"https://www.npmjs.com/package/core-js\" target=\"_target\" rel=\"nofollow\">core-js</a>和<a href=\"https://www.npmjs.com/package/regenerator-runtime\" target=\"_target\" rel=\"nofollow\">regenerator-runtime</a>的再次封装，在<code class=\"language-text\">@babel/preset-env</code>中的<code class=\"language-text\">useBuiltIns: entry</code>用到，<a href=\"https://github.com/babel/babel/blob/master/packages/babel-polyfill/src/index.js\" target=\"_target\" rel=\"nofollow\">代码不多</a>。</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>global<span class=\"token punctuation\">.</span>_babelPolyfill<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"only one instance of @babel/polyfill is allowed\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\nglobal<span class=\"token punctuation\">.</span>_babelPolyfill <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> <span class=\"token string\">\"core-js/shim\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token string\">\"regenerator-runtime/runtime\"</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><strong>core-js/shim</strong></p>\n<blockquote>\n<p>shim only: Only includes the standard methods.</p>\n</blockquote>\n<p>只包含了纳入标准的<strong>API</strong>及<strong>实例化方法</strong>，例如下列常见的。注意，这里没有 generator/async，如果需要，那就安装插件<code class=\"language-text\">@babel/preset-stage-3</code>（或者 0 / 1 / 2）</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token operator\">...</span>\n<span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./modules/es6.string.trim'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./modules/es6.string.includes'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./modules/es7.array.includes'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./modules/es6.promise'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token operator\">...</span></code></pre></div>\n<p><strong>regenerator-runtime/runtime</strong></p>\n<blockquote>\n<p>Standalone runtime for Regenerator-compiled generator and async functions.</p>\n</blockquote>\n<p>主要是给 generator/async 做支持的插件。</p>\n<h2 id=\"总结\" style=\"position:relative;\"><a href=\"#%E6%80%BB%E7%BB%93\" aria-label=\"总结 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>总结</h2>\n<p>这里需要理解下三个概念：</p>\n<ul>\n<li>最新 ES 语法：比如，箭头函数</li>\n<li>最新 ES API：，比如，Promise</li>\n<li>最新 ES 实例方法：比如，String.protorype.includes</li>\n</ul>\n<p><code class=\"language-text\">@babel/preset-env</code>默认支持<strong>语法</strong>转化，需要开启<code class=\"language-text\">useBuiltIns</code>配置才能转化<strong>API</strong>和<strong>实例方法</strong>。</p>\n<p>此外，不管是写项目还是写 Library/Module，使用<code class=\"language-text\">@babel/preset-env</code>并正确配置就行。多看英文原稿说明，中文总结看看就好，别太当真。</p>\n<h2 id=\"参考\" style=\"position:relative;\"><a href=\"#%E5%8F%82%E8%80%83\" aria-label=\"参考 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>参考</h2>\n<ul>\n<li><a href=\"https://www.npmjs.com/package/@babel/preset-env\" target=\"_target\" rel=\"nofollow\">@babel/preset-env</a></li>\n<li><a href=\"https://www.npmjs.com/package/@babel/preset-stage-0\" target=\"_target\" rel=\"nofollow\">@babel/preset-stage-0</a></li>\n<li><a href=\"https://www.npmjs.com/package/@babel/preset-stage-1\" target=\"_target\" rel=\"nofollow\">@babel/preset-stage-1</a></li>\n<li><a href=\"https://www.npmjs.com/package/@babel/preset-stage-2\" target=\"_target\" rel=\"nofollow\">@babel/preset-stage-2</a></li>\n<li><a href=\"https://www.npmjs.com/package/@babel/preset-stage-3\" target=\"_target\" rel=\"nofollow\">@babel/preset-stage-3</a></li>\n<li><a href=\"https://www.cnblogs.com/chris-oil/p/5717544.html\" target=\"_target\" rel=\"nofollow\">stage 的区别</a></li>\n<li><a href=\"https://zhuanlan.zhihu.com/p/25961891\" target=\"_target\" rel=\"nofollow\">弄清楚 babel 的 stage</a></li>\n<li><a href=\"https://zhuanlan.zhihu.com/p/29506685\" target=\"_target\" rel=\"nofollow\">再见，babel-preset-2015</a></li>\n<li><a href=\"https://www.zhihu.com/question/27917401/answer/223309781\" target=\"_target\" rel=\"nofollow\">ECMAScript 6 的模块相比 CommonJS 的 require (…)有什么优点？</a></li>\n</ul>","timeToRead":10,"wordCount":{"paragraphs":106,"sentences":109,"words":543},"fields":{"slug":"/guan-yu-Babel-zui-xin-shi-yong-fang-shi/","relativePath":"2017/2017-11-19---guan-yu-Babel-zui-xin-shi-yong-fang-shi/index.md"},"excerpt":"文章总结的时间是 2017/11/20 本文是为了梳理 Babel 配置及使用而整理，因为看过使用 Babel…","frontmatter":{"title":"关于Babel最新使用方式","date":"19 Nov 2017","tags":["Babel","JavaScript"],"cover":"","comments":true,"author":"烈风裘"}}},"pageContext":{"curr":"/TypeScript/","prev":"/guan-yu-Babel-zui-xin-shi-yong-fang-shi/","next":"/deepLinks/"}},"staticQueryHashes":["3240721340","63159454"]}