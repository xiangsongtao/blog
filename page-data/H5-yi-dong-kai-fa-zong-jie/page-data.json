{"componentChunkName":"component---src-templates-blog-post-js","path":"/H5-yi-dong-kai-fa-zong-jie/","result":{"data":{"site":{"siteMetadata":{"title":"Attila","cover":"/background/1.jpg","description":"Thoughts, stories and ideas.","keywords":["烈风裘的博客","X-Blog","Attila","Gatsby","前端成长记录"],"tagCover":"/background/5.jpg","archiveCover":"/background/escape-flight.png","siteUrl":"https://xiangst0816.github.io/blog","logo":"","navigation":true,"subscribe":true}},"allAuthorJson":{"totalCount":2,"edges":[{"node":{"id":"烈风裘","bio":"一往无前, 直到云开雾散!","avatar":"/avatar/me.jpeg","cover":"/background/photo-1503197979108-c824168d51a8.jpeg","github":"https://github.com/xiangst0816","twitter":"","zhihu":"","weibo":"","facebook":"","website":"https://xiangst0816.github.io/blog/","location":"HangZhou, China"}},{"node":{"id":"WALL-E","bio":"还有要清理的吗?","avatar":"/avatar/cleaner.jpg","cover":"","github":null,"twitter":null,"zhihu":null,"weibo":null,"facebook":null,"website":null,"location":"Earth"}}]},"master":{"id":"烈风裘","bio":"一往无前, 直到云开雾散!","avatar":"/avatar/me.jpeg","cover":"/background/photo-1503197979108-c824168d51a8.jpeg","github":"https://github.com/xiangst0816","twitter":"","zhihu":"","weibo":"","facebook":"","website":"https://xiangst0816.github.io/blog/","location":"HangZhou, China"},"currentPost":{"html":"<h2 id=\"透明度\" style=\"position:relative;\"><a href=\"#%E9%80%8F%E6%98%8E%E5%BA%A6\" aria-label=\"透明度 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>透明度</h2>\n<p>主要是兼容 IE6+的写法，当我们在兼容低版本浏览器的时候可能下面的写法可以满足我们的需求（两个属性都写上，浏览器识别的属性直接覆盖前者的属性）：</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">.item1{\n    opacity:0.1;\n    //IE8以上浏览器识别\n    filter: progid:DXImageTransform.Microsoft.Alpha(opacity=70);\n    //滤镜低版本IE7-8支持\n}</code></pre></div>\n<h2 id=\"html5-标签唤起发短信功能\" style=\"position:relative;\"><a href=\"#html5-%E6%A0%87%E7%AD%BE%E5%94%A4%E8%B5%B7%E5%8F%91%E7%9F%AD%E4%BF%A1%E5%8A%9F%E8%83%BD\" aria-label=\"html5 标签唤起发短信功能 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>html5 标签唤起发短信功能</h2>\n<p>做 html5 开发的过程中，我们可能会有这样的需求：</p>\n<p>点击按钮，呼起系统的发送短信的窗口，并且自动填充发送到的号码和内容。网络上可以很容易的找到这方面的 demo ，并且也可以找到在安卓上和 iOS 上是有却别的（body 之前的标示）：</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">&lt;!-- ios UC浏览器--&gt;\n&lt;a href=&quot;sms:10086?body=发送的内容&quot;&gt;点击我发送短信&lt;/a&gt;\n&lt;!-- ios &lt;=ios7--&gt;\n&lt;a href=&quot;sms:10086;body=发送的内容&quot;&gt;点击我发送短信&lt;/a&gt;\n&lt;!-- ios &gt;=ios8--&gt;\n&lt;a href=&quot;sms:10086&amp;body=发送的内容&quot;&gt;点击我发送短信&lt;/a&gt;\n&lt;!-- android--&gt;\n&lt;a href=&quot;sms:10086?body=发送的内容&quot;&gt;点击我发送短信&lt;/a&gt;</code></pre></div>\n<p>这里有图片</p>\n<h2 id=\"input-标签选择系统文件的问题\" style=\"position:relative;\"><a href=\"#input-%E6%A0%87%E7%AD%BE%E9%80%89%E6%8B%A9%E7%B3%BB%E7%BB%9F%E6%96%87%E4%BB%B6%E7%9A%84%E9%97%AE%E9%A2%98\" aria-label=\"input 标签选择系统文件的问题 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>input 标签选择系统文件的问题</h2>\n<p>在 html5 中 input 标签提供给了开发者访问系统文件的能力。在移动端的系统浏览器中使用 input 控件没有什么问题。但是在 app 的<strong>webview</strong>中需要注意，webview 读取系统文件是需要有权限的，如果权限未设置会出现 bug，IOS 和 Android 同理。</p>\n<h2 id=\"多页面-html-如何传递数据\" style=\"position:relative;\"><a href=\"#%E5%A4%9A%E9%A1%B5%E9%9D%A2-html-%E5%A6%82%E4%BD%95%E4%BC%A0%E9%80%92%E6%95%B0%E6%8D%AE\" aria-label=\"多页面 html 如何传递数据 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>多页面 html 如何传递数据</h2>\n<p>传统的方法是在页面 url 的 query 中添加参数，但是需要处处携带。但是使用本地存储就可以解决。这个是淘宝的一个面试题，不过熟悉 sessionStroage 及 localStorage 的同学应该知道怎么办了。</p>\n<p>另外，在 app 的<strong>webview</strong>中需要注意，IOS 和 Android 的同学开启 localStorage 向磁盘写文件的权限。</p>\n<h2 id=\"js-在客户端生成二维码或者一维码\" style=\"position:relative;\"><a href=\"#js-%E5%9C%A8%E5%AE%A2%E6%88%B7%E7%AB%AF%E7%94%9F%E6%88%90%E4%BA%8C%E7%BB%B4%E7%A0%81%E6%88%96%E8%80%85%E4%B8%80%E7%BB%B4%E7%A0%81\" aria-label=\"js 在客户端生成二维码或者一维码 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>JS 在客户端生成二维码或者一维码</h2>\n<p>这个能实现，使用 qrcodejs 或者 jQuery.qrcide 插件。前辈总结的图用下：</p>\n<p>这里有图！！</p>\n<h2 id=\"本地存储-js-字符串并解析\" style=\"position:relative;\"><a href=\"#%E6%9C%AC%E5%9C%B0%E5%AD%98%E5%82%A8-js-%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%B9%B6%E8%A7%A3%E6%9E%90\" aria-label=\"本地存储 js 字符串并解析 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>本地存储 JS 字符串并解析</h2>\n<p>最终的书写代码如下：</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">var fnStr = &#39;return function (){console.log(&quot;you are here!&quot;)}&#39;\nvar fn = new Function(fnStr);\nfn()\n-&gt; function (){console.log(&quot;you are here!&quot;)}\nfn()()\n-&gt; you are here!</code></pre></div>\n<h2 id=\"键盘被呼起模拟滚动\" style=\"position:relative;\"><a href=\"#%E9%94%AE%E7%9B%98%E8%A2%AB%E5%91%BC%E8%B5%B7%E6%A8%A1%E6%8B%9F%E6%BB%9A%E5%8A%A8\" aria-label=\"键盘被呼起模拟滚动 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>键盘被呼起模拟滚动</h2>\n<p>在移动端浏览器中，正常情况下点击 Input 是能自动滚动页面让 input 和键盘显示在一起。但是在某些 webview 中需要 js 模拟唤起，下面是实现代码：</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">function inputScroll(dom){\nvar tplList=[&#39;ss&#39;,&#39;bb&#39;] ;\n\nvar tpl = $.fn.getQueryString(tpl);\n  if(tplList.indexOf(tpl)){\n    dom.focus(function(){\n      var clientHeight = $(window).height();\n      var contentHeight = clientHeight + clientHeight/2;\n      var smsInputTop= $(this).offset().top;\n\n      content.height(contentHeight);\n      window.scrollTo(0,smsInputTop-76);\n    });\n  }\n}</code></pre></div>\n<h2 id=\"参考\" style=\"position:relative;\"><a href=\"#%E5%8F%82%E8%80%83\" aria-label=\"参考 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>参考</h2>\n<ul>\n<li><a href=\"https://github.com/zhiqiang21/blog/issues/27\" target=\"_target\" rel=\"nofollow\">移动端 h5 开发相关内容总结（四）</a></li>\n</ul>","timeToRead":4,"wordCount":{"paragraphs":20,"sentences":20,"words":103},"fields":{"slug":"/H5-yi-dong-kai-fa-zong-jie/","relativePath":"2016/2016-10-20---H5-yi-dong-kai-fa-zong-jie/index.md"},"excerpt":"透明度 主要是兼容 IE6+的写法，当我们在兼容低版本浏览器的时候可能下面的写法可以满足我们的需求（两个属性都写上，浏览器识别的属性直接覆盖前者的属性）： html5 标签唤起发短信功能 做 html…","frontmatter":{"title":"H5移动开发总结","date":"20 Oct 2016","tags":["Mobile"],"cover":"","comments":true,"author":"烈风裘"}},"nextPost":{"html":"<blockquote>\n<p>前言介绍，因为在给网站升级 https，其中涉及到修改文件内容等操作，于是阴差阳错的将/etc 文件全部<code class=\"language-text\">chmod 777</code>了，结果导致阿里云服务器远程 SSH 无法登录及 FTP 也无法使用。</p>\n<p>更悲催的是，我之前都没做过数据库镜像备份及数据库备份，想着应该不会发生，结果还是发生了。从客服了解到，只能重置服务器，让我将‘受伤’的系统盘做一个镜像。等新系统初始化完毕之后挂载镜像再做修复。</p>\n<p>于是，就有了这边文章的起源。从零开始部署+修复数据。不过，没想象的难。</p>\n</blockquote>\n<h2 id=\"mevn\" style=\"position:relative;\"><a href=\"#mevn\" aria-label=\"mevn permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>MEVN</h2>\n<p>这个单词是 Mongodb、Express、Vue、Nodejs 全栈技术的缩写，和 MEAN 很像，其中 Vue 也是 MVVM 框架，因此改动不算大。</p>\n<h2 id=\"阿里云服务器\" style=\"position:relative;\"><a href=\"#%E9%98%BF%E9%87%8C%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8\" aria-label=\"阿里云服务器 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>阿里云服务器</h2>\n<p>购买了阿里云的包年的服务器，选择 CentOS+Nginx+Nodejs 的环境配置之后拿到手的就是原始的服务器环境。</p>\n<h2 id=\"ssh-登录\" style=\"position:relative;\"><a href=\"#ssh-%E7%99%BB%E5%BD%95\" aria-label=\"ssh 登录 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SSH 登录</h2>\n<p>Mac 使用起来还是挺方便的，在终端中输入命令及密码：</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ ssh -p 22 root@xxx.xxx.xxx.xxx\n$ password</code></pre></div>\n<h2 id=\"nodejs-升级\" style=\"position:relative;\"><a href=\"#nodejs-%E5%8D%87%E7%BA%A7\" aria-label=\"nodejs 升级 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Nodejs 升级</h2>\n<p>升级 Nodejs 是为了使用 ES6 的语法写后台应用，首次尝试了使用 YUM 安装：</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ yum insalll -y nodejs</code></pre></div>\n<p>这个命令安装的是 0.10 版本，但是现在 Node 最新版本已经是 6.8.1 了，故需要换一个方法。先下载最新版本，之后再安装。<a href=\"http://jingyan.baidu.com/article/dca1fa6f48f478f1a5405272.html\" target=\"_target\" rel=\"nofollow\">参考这里</a>。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ curl --silent --location https://rpm.nodesource.com/setup_6.x | bash -\n$ yum install -y nodejs</code></pre></div>\n<p>之后是安装 npm 包管理器、n 命令（nodejs 版本管理工具）、cnpm、pm2</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$  yun install -y npm\n$ npm install n -g\n$ npm install cnpm -g\n$ cnpm install pm2 -g</code></pre></div>\n<h2 id=\"挂载原来的镜像文件\" style=\"position:relative;\"><a href=\"#%E6%8C%82%E8%BD%BD%E5%8E%9F%E6%9D%A5%E7%9A%84%E9%95%9C%E5%83%8F%E6%96%87%E4%BB%B6\" aria-label=\"挂载原来的镜像文件 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>挂载原来的镜像文件</h2>\n<p>邀请了阿里云的客服帮我把以前的服务器镜像挂载到了<code class=\"language-text\">/dev/vdb1</code>下，通过下面的的命令打开镜像，很是很简单。镜像在<code class=\"language-text\">/alidata/disk_bk</code>下显示。之后就可以 cd 进去了。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ mount -o loop /dev/vdb1 /alidata/disk_bk</code></pre></div>\n<p>解挂命令(当前在/alidata 下)：</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ umount disk_bk/\n\n$ lsof | grpe disk_bk //如果解挂不行，查询当前那个进程在使用，然后\n$ kill -9 pid</code></pre></div>\n<p>使用<code class=\"language-text\">mv</code>命令将以前的资料导出到新环境中，包括部署前端文件及数据库。</p>\n<h2 id=\"nginx\" style=\"position:relative;\"><a href=\"#nginx\" aria-label=\"nginx permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Nginx</h2>\n<p>我只是修改了转发端口，之前是代理 8088，我改成了我的 8080.</p>\n<p>配置文件：</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">/alidata/server/nginx/conf/vhosts</code></pre></div>\n<p>进入目录后重启服务：</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ cd /alidata/server/nginx/sbin\n$ ./nginx -s reload</code></pre></div>\n<h2 id=\"mongodb\" style=\"position:relative;\"><a href=\"#mongodb\" aria-label=\"mongodb permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Mongodb</h2>\n<h3 id=\"关闭以前的-mongod-服务\" style=\"position:relative;\"><a href=\"#%E5%85%B3%E9%97%AD%E4%BB%A5%E5%89%8D%E7%9A%84-mongod-%E6%9C%8D%E5%8A%A1\" aria-label=\"关闭以前的 mongod 服务 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>关闭以前的 mongod 服务</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ mongod --shutdown //不行使用下面的\n\n$  lsof | grep 27017  //找占用27017端口的进程，然后kill，一般都这么搞\n$  kill pid</code></pre></div>\n<h3 id=\"启动-mongod-服务，指向最新数据库\" style=\"position:relative;\"><a href=\"#%E5%90%AF%E5%8A%A8-mongod-%E6%9C%8D%E5%8A%A1%EF%BC%8C%E6%8C%87%E5%90%91%E6%9C%80%E6%96%B0%E6%95%B0%E6%8D%AE%E5%BA%93\" aria-label=\"启动 mongod 服务，指向最新数据库 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>启动 mongod 服务，指向最新数据库</h3>\n<h4 id=\"mongod-以守护进程的方式启动\" style=\"position:relative;\"><a href=\"#mongod-%E4%BB%A5%E5%AE%88%E6%8A%A4%E8%BF%9B%E7%A8%8B%E7%9A%84%E6%96%B9%E5%BC%8F%E5%90%AF%E5%8A%A8\" aria-label=\"mongod 以守护进程的方式启动 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>mongod 以守护进程的方式启动</h4>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">mongod --dbpath=/data/db --port=27017 --fork --logpath=/alidata/log/mongod/mongod.log</code></pre></div>\n<h4 id=\"查看日志是否错误\" style=\"position:relative;\"><a href=\"#%E6%9F%A5%E7%9C%8B%E6%97%A5%E5%BF%97%E6%98%AF%E5%90%A6%E9%94%99%E8%AF%AF\" aria-label=\"查看日志是否错误 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>查看日志是否错误</h4>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">tail -f /var/log/mongd.log //查看日志文件（cat也行）</code></pre></div>\n<h2 id=\"启动应用\" style=\"position:relative;\"><a href=\"#%E5%90%AF%E5%8A%A8%E5%BA%94%E7%94%A8\" aria-label=\"启动应用 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>启动应用</h2>\n<p>安装各种依赖</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ cnpn install</code></pre></div>\n<p>然后就能启动了，然后查看输出是否有问题。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ cd /home/x-songtao\n$ pm2 start ./bin/www -n x-songtao -i max;pm2 logs</code></pre></div>\n<p>最后，<a href=\"xiangsongtao.com\">访问试试看</a>，噢耶！</p>\n<p>(完)</p>","timeToRead":4,"wordCount":{"paragraphs":31,"sentences":31,"words":131},"fields":{"slug":"/cong-zong-ling-kai-shi-MEVN-huan-jing/","relativePath":"2016/2016-10-18---cong-zong-ling-kai-shi-MEVN-huan-jing/index.md"},"excerpt":"前言介绍，因为在给网站升级 https，其中涉及到修改文件内容等操作，于是阴差阳错的将/etc 文件全部了，结果导致阿里云服务器远程 SSH 无法登录及 FTP…","frontmatter":{"title":"从零开始MEVN环境部署","date":"18 Oct 2016","tags":["MEVN"],"cover":"","comments":true,"author":"烈风裘"}},"prevPost":{"html":"<p>转载这篇文章,文章里面内容就不再展开，感兴趣的可以看下，<a href=\"http://www.cnblogs.com/vans/p/4550356.html\" target=\"_target\" rel=\"nofollow\">地址点击这里</a>。</p>\n<p>下面是我的评价：</p>\n<p>文章里说的都是基础，有些实际应用中的问题如果基础比较好的话能够深挖问题背后的原因，方便解决问题。我觉得基础是一个内化的过程，而不是背诵的过程。遇到问题深挖一下，然后在琢磨下背后的原理，这样比背诵的效果会好很多。比如，这样问应聘者：</p>\n<blockquote>\n<p>问：每天早上一打开网页就出现电信在右下角的小广告，需求说要避免这种情况，你该如何处理？</p>\n</blockquote>\n<blockquote>\n<p>答： 1. 如果特征相同的话，插入到 html 中的代码应该都是 ifream 结构的，页面加载的同时用 js 检查页面中是否有不属于页面的东西，如果有则<code class=\"language-text\">history.go(0)</code>处理；2. 另外一种更保险的方式是用 https 加密传输 html 内容，但是会 ssl 加解密通信会增加页面打开时间，建议再使用 http2.0 的方式请求，这样只建立一次 TCP 就能 Down 下所有所需资源，与此同时做好 cache-controll 中的缓存策略处理，保证下次连接返回 200(from cache)，弥补下首次加载的速度。</p>\n</blockquote>\n<p>我想，这样比问“HTTP 协议”，“三次握手”、“网络协议”、“W3C 标准协议”、“性能优化”、“安全性”等问题更具有挑战吧？</p>\n<p>另外，我知道 TCP 有三次握手，但是每次握手改变什么标记字段对我前端又有啥帮助呢？</p>\n<p>(完)</p>","timeToRead":1,"wordCount":{"paragraphs":8,"sentences":8,"words":74},"fields":{"slug":"/zhuan-zai-qian-duan-wo/","relativePath":"2016/2016-10-20---zhuan-zai-qian-duan-wo/index.md"},"excerpt":"…","frontmatter":{"title":"(转载)前端，我为什么不要你","date":"20 Oct 2016","tags":["随笔"],"cover":"","comments":true,"author":"烈风裘"}}},"pageContext":{"curr":"/H5-yi-dong-kai-fa-zong-jie/","prev":"/zhuan-zai-qian-duan-wo/","next":"/cong-zong-ling-kai-shi-MEVN-huan-jing/"}},"staticQueryHashes":["3240721340","63159454"]}