<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[Attila]]></title><description><![CDATA[Thoughts, stories and ideas.]]></description><link>https://xiangst0816.github.io/blog</link><image><url>/background/1.jpg</url><title>Attila</title><link>https://xiangst0816.github.io/blog</link></image><generator>RSS for Node</generator><lastBuildDate>Wed, 10 Feb 2021 16:10:04 GMT</lastBuildDate><atom:link href="https://xiangst0816.github.io/blog/rss.xml" rel="self" type="application/rss+xml"/><language><![CDATA[zh-CN]]></language><item><title><![CDATA[Nodejs查漏补缺-内存相关]]></title><description><![CDATA[<h3 id="1-v8为什么会有内存限制，原因是什么，如何解除？" style="position:relative;"><a href="#1-v8%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BC%9A%E6%9C%89%E5%86%85%E5%AD%98%E9%99%90%E5%88%B6%EF%BC%8C%E5%8E%9F%E5%9B%A0%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%8C%E5%A6%82%E4%BD%95%E8%A7%A3%E9%99%A4%EF%BC%9F" aria-label="1 v8为什么会有内存限制，原因是什么，如何解除？ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. V8为什么会有内存限制，原因是什么，如何解除？</h3>
<p><strong>V8限制堆的大小，分为两个层次的原因：</strong></p>
<ol>
<li><strong>表层原因</strong>：是因为V8最终为浏览器设计，大内存使用场景无法遇到；</li>
<li><strong>深层原因</strong>：是因为V8的垃圾回收机制限制。以1.5G的垃圾回收堆内存为例，一次小回收需要50ms以上，做一次非增量式的垃圾回收甚至要1s以上。垃圾回收过程JS线程暂停，应用性能和响应能力直线下降。限制是一个好选择（JAVA也有类似的设计）。</li>
</ol>
<p><strong>解除方式：</strong></p>
<p>可以在Node启动的时候增加额外的启动参数调整old和new两个内存限制的大小：</p>
<div class="gatsby-highlight" data-language=" shell"><pre class="language- shell"><code class="language- shell">node --max-old-space-size=1700 test.js // 单位为MB
node --max-new-space-size=1024 test.js // 单位为KB</code></pre></div>
<h3 id="2-简述v8的垃圾回收机制，为什么会有内存分代？" style="position:relative;"><a href="#2-%E7%AE%80%E8%BF%B0v8%E7%9A%84%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6%EF%BC%8C%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BC%9A%E6%9C%89%E5%86%85%E5%AD%98%E5%88%86%E4%BB%A3%EF%BC%9F" aria-label="2 简述v8的垃圾回收机制，为什么会有内存分代？ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 简述V8的垃圾回收机制，为什么会有内存分代？</h3>
<p>V8的垃圾回收策略主要基于<strong>分代式垃圾回收机制</strong>。使用分代式的原因：</p>
<ol>
<li><strong>没有一种垃圾回收算法</strong>能够胜任所有场景；</li>
<li>按照<strong>对象的存活时间</strong>将内存的垃圾回收进行不同的分代，不同分代实施不同的策略更高效；</li>
</ol>
<p><strong>分代方式及大小：</strong></p>
<p><figure class="gatsby-resp-image-figure" style="">
    <span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 840px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 34.285714285714285%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsSAAALEgHS3X78AAAA60lEQVQoz1WRyaqEQAxF+/8/zYUgqCtBXKgb59lySHPyXsQuCKm6SW5uUh95nXVdpW1baZpG9n2X67p+rOs6qeta/XmeD879vm/l+PR9L2VZCj6OY0mSRMIwVL9tmzjnxO1OPW+MZor/27IschzHHyFqsizTrp7nSRRF4vu+kpNEZ1SYAnub8abBQ8iY1mUcRx13GAaZpkksRgHK5nl+FJoRJ4+xlRBFQRBIURQKQGg7sT1xKK6q6ikkbvazwzzPdWR2CIhHhZFZARgxGw8Mde88JUzTVHfG7wIyNneS378PDiHrYHSMPGJvxV8uUx4BlDEmrgAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="分代方式及大小"
        title="分代方式及大小"
        src="/blog/static/34066063057e6a450fcfef6671b7ae55/f88f5/image-20200817110425925.png"
        srcset="/blog/static/34066063057e6a450fcfef6671b7ae55/e1650/image-20200817110425925.png 210w,
/blog/static/34066063057e6a450fcfef6671b7ae55/8cae7/image-20200817110425925.png 420w,
/blog/static/34066063057e6a450fcfef6671b7ae55/f88f5/image-20200817110425925.png 840w,
/blog/static/34066063057e6a450fcfef6671b7ae55/57a2b/image-20200817110425925.png 1260w,
/blog/static/34066063057e6a450fcfef6671b7ae55/b5d14/image-20200817110425925.png 1680w,
/blog/static/34066063057e6a450fcfef6671b7ae55/56625/image-20200817110425925.png 1716w"
        sizes="(max-width: 840px) 100vw, 840px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span>
    <figcaption class="gatsby-resp-image-figcaption">分代方式及大小</figcaption>
  </figure></p>
<p>V8内存分代分为两部分：<strong>新生代内存空间</strong>和<strong>老生代内存空间</strong>；内存对应的默认最大大小如上图；不同分代执行的算法不同。</p>
<p><strong>Scavenge算法（新旧Space倒换，引用计数方式）</strong>：通过复制的方式，从<strong>From</strong>到<strong>To</strong>之间复制存活的对象。因为在此分代中（生命周期短的场景），存活的对象只占少部分，因此性能好。对于多次复制依然存活的对象，会转移到老生代中（晋升），转移算法如下。</p>
<p><figure class="gatsby-resp-image-figure" style="">
    <span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 840px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 46.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAAA4ElEQVQoz4VSSQ6DQAzj/99CXDlxZL9wQEjsO7hy1IymQNtI0STE8jgeHLzjPE85t21DXdcIwxBxHGMYBuz7/oH5FY4CFTzPM8ZxRBRFyPNc+nVdYeOeUueO3dgKSLosC+wNfinU2U0h1UzTJKtTHWtdWbGcHcchydlNoSbJ6J3ruvB9X07P85BlmZDTW2ZVVQiCAEmSmMtvhAze1vc90jSVByFRURTyTdWQmFaUZYm2bUUEZ4bw6oEGgfaqT37ZtfHw+lLqDVfrus70V6+v9VeFVNY0jXhIn/jatkf/fpsX11jASuRCRhYAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="新生代转移算法"
        title="新生代转移算法"
        src="/blog/static/dd05683c5b7886c35659a4abaa456f20/f88f5/image-20200817110448724.png"
        srcset="/blog/static/dd05683c5b7886c35659a4abaa456f20/e1650/image-20200817110448724.png 210w,
/blog/static/dd05683c5b7886c35659a4abaa456f20/8cae7/image-20200817110448724.png 420w,
/blog/static/dd05683c5b7886c35659a4abaa456f20/f88f5/image-20200817110448724.png 840w,
/blog/static/dd05683c5b7886c35659a4abaa456f20/57a2b/image-20200817110448724.png 1260w,
/blog/static/dd05683c5b7886c35659a4abaa456f20/6a7f9/image-20200817110448724.png 1586w"
        sizes="(max-width: 840px) 100vw, 840px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span>
    <figcaption class="gatsby-resp-image-figcaption">新生代转移算法</figcaption>
  </figure></p>
<p><strong>Mark-Sweep算法（标记清除）</strong>：只标记活着的对象，对于没标记的对象进行清除；因为死对象在老生代中只占少部分，所以效率高。老生代内存空间主要以此算法为主（Mark-Sweep），但是会存在文件碎片，当空间不足以对分配新晋升的对象是，才使用下面的Mark-Compact算法；</p>
<p><figure class="gatsby-resp-image-figure" style="">
    <span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 840px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 26.190476190476193%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsSAAALEgHS3X78AAAA80lEQVQY032QPYqEQBCFG7yBwYCBkV5hIk9g6CXMRCY1NDbSzMQTKJ7AAyiCkamMIGKiBib+vqGaHTfaLXhUvS76o6oYfuK6LvwX4zji/X7/2T/Pk2dGINJxHPA8D2VZom1buK6LaZrgOA5M00QQBJjnGa/XC0VRwPd92LYNy7JQ1/UNvYEkSZIQRRHyPIcgCBzMGONSFAVd1/E6DEOoqnr3kiThwH3ff4FkdF1HmqaoqgqapmEYBjyfT4iiCMMw0Pc9ZFlGHMfc0wCPxwNZlnEgbcm+t6O8bRsHL8vCp2uahq9Nb9SjldZ15R/JU0363o8YH9ebRCVj5BJvAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Mark-Sweep算法"
        title="Mark-Sweep算法"
        src="/blog/static/8d0c601cc10b231fcc1344bdc47e407d/f88f5/image-20200817110509950.png"
        srcset="/blog/static/8d0c601cc10b231fcc1344bdc47e407d/e1650/image-20200817110509950.png 210w,
/blog/static/8d0c601cc10b231fcc1344bdc47e407d/8cae7/image-20200817110509950.png 420w,
/blog/static/8d0c601cc10b231fcc1344bdc47e407d/f88f5/image-20200817110509950.png 840w,
/blog/static/8d0c601cc10b231fcc1344bdc47e407d/57a2b/image-20200817110509950.png 1260w,
/blog/static/8d0c601cc10b231fcc1344bdc47e407d/ed226/image-20200817110509950.png 1542w"
        sizes="(max-width: 840px) 100vw, 840px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span>
    <figcaption class="gatsby-resp-image-figcaption">Mark-Sweep算法</figcaption>
  </figure></p>
<p><strong>Mark-Compact算法（标记整理）</strong>：标记内存对象，整理的过程中将活着的和死去的对象分向两头，移动完之后直接清理掉边界之外的内存。</p>
<p><figure class="gatsby-resp-image-figure" style="">
    <span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 840px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 27.61904761904762%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsSAAALEgHS3X78AAAAvklEQVQY05WPSwqDQBBER6/q0pO483MBEUHHS8QLuFZvILhRBBF/FapBoyEJpKDomoZ5dKl93/FJ7/u+79E0DX5p2zYohnVdsSzL6XmeBdh1HeI4RhiGSNNUcpIkyHQGrfXpKIpQFIVABUgI6YRw8k3VdQ3TNKGUgmEYMr/Ztu078FrxyFVV/YRcbVnWHUgPw4BxHMWs3bYtgiCA53nwfR+u64qZuTv2juMgf+QvIC866hJalqVcN00T/hH/PwHSsII5LGUT5AAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Mark-Compact算法"
        title="Mark-Compact算法"
        src="/blog/static/b1a13e38721de90579247d2b40244d54/f88f5/image-20200817110522895.png"
        srcset="/blog/static/b1a13e38721de90579247d2b40244d54/e1650/image-20200817110522895.png 210w,
/blog/static/b1a13e38721de90579247d2b40244d54/8cae7/image-20200817110522895.png 420w,
/blog/static/b1a13e38721de90579247d2b40244d54/f88f5/image-20200817110522895.png 840w,
/blog/static/b1a13e38721de90579247d2b40244d54/57a2b/image-20200817110522895.png 1260w,
/blog/static/b1a13e38721de90579247d2b40244d54/a66c0/image-20200817110522895.png 1514w"
        sizes="(max-width: 840px) 100vw, 840px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span>
    <figcaption class="gatsby-resp-image-figcaption">Mark-Compact算法</figcaption>
  </figure></p>
<p><strong>算法改进部分（顾名思义）</strong></p>
<p>Mark-Sweep部分 -> Incremental Marking（增量标记）、Lazy-Sweeping（延迟清除）</p>
<p>Mark-Compact部分 -> Incremental Compaction（增量整理）</p>
<h3 id="3-导致内存泄漏的常见类型有哪些，如何规避？" style="position:relative;"><a href="#3-%E5%AF%BC%E8%87%B4%E5%86%85%E5%AD%98%E6%B3%84%E6%BC%8F%E7%9A%84%E5%B8%B8%E8%A7%81%E7%B1%BB%E5%9E%8B%E6%9C%89%E5%93%AA%E4%BA%9B%EF%BC%8C%E5%A6%82%E4%BD%95%E8%A7%84%E9%81%BF%EF%BC%9F" aria-label="3 导致内存泄漏的常见类型有哪些，如何规避？ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. 导致内存泄漏的常见类型有哪些，如何规避？</h3>
<blockquote>
<p>闭包：实现 <strong>外部作用域</strong> 访问 <strong>内部作用域</strong> 中变量的方法（一般情况下外部作用域无法方位内部的）</p>
</blockquote>
<p><strong>常见类型及规避方案</strong></p>
<ul>
<li><u>缓存</u>：1. 增加缓存策略；2. 使用三方缓存方案</li>
<li><u>队列消费不及时</u>：1. 监控队列长度；2. 任意异步调用都应该包含超时机制</li>
<li><u>作用域未释放</u>：闭包和全局变量两种；通过赋值的方式（undefined or null）解除引用更好。通过delete删除对象属性有可能干扰V8的优化。</li>
</ul>
<p><mark>以上场景类型涉及到的对象都在<strong>老生代内存空间</strong>中！</mark></p>
<h3 id="4-如何理解堆内内存及堆外内存？node应用的内存构成是？" style="position:relative;"><a href="#4-%E5%A6%82%E4%BD%95%E7%90%86%E8%A7%A3%E5%A0%86%E5%86%85%E5%86%85%E5%AD%98%E5%8F%8A%E5%A0%86%E5%A4%96%E5%86%85%E5%AD%98%EF%BC%9Fnode%E5%BA%94%E7%94%A8%E7%9A%84%E5%86%85%E5%AD%98%E6%9E%84%E6%88%90%E6%98%AF%EF%BC%9F" aria-label="4 如何理解堆内内存及堆外内存？node应用的内存构成是？ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. 如何理解堆内内存及堆外内存？Node应用的内存构成是？</h3>
<p>Node的内存构成主要由 <strong>通过V8进行分配的部分</strong> 和 <strong>Node自定分配的部分</strong>。</p>
<p><figure class="gatsby-resp-image-figure" style="">
    <span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 840px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 40.476190476190474%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAAAvUlEQVQoz4WSiw6EIAwE+f9P1agB3/jo3TTppYcamxBJC9PtYpBvnOepy/bEcRzSdZ3UdS0pJXk6V0bwRfvmnGUcRxmGQfq+1/26rq+wH9AfmudZFQEAbLFtm4I99A78p3Dfd4kx6uVlWRQKhBzjT9OkDT2wVB3KURmRhXdAUds0jVRVpVDz04dXevEQNYDZowi1KLWR27ZVb8lR5/EuCn2CiyjksO9sYJpRMyA23QLLX4YLjIxn5ufT6/r8Bxh+dnlrbm2hAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="堆内外示例"
        title="堆内外示例"
        src="/blog/static/a5b0ae0162d0c8471e091b50665f9277/f88f5/image-20200817110538576.png"
        srcset="/blog/static/a5b0ae0162d0c8471e091b50665f9277/e1650/image-20200817110538576.png 210w,
/blog/static/a5b0ae0162d0c8471e091b50665f9277/8cae7/image-20200817110538576.png 420w,
/blog/static/a5b0ae0162d0c8471e091b50665f9277/f88f5/image-20200817110538576.png 840w,
/blog/static/a5b0ae0162d0c8471e091b50665f9277/57a2b/image-20200817110538576.png 1260w,
/blog/static/a5b0ae0162d0c8471e091b50665f9277/3bb79/image-20200817110538576.png 1484w"
        sizes="(max-width: 840px) 100vw, 840px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span>
    <figcaption class="gatsby-resp-image-figcaption">堆内外示例</figcaption>
  </figure></p>
<p>所以堆内内存主要指的是V8管理的内存，堆外是Node自行管理的部分，比如Buffer的使用。</p>
<h3 id="5-大内存应用如何处理？" style="position:relative;"><a href="#5-%E5%A4%A7%E5%86%85%E5%AD%98%E5%BA%94%E7%94%A8%E5%A6%82%E4%BD%95%E5%A4%84%E7%90%86%EF%BC%9F" aria-label="5 大内存应用如何处理？ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>5. 大内存应用如何处理？</h3>
<p>如问题4，使用堆外内存方式处理，比如使用<strong>Stream</strong>方式。使用 <strong>流</strong> 的方式处理，下面代码不会受到V8内存限制的影响，有效的提高程序的健壮性。</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">var</span> reader <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">createReadStream</span><span class="token punctuation">(</span><span class="token string">'in.txt'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> writer <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">createWriteStream</span><span class="token punctuation">(</span><span class="token string">'out.txt'</span><span class="token punctuation">)</span>
reader<span class="token punctuation">.</span><span class="token function">pip</span><span class="token punctuation">(</span>writer<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>]]></description><link>https://xiangst0816.github.io/blog/nodejs-cha-lou-bu-que-nei-cun-xiang-guan/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/nodejs-cha-lou-bu-que-nei-cun-xiang-guan/</guid><category><![CDATA[Node]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Mon, 17 Aug 2020 03:05:42 GMT</pubDate></item><item><title><![CDATA[Nodejs查漏补缺-Buffer相关]]></title><description><![CDATA[<h3 id="1-新建buffer会占用v8分配的内存吗？" style="position:relative;"><a href="#1-%E6%96%B0%E5%BB%BAbuffer%E4%BC%9A%E5%8D%A0%E7%94%A8v8%E5%88%86%E9%85%8D%E7%9A%84%E5%86%85%E5%AD%98%E5%90%97%EF%BC%9F" aria-label="1 新建buffer会占用v8分配的内存吗？ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 新建Buffer会占用V8分配的内存吗？</h3>
<p>不会，Buffer属于堆外内存，不是V8分配的</p>
<h3 id="2-buffer的内存分配机制" style="position:relative;"><a href="#2-buffer%E7%9A%84%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D%E6%9C%BA%E5%88%B6" aria-label="2 buffer的内存分配机制 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. Buffer的内存分配机制</h3>
<p>Buffer对象类似数组，它的元素为16进制的两位数，即0到255的数值。<strong>其内存分配是在Node的C++层面实现的内存的申请，但是在JavaScript层面分配内存</strong>。Node采用了<strong>slab分配机制</strong>，以<strong>8KB</strong>为界限区分Buffer是大对象还是小对象。</p>
<p><strong>小对象（&#x3C;8KB）：</strong></p>
<p>采用slab的机制进行预先申请和事后分配的策略。例如第一次分配一个1024字节的Buffer，Buffer.alloc(1024)，那么这次分配就会用到一个slab，接着如果继续Buffer.alloc(1024)，那么上一次用的slab的空间还没有用完，因为总共是8kb，1024+1024 = 2048个字节，没有8kb，所以就继续用这个slab给Buffer分配空间。如果下次超过剩余空间，则重新申请一个新的slab存数据。</p>
<p><strong>大对象（>8KB）：</strong></p>
<p>直接分配一个SlowBuffer对象作为slab单元，这个slab单元会被这个大Buffer对象独占。</p>
<h3 id="3-buffer与string的关系" style="position:relative;"><a href="#3-buffer%E4%B8%8Estring%E7%9A%84%E5%85%B3%E7%B3%BB" aria-label="3 buffer与string的关系 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. Buffer与String的关系</h3>
<p>Buffer是二进制数据，字符串与Buffer之间存在编码关系，通过setEncoding方式进行转码。但是Node的Buffer支持的编码类型有限，需要借助iconv等工具进行拓展。</p>]]></description><link>https://xiangst0816.github.io/blog/nodejs-cha-lou-bu-que-buffer-xiang-guan/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/nodejs-cha-lou-bu-que-buffer-xiang-guan/</guid><category><![CDATA[Node]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Sun, 16 Aug 2020 15:47:58 GMT</pubDate></item><item><title><![CDATA[Nodejs查漏补缺-异步相关]]></title><description><![CDATA[<h3 id="1-从用户态发出异步io调用后，到回调函数被执行，中间发生了什么？" style="position:relative;"><a href="#1-%E4%BB%8E%E7%94%A8%E6%88%B7%E6%80%81%E5%8F%91%E5%87%BA%E5%BC%82%E6%AD%A5io%E8%B0%83%E7%94%A8%E5%90%8E%EF%BC%8C%E5%88%B0%E5%9B%9E%E8%B0%83%E5%87%BD%E6%95%B0%E8%A2%AB%E6%89%A7%E8%A1%8C%EF%BC%8C%E4%B8%AD%E9%97%B4%E5%8F%91%E7%94%9F%E4%BA%86%E4%BB%80%E4%B9%88%EF%BC%9F" aria-label="1 从用户态发出异步io调用后，到回调函数被执行，中间发生了什么？ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 从用户态发出异步I/O调用后，到回调函数被执行，中间发生了什么？</h3>
<p>因为Node中的异步I/O调用不是有开发者自己调用的。示例代码如下：</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript">fs<span class="token punctuation">.</span><span class="token function-variable function">open</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">path<span class="token punctuation">,</span> flags<span class="token punctuation">,</span> mode<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token comment">// ...</span>
  binding<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span>
    pathModule<span class="token punctuation">.</span><span class="token function">_makeLong</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">,</span> 
    <span class="token function">stringToFlags</span><span class="token punctuation">(</span>flags<span class="token punctuation">)</span><span class="token punctuation">,</span> 
    mode<span class="token punctuation">,</span> 
    callback
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span></code></pre></div>
<p>整个异步I/O的流程如下：</p>
<p><figure class="gatsby-resp-image-figure" style="">
    <span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 840px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 72.38095238095238%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsSAAALEgHS3X78AAABpklEQVQ4y3WTaYoCQQyFvf9h/OMJGkRRUFFx33HHfd/NzBdIUeU4gaaq08nLe0k6Jr/2fr85ZL/fS71el8ViIWaPx0NqtZpUq1XxY7vdrpTLZbler4E/ZhfO4/Eo0+lUgZ/Pp/pImEwm6gfcilB0OBzK5XJx+TwOEAA+Eng+n13y7XaT9Xotu91O7+aj+Gq10oI+qZghY8vlUvr9vmPDMxqNpFQqqTxrBYCwHgwGcjgcvjPkhAlgVDYWvLdaLWm32+rH7ve73ufzeSA56CFBxWJRksmk5HI5TXi9XsqqUCgoy+1264ZHbDqdlkajobmBZGs0EmDT6/VUCr7T6STNZlN9NlFYsQ2AjsdjVfN1ykwNdpZMIAPK5/NayIZCK2CdSqW0lxRGTQCIAyn0CmnIAAA2yGI4Js18lUrFTf8PICfsoihSRkgFgDObzUqn09E7bLgnEgmJx+OSyWTU93XKm81GZTMIC0Iy7Gyi9gPwzgawamYBIJTpG4FIgB3fuJM4m82c79P8XQ4YkmDDsCDeAbPd9AF8ICfZX8pPgzVFaAUD8xn+l/MDsKkyr9vSg9YAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="异步I/O的流程"
        title="异步I/O的流程"
        src="/blog/static/32dfa402a156af314fcdc1d6821b506c/f88f5/image-20200816210914233.png"
        srcset="/blog/static/32dfa402a156af314fcdc1d6821b506c/e1650/image-20200816210914233.png 210w,
/blog/static/32dfa402a156af314fcdc1d6821b506c/8cae7/image-20200816210914233.png 420w,
/blog/static/32dfa402a156af314fcdc1d6821b506c/f88f5/image-20200816210914233.png 840w,
/blog/static/32dfa402a156af314fcdc1d6821b506c/57a2b/image-20200816210914233.png 1260w,
/blog/static/32dfa402a156af314fcdc1d6821b506c/b5d14/image-20200816210914233.png 1680w,
/blog/static/32dfa402a156af314fcdc1d6821b506c/a533f/image-20200816210914233.png 1690w"
        sizes="(max-width: 840px) 100vw, 840px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span>
    <figcaption class="gatsby-resp-image-figcaption">异步I/O的流程</figcaption>
  </figure></p>
<p><strong>请求对象、I/O线程池、观察者、 事件循环</strong> 这四个共同构成了Node异步I/O模型的基本要素。大致流程：</p>
<ol>
<li>创建FSReqWrap<strong>请求对象</strong>，包括传参、当前方法、回调函数等都在请求对象中；</li>
<li>将<strong>请求对象</strong>放入线程池中等待执行；</li>
<li>线程执行完毕后，将<strong>结果</strong>存储在<strong>请求对象</strong>中，通知IOCP</li>
<li>事件循环的观察者在<strong>每次Tick</strong>的执行中，调用IOCP相关方法查看是否有执行完毕的请求</li>
<li>将<strong>请求对象</strong>放入I/O观察者队列，然后当做事件处理</li>
</ol>
<h3 id="2-node应用是单线程还是多线程，如何理解？" style="position:relative;"><a href="#2-node%E5%BA%94%E7%94%A8%E6%98%AF%E5%8D%95%E7%BA%BF%E7%A8%8B%E8%BF%98%E6%98%AF%E5%A4%9A%E7%BA%BF%E7%A8%8B%EF%BC%8C%E5%A6%82%E4%BD%95%E7%90%86%E8%A7%A3%EF%BC%9F" aria-label="2 node应用是单线程还是多线程，如何理解？ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. Node应用是单线程还是多线程，如何理解？</h3>
<p>JavaScript执行是单线程，但是Node本身是多线程的，比如I/O相关操作。</p>
<h3 id="3-非io的异步执行过程？" style="position:relative;"><a href="#3-%E9%9D%9Eio%E7%9A%84%E5%BC%82%E6%AD%A5%E6%89%A7%E8%A1%8C%E8%BF%87%E7%A8%8B%EF%BC%9F" aria-label="3 非io的异步执行过程？ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. 非I/O的异步执行过程？</h3>
<p>这里涉及的到异步API包括：<strong>setTimeout()、setInterval()、setImmediate()、process.nextTick()</strong> 这四个；整个过程以setTimeout()为例：</p>
<p><figure class="gatsby-resp-image-figure" style="">
    <span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 840px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 53.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAABTklEQVQoz3WS3Y6CUAyEef9388YbA0RiAAEREEH+VOzma9IT3XVJjshpOzOd1nu9XsJTVZUcj0fJskzu97veLcsi2+1WdrudWN4wDHI4HPTEcax3xCzu8bOuq3RdJ3mey+Vy+QCEoCxLvaPoer068rZtHZCBOkAKSJimSR6Phwa54/t2u+kdBBzuEUDd78cz9PP5LFEUKbMppL0gCPQAPM+zgqRpKr7vqwByviokACtqDBCApmn0mEKKyKNt8qh7b9spxLswDNUzaxlVKE6SRPq+12LIIYXk+Xw6kj+AsNoAAORBAUAMwrzkXRSFtlzXtRvWByCsgG02G/VrHEdtl4L9fu8mCrgB4iO+k/tVIQHWBqUoNF8pQrV5Sx77xx5iBQRfFaLodDopiLWBPyiBCCCI8I3/qOf736EAAiggtl8U2LqYr8RpnSmbp+9r8wPJlFLPdrX7RwAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="非I/O的异步流程"
        title="非I/O的异步流程"
        src="/blog/static/f46a61960e35a5e909640bbc43fbe0d0/f88f5/image-20200816213701565.png"
        srcset="/blog/static/f46a61960e35a5e909640bbc43fbe0d0/e1650/image-20200816213701565.png 210w,
/blog/static/f46a61960e35a5e909640bbc43fbe0d0/8cae7/image-20200816213701565.png 420w,
/blog/static/f46a61960e35a5e909640bbc43fbe0d0/f88f5/image-20200816213701565.png 840w,
/blog/static/f46a61960e35a5e909640bbc43fbe0d0/57a2b/image-20200816213701565.png 1260w,
/blog/static/f46a61960e35a5e909640bbc43fbe0d0/b5d14/image-20200816213701565.png 1680w,
/blog/static/f46a61960e35a5e909640bbc43fbe0d0/53120/image-20200816213701565.png 1952w"
        sizes="(max-width: 840px) 100vw, 840px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span>
    <figcaption class="gatsby-resp-image-figcaption">非I/O的异步流程</figcaption>
  </figure></p>
<ol>
<li>创建setTimeout时，将定时器插入到定时观察者内部的<strong>红黑树</strong>中</li>
<li>每次Tick执行是，会从改红黑树中取出定时器对象判定</li>
<li>判定时间到了则执行定时器回调，否则跳过</li>
</ol>
<p><strong>process.nextTick()</strong> 与setTimeout（setInterval）类似，只是process.nextTick() 只会将回调函数放入队列中，在下一轮Tick时取出执行。时间效率<strong>「O(1)」</strong> 比setTimeout「O(logn)」高。</p>
<p><strong>setImmediate()</strong>与process.nextTick()类似，但是process.nextTick()的优先级更高；具体来说：</p>
<ol>
<li>process.nextTick()回调函数保存在数组中；setImmediate()保存在链表中</li>
<li>process.nextTick()每轮循环中会将数组中的回调函数全部执行完；setImmediate()在每轮循环中执行链表的一个回调函数（执行完毕后进入下一轮循环）</li>
<li>
<p>process.nextTick()是idle观察者，setImmediate()是check观察者；</p>
<ol>
<li>优先级：idle观察者 -> I/O观察者 -> check观察者</li>
</ol>
</li>
</ol>]]></description><link>https://xiangst0816.github.io/blog/nodejs-cha-lou-bu-que-yi-bu-xiang-guan/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/nodejs-cha-lou-bu-que-yi-bu-xiang-guan/</guid><category><![CDATA[Node]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Sun, 16 Aug 2020 14:03:52 GMT</pubDate></item><item><title><![CDATA[Nodejs查漏补缺-模块相关]]></title><description><![CDATA[<h3 id="1-请介绍一下node里的模块是什么？" style="position:relative;"><a href="#1-%E8%AF%B7%E4%BB%8B%E7%BB%8D%E4%B8%80%E4%B8%8Bnode%E9%87%8C%E7%9A%84%E6%A8%A1%E5%9D%97%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F" aria-label="1 请介绍一下node里的模块是什么？ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1 请介绍一下node里的模块是什么？</h3>
<p>Node中，每个文件模块都是一个对象，它的接口 <code class="language-text">NodeModule</code> 定义如下：</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">interface</span> <span class="token class-name">NodeModule</span> <span class="token punctuation">{</span>
    exports<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
    <span class="token keyword">require</span><span class="token operator">:</span> NodeRequireFunction<span class="token punctuation">;</span>
    id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    filename<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    loaded<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
    parent<span class="token operator">:</span> NodeModule <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    children<span class="token operator">:</span> NodeModule<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    paths<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">NodeRequireFunction</span> <span class="token punctuation">{</span>
    <span class="token comment">/* tslint:disable-next-line:callable-types */</span>
    <span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">Module</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> parent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>parent <span class="token operator">=</span> parent<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>parent <span class="token operator">&amp;&amp;</span> parent<span class="token punctuation">.</span>children<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    parent<span class="token punctuation">.</span>children<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">this</span><span class="token punctuation">.</span>filename <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>loaded <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>children <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">module</span><span class="token punctuation">.</span>exports <span class="token operator">=</span> Module<span class="token punctuation">;</span></code></pre></div>
<p>所有的模块都是 Module 的实例。module.exports 的定义就在这里体现，<strong>默认是空对象</strong>！</p>
<p>这里的module.js引用subModules.js文件，打印module.js中的的 <code class="language-text">module</code> 变量的结果：</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript">Module <span class="token punctuation">{</span>
  id<span class="token operator">:</span> <span class="token string">'.'</span><span class="token punctuation">,</span> <span class="token comment">// 当前的ID</span>
  path<span class="token operator">:</span> <span class="token string">'/Users/Hsiang/tp/config'</span><span class="token punctuation">,</span> <span class="token comment">// 文件Path</span>
  exports<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">// 导出的方法</span>
  parent<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
  filename<span class="token operator">:</span> <span class="token string">'/Users/Hsiang/tp/config/module.js'</span><span class="token punctuation">,</span> <span class="token comment">// 当前模块的文件名</span>
  loaded<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 是否加载</span>
  children<span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token comment">// 依赖的模块</span>
    Module <span class="token punctuation">{</span>
      id<span class="token operator">:</span> <span class="token string">'/Users/Hsiang/tp/config/subModule.js'</span><span class="token punctuation">,</span>
      path<span class="token operator">:</span> <span class="token string">'/Users/Hsiang/tp/config'</span><span class="token punctuation">,</span>
      exports<span class="token operator">:</span> <span class="token punctuation">[</span>Object<span class="token punctuation">]</span><span class="token punctuation">,</span>
      parent<span class="token operator">:</span> <span class="token punctuation">[</span>Circular<span class="token punctuation">]</span><span class="token punctuation">,</span>
      filename<span class="token operator">:</span> <span class="token string">'/Users/Hsiang/tp/config/subModule.js'</span><span class="token punctuation">,</span>
      loaded<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      children<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      paths<span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  paths<span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token comment">// 当前模块寻址Path顺序</span>
    <span class="token string">'/Users/Hsiang/tp/config/node_modules'</span><span class="token punctuation">,</span>
    <span class="token string">'/Users/Hsiang/tp/node_modules'</span><span class="token punctuation">,</span>
    <span class="token string">'/Users/Hsiang/node_modules'</span><span class="token punctuation">,</span>
    <span class="token string">'/Users/node_modules'</span><span class="token punctuation">,</span>
    <span class="token string">'/node_modules'</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span></code></pre></div>
<h3 id="2-我们知道node导出模块有两种方式，一种是-exportsxxxxxx-和moduleexports-有什么区别吗" style="position:relative;"><a href="#2-%E6%88%91%E4%BB%AC%E7%9F%A5%E9%81%93node%E5%AF%BC%E5%87%BA%E6%A8%A1%E5%9D%97%E6%9C%89%E4%B8%A4%E7%A7%8D%E6%96%B9%E5%BC%8F%EF%BC%8C%E4%B8%80%E7%A7%8D%E6%98%AF-exportsxxxxxx-%E5%92%8Cmoduleexports-%E6%9C%89%E4%BB%80%E4%B9%88%E5%8C%BA%E5%88%AB%E5%90%97" aria-label="2 我们知道node导出模块有两种方式，一种是 exportsxxxxxx 和moduleexports 有什么区别吗 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 我们知道node导出模块有两种方式，一种是 exports.xxx=xxx 和module.exports={} 有什么区别吗</h3>
<p><code class="language-text">exports</code> 其实就是 <code class="language-text">module.exports</code> 的引用，最终使用模块认的是 <code class="language-text">module.exports</code> ，而不是 <code class="language-text">exports</code>；保险起见，直接使用 <code class="language-text">module.exports</code>。</p>
<h3 id="3-加载模块时，为什么每个模块都有exports-require-module-__filename-__dirname属性呢？" style="position:relative;"><a href="#3-%E5%8A%A0%E8%BD%BD%E6%A8%A1%E5%9D%97%E6%97%B6%EF%BC%8C%E4%B8%BA%E4%BB%80%E4%B9%88%E6%AF%8F%E4%B8%AA%E6%A8%A1%E5%9D%97%E9%83%BD%E6%9C%89exports-require-module-__filename-__dirname%E5%B1%9E%E6%80%A7%E5%91%A2%EF%BC%9F" aria-label="3 加载模块时，为什么每个模块都有exports require module __filename __dirname属性呢？ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. 加载模块时，为什么每个模块都有exports, require, module, __filename, __dirname属性呢？</h3>
<p>在执行模块代码之前，Node.js 会使用一个如下的函数封装器将其封装，模块内部的变量为<strong>函数及作用域</strong>：</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token comment">// /Users/Hsiang/tp/config/module.js</span>
<span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">exports<span class="token punctuation">,</span> require<span class="token punctuation">,</span> module<span class="token punctuation">,</span> __filename<span class="token punctuation">,</span> __dirname</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 模块的代码实际上在这里</span>
  <span class="token comment">// __filename === /Users/xx/projectName/src/module.js   绝对路径</span>
  <span class="token comment">// __dirname === /Users/xx/projectName/src   绝对路径</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<h3 id="4-请介绍一下require的模块加载机制及模块寻找顺序？" style="position:relative;"><a href="#4-%E8%AF%B7%E4%BB%8B%E7%BB%8D%E4%B8%80%E4%B8%8Brequire%E7%9A%84%E6%A8%A1%E5%9D%97%E5%8A%A0%E8%BD%BD%E6%9C%BA%E5%88%B6%E5%8F%8A%E6%A8%A1%E5%9D%97%E5%AF%BB%E6%89%BE%E9%A1%BA%E5%BA%8F%EF%BC%9F" aria-label="4 请介绍一下require的模块加载机制及模块寻找顺序？ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. 请介绍一下require的模块加载机制及模块寻找顺序？</h3>
<p>require的接口定义如下：</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">interface</span> <span class="token class-name">NodeRequire</span> <span class="token keyword">extends</span> <span class="token class-name">NodeRequireFunction</span> <span class="token punctuation">{</span>
    resolve<span class="token operator">:</span> RequireResolve<span class="token punctuation">;</span>
    cache<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
    extensions<span class="token operator">:</span> NodeExtensions<span class="token punctuation">;</span>
    main<span class="token operator">:</span> NodeModule <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>require具体代码执行过程：</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token comment">// require 其实内部调用 Module._load 方法</span>
Module<span class="token punctuation">.</span><span class="token function-variable function">_load</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">request<span class="token punctuation">,</span> parent<span class="token punctuation">,</span> isMain</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//  计算绝对路径</span>
  <span class="token keyword">var</span> filename <span class="token operator">=</span> Module<span class="token punctuation">.</span><span class="token function">_resolveFilename</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> parent<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">//  第一步：如果有缓存，取出缓存</span>
  <span class="token keyword">var</span> cachedModule <span class="token operator">=</span> Module<span class="token punctuation">.</span>_cache<span class="token punctuation">[</span>filename<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>cachedModule<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> cachedModule<span class="token punctuation">.</span>exports<span class="token punctuation">;</span>

  <span class="token comment">// 第二步：是否为内置模块</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>NativeModule<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> NativeModule<span class="token punctuation">.</span><span class="token function">require</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token comment">/********************************这里注意了**************************/</span>
  <span class="token comment">// 第三步：生成模块实例，存入缓存</span>
  <span class="token comment">// 这里的Module就是我们上面的1定义的Module</span>
  <span class="token keyword">var</span> module <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Module</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> parent<span class="token punctuation">)</span><span class="token punctuation">;</span>
  Module<span class="token punctuation">.</span>_cache<span class="token punctuation">[</span>filename<span class="token punctuation">]</span> <span class="token operator">=</span> module<span class="token punctuation">;</span>

  <span class="token comment">/********************************这里注意了**************************/</span>
  <span class="token comment">// 第四步：加载模块</span>
  <span class="token comment">// 下面的module.load实际上是Module原型上有一个方法叫Module.prototype.load</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    module<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">;</span>
    hadException <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>hadException<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">delete</span> Module<span class="token punctuation">.</span>_cache<span class="token punctuation">[</span>filename<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 第五步：输出模块的exports属性</span>
  <span class="token keyword">return</span> module<span class="token punctuation">.</span>exports<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<p>module.load 这里的寻址方式如下：</p>
<ol>
<li>如果是Core模块</li>
<li>
<p>如果是路径</p>
<ol>
<li>LOAD<em>AS</em>FILE: x.js -> x.json -> x.node</li>
<li>LOAD<em>AS</em>DIRECTORY: </li>
<li>
<p>如果存在 package.json | main </p>
<ol>
<li>构造新位置M -> LOAD<em>AS</em>FILE(M) -> LOAD_INDEX(M)</li>
</ol>
</li>
<li>LOAD_INDEX(M): index.js -> index.json -> index.node</li>
</ol>
</li>
<li>其他…</li>
</ol>
<h3 id="5-如何判断当前js文件是被引用还是被直接运行？" style="position:relative;"><a href="#5-%E5%A6%82%E4%BD%95%E5%88%A4%E6%96%AD%E5%BD%93%E5%89%8Djs%E6%96%87%E4%BB%B6%E6%98%AF%E8%A2%AB%E5%BC%95%E7%94%A8%E8%BF%98%E6%98%AF%E8%A2%AB%E7%9B%B4%E6%8E%A5%E8%BF%90%E8%A1%8C%EF%BC%9F" aria-label="5 如何判断当前js文件是被引用还是被直接运行？ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>5. 如何判断当前JS文件是被引用还是被直接运行？</h3>
<p><code class="language-text">require.main</code> 返回的是 <code class="language-text">Module</code> 对象，表示当 Node.js 进程启动时加载的入口脚本。因此可以通过下面方式判定：</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">if</span><span class="token punctuation">(</span>require<span class="token punctuation">.</span>main <span class="token operator">===</span> module<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 当前文件为node主入口</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  <span class="token comment">// 当前文件为子模块</span>
<span class="token punctuation">}</span></code></pre></div>
<h3 id="6-循环require模块会发生什么结果？" style="position:relative;"><a href="#6-%E5%BE%AA%E7%8E%AFrequire%E6%A8%A1%E5%9D%97%E4%BC%9A%E5%8F%91%E7%94%9F%E4%BB%80%E4%B9%88%E7%BB%93%E6%9E%9C%EF%BC%9F" aria-label="6 循环require模块会发生什么结果？ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>6. 循环require模块会发生什么结果？</h3>
<blockquote>
<p>摘抄自Node文档：<a href="http://nodejs.cn/api/modules.html" target="_target" rel="nofollow">http://nodejs.cn/api/modules.html</a></p>
</blockquote>
<p>当循环调用 <code class="language-text">require()</code> 时，一个模块可能在未完成执行时被返回。</p>
<p>例如以下情况:</p>
<p><code class="language-text">a.js</code>:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'a 开始'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
exports<span class="token punctuation">.</span>done <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> b <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./b.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'在 a 中，b.done = %j'</span><span class="token punctuation">,</span> b<span class="token punctuation">.</span>done<span class="token punctuation">)</span><span class="token punctuation">;</span>
exports<span class="token punctuation">.</span>done <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'a 结束'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p><code class="language-text">b.js</code>:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'b 开始'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
exports<span class="token punctuation">.</span>done <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./a.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'在 b 中，a.done = %j'</span><span class="token punctuation">,</span> a<span class="token punctuation">.</span>done<span class="token punctuation">)</span><span class="token punctuation">;</span>
exports<span class="token punctuation">.</span>done <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'b 结束'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p><code class="language-text">main.js</code>:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'main 开始'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./a.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> b <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./b.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'在 main 中，a.done=%j，b.done=%j'</span><span class="token punctuation">,</span> a<span class="token punctuation">.</span>done<span class="token punctuation">,</span> b<span class="token punctuation">.</span>done<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>当 <code class="language-text">main.js</code> 加载 <code class="language-text">a.js</code> 时， <code class="language-text">a.js</code> 又加载 <code class="language-text">b.js</code>。 此时， <code class="language-text">b.js</code> 会尝试去加载 <code class="language-text">a.js</code>。 为了防止无限的循环，会返回一个 <code class="language-text">a.js</code> 的 <code class="language-text">exports</code> 对象的 <strong><mark>未完成的副本（不是一定是空对象）</mark></strong> 给 <code class="language-text">b.js</code> 模块。 然后 <code class="language-text">b.js</code> 完成加载，并将 <code class="language-text">exports</code> 对象提供给 <code class="language-text">a.js</code> 模块。</p>
<p>当 <code class="language-text">main.js</code> 加载这两个模块时，它们都已经完成加载。 因此，该程序的输出会是：</p>
<div class="gatsby-highlight" data-language="console"><pre class="language-console"><code class="language-console">$ node main.js
main 开始
a 开始
b 开始
在 b 中，a.done = false
b 结束
在 a 中，b.done = true
a 结束
在 main 中，a.done=true，b.done=true</code></pre></div>
<p>需要仔细的规划, 以允许循环模块依赖在应用程序内正常工作.</p>
<h3 id="7-模块缓存，如何解除缓存问题？" style="position:relative;"><a href="#7-%E6%A8%A1%E5%9D%97%E7%BC%93%E5%AD%98%EF%BC%8C%E5%A6%82%E4%BD%95%E8%A7%A3%E9%99%A4%E7%BC%93%E5%AD%98%E9%97%AE%E9%A2%98%EF%BC%9F" aria-label="7 模块缓存，如何解除缓存问题？ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>7. 模块缓存，如何解除缓存问题？</h3>
<p>问题4中，关于require的工作机制提到了load模块时会存在缓存设计，即被引入的模块将被缓存在 <code class="language-text">require.cache</code>  （等同于 <code class="language-text">Module._cache</code> ）中；另外Module类在初始化时，会在 <code class="language-text">parent.children</code> 中保存子模块的一个引用。根据Nodejs内存回收机制，简单的讲就是当一个对象没有被任何其他对象引用的时候（引用计数模式），这个对象就会被标记为可回收，并在下一次GC处理的时候释放内存。</p>
<p>所以消除模块缓存需要做的处理如下：</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">cleanCache</span><span class="token punctuation">(</span><span class="token parameter">modulePath</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> module <span class="token operator">=</span> require<span class="token punctuation">.</span>cache<span class="token punctuation">[</span>modulePath<span class="token punctuation">]</span><span class="token punctuation">;</span> 
    <span class="token comment">// 1. remove reference in module.parent</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>module<span class="token punctuation">.</span>parent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        module<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>children<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>module<span class="token punctuation">.</span>parent<span class="token punctuation">.</span>children<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>module<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 2. 去除本身cache的引用（require.cache === module._cache）</span>
    require<span class="token punctuation">.</span>cache<span class="token punctuation">[</span>modulePath<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<h3 id="8-如何找到模块的绝对路径？" style="position:relative;"><a href="#8-%E5%A6%82%E4%BD%95%E6%89%BE%E5%88%B0%E6%A8%A1%E5%9D%97%E7%9A%84%E7%BB%9D%E5%AF%B9%E8%B7%AF%E5%BE%84%EF%BC%9F" aria-label="8 如何找到模块的绝对路径？ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>8. 如何找到模块的绝对路径？</h3>
<p><strong>API: require.resolve(‘./moduleName’)</strong></p>
<p>使用内部的 <code class="language-text">require()</code> 机制查询模块的位置，此操作只返回解析后的文件名，不会加载该模块。</p>
<p>如果找不到模块，则会抛出 <code class="language-text">MODULE_NOT_FOUND</code> 错误。</p>
<h3 id="9-mjs解释下" style="position:relative;"><a href="#9-mjs%E8%A7%A3%E9%87%8A%E4%B8%8B" aria-label="9 mjs解释下 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>9. mjs解释下</h3>
<p> <code class="language-text">.mjs</code> 扩展名是保留给 <a href="http://nodejs.cn/s/iyYkEg" target="_target" rel="nofollow">ECMAScript 模块</a>，无法通过 <code class="language-text">require()</code> 加载。目前处于实现性质阶段，不建议 <code class="language-text">import</code> 和 <code class="language-text">require</code> 混用；</p>]]></description><link>https://xiangst0816.github.io/blog/nodejs-cha-lou-bu-que-mo-kuai-xiang-guan/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/nodejs-cha-lou-bu-que-mo-kuai-xiang-guan/</guid><category><![CDATA[Node]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Sun, 16 Aug 2020 03:48:20 GMT</pubDate></item><item><title><![CDATA[设计模式「策略模式」]]></title><description><![CDATA[<h2 id="背景" style="position:relative;"><a href="#%E8%83%8C%E6%99%AF" aria-label="背景 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>背景</h2>
<p>在现实生活中，存在实现一个目标有多种策略可供选择的情况，比如：出门旅行的多种目的地、乘车方式等；超市打折促销的方式；吃饭做菜时，土豆丝的多种做法等；</p>
<p><strong>在软件开发过程中也会遇到此类问题（模式），当实现某个功能存在多种策略时，我们根据环境（Context）的不同，选择指定的策略</strong>。比如进行排序，有冒泡排序、选择排序、插入排序、二叉树排序等。</p>
<blockquote>
<p>反例介绍</p>
</blockquote>
<p>当代码中存在根据环境进行多重if-else判断时，增加策略会导致源码有较大修改，导致条件语句结构复杂不移维护，违背<strong>开闭原则</strong>。此时采用策略模式就能很好的解决该问题。</p>
<h2 id="定义及特点" style="position:relative;"><a href="#%E5%AE%9A%E4%B9%89%E5%8F%8A%E7%89%B9%E7%82%B9" aria-label="定义及特点 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>定义及特点</h2>
<p>策略模式（Strategy）：该模式定义了一些列算法，并将算法封装起来，使他们能够互相替换，且算法的变化不影响使用算法的用户（Context）。策略模式属于对象行为模式，将算法具体实现进行封装（把<strong>使用算法</strong>和<strong>算法实现</strong>分割开来，<strong>算法实现</strong>委派不同的对象进行管理）。</p>
<h3 id="1-主要优点" style="position:relative;"><a href="#1-%E4%B8%BB%E8%A6%81%E4%BC%98%E7%82%B9" aria-label="1 主要优点 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 主要优点</h3>
<ol>
<li>多重条件语句不易维护，而使用策略模式可以避免使用多重条件语句。</li>
<li>策略模式提供了一系列的可供重用的算法族，恰当使用继承可以把算法族的公共代码转移到父类里面，从而避免重复的代码。</li>
<li>策略模式可以提供相同行为的不同实现，客户可以根据不同时间或空间要求选择不同的。</li>
<li>策略模式提供了对开闭原则的完美支持，可以在不修改原代码的情况下，灵活增加新算法。</li>
<li>策略模式把算法的使用放到环境类中，而算法的实现移到具体策略类中，实现了二者的分离。</li>
</ol>
<h3 id="2-主要缺点" style="position:relative;"><a href="#2-%E4%B8%BB%E8%A6%81%E7%BC%BA%E7%82%B9" aria-label="2 主要缺点 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 主要缺点</h3>
<ol>
<li>客户端必须理解所有策略算法的区别，以便适时选择恰当的算法类。</li>
<li>策略模式造成很多的策略类。</li>
</ol>
<h2 id="结构及实现" style="position:relative;"><a href="#%E7%BB%93%E6%9E%84%E5%8F%8A%E5%AE%9E%E7%8E%B0" aria-label="结构及实现 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>结构及实现</h2>
<p>策略模式是准备一组算法，并将这组算法封装到一系列的<strong>策略类</strong>里面，作为一个抽象策略类的子类。<strong>策略模式的重心不是如何实现算法，而是如何组织这些算法</strong>，从而让程序结构更加灵活，具有更好的维护性和扩展性，现在我们来分析其基本结构和实现方法。</p>
<h3 id="1-模式的结构" style="position:relative;"><a href="#1-%E6%A8%A1%E5%BC%8F%E7%9A%84%E7%BB%93%E6%9E%84" aria-label="1 模式的结构 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 模式的结构</h3>
<p>策略模式的主要角色如下。</p>
<ol>
<li>抽象策略（Strategy）类：定义了一个公共接口，各种不同的算法以不同的方式实现这个接口，环境角色使用这个接口调用不同的算法，一般使用接口或抽象类实现。</li>
<li>具体策略（Concrete Strategy）类：实现了抽象策略定义的接口，提供具体的算法实现。</li>
<li>环境（Context）类：持有一个策略类的引用，最终给客户端调用。</li>
</ol>
<p><figure class="gatsby-resp-image-figure" style="">
    <span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 840px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 49.047619047619044%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABO0lEQVQoz32S4Y6CQAyEef8H45dBjAkqipigoKKCAgZQ6eXrZQ1nOJtMdtPtzky7a6VpKvv9Xna7na51XUtVVbpPkkTzrI/HQ7quk9fr9Qf9HHtrOp3KeDwWx3FkMpmIEXBdVzEajfSsKAohzMX/YMVx/HYRRZFexOF6vZbtdivH41EF7vf7oEOcg+fz+UsovSDJRUDxZ+AegfP5LJ7nqWhZlmoiyzIltowSZGC5XMp8Ptfc7XZTIHC9XmWz2chsNpPVaqWEOD+dTnK5XFRECbFJ0GYYhlocBIGOgFzbtipEMY5s21YwV0Ad7iB9E5rZcLH/coQ5J/I8V1e0DSAxv8KMyfr2Yv3hE4fDQRaLhfi+r27pBFKEICSsIYIhYlbmxcPQJuSsOGW+uNRX/ubwE7RnvkgfTdPorKn5AfCu/180l8WjAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="策略模式"
        title="策略模式"
        src="/blog/static/6c744d11a41b9f1a792f9b67d6b3de7b/f88f5/image-20191004145847644.png"
        srcset="/blog/static/6c744d11a41b9f1a792f9b67d6b3de7b/e1650/image-20191004145847644.png 210w,
/blog/static/6c744d11a41b9f1a792f9b67d6b3de7b/8cae7/image-20191004145847644.png 420w,
/blog/static/6c744d11a41b9f1a792f9b67d6b3de7b/f88f5/image-20191004145847644.png 840w,
/blog/static/6c744d11a41b9f1a792f9b67d6b3de7b/57a2b/image-20191004145847644.png 1260w,
/blog/static/6c744d11a41b9f1a792f9b67d6b3de7b/609d5/image-20191004145847644.png 1292w"
        sizes="(max-width: 840px) 100vw, 840px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span>
    <figcaption class="gatsby-resp-image-figcaption">策略模式</figcaption>
  </figure></p>
<h3 id="2-模式的实现" style="position:relative;"><a href="#2-%E6%A8%A1%E5%BC%8F%E7%9A%84%E5%AE%9E%E7%8E%B0" aria-label="2 模式的实现 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 模式的实现</h3>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">interface</span> <span class="token class-name">IStrategy</span> <span class="token punctuation">{</span>
  <span class="token function">strategyMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Context</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> strategy<span class="token operator">:</span> IStrategy<span class="token punctuation">;</span>

  <span class="token function">setStrategy</span><span class="token punctuation">(</span>strategy<span class="token operator">:</span> IStrategy<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>strategy <span class="token operator">=</span> strategy<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">getStrategy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> IStrategy <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>strategy<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">strategyMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>strategy<span class="token punctuation">.</span><span class="token function">strategyMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">ConcreteStrategyA</span> <span class="token keyword">implements</span> <span class="token class-name">IStrategy</span> <span class="token punctuation">{</span>
  <span class="token function">strategyMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'具体策略A的策略方法被访问！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">ConcreteStrategyB</span> <span class="token keyword">implements</span> <span class="token class-name">IStrategy</span> <span class="token punctuation">{</span>
  <span class="token function">strategyMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'具体策略B的策略方法被访问！'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> context <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Context</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> csa <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConcreteStrategyA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> csb <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConcreteStrategyB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

context<span class="token punctuation">.</span><span class="token function">setStrategy</span><span class="token punctuation">(</span>csa<span class="token punctuation">)</span><span class="token punctuation">;</span>
context<span class="token punctuation">.</span><span class="token function">strategyMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'------------'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
context<span class="token punctuation">.</span><span class="token function">setStrategy</span><span class="token punctuation">(</span>csb<span class="token punctuation">)</span><span class="token punctuation">;</span>
context<span class="token punctuation">.</span><span class="token function">strategyMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 具体策略A的策略方法被访问！</span>
<span class="token comment">// ------------</span>
<span class="token comment">// 具体策略B的策略方法被访问！</span></code></pre></div>
<h2 id="应用场景" style="position:relative;"><a href="#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF" aria-label="应用场景 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>应用场景</h2>
<p>策略模式在很多地方用到，如 JavaSE 中的容器布局管理就是一个典型的实例，Java SE 中的每个容器都存在多种布局供用户选择。在程序设计中，通常在以下几种情况中使用策略模式较多。</p>
<ol>
<li>一个系统需要动态地在几种算法中选择一种时，可将每个算法封装到策略类中。</li>
<li>一个类定义了多种行为，并且这些行为在这个类的操作中以多个条件语句的形式出现，可将每个条件分支移入它们各自的策略类中以代替这些条件语句。</li>
<li>系统中各算法彼此完全独立，且要求对客户隐藏具体算法的实现细节时。</li>
<li>系统要求使用算法的客户不应该知道其操作的数据时，可使用策略模式来隐藏与算法相关的<strong>数据结构</strong>。</li>
<li>多个类只区别在表现行为不同，可以使用策略模式，在运行时动态选择具体要执行的行为</li>
</ol>
<p><figure class="gatsby-resp-image-figure" style="">
    <span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 840px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 49.523809523809526%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABNklEQVQoz4WS6YrCQBCE5/0fLSj4QzDmUCMmXqh459DU8jXMErLiDhTT6c7UdFWPe71eut/vOp/PejweKstSl8vFcsTX69VqVVXp/X6rbVvbP4Gaez6fSpJEw+HQ9jzPNRqNLC6KQuPxWIPBQOv1WlzOoW9wdJFlmZbLpeI4thiyxWKhNE01m82stlqt/nTEBV2Qc112kshG5u12U13X6i/s2O/3OhwOCsNQ8/nc7DmdTlb7JYSdhVd0ttlsLM83HmINB7EEBViBIv7b7XYGSJ0noiOkIXUymWi73RoJoOumaQzk8TsIAusQUkDXRtiVSzddmeT7MXZwKZ5CwjfwL8N5uf7At2fBOh6PiqJI0+nUBshQaQIyiN2n0fsL+jk/FD80dmygDin2uP/eVR/+IPaArs/UfgDypwIdZW7LWgAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="策略模式示例"
        title="策略模式示例"
        src="/blog/static/c79057e6719d12bebcb6c6422ae3c05f/f88f5/image-20191004145929189.png"
        srcset="/blog/static/c79057e6719d12bebcb6c6422ae3c05f/e1650/image-20191004145929189.png 210w,
/blog/static/c79057e6719d12bebcb6c6422ae3c05f/8cae7/image-20191004145929189.png 420w,
/blog/static/c79057e6719d12bebcb6c6422ae3c05f/f88f5/image-20191004145929189.png 840w,
/blog/static/c79057e6719d12bebcb6c6422ae3c05f/57a2b/image-20191004145929189.png 1260w,
/blog/static/c79057e6719d12bebcb6c6422ae3c05f/04a4c/image-20191004145929189.png 1500w"
        sizes="(max-width: 840px) 100vw, 840px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span>
    <figcaption class="gatsby-resp-image-figcaption">策略模式示例</figcaption>
  </figure></p>
<h2 id="拓展" style="position:relative;"><a href="#%E6%8B%93%E5%B1%95" aria-label="拓展 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>拓展</h2>
<p>在一个使用策略模式的系统中，当存在的策略很多时，客户端管理所有策略算法将变得很复杂，如果在环境类中使用<strong>策略工厂模式</strong>来管理这些策略类将大大减少客户端的工作复杂度，其结构图如图所示。</p>
<p><figure class="gatsby-resp-image-figure" style="">
    <span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 840px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 42.857142857142854%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAABNElEQVQoz4WSa8uCQBCF9///M0HNLAk/WHY1K81b2kU7cQbmRSJ4Bw5ru+yZOc9mTqcTjscj9vs9rtcrHo8HLpeL7B0OB5zPZ7xeL7zfbwzDIKt+q3SPMp7nYTKZwLZtLBYLFEWB2WwG13XhOA7m8znqugar7/s/k3FxX89MlmVQcZqqqpCmKfI8F3Pq+XzKRRpzeioIAmkchqHcKcsSTdPAjDsx/nQ6Rdu2uN/v6LpOEHC93W7Y7XbwfV9MmIwp+JtoOBAbGmVAfsvlElEUCU9ORjPyoxiJXC3LEiM2pulqtZJBOKVMqIB/1Rg2i9E5BS9SasLpmYrn5terfb+eNqRBHMei9XotCDabjTDlGZOY8d9hbPS9xyJ48tputyIi4JokiTAkazOO9Z/4UIxFnspWpbw/fWKxArA+jnEAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="策略工厂模式"
        title="策略工厂模式"
        src="/blog/static/e507711141bc3b2b7370af7d2b568c8c/f88f5/image-20191004145945184.png"
        srcset="/blog/static/e507711141bc3b2b7370af7d2b568c8c/e1650/image-20191004145945184.png 210w,
/blog/static/e507711141bc3b2b7370af7d2b568c8c/8cae7/image-20191004145945184.png 420w,
/blog/static/e507711141bc3b2b7370af7d2b568c8c/f88f5/image-20191004145945184.png 840w,
/blog/static/e507711141bc3b2b7370af7d2b568c8c/57a2b/image-20191004145945184.png 1260w,
/blog/static/e507711141bc3b2b7370af7d2b568c8c/b5d14/image-20191004145945184.png 1680w,
/blog/static/e507711141bc3b2b7370af7d2b568c8c/f6042/image-20191004145945184.png 1720w"
        sizes="(max-width: 840px) 100vw, 840px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span>
    <figcaption class="gatsby-resp-image-figcaption">策略工厂模式</figcaption>
  </figure></p>]]></description><link>https://xiangst0816.github.io/blog/design-patterns-strategy-patterns/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/design-patterns-strategy-patterns/</guid><category><![CDATA[设计模式]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Fri, 04 Oct 2019 07:01:02 GMT</pubDate></item><item><title><![CDATA[cnpm使用总结]]></title><description><![CDATA[<h2 id="安装" style="position:relative;"><a href="#%E5%AE%89%E8%A3%85" aria-label="安装 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>安装</h2>
<p>全局安装，<a href="https://npm.taobao.org" target="_target" rel="nofollow">详情</a>：</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">$ npm install tnpm -g --registry=https://registry.npm.taobao.org</code></pre></div>
<h2 id="使用问题" style="position:relative;"><a href="#%E4%BD%BF%E7%94%A8%E9%97%AE%E9%A2%98" aria-label="使用问题 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>使用问题</h2>
<p>cnpm是使用软连方式安装，所以在IDE使用时，会遇到两个问题：</p>
<ol>
<li>某些 IDE 无法正确识别软链，会导致循环索引。</li>
<li><code class="language-text">node_modules</code> 目录下同时存在软链，不方便查看。</li>
</ol>
<p>第一点，安装 <a href="https://www.npmjs.com/package/webstorm-disable-index" target="_target" rel="nofollow">webstorm-disable-index</a> 这个依赖包即可。</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">$ tnpm i webstorm-disable-index --save-dev
$ ls .idea/</code></pre></div>
<p>第二点，你可以在 <code class="language-text">VSCode</code> 配置：</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">&quot;files.exclude&quot;: {
  &quot;**/node_modules/_*@*&quot;: true,
},</code></pre></div>
<p>在 <code class="language-text">WebStorm</code> 配置 <code class="language-text">File Types</code> 的 <code class="language-text">Ignore</code> 增加 <code class="language-text">_*@*;</code> 即可。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 840px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 67.14285714285715%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAAB7UlEQVQ4y42TSY/TQBBG/YuSyWbHcbfd7va+O3a2gUHA3FkkJC5ckBA3fvNHdSeMEJNBOTyV3S6XXV2vrSjfIiF8WcL1UyzdEEGoIKQC8wVWjovFyjHMl/Z/mS1sWGV3Qt4cwMIKQdRApi32h5Nh3B+Q5aX5wC34QsKSaY+yPSJMukvRCl0/YBj36IcdVJzC44H5Ww0PQrB/+bNO0VJZj258gMqobVVDxLUpNOyOhqYbEKUFYsIPIyogX8YPYYVJi2Z4jao7QhcX9IdSCgjBEV4IfM/AuQvOXoaxDSy2+4H68Rf44SdW7Xesm68oTl/QvPkGt/4Eu/gAp/xInOP6KvSs+ox19kgtl69Qj+/BohE83lPcQhU7xNURG9XBU/0NnPM2NANLJg22+wfk1WjaDWQOxjk8Ri36nNq8EcrV75mh1P09tI8+aaN95LTB56mFJj5HPuX8jZlyQcq0NBTtoNFGXbwT0iRoZZ7BGMGvPjMeDoe30ILroiKqycstTX5HawPSskFWtUgJHfOqQbp9h7S9pxNWIinqS05j9LJEXNBFCRnn4CIm2yNjvOHKadBHMlA5bU1ipNcfkFGMIC7BFBXceC4cx4aztrF2HbiETfd38wWmdzPD5BKfrqdTTAids1iuMJvNMZktMZ2v8BuaPdCd6+r9yAAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="webstorm ignore 49004433"
        title="webstorm ignore 49004433"
        src="/blog/static/f5f380733d592fe156168a80a677be49/f88f5/webstorm_ignore.49004433.png"
        srcset="/blog/static/f5f380733d592fe156168a80a677be49/e1650/webstorm_ignore.49004433.png 210w,
/blog/static/f5f380733d592fe156168a80a677be49/8cae7/webstorm_ignore.49004433.png 420w,
/blog/static/f5f380733d592fe156168a80a677be49/f88f5/webstorm_ignore.49004433.png 840w,
/blog/static/f5f380733d592fe156168a80a677be49/57a2b/webstorm_ignore.49004433.png 1260w,
/blog/static/f5f380733d592fe156168a80a677be49/b5d14/webstorm_ignore.49004433.png 1680w,
/blog/static/f5f380733d592fe156168a80a677be49/4636e/webstorm_ignore.49004433.png 2000w"
        sizes="(max-width: 840px) 100vw, 840px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>]]></description><link>https://xiangst0816.github.io/blog/cnpm-shi-yong-zong-jie/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/cnpm-shi-yong-zong-jie/</guid><category><![CDATA[未归档]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Sun, 22 Sep 2019 07:24:45 GMT</pubDate></item><item><title><![CDATA[如何进行Nodejs版本管理]]></title><description><![CDATA[<h1 id="如何进行nodejs版本管理" style="position:relative;"><a href="#%E5%A6%82%E4%BD%95%E8%BF%9B%E8%A1%8Cnodejs%E7%89%88%E6%9C%AC%E7%AE%A1%E7%90%86" aria-label="如何进行nodejs版本管理 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>如何进行Nodejs版本管理</h1>
<h2 id="使用场景" style="position:relative;"><a href="#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF" aria-label="使用场景 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>使用场景</h2>
<p>一般来说，直接从 <a href="https://nodejs.org/" target="_target" rel="nofollow">Node.js 官网</a>下载对应的安装包，即可完成环境配置。</p>
<p>但在<strong>本地开发</strong>的时候，经常需要快速更新或切换版本。</p>
<p>社区有 <a href="https://github.com/creationix/nvm" target="_target" rel="nofollow">nvm</a>、<a href="https://github.com/tj/n" target="_target" rel="nofollow">n</a> 等方案，我们推荐跨平台的 <a href="https://github.com/jasongin/nvs" target="_target" rel="nofollow">nvs</a>。</p>
<h2 id="如何安装" style="position:relative;"><a href="#%E5%A6%82%E4%BD%95%E5%AE%89%E8%A3%85" aria-label="如何安装 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>如何安装</h2>
<h3 id="linux--macos-环境" style="position:relative;"><a href="#linux--macos-%E7%8E%AF%E5%A2%83" aria-label="linux  macos 环境 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Linux / macOS 环境</h3>
<p>通过 Git Clone 对应的项目即可。</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">$ export NVS_HOME=&quot;$HOME/.nvs&quot;
$ git clone https://github.com/jasongin/nvs --depth=1 &quot;$NVS_HOME&quot;
$ . &quot;$NVS_HOME/nvs.sh&quot; install</code></pre></div>
<blockquote>
<p>注意，安装程序会在<code class="language-text">~/.bashrc</code>, <code class="language-text">~/.profile</code>, 或者 <code class="language-text">~/.zshrc</code> 中写入命令，先保证这些文件是存在的！</p>
</blockquote>
<h3 id="windows-环境" style="position:relative;"><a href="#windows-%E7%8E%AF%E5%A2%83" aria-label="windows 环境 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Windows 环境</h3>
<p>由于 Windows 环境配置比较复杂，所以 Windows 环境下还是推荐使用 <code class="language-text">msi</code> 文件完成初始化工作。</p>
<p>访问 <a href="https://github.com/jasongin/nvs/releases" target="_target" rel="nofollow">nvs/releases</a> 下载最新版本的 <code class="language-text">nvs.msi</code>，然后双击安装即可。</p>
<h2 id="配置镜像地址" style="position:relative;"><a href="#%E9%85%8D%E7%BD%AE%E9%95%9C%E5%83%8F%E5%9C%B0%E5%9D%80" aria-label="配置镜像地址 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>配置镜像地址</h2>
<p>在国内由于大家都懂的原因，需要把对应的镜像地址修改下：</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">$ nvs remote node https://npm.taobao.org/mirrors/node/
$ nvs remote
default             node
chakracore          https://github.com/nodejs/node-chakracore/releases/
chakracore-nightly  https://nodejs.org/download/chakracore-nightly/
nightly             https://nodejs.org/download/nightly/
node                https://nodejs.org/dist/</code></pre></div>
<h2 id="使用指南" style="position:relative;"><a href="#%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97" aria-label="使用指南 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>使用指南</h2>
<p>通过以下命令，即可非常简单的安装 Node.js 最新的 LTS 版本。</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text"># 安装最新的 LTS 版本
$ nvs add lts

# 配置为默认版本
$ nvs link lts</code></pre></div>
<p>安装其他版本：</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text"># 安装其他版本
$ nvs add 8

# 查看已安装的版本
$ nvs ls

# 在当前 Shell 切换版本
$ nvs use 8</code></pre></div>
<p>更多指令参见 <code class="language-text">nvs --help</code> 。</p>
<h2 id="共用-npm-全局模块（必须）" style="position:relative;"><a href="#%E5%85%B1%E7%94%A8-npm-%E5%85%A8%E5%B1%80%E6%A8%A1%E5%9D%97%EF%BC%88%E5%BF%85%E9%A1%BB%EF%BC%89" aria-label="共用 npm 全局模块（必须） permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>共用 npm 全局模块（必须）</h2>
<p>使用 <code class="language-text">nvs</code> 时，默认的 <code class="language-text">prefix</code> 是当前激活的 Node.js 版本的安装路径。</p>
<p>带来一个问题是：切换版本之后，之前安装全局命令模块需要重新安装，非常不方便。</p>
<p>解决方案是配置统一的全局模块安装路径到 <code class="language-text">~/.npm-global</code>，如下：</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">$ mkdir -p ~/.npm-global
$ npm config set prefix ~/.npm-global</code></pre></div>
<p>还需配置环境变量到 <code class="language-text">~/.bashrc</code> 或 <code class="language-text">~/.zshrc</code> 文件里面：</p>
<blockquote>
<p>缺少了这步，全局安装的命令都不会生效！</p>
</blockquote>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">$ echo &quot;export PATH=~/.npm-global/bin:$PATH&quot; &gt;&gt; ~/.zshrc
$ source ~/.zshrc</code></pre></div>]]></description><link>https://xiangst0816.github.io/blog/ru-he-jin-hang-nodejs/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/ru-he-jin-hang-nodejs/</guid><category><![CDATA[未归档]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Sun, 22 Sep 2019 07:14:15 GMT</pubDate></item><item><title><![CDATA[CSS揭秘]]></title><description><![CDATA[<p>原版《CSS Secrets》是由 LEA VEROU 编写，主要介绍网页设计中比较经典的 CSS 实现方案及编写技巧。中文版由“CSS 魔法”翻译，在阅读过程中个人感觉翻译的还是很到位的，这里点个赞。</p>
<blockquote>
<p>CSS Secrets: Better Solutions to Everyday Web Design Problems</p>
</blockquote>
<p>这篇文章是对《CSS 揭秘》一书的总结，以思维导图的方式将书中脉络梳理出来，在过一遍书中知识点时做到查漏补缺。另外，通过一次梳理就记住 CSS 编写时的技巧基本不可能，希望以后遇到类似问题时能快速查到解决方案。</p>
<h2 id="css-编码技巧" style="position:relative;"><a href="#css-%E7%BC%96%E7%A0%81%E6%8A%80%E5%B7%A7" aria-label="css 编码技巧 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>CSS 编码技巧</h2>
<h4 id="思维导图" style="position:relative;"><a href="#%E6%80%9D%E7%BB%B4%E5%AF%BC%E5%9B%BE" aria-label="思维导图 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>思维导图</h4>
<p><img src="/blog/post-asset//bdd387f4d9f28a07a30d509e8bcfb542/CSS%E7%BC%96%E7%A0%81%E6%8A%80%E5%B7%A7.svg" alt="CSS编码技巧"></p>
<h4 id="备注" style="position:relative;"><a href="#%E5%A4%87%E6%B3%A8" aria-label="备注 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>备注</h4>
<p>CSS 的编写和 JavaScript 的思维模型还是有很大差距的，CSS 中不同属性的组合是会产生不同效果的，这个也是 CSS 使用者头疼的问题，比如对 span 标签设置 height 为什么不生效的问题、内部元素 margin-top 会影响外容器、浮动清除等问题。因此，CSS 在编写时需要了解以下部分：</p>
<ul>
<li>
<p>理解</p>
<ul>
<li>流的方式排版</li>
<li>块级盒模型（块级元素）</li>
<li>行框盒模型（内联元素）</li>
<li>幽灵节点</li>
<li>BFC：块级格式化上下文</li>
<li>浮动元素</li>
<li>定位</li>
<li>flex、grid</li>
</ul>
</li>
<li>
<p>熟记</p>
<ul>
<li>各种属性的特点</li>
<li>不同盒模型下属性生效规则</li>
<li>属性的默认表现</li>
<li>属性堆叠覆盖</li>
<li>属性的继承关系</li>
</ul>
</li>
<li>
<p>新规范</p>
<ul>
<li>CSS Hudini</li>
<li>CSS Grid</li>
<li>xx Worklet</li>
<li>CSS Variable</li>
</ul>
</li>
<li>
<p>兼容性</p>
<ul>
<li>CanIUse</li>
<li>autoprefix</li>
</ul>
</li>
<li>
<p>预处理器</p>
<ul>
<li>SCSS</li>
<li>LESS</li>
<li>Stylus</li>
</ul>
</li>
<li>
<p>组件库的样式系统设计</p>
<ul>
<li>主题切换方案</li>
<li>组件样式</li>
<li>命名规范（BEM）</li>
<li>fn/mixin</li>
<li>变量</li>
</ul>
</li>
<li>
<p>Scoped CSS</p>
<ul>
<li>CSS Module</li>
<li>CSS-In-JS</li>
</ul>
</li>
</ul>
<p>我认为一个合格的前端以上都是必须要理解 8~9 成的。</p>
<h2 id="背景与边框" style="position:relative;"><a href="#%E8%83%8C%E6%99%AF%E4%B8%8E%E8%BE%B9%E6%A1%86" aria-label="背景与边框 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>背景与边框</h2>
<h4 id="思维导图-1" style="position:relative;"><a href="#%E6%80%9D%E7%BB%B4%E5%AF%BC%E5%9B%BE-1" aria-label="思维导图 1 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>思维导图</h4>
<p><img src="/blog/post-asset//0166615ecf4200a740f147a8d70a7238/%E8%83%8C%E6%99%AF%E4%B8%8E%E8%BE%B9%E6%A1%86.svg" alt="背景与边框"></p>
<h4 id="备注-1" style="position:relative;"><a href="#%E5%A4%87%E6%B3%A8-1" aria-label="备注 1 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>备注</h4>
<ul>
<li>CSS 渐变部分参考这部分<a href="/blog/guan-yu-linear-gradient-ni-xu/">《关于 linear-gradient()你需要知道的事儿》</a></li>
<li>background 支持多属性</li>
<li>background-clip：背景裁切</li>
<li>background-origin：用于改变 background-position 定位边界</li>
</ul>
<h2 id="形状" style="position:relative;"><a href="#%E5%BD%A2%E7%8A%B6" aria-label="形状 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>形状</h2>
<h4 id="思维导图-2" style="position:relative;"><a href="#%E6%80%9D%E7%BB%B4%E5%AF%BC%E5%9B%BE-2" aria-label="思维导图 2 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>思维导图</h4>
<p><img src="/blog/post-asset//b42ef114d3d4d800de05a0644f2910f9/%E5%BD%A2%E7%8A%B6.svg" alt="形状"></p>
<h4 id="备注-2" style="position:relative;"><a href="#%E5%A4%87%E6%B3%A8-2" aria-label="备注 2 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>备注</h4>
<ul>
<li>一个元素有两个伪类（before、after）可以帮我们处理些难搞的背景需求</li>
<li>clip-path：用于图片裁切</li>
<li>animation 是能暂停的，并能设置某个暂停时间的表现状态，类似于“切帧”的概念</li>
</ul>
<h2 id="视觉效果" style="position:relative;"><a href="#%E8%A7%86%E8%A7%89%E6%95%88%E6%9E%9C" aria-label="视觉效果 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>视觉效果</h2>
<h4 id="思维导图-3" style="position:relative;"><a href="#%E6%80%9D%E7%BB%B4%E5%AF%BC%E5%9B%BE-3" aria-label="思维导图 3 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>思维导图</h4>
<p><img src="/blog/post-asset//dc1640380530e3a22b714bffb56cbe5c/%E8%A7%86%E8%A7%89%E6%95%88%E6%9E%9C.svg" alt="视觉效果"></p>
<h4 id="备注-3" style="position:relative;"><a href="#%E5%A4%87%E6%B3%A8-3" aria-label="备注 3 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>备注</h4>
<ul>
<li>不规则元素的阴影使用 drop-shadow 滤镜处理</li>
</ul>
<h2 id="字体排印" style="position:relative;"><a href="#%E5%AD%97%E4%BD%93%E6%8E%92%E5%8D%B0" aria-label="字体排印 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>字体排印</h2>
<h4 id="思维导图-4" style="position:relative;"><a href="#%E6%80%9D%E7%BB%B4%E5%AF%BC%E5%9B%BE-4" aria-label="思维导图 4 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>思维导图</h4>
<p><img src="/blog/post-asset//3d1199f634ae606df80f27856e0f66ae/%E5%AD%97%E4%BD%93%E6%8E%92%E5%8D%B0.svg" alt="字体排印"></p>
<h4 id="备注-4" style="position:relative;"><a href="#%E5%A4%87%E6%B3%A8-4" aria-label="备注 4 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>备注</h4>
<ul>
<li>自定义下划线效果使用还是蛮频繁的</li>
<li>text-shadow 是能重叠书写的</li>
</ul>
<h2 id="用户体验" style="position:relative;"><a href="#%E7%94%A8%E6%88%B7%E4%BD%93%E9%AA%8C" aria-label="用户体验 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>用户体验</h2>
<h4 id="思维导图-5" style="position:relative;"><a href="#%E6%80%9D%E7%BB%B4%E5%AF%BC%E5%9B%BE-5" aria-label="思维导图 5 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>思维导图</h4>
<p><img src="/blog/post-asset//c3ee84248a2b62059ca125228e83f40e/%E7%94%A8%E6%88%B7%E4%BD%93%E9%AA%8C.svg" alt="用户体验"></p>
<h4 id="备注-5" style="position:relative;"><a href="#%E5%A4%87%E6%B3%A8-5" aria-label="备注 5 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>备注</h4>
<ul>
<li>blur 的逻辑是对某个 div 内部内容整体虚化，div 底部的内容还是能穿透上来正常显示</li>
<li>扩大点击区域使用伪类处理是最佳选择</li>
</ul>
<h2 id="结构与布局" style="position:relative;"><a href="#%E7%BB%93%E6%9E%84%E4%B8%8E%E5%B8%83%E5%B1%80" aria-label="结构与布局 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>结构与布局</h2>
<h4 id="思维导图-6" style="position:relative;"><a href="#%E6%80%9D%E7%BB%B4%E5%AF%BC%E5%9B%BE-6" aria-label="思维导图 6 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>思维导图</h4>
<p><img src="/blog/post-asset//7dfa3cfbe9b352aa08c6ceb7fd192d53/%E7%BB%93%E6%9E%84%E4%B8%8E%E5%B8%83%E5%B1%80.svg" alt="结构与布局"></p>
<h4 id="备注-6" style="position:relative;"><a href="#%E5%A4%87%E6%B3%A8-6" aria-label="备注 6 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>备注</h4>
<ul>
<li>flex 布局方案是最终方案，尤其是在现在(2018)，如果面试有遇到需要了解 Hack 的情况，请珍爱生命，立刻停止面试</li>
<li>响应式设计除了根据屏幕宽度，还可以根据<strong>当前组件的</strong>外容器的尺寸响应</li>
</ul>
<h2 id="过度与动画" style="position:relative;"><a href="#%E8%BF%87%E5%BA%A6%E4%B8%8E%E5%8A%A8%E7%94%BB" aria-label="过度与动画 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>过度与动画</h2>
<h4 id="思维导图-7" style="position:relative;"><a href="#%E6%80%9D%E7%BB%B4%E5%AF%BC%E5%9B%BE-7" aria-label="思维导图 7 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>思维导图</h4>
<p><img src="/blog/post-asset//76e3b8479db5e7f2854211890284f1f9/%E8%BF%87%E5%BA%A6%E4%B8%8E%E5%8A%A8%E7%94%BB.svg" alt="过度与动画"></p>
<h4 id="备注-7" style="position:relative;"><a href="#%E5%A4%87%E6%B3%A8-7" aria-label="备注 7 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>备注</h4>
<ul>
<li>“transform-origin 只是语法糖”这部分让我大开眼界</li>
<li>在某些情况，使用 animation-direction 可以精简关键帧</li>
</ul>
<p>（完）</p>]]></description><link>https://xiangst0816.github.io/blog/css-jie-mi/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/css-jie-mi/</guid><category><![CDATA[CSS]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Sat, 21 Jul 2018 12:30:13 GMT</pubDate></item><item><title><![CDATA[关于linear-gradient()你需要知道的事儿]]></title><description><![CDATA[<p><code class="language-text">linear-gradient()</code>是一个 CSS 函数，它能创建一个在多个颜色之间根据已知路径进行线性渐变的<strong>图片</strong>。没错，<code class="language-text">linear-gradient()</code>是<code class="language-text">&lt;gradient&gt;</code>类型的<code class="language-text">&lt;image&gt;</code>图片，因此渐变函数无法应用于<code class="language-text">&lt;color&gt;</code>的场景，比如：background-color。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 840px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 38.57142857142858%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAAB1UlEQVQoz12SO0+UQRSG98dZYGWCsfZ3GGyNUSKNibWIFqIVFbcQaOyABFDA5bK77OW7zze377LfLo9nF2Nh8WZOZs48855zpnV89pMgTRlG0Vz9ICR3nqKZ4Kr6n6yoHDdMplNqOZvFrm4omylhBctnjqOsoRULxApAW48yjlTlEjuMc3JpTD2ZzAGNgAJtOewMuY4SApNjKk1hAlR4zf7JMXempJUPQlSqGaYF/cjTG8UMwphuf0SiDMoWpNrhfMnerw4L79Z4u7XLTvuIgT4jvfyG3V2CL4vgInEYKpT2RHlFoEop3xApS5AZRolimOQM4oxhnLN5esvjlTXeCHBbgP38lESAemcJv7pIYwTo0wwv5eauItOllDor35IbQ5ZreUzLvob7KQcXXRZWPrP812F/7vA7evcl5aenD8BKgIUAU4ElWUEUpwIyhOIqSWIBe4bSgqYu2Rfgo+VVXm/usPX7kLuZw4t19PYLio9PBBjSui9LSl9xN7Lc9g3t9g3dXkD7ekDn9oog1pxfdrAq5cfVgGcf1nm/d8D+zQkjc4662sAevKL6+pyJjWk5maSvxxT/a/yw+rqex7OczBf0ZICRsajCy3cq8IWWliV4NaKWvD8EVkiExVLXqQAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="demo"
        title="demo"
        src="/blog/static/d6acc9328f64adabc347c800aa31fd0b/f88f5/demo.png"
        srcset="/blog/static/d6acc9328f64adabc347c800aa31fd0b/e1650/demo.png 210w,
/blog/static/d6acc9328f64adabc347c800aa31fd0b/8cae7/demo.png 420w,
/blog/static/d6acc9328f64adabc347c800aa31fd0b/f88f5/demo.png 840w,
/blog/static/d6acc9328f64adabc347c800aa31fd0b/a4e6c/demo.png 1065w"
        sizes="(max-width: 840px) 100vw, 840px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<p>此外，<code class="language-text">linear-gradient()</code>没有内在维度、尺寸或者比例，它的具体尺寸将和对应元素尺寸匹配，如果希望创建能重复渐变的特性，可以使用<code class="language-text">repeating-linear-gradient()</code>函数。</p>
<h2 id="线性渐变是如何合成的？" style="position:relative;"><a href="#%E7%BA%BF%E6%80%A7%E6%B8%90%E5%8F%98%E6%98%AF%E5%A6%82%E4%BD%95%E5%90%88%E6%88%90%E7%9A%84%EF%BC%9F" aria-label="线性渐变是如何合成的？ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>线性渐变是如何合成的？</h2>
<p>我们需要清楚的一点是，<strong>linear-gradient 是一个 css 函数</strong>，具体的图形绘制是由底层机制处理。我们在这里能做的就是<strong>理解传参原理和传参指纹</strong>，解释这个过程你需要清楚这个图：</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 274px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 140%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAcCAYAAABh2p9gAAAACXBIWXMAAAsSAAALEgHS3X78AAAD+klEQVRIx5VWa1MaSxTc//8H8iVfrEq0ktIYXwGioPJwdndmFoOaKDFoUFhgIcpLEcW+PSubIoR4y6nqOrPMnJ4+8zgHCxPt8fExtA8PD/D9Kmq+j8vLS1SIatVHvV5D+eICV9fXv+dHPlGzpgmjCY16HQeFAna2t7GZ+IytrVT4nc1koD1vPH/0POGkymaziX6/j3+1aPFofmSt6cFo4Pb2FrVaLeyPRqM/MK1q8tuaHoyacaxWq5g1bsYGgwF6vR7u7+9nK4xWniRoNBrhAZl2d3eHm5sbdDoddLvdcDuGw+HfIRsi0/bzHvb2bGidx8HBIZTy4EiN4skJnW9CErMNDw9/hjy9Xb8PZXg3oII+rq6u0GwFDKeLX79a+PnzHC9plu83eLdq3K+Ah9AiSYdhGUW36PcG+P79jIt00G73iV6ITqc/Ri9Et9sP0W53YL16lcTr11nMzdl480bi7VsX8/MOYeP9e8mxOPtpLC9LwsHHjw5WVx2srzvY2HAQi7mEQDy2h7XVFKy5OUESRTKbVuDdOxeLiwpLSworKx4WFnb5e5JOeRJIWoVEQmFzUxMSm59tXnob6bSmzcGan8+RQIcEHz64hE0lAmtrLj590qGShYU4nRUdJFIpRUgkkza2twUyGZeHqeC6HkmzsBYXcwxBkUBSgQoVPIVhIx4XIcnSUgI7OxK7u5LWqBEkceE4ClIq3giJfF5DCBKurOToqBmGDEOIVOzsGLjIZo3ydSqNk0DCth0SKF4vRRKJ/X2JQkHi61fN30gYi+VIoCn/SUE6I0MSIQwkQzGKYzyMZXjeE0mhoHhXFY6OJL59kzg+lvjxQ/N3EiaTOeRymjCrq5BASkk1NiG4qosvX0yoCRweSvYFrY2TE4nTU0UihVJJolzWJCZhJpMb74MJQ9KakARDceioGIqis+aeJdgXdNa8mw6KRUEym0QSlYpirtT8JqHrCkr1GIpDEpskLlcyTpoKdKiiXM5zLEXCNB+AR2gmYE3rMgHb7Du4vvZIzGsjRIpkGYaSDRUcH5twBAkFyYwiQUKb37uct0ElLon2+KoEgsBGq2XT7jF/5nB+vgWrXvf5tAKuEIQ26hu020/odIytc4Ej9ht8500+tYBo8KlWSFrmQiUqPP07Yz/XfL+Gwd1wXHcemROHoR0nrCjBjmZm7KiZBGrSlkGxWISSLrfkJExxPotYqVRi+A2MptPXZKI0ydQk0MlkahKt+f2CVa9S8XmiJe5tGaWzMwTNFlVOZewotUcExnk0Gcu4VSqVZwuXNa3u/6pbEAThopPFa3LcmlW5Zu1pZNvtNk+19bJC/y+l0b+KKOxZ8150bSICU6+jajhN+h9Y4xNPsjDeiQAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="linear gradient"
        title="linear gradient"
        src="/blog/static/a0bfca43b54373ee54a14b501688f1c0/23e71/linear-gradient.png"
        srcset="/blog/static/a0bfca43b54373ee54a14b501688f1c0/e1650/linear-gradient.png 210w,
/blog/static/a0bfca43b54373ee54a14b501688f1c0/23e71/linear-gradient.png 274w"
        sizes="(max-width: 274px) 100vw, 274px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<p><strong>理解渐变关键点：</strong></p>
<ul>
<li>线性渐变的渐变路径是<strong>一个穿过中心的一个轴（Gradient line）</strong>，这个轴会有<strong>角度和方向</strong></li>
<li>默认的方向是<code class="language-text">to bottom</code>，如图所示的<strong>starting point</strong>和<strong>ending point</strong></li>
<li>starting point 表示第一个颜色开始的位置（以矩形框最远端点到 Gradient line 的垂直交点）</li>
<li>ending point 表示最后一个颜色的位置</li>
<li><strong>starting point</strong>和<strong>ending point</strong>为中心对称结构</li>
<li>渐变将从 starting point 一直变化到 ending point，渐变线垂直 Gradient line</li>
<li>抛开上图矩形的边框的影响，因为 Gradient line 只和矩形中心有关</li>
<li>距离 starting point 和 ending point 最近的的<strong>外框矩形直角</strong>将会和对应的 starting point 和 ending point 有<strong>相同的颜色</strong></li>
<li>我们需要在这个 Gradient line 上<strong>指定多个确切的 color-stop 点</strong></li>
<li>如果只指定了 color，则 color 将<strong>均分</strong>starting point 和 ending point 之间的位置（<strong>包括端点</strong>，可以理解为端点为 0）</li>
<li>color-stop 的位置可以使用<code class="language-text">&lt;length&gt;</code>和<code class="language-text">&lt;percentage&gt;</code>两个单位定义</li>
</ul>
<h2 id="语法结构" style="position:relative;"><a href="#%E8%AF%AD%E6%B3%95%E7%BB%93%E6%9E%84" aria-label="语法结构 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>语法结构</h2>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">linear-gradient(
  [ &lt;angle&gt; | to &lt;side-or-corner&gt; ,]? &lt;color-stop&gt; [, &lt;color-stop&gt;]+ )
  \---------------------------------/ \----------------------------/
    Definition of the gradient line        List of color stops

where &lt;side-or-corner&gt; = [left | right] || [top | bottom]
  and &lt;color-stop&gt;     = &lt;color&gt; [ &lt;percentage&gt; | &lt;length&gt; ]?</code></pre></div>
<p>需要说明的是：</p>
<ul>
<li><code class="language-text">to &lt;side-or-corner&gt;</code>的默认值是<code class="language-text">to bottom</code></li>
<li>
<p><code class="language-text">to &lt;side-or-corner&gt;</code>是<code class="language-text">&lt;angle&gt;</code>的简写版，对应关系如下：</p>
<ul>
<li><code class="language-text">to top</code> -> <code class="language-text">0deg</code></li>
<li><code class="language-text">to bottom</code> -> <code class="language-text">180deg</code></li>
<li><code class="language-text">to left</code> -> <code class="language-text">270deg</code></li>
<li><code class="language-text">to right</code> -> <code class="language-text">90deg</code></li>
</ul>
</li>
<li><code class="language-text">&lt;angle&gt;</code>的角度关系可以理解为时钟的指针</li>
<li>关于<code class="language-text">&lt;angle&gt;</code>，0.25turn === 90deg</li>
</ul>
<h2 id="拓展" style="position:relative;"><a href="#%E6%8B%93%E5%B1%95" aria-label="拓展 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>拓展</h2>
<h3 id="code-classlanguage-textltimagegtcode类型" style="position:relative;"><a href="#code-classlanguage-textltimagegtcode%E7%B1%BB%E5%9E%8B" aria-label="code classlanguage textltimagegtcode类型 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code class="language-text">&lt;image&gt;</code>类型</h3>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/image" target="_target" rel="nofollow"><code class="language-text">&lt;image&gt;</code>类型</a>是 CSS 的一种数据类型，表示二维图形。图形可以为两种展现形式：<strong>纯图片</strong>，比如从<code class="language-text">&lt;url&gt;</code>中提供；或者<strong>动态生成</strong>的图片，比如通过<code class="language-text">&lt;gradient&gt;</code>。这样的类型可以被多个 css 属性使用，比如：</p>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/background-image" target="_target" rel="nofollow"><code class="language-text">background-image</code></a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/border-image" target="_target" rel="nofollow"><code class="language-text">border-image</code></a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/content" target="_target" rel="nofollow"><code class="language-text">content</code></a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/cursor" target="_target" rel="nofollow"><code class="language-text">cursor</code></a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/list-style-image" target="_target" rel="nofollow"><code class="language-text">list-style-image</code></a></li>
</ul>
<h4 id="如何确定尺寸" style="position:relative;"><a href="#%E5%A6%82%E4%BD%95%E7%A1%AE%E5%AE%9A%E5%B0%BA%E5%AF%B8" aria-label="如何确定尺寸 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>如何确定尺寸</h4>
<ol>
<li>如果提供了具体的 width 和 height，则使用提供值确定图片尺寸，此时可能会有图片挤压拉伸。</li>
<li>如果只提供了 width 或者 height，缺失部分就用图片固有比例展示。</li>
<li>如果 width 和 height 都未提供，则使用图片默认尺寸比例展示，此时图片可能无法贴合外部容器。</li>
</ol>
<h4 id="语法" style="position:relative;"><a href="#%E8%AF%AD%E6%B3%95" aria-label="语法 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>语法</h4>
<p><code class="language-text">&lt;image&gt;</code>类型可以有三种引入方式：</p>
<ol>
<li><code class="language-text">&lt;url&gt;</code>引入，比如：url(test.jpg)</li>
<li>linear-gradient()，比如：linear-gradient(blue, red)</li>
<li>element(#id)，兼容性不足</li>
</ol>
<h3 id="code-classlanguage-textltgradientgtcode类型" style="position:relative;"><a href="#code-classlanguage-textltgradientgtcode%E7%B1%BB%E5%9E%8B" aria-label="code classlanguage textltgradientgtcode类型 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code class="language-text">&lt;gradient&gt;</code>类型</h3>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/gradient" target="_target" rel="nofollow">渐变类型</a>是 image 类型的一种，他没有固定的尺寸和比例，最终尺寸将和定义它的元素尺寸匹配。</p>
<p>这种类型的 CSS 函数有：</p>
<ul>
<li>linear-gradient()</li>
<li>radial-gradient()</li>
<li>repeating-linear-gradient()</li>
<li>repeat-radial-gradient()</li>
</ul>
<h2 id="参考" style="position:relative;"><a href="#%E5%8F%82%E8%80%83" aria-label="参考 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>参考</h2>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/linear-gradient" target="_target" rel="nofollow">MDN Web Doc - linear-gradient()</a></li>
</ul>]]></description><link>https://xiangst0816.github.io/blog/guan-yu-linear-gradient-ni-xu/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/guan-yu-linear-gradient-ni-xu/</guid><category><![CDATA[CSS]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Fri, 13 Jul 2018 01:04:55 GMT</pubDate></item><item><title><![CDATA[关于Module]]></title><description><![CDATA[<p>CommonJS 和 AMD 模块都只能<strong>在运行时</strong>才能确定模块导出的<strong>对象</strong>。因此运行时才能得到整个对象，也就无法做到静态优化。而 ES6 从语法层面支持模块功能，其设计初衷就是就是尽量的静态化，使得代码在编译时就能确定模块的依赖关系。</p>
<p>ES6 关于 Module 的介绍参考阮一峰的 ES6 教程：<a href="http://es6.ruanyifeng.com/#docs/module" target="_target" rel="nofollow">ECMAScript 6 入门-Module 的语法</a>。下面是平时用到比较少的部分，使用时应该注意的地方。</p>
<h2 id="es6-模块使用时的注意点" style="position:relative;"><a href="#es6-%E6%A8%A1%E5%9D%97%E4%BD%BF%E7%94%A8%E6%97%B6%E7%9A%84%E6%B3%A8%E6%84%8F%E7%82%B9" aria-label="es6 模块使用时的注意点 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ES6 模块使用时的注意点</h2>
<ul>
<li>模块转发时，当前模块不能使用转发的变量</li>
</ul>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">export</span> <span class="token punctuation">{</span> foo<span class="token punctuation">,</span> bar <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"my_module"</span><span class="token punctuation">;</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>foo<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// error</span></code></pre></div>
<ul>
<li>default 本质上就是输出一个叫 default 的变量或方法，然后系统允许你为他任意取名</li>
</ul>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">export</span> <span class="token punctuation">{</span> add <span class="token keyword">as</span> <span class="token keyword">default</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 等同于</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> add<span class="token punctuation">;</span></code></pre></div>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token keyword">default</span> <span class="token keyword">as</span> foo <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"modules"</span><span class="token punctuation">;</span>
<span class="token comment">// 等同于</span>
<span class="token keyword">import</span> foo <span class="token keyword">from</span> <span class="token string">"modules"</span><span class="token punctuation">;</span></code></pre></div>
<h2 id="浏览器加载-es6-模块时的注意点" style="position:relative;"><a href="#%E6%B5%8F%E8%A7%88%E5%99%A8%E5%8A%A0%E8%BD%BD-es6-%E6%A8%A1%E5%9D%97%E6%97%B6%E7%9A%84%E6%B3%A8%E6%84%8F%E7%82%B9" aria-label="浏览器加载 es6 模块时的注意点 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>浏览器加载 ES6 模块时的注意点</h2>
<ul>
<li>defer 和 async 的区别：<code class="language-text">defer</code>是“渲染完再执行”，保证顺序；<code class="language-text">async</code>是“下载完就执行”，不保证顺序。</li>
<li><code class="language-text">type=&quot;module&quot;</code>时，默认为 defer 模式</li>
</ul>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>module<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>./foo.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token comment">&lt;!-- 等同于 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>module<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>./foo.js<span class="token punctuation">"</span></span> <span class="token attr-name">defer</span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></code></pre></div>
<h2 id="es6-模块与-commonjs-模块的差异" style="position:relative;"><a href="#es6-%E6%A8%A1%E5%9D%97%E4%B8%8E-commonjs-%E6%A8%A1%E5%9D%97%E7%9A%84%E5%B7%AE%E5%BC%82" aria-label="es6 模块与 commonjs 模块的差异 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ES6 模块与 CommonJS 模块的差异</h2>
<p>在整理 JavaScript 中 Module 相关的知识点时，不得不提 CommonJS 与 ES6 的 import/export 之间的关系。最主要的提点如下，其余部分都是从这两点的引申，所以不再重复。</p>
<ul>
<li>CommonJS 模块输出的是一个<strong>值的拷贝</strong>，ES6 模块输出的是值的<strong>引用</strong>。</li>
<li>CommonJS 模块是<strong>运行时加载</strong>，ES6 模块是<strong>编译时</strong>输出接口。</li>
</ul>
<h2 id="commonjs-中在code-classlanguage-textmoduleexportscode和code-classlanguage-textexportscode的区别？" style="position:relative;"><a href="#commonjs-%E4%B8%AD%E5%9C%A8code-classlanguage-textmoduleexportscode%E5%92%8Ccode-classlanguage-textexportscode%E7%9A%84%E5%8C%BA%E5%88%AB%EF%BC%9F" aria-label="commonjs 中在code classlanguage textmoduleexportscode和code classlanguage textexportscode的区别？ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>CommonJS 中在<code class="language-text">module.exports</code>和<code class="language-text">exports</code>的区别？</h2>
<p>Nodejs<a href="http://nodejs.cn/api/modules.html#modules_exports_shortcut" target="_target" rel="nofollow">文档说明</a>已解释了两者的区别，总的来说就五点：</p>
<ol>
<li>module.exports 初始值为一个空对象 {}</li>
<li>exports 表示别名， 默认是指向 module.exports 的引用</li>
<li>如果新值赋值给 exports，那他就不再指向 module.exports</li>
<li>require() 返回的是 module.exports 而不是 exports</li>
<li>如果两者产生困惑，那就忽视 exports，直接使用 module.exports</li>
</ol>
<blockquote>
<p>module.exports: 我才是老大！exports 只是我的昵称。</p>
</blockquote>
<p>保险起见，可以这样使用：</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">Constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// code here</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>]]></description><link>https://xiangst0816.github.io/blog/guan-yu-module/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/guan-yu-module/</guid><category><![CDATA[设计模式]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Sat, 07 Jul 2018 01:58:56 GMT</pubDate></item><item><title><![CDATA[关于class]]></title><description><![CDATA[<blockquote>
<p>这篇文章总结 class 相关，并辐射出周边需要了解的知识点，便于形成巩固自己的心理表征。</p>
</blockquote>
<h2 id="如何编写一个类？" style="position:relative;"><a href="#%E5%A6%82%E4%BD%95%E7%BC%96%E5%86%99%E4%B8%80%E4%B8%AA%E7%B1%BB%EF%BC%9F" aria-label="如何编写一个类？ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>如何编写一个类？</h2>
<p>在 ES6 还没出来之前，前端在编写 class 时，相比去其他设计成熟的语言会显得很诡异，比如使用 JS 原生的方式实现一个类继承，这个我在之前的文章中有说明。</p>
<ul>
<li><a href="https://xiangsongtao.github.io/blog/di-liu-lu-zhang-mian-xiang-dui-xiang/#16-%E7%AE%80%E5%8D%95%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E6%9C%80%E7%90%86%E6%83%B3%E7%9A%84%E7%BB%A7%E6%89%BF%E8%8C%83%E5%BC%8F" target="_target" rel="nofollow">第六章 面相对象的程序设计(简单实现一个最理想的继承范式?)</a></li>
<li><a href="https://xiangsongtao.github.io/blog/di-liu-lu-zhang-mian-xiang-dui-xiang/#2-code-classlanguage-textnewcode%E6%93%8D%E4%BD%9C%E7%AC%A6%E6%89%A7%E8%A1%8C%E7%9A%84%E8%BF%87%E7%A8%8B" target="_target" rel="nofollow">第六章 面相对象的程序设计(new 操作符执行的过程?)</a></li>
</ul>
<p>下面是 UML 说明：</p>
<p><figure class="gatsby-resp-image-figure" style="">
    <span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 840px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 51.90476190476191%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAAA00lEQVQoz62S6QqDQBCD+/6PJ4qIKIqgeB8oildKBqZoW9sf7UBATPbbLLu3fd/xT91+Wcz5ClzX9RTetu3h8Zu+epq9BDLQti3CMIRt2wiCAF3XQWcYBuR5DtM0JUNvmqZT0xOQDRg0DANFUaCuawE0TSNeHMfwPA9JkiDLMvH7vhegnuQF6Ps+LMuSpvM8I01TVFUlTQh0HAdRFMlp2JCtPwK5yHVdUVmWAtMhgK20GZuP43h95OPtcdiC4kYq/bcsi+h4aZfA59C7p6Lz13f4TncP9g9h3NDeJQAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="image-20180623224452836"
        title="image-20180623224452836"
        src="/blog/static/3e65303fa4dde3287bc943b9c9f3f449/f88f5/class-uml.png"
        srcset="/blog/static/3e65303fa4dde3287bc943b9c9f3f449/e1650/class-uml.png 210w,
/blog/static/3e65303fa4dde3287bc943b9c9f3f449/8cae7/class-uml.png 420w,
/blog/static/3e65303fa4dde3287bc943b9c9f3f449/f88f5/class-uml.png 840w,
/blog/static/3e65303fa4dde3287bc943b9c9f3f449/e56c1/class-uml.png 1054w"
        sizes="(max-width: 840px) 100vw, 840px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span>
    <figcaption class="gatsby-resp-image-figcaption">image-20180623224452836</figcaption>
  </figure></p>
<p>传统的基于原型的实现：</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// 1. 父类定义</span>
<span class="token keyword">function</span> <span class="token function">SuperType</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"red"</span><span class="token punctuation">,</span> <span class="token string">"blue"</span><span class="token punctuation">,</span> <span class="token string">"green"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token class-name">SuperType</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">sayName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 2. 子类定义</span>
<span class="token keyword">function</span> <span class="token function">SubType</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 2.1 继承了 SuperType 构造函数中定义的属性</span>
  <span class="token function">SuperType</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 2.2 子类自己的属性</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 父类原型链复制</span>
<span class="token class-name">SubType</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">SuperType</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 因为使用“.prototype =...”后,constructor会改变为“=...”的那个</span>
<span class="token comment">// constructor，所以要重新指定.constructor 为自身。</span>
<span class="token class-name">SubType</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> SubType<span class="token punctuation">;</span>
<span class="token class-name">SubType</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">sayAge</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 3. 实例化</span>
<span class="token keyword">var</span> instance1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubType</span><span class="token punctuation">(</span><span class="token string">"name1"</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
instance1<span class="token punctuation">.</span>colors<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">"black"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
instance1<span class="token punctuation">.</span><span class="token function">sayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// name1</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>instance1<span class="token punctuation">.</span>colors<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//"red,blue,green,black"</span>

<span class="token keyword">var</span> instance2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubType</span><span class="token punctuation">(</span><span class="token string">"name2"</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
instance2<span class="token punctuation">.</span><span class="token function">sayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// name2</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>instance2<span class="token punctuation">.</span>colors<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//"red,blue,green"</span></code></pre></div>
<p>ES6 出来之后，关于 class 的实现就和其他高级语言差不多了，但是也仅仅是阉割版。ES6 实现如下：</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// 1. 父类定义</span>
<span class="token keyword">class</span> <span class="token class-name">SuperType</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"red"</span><span class="token punctuation">,</span> <span class="token string">"blue"</span><span class="token punctuation">,</span> <span class="token string">"green"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">sayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 2. 子类定义</span>
<span class="token keyword">class</span> <span class="token class-name">SubType</span> <span class="token keyword">extends</span> <span class="token class-name">SuperType</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 2.1 继承了 SuperType 构造函数中定义的属性</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 2.2 子类自己的属性</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">sayAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 3. 实例化</span>
<span class="token keyword">var</span> instance1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubType</span><span class="token punctuation">(</span><span class="token string">"name1"</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
instance1<span class="token punctuation">.</span>colors<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">"black"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
instance1<span class="token punctuation">.</span><span class="token function">sayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// name1</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>instance1<span class="token punctuation">.</span>colors<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//"red,blue,green,black"</span>

<span class="token keyword">var</span> instance2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubType</span><span class="token punctuation">(</span><span class="token string">"name2"</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
instance2<span class="token punctuation">.</span><span class="token function">sayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// name2</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>instance2<span class="token punctuation">.</span>colors<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//"red,blue,green"</span></code></pre></div>
<p>TypeScript 加强了 class 的实现，这也是我比较看好 TypeScript 的原因，可以渐进的从弱类型（指定 any）一直到强类型（指定类型）过渡。下面是 TypeScript 实现相同功能的代码，从代码中可以看出，其实代码没变化多少：</p>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token comment">// 1. 父类定义</span>
<span class="token keyword">class</span> <span class="token class-name">SuperType</span> <span class="token punctuation">{</span>
  <span class="token keyword">constructor</span><span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"red"</span><span class="token punctuation">,</span> <span class="token string">"blue"</span><span class="token punctuation">,</span> <span class="token string">"green"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">sayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 2. 子类定义</span>
<span class="token keyword">class</span> <span class="token class-name">SubType</span> <span class="token keyword">extends</span> <span class="token class-name">SuperType</span> <span class="token punctuation">{</span>
  <span class="token keyword">constructor</span><span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 2.1 继承了 SuperType 构造函数中定义的属性</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 2.2 子类自己的属性</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">sayAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 3. 实例化</span>
<span class="token keyword">var</span> instance1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubType</span><span class="token punctuation">(</span><span class="token string">"name1"</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
instance1<span class="token punctuation">.</span>colors<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">"black"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
instance1<span class="token punctuation">.</span><span class="token function">sayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// name1</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>instance1<span class="token punctuation">.</span>colors<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//"red,blue,green,black"</span>

<span class="token keyword">var</span> instance2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubType</span><span class="token punctuation">(</span><span class="token string">"name2"</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
instance2<span class="token punctuation">.</span><span class="token function">sayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// name2</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>instance2<span class="token punctuation">.</span>colors<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//"red,blue,green"</span></code></pre></div>
<p>通过以上的发展对比可以看出，前端的 JavaScript 基础设施正在被加强，且都有背后大厂的支持，未来能够继续保持比较快的发展趋势。这也是我为什么喜欢前端的原因。</p>
<h2 id="es6-中使用-class-的注意点有哪些？" style="position:relative;"><a href="#es6-%E4%B8%AD%E4%BD%BF%E7%94%A8-class-%E7%9A%84%E6%B3%A8%E6%84%8F%E7%82%B9%E6%9C%89%E5%93%AA%E4%BA%9B%EF%BC%9F" aria-label="es6 中使用 class 的注意点有哪些？ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ES6 中使用 class 的注意点有哪些？</h2>
<ul>
<li>class 先定义再使用，<strong>不存在变量提升</strong></li>
<li><strong>不存在私有属性和方法</strong></li>
<li>可以定义<strong>静态属性和方法</strong>，静态方法中的 this 指向 class 本身</li>
</ul>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">class</span> <span class="token class-name">Foo</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">baz</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// this === Foo</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">static</span> <span class="token function">baz</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">baz</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

Foo<span class="token punctuation">.</span><span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// hello</span></code></pre></div>
<ul>
<li>实例属性可以不在<code class="language-text">constructor</code>中定义，直接写在外面</li>
</ul>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">class</span> <span class="token class-name">ReactCounter</span> <span class="token keyword">extends</span> <span class="token class-name">React</span><span class="token punctuation">.</span>Component <span class="token punctuation">{</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span>
    count<span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<ul>
<li><code class="language-text">new.target</code>的使用技巧：<strong>感知当前类的继承情况</strong></li>
</ul>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">class</span> <span class="token class-name">Shape</span> <span class="token punctuation">{</span>
  <span class="token keyword">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">new</span><span class="token punctuation">.</span>target <span class="token operator">===</span> Shape<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">"本类不能实例化"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Rectangle</span> <span class="token keyword">extends</span> <span class="token class-name">Shape</span> <span class="token punctuation">{</span>
  <span class="token keyword">constructor</span><span class="token punctuation">(</span>length<span class="token punctuation">,</span> width<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Shape</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 报错</span>
<span class="token keyword">var</span> y <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Rectangle</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 正确</span></code></pre></div>
<ul>
<li>理解继承类中的<code class="language-text">super</code>函数（这部分有三种情况）</li>
</ul>
<div class="gatsby-highlight" data-language="typescript"><pre class="language-typescript"><code class="language-typescript"><span class="token keyword">class</span> <span class="token class-name">Parent</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token function">myMethod</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"static"</span><span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">myMethod</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"instance"</span><span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Child</span> <span class="token keyword">extends</span> <span class="token class-name">Parent</span> <span class="token punctuation">{</span>
  <span class="token keyword">constructor</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1. super()===Parent.prototype.constructor.call(this)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">static</span> <span class="token function">myMethod</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">myMethod</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 2. super===Parent</span>
  <span class="token punctuation">}</span>

  <span class="token function">myMethod</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">myMethod</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 3. super===Parent.prototype, 父类原型上的方法</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

Child<span class="token punctuation">.</span><span class="token function">myMethod</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// static 1</span>

<span class="token keyword">var</span> child <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Child</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
child<span class="token punctuation">.</span><span class="token function">myMethod</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// instance 2</span></code></pre></div>
<h2 id="typescript-中使用-class-的注意点有哪些？" style="position:relative;"><a href="#typescript-%E4%B8%AD%E4%BD%BF%E7%94%A8-class-%E7%9A%84%E6%B3%A8%E6%84%8F%E7%82%B9%E6%9C%89%E5%93%AA%E4%BA%9B%EF%BC%9F" aria-label="typescript 中使用 class 的注意点有哪些？ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>TypeScript 中使用 class 的注意点有哪些？</h2>
<p>相关的注意点完全继承上面的关于 ES6 的内容，需要额外指明的如下：</p>
<ul>
<li>支持 public、private、protected</li>
<li>支持 readonly 属性</li>
<li><a href="https://www.tslang.cn/docs/handbook/classes.html" target="_target" rel="nofollow">其余参考文档</a></li>
</ul>]]></description><link>https://xiangst0816.github.io/blog/guan-yu-class/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/guan-yu-class/</guid><category><![CDATA[设计模式]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Sat, 30 Jun 2018 02:51:25 GMT</pubDate></item><item><title><![CDATA[刻意练习]]></title><description><![CDATA[<p>书中的训练方法自己还在上学期间就在大脑中有些印象，比如归纳总结找出共同点或者规律，便于以后相同问题能快速解决等。但是，我把“刻意练习”的方法使用的比较局限。我觉得在生活的方方面面都能刻意的使用“刻意练习”的方法来做，而不只是爱好或者工作。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 268px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDAFA3PEY8MlBGQUZaVVBfeMiCeG5uePWvuZHI////////////////////////////////////////////////////2wBDAVVaWnhpeOuCguv/////////////////////////////////////////////////////////////////////////wgARCAAUABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAECA//EABUBAQEAAAAAAAAAAAAAAAAAAAAB/9oADAMBAAIQAxAAAAHrLI0KQiiv/8QAFBABAAAAAAAAAAAAAAAAAAAAMP/aAAgBAQABBQIf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAwEBPwEf/8QAFBEBAAAAAAAAAAAAAAAAAAAAIP/aAAgBAgEBPwEf/8QAFBABAAAAAAAAAAAAAAAAAAAAMP/aAAgBAQAGPwIf/8QAFxAAAwEAAAAAAAAAAAAAAAAAABARAf/aAAgBAQABPyHSrXCL/9oADAMBAAIAAwAAABBfx7z/xAAUEQEAAAAAAAAAAAAAAAAAAAAg/9oACAEDAQE/EB//xAAVEQEBAAAAAAAAAAAAAAAAAAABIP/aAAgBAgEBPxBj/8QAGRABAAMBAQAAAAAAAAAAAAAAAQAQETFR/9oACAEBAAE/EGiYzXtdkWkLsxX/2Q=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="book 1"
        title="book 1"
        src="/blog/static/693e57c6042823ecb5a6c8d59486ba74/b4eaa/book-1.jpg"
        srcset="/blog/static/693e57c6042823ecb5a6c8d59486ba74/58c35/book-1.jpg 210w,
/blog/static/693e57c6042823ecb5a6c8d59486ba74/b4eaa/book-1.jpg 268w"
        sizes="(max-width: 268px) 100vw, 268px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<p>下面是我的读书总结，希望能对你有用：</p>
<p><img src="/blog/post-asset//5afec5ddc66c5dd9d229e6fa846178f7/%E5%88%BB%E6%84%8F%E7%BB%83%E4%B9%A0.svg"></p>]]></description><link>https://xiangst0816.github.io/blog/ke-yi-lian-xi/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/ke-yi-lian-xi/</guid><category><![CDATA[读书]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Wed, 23 May 2018 15:42:12 GMT</pubDate></item><item><title><![CDATA[如何高效阅读]]></title><description><![CDATA[<p>在读这本书的同时也是在进行高效阅读的实践，因为我性子比较急，做事强调结果，有很强的目的性。这样的性格特点和书中的一些观点结论不谋而合，下面进行总结回顾。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 350px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDAFA3PEY8MlBGQUZaVVBfeMiCeG5uePWvuZHI////////////////////////////////////////////////////2wBDAVVaWnhpeOuCguv/////////////////////////////////////////////////////////////////////////wgARCAAUABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAECA//EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAessNAgKD//EABQQAQAAAAAAAAAAAAAAAAAAADD/2gAIAQEAAQUCH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8BH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8BH//EABQQAQAAAAAAAAAAAAAAAAAAADD/2gAIAQEABj8CH//EABYQAQEBAAAAAAAAAAAAAAAAAAEQMf/aAAgBAQABPyF2u1v/2gAMAwEAAgADAAAAEFAAAP/EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8QH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8QH//EABsQAAMAAgMAAAAAAAAAAAAAAAABMRARIVFh/9oACAEBAAE/EPQbfcFMDfEooJtmhQ//2Q=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="how to read"
        title="how to read"
        src="/blog/static/b2c21da30a3b721bdd80e36a759f1d05/4d514/how-to-read.jpg"
        srcset="/blog/static/b2c21da30a3b721bdd80e36a759f1d05/58c35/how-to-read.jpg 210w,
/blog/static/b2c21da30a3b721bdd80e36a759f1d05/4d514/how-to-read.jpg 350w"
        sizes="(max-width: 350px) 100vw, 350px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<h3 id="读书目的" style="position:relative;"><a href="#%E8%AF%BB%E4%B9%A6%E7%9B%AE%E7%9A%84" aria-label="读书目的 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>读书目的</h3>
<p>带着目的或者问题看书，重点部分只占 20%，跳过不需要的。此外，关键点做好标记，便于为之后的结构化做准备。</p>
<h3 id="结构化" style="position:relative;"><a href="#%E7%BB%93%E6%9E%84%E5%8C%96" aria-label="结构化 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>结构化</h3>
<p>书是思想的结晶，一般好书都是有系统的思维脉络，这可以通过画图（思维导图或其他）结构化知识体系。这样的方式也便于之后的回忆。</p>
<h3 id="必须给时间回忆" style="position:relative;"><a href="#%E5%BF%85%E9%A1%BB%E7%BB%99%E6%97%B6%E9%97%B4%E5%9B%9E%E5%BF%86" aria-label="必须给时间回忆 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>必须给时间回忆</h3>
<p>回忆是让大脑在潜意识中对信息进行处理，条理化逻辑化，并加深对书中观点的记忆。这样的记忆积累有助于后面的阅读预测，便于下次遇到同类型知识点能快速跳过。</p>
<blockquote>
<p>记忆是学习的基础！</p>
</blockquote>
<h3 id="预测" style="position:relative;"><a href="#%E9%A2%84%E6%B5%8B" aria-label="预测 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>预测</h3>
<p>如果预测到了将要展开的部分就直接跳过，节省时间。</p>
<h3 id="手指引读" style="position:relative;"><a href="#%E6%89%8B%E6%8C%87%E5%BC%95%E8%AF%BB" aria-label="手指引读 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>手指引读</h3>
<p>如果注意力存在问题，可以使用此招集中注意力。</p>
<h3 id="学会管理精力" style="position:relative;"><a href="#%E5%AD%A6%E4%BC%9A%E7%AE%A1%E7%90%86%E7%B2%BE%E5%8A%9B" aria-label="学会管理精力 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>学会管理精力</h3>
<p>把精力用在刀刃上能事半功倍，在精力充沛的时间读书，如果状态不行就试着跑跑步后再看书。</p>]]></description><link>https://xiangst0816.github.io/blog/how-to-read/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/how-to-read/</guid><category><![CDATA[读书]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Wed, 02 May 2018 13:30:53 GMT</pubDate></item><item><title><![CDATA[CSS新世界]]></title><description><![CDATA[<p>本书是著名博主张鑫旭的呕心沥血之作，涵盖了 CSS2.1 版本需要注意和知道的常用知识，我这里在看书总结时对以往不太清楚的地方做个深入整理，理清自己的知识体系树。</p>
<p><strong>知识应该成体系</strong>才能方便我们日后工作中对内部信息进行快速检索，所以我在看这本书的同时会画一些结构树（思维导图），以便让我能更深入的理解 CSS 中的一些<strong>“怪异、特殊”</strong>的行为。</p>
<p><strong>需要重点说明的是</strong>：本书是对 CSS2.1 的介绍与总结，最新的 CSS3 的内容需要从别的地方获取资料学习。</p>
<h2 id="前言" style="position:relative;"><a href="#%E5%89%8D%E8%A8%80" aria-label="前言 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>前言</h2>
<h3 id="了解流" style="position:relative;"><a href="#%E4%BA%86%E8%A7%A3%E6%B5%81" aria-label="了解流 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>了解“流”</h3>
<p>HTML+CSS 最初是用于图文信息排版，因此浏览器默认是以“流”的方式进行<strong>默认排版（预设）</strong>，即内容从上向下，从左往右。此外，文本、段落、图片等内容又因为是否自动换行而分为<strong>类联元素</strong>和<strong>块级元素</strong>。对于现代的应用的界面绘制，需要清楚有这个<strong>默认基础</strong>！</p>
<h3 id="css-生效规则" style="position:relative;"><a href="#css-%E7%94%9F%E6%95%88%E8%A7%84%E5%88%99" aria-label="css 生效规则 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>CSS 生效规则</h3>
<ul>
<li>不同元素的样式预设不一样</li>
<li>通过堆叠 CSS 属性修改元素样式</li>
<li>不同 CSS 属性之间会互相影响</li>
<li>CSS 属性是有层叠关系及从属关系</li>
</ul>
<h2 id="块级元素" style="position:relative;"><a href="#%E5%9D%97%E7%BA%A7%E5%85%83%E7%B4%A0" aria-label="块级元素 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>块级元素</h2>
<p>块级元素（block/inline-block）一般用于<strong>段落</strong>或者<strong>结构展示</strong>，或者能使<code class="language-text">height</code>和<code class="language-text">width</code>生效的元素。因此可以成为“容器盒子”。也就是说，内联元素（inline）和<code class="language-text">height</code>和<code class="language-text">width</code>没半毛钱关系！</p>
<h3 id="1-code-classlanguage-textwidthautocode" style="position:relative;"><a href="#1-code-classlanguage-textwidthautocode" aria-label="1 code classlanguage textwidthautocode permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. <code class="language-text">width:auto</code></h3>
<p>属性的作用效果与元素的 display 属性密切相关，可以是宽度自适应、包裹特性、收缩到最小等。</p>
<h3 id="2-code-classlanguage-textbox-sizingcode" style="position:relative;"><a href="#2-code-classlanguage-textbox-sizingcode" aria-label="2 code classlanguage textbox sizingcode permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. <code class="language-text">box-sizing</code></h3>
<p>老生常谈的属性，需要知道：</p>
<ul>
<li><code class="language-text">border-box</code>、<code class="language-text">padding-box</code>规定了<code class="language-text">width</code>和<code class="language-text">height</code>的作用边界（规则）</li>
<li><code class="language-text">position:absolute</code>元素 100%尺寸永远以<code class="language-text">padding-box</code>为边界</li>
<li><code class="language-text">margin</code>的背景永远透明</li>
</ul>
<h3 id="3-code-classlanguage-textheight100code" style="position:relative;"><a href="#3-code-classlanguage-textheight100code" aria-label="3 code classlanguage textheight100code permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. <code class="language-text">height:100%</code></h3>
<p>父元素<strong>必须有可生效的值</strong>，子元素的高度百分比才生效，否则为转为<code class="language-text">auto</code></p>
<h3 id="4-code-classlanguage-textmin-widthmax-widthcode" style="position:relative;"><a href="#4-code-classlanguage-textmin-widthmax-widthcode" aria-label="4 code classlanguage textmin widthmax widthcode permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. <code class="language-text">min-width/max-width</code></h3>
<ul>
<li>为自适应布局、流体布局而生</li>
<li><code class="language-text">min-width/min-height</code>的初始值为<code class="language-text">auto</code></li>
<li><code class="language-text">max-width/max-height</code>的初始值为<code class="language-text">none</code></li>
<li>如果元素的<code class="language-text">max-height</code>比<code class="language-text">height</code>计算值大，则元素的高度自动转为<code class="language-text">height</code>值</li>
</ul>
<h3 id="5-code-classlanguage-textmargincode" style="position:relative;"><a href="#5-code-classlanguage-textmargincode" aria-label="5 code classlanguage textmargincode permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>5 <code class="language-text">margin</code></h3>
<p>块级元素的 margin 内容较多：</p>
<ul>
<li><code class="language-text">margin box</code>表示元素占据的空间尺寸，设置<strong>负值</strong>可拓展元素尺寸，<strong>前提是 <code class="language-text">display:block; width:auto</code>!</strong></li>
<li>滚动容器的底部留白用<code class="language-text">margin-bottom</code>实现</li>
<li>垂直方向<code class="language-text">margin</code>合并不是 bug，可通过块状格式化上下文（Block Formatting Context-BFC）设置隔离区</li>
<li><code class="language-text">margin:auto</code>用于占据剩余空间，实现左中右对其效果</li>
</ul>
<h2 id="内联元素" style="position:relative;"><a href="#%E5%86%85%E8%81%94%E5%85%83%E7%B4%A0" aria-label="内联元素 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>内联元素</h2>
<h3 id="1-内联元素的种类区分？" style="position:relative;"><a href="#1-%E5%86%85%E8%81%94%E5%85%83%E7%B4%A0%E7%9A%84%E7%A7%8D%E7%B1%BB%E5%8C%BA%E5%88%86%EF%BC%9F" aria-label="1 内联元素的种类区分？ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 内联元素的种类区分？</h3>
<div class="gatsby-highlight" data-language="css"><pre class="language-css"><code class="language-css"><span class="token property">display</span><span class="token punctuation">:</span> inline<span class="token punctuation">;</span>
<span class="token property">display</span><span class="token punctuation">:</span> inline-block<span class="token punctuation">;</span>
<span class="token property">display</span><span class="token punctuation">:</span> inline-table<span class="token punctuation">;</span>
<span class="token property">display</span><span class="token punctuation">:</span> inline-x<span class="token punctuation">;</span></code></pre></div>
<p>内联所指的是外在盒子，能和文字一行显示（排除浮动元素）。</p>
<h3 id="2-内联盒模型？" style="position:relative;"><a href="#2-%E5%86%85%E8%81%94%E7%9B%92%E6%A8%A1%E5%9E%8B%EF%BC%9F" aria-label="2 内联盒模型？ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 内联盒模型？</h3>
<p>重点理解<strong>“行框盒子”</strong>的位置！如图：</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 565px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 86.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAIAAABSJhvpAAAACXBIWXMAAAsSAAALEgHS3X78AAABiElEQVQ4y61TDU+DMBDd//9pU+PXdE0YZWV0lPI9EPpBOQ90i8YtavSlaeDRd3fcvS5gxjiOcAHjZ3w8vDgrcM6dZHAZk3gYhizLgiAoy5JSulqtoiiqqmq9Xu/3eyTjOJZSpmkazcDDKHkXY3gzAylrrdYaHzA5Mm5mlFLmCHzF/a2iBfwBF8Uv1tKqDpums3aq7lfi3lpSFE95oa2BpoZDCX33UzHCOtdj240CcgfrW8iTM2Izuk4bbUyvNTbEDBazKa0w+aFtdSZUU/cTo5GfPrnBzLOcxAerouV2c7vKZUwJeb6/YxuvEII8PogtzXjItjThO1y7wA8IKaSsu+4k1vGD4D6rq0LsOdsG1N/kqeS7MEsl9b2QBXkuecQo3cSc52VxUOr4z1iCmZ14bCoONxHiarm8ub5GtyDTti2O91zDGgAOkAHE2OX3EE3TJEmCe13Xfd+fDPtFjKF3AAKA4XznEtzIGCOEeJ7n+/7vTIIZ0NVo4zAM0dLficfj+hd7frzAl/AKXq3c5vcBayMAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="inline x"
        title="inline x"
        src="/blog/static/7986794f82cfb421c0550b34df7582f1/1dc78/inline-x.png"
        srcset="/blog/static/7986794f82cfb421c0550b34df7582f1/e1650/inline-x.png 210w,
/blog/static/7986794f82cfb421c0550b34df7582f1/8cae7/inline-x.png 420w,
/blog/static/7986794f82cfb421c0550b34df7582f1/1dc78/inline-x.png 565w"
        sizes="(max-width: 565px) 100vw, 565px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<blockquote>
<p>注意：<code class="language-text">p</code>标签中每一行都是一个行框盒子！！！</p>
</blockquote>
<h3 id="3-幽灵节点概念？" style="position:relative;"><a href="#3-%E5%B9%BD%E7%81%B5%E8%8A%82%E7%82%B9%E6%A6%82%E5%BF%B5%EF%BC%9F" aria-label="3 幽灵节点概念？ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. 幽灵节点概念？</h3>
<p>需要知道的限定条件：</p>
<ul>
<li>只是<strong>HTML5 文档申明</strong>中</li>
<li>在<mark><strong>每个行框盒子前面</strong></mark>有一个“幽灵空白节点”，不占据任何宽度但又确实存在，具有当前继承属性的<strong>字体和行高</strong></li>
</ul>
<p>幽灵节点用于解释一些内联盒模型存在的“怪异行为”，需要重点理解。</p>
<h3 id="4-替换元素和非替换元素的区别？" style="position:relative;"><a href="#4-%E6%9B%BF%E6%8D%A2%E5%85%83%E7%B4%A0%E5%92%8C%E9%9D%9E%E6%9B%BF%E6%8D%A2%E5%85%83%E7%B4%A0%E7%9A%84%E5%8C%BA%E5%88%AB%EF%BC%9F" aria-label="4 替换元素和非替换元素的区别？ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. 替换元素和非替换元素的区别？</h3>
<p><strong>替换元素</strong>：通过修改某个属性值就可以替换呈现的内容的元素，比如<code class="language-text">&lt;img src=&quot;xx&quot;&gt;</code>。</p>
<p><strong>非替换元素</strong>: 就是传统的内联元素，比如<code class="language-text">&lt;span&gt;</code></p>
<ul>
<li>默认情况下，替换元素和非替换元素都是<strong>内联元素</strong></li>
<li>替换元素有自己的固有尺寸</li>
<li>替换元素和非替换元素之间只隔了一个<code class="language-text">src/CSS content</code>属性</li>
</ul>
<h3 id="5-code-classlanguage-textpaddingcode" style="position:relative;"><a href="#5-code-classlanguage-textpaddingcode" aria-label="5 code classlanguage textpaddingcode permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>5. <code class="language-text">padding</code></h3>
<p>内联元素的 padding 在<strong>垂直方向</strong>会影响布局，会影响视觉表现，但是并没有可视宽高的概念（width/height 不生效），不占据垂直尺寸。</p>
<h3 id="6-code-classlanguage-textbordercode" style="position:relative;"><a href="#6-code-classlanguage-textbordercode" aria-label="6 code classlanguage textbordercode permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>6. <code class="language-text">border</code></h3>
<p>内联元素设置 border 是会生效的，但是如同 5 的解释，水平方向占据尺寸；<strong>垂直方向影响视觉表现，不占据尺寸</strong>。</p>
<h3 id="7-code-classlanguage-textmargincode" style="position:relative;"><a href="#7-code-classlanguage-textmargincode" aria-label="7 code classlanguage textmargincode permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>7. <code class="language-text">margin</code></h3>
<p>具有<code class="language-text">display:inline</code>属性的非替换元素（<code class="language-text">&lt;span&gt;</code>）的垂直<code class="language-text">margin</code>是无效的。<strong>需要理解下内联元素文本展示的属性。</strong></p>
<h3 id="8-code-classlanguage-textline-heightcode和code-classlanguage-textvertical-aligncode" style="position:relative;"><a href="#8-code-classlanguage-textline-heightcode%E5%92%8Ccode-classlanguage-textvertical-aligncode" aria-label="8 code classlanguage textline heightcode和code classlanguage textvertical aligncode permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>8. <code class="language-text">line-height</code>和<code class="language-text">vertical-align</code></h3>
<ul>
<li><mark>内联元素高度全权由 line-height 属性决定!!!</mark></li>
<li>分析内联元素的结构要时刻考虑：<strong>继承特性</strong>、<strong>幽灵节点</strong>、<strong>默认 baseline 对齐</strong>、<strong>替换元素的 baseline 为下边缘</strong></li>
<li><code class="language-text">vertical-align</code>不是真正的垂直居中，考虑下字符<code class="language-text">x</code></li>
<li><code class="language-text">line-height</code>不同单位继承特性不同，数值属性直接向下传递，其他属性计算后传递</li>
<li><code class="language-text">vertical-align</code>的生效前提是：<strong>内联元素及 display 值为 table-cell 的元素</strong>。这个过程需要注意 float 和 absolute 会强制改变<strong>display->block</strong>。</li>
</ul>
<h2 id="浮动元素" style="position:relative;"><a href="#%E6%B5%AE%E5%8A%A8%E5%85%83%E7%B4%A0" aria-label="浮动元素 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>浮动元素</h2>
<h3 id="1-浮动的本质是？" style="position:relative;"><a href="#1-%E6%B5%AE%E5%8A%A8%E7%9A%84%E6%9C%AC%E8%B4%A8%E6%98%AF%EF%BC%9F" aria-label="1 浮动的本质是？ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 浮动的本质是？</h3>
<p>浮动的本质是为了<strong>实现文字环绕效果</strong>。因此在布局时会使自己的高度塌陷，让后面的<strong>行框盒子</strong>向上排布。这里需要注意的是：</p>
<ul>
<li>行框盒子和浮动元素<strong>不可重叠</strong>（正是浮动效果产生的原因）</li>
<li>行框盒子外边的<strong>块状容器盒子</strong>是在包含浮动元素的</li>
<li>浮动元素的几何尺寸会影响外部行框元素的布局（浮动跟随的 bug）</li>
<li>浮动元素在当前<strong>行框盒子</strong>内定位，每行都是一个行框盒子</li>
<li>即使没有行框盒子也存在一个类似于幽灵节点的<strong>浮动锚点</strong>，其表现如同空的内联元素</li>
<li><strong>注意：图中每行都是一个行框盒子</strong></li>
</ul>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 564px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 86.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAIAAABSJhvpAAAACXBIWXMAAAsSAAALEgHS3X78AAAClUlEQVQ4y32S21PaQBTG/f9f+1YfWsXaigMKKqJ4a2fUAokoSNDcNrtJNgmBkEBIyJUuiIK20zO/OXtmst+e7J5vbbqMdEa6gMRw6DiOPXZdkm17YA8GZF1sm8fa9F8RRdH9Q6vVfpYVXdN7EKlI1iSoiiIiX5OF9lUcx14UwTBEWOzIz08MXc/nMwKqjyaSNeJsVyBYI37oAcPqOD4Mk/BFPDsnDI0kOUmS0/ZtiT45pk6POSbH818R3EZoG8JvJPPchqZlRWEzjK8m0XgpjiIzTS/T9IqpntOVSwKWyryQQSiL4A6EOwjtsOxWV88BYSNKfk7i8WrnbhCUo/gUMgWB3icgaY8DGR5sIzVLgGpWQt8l4/CWPZRdyov8pdj3DQDy3W5ZVYsERSkguTiwz1VcSpLf6bQ6ndai8Nd1s3itYAqCcRQtH2w+moSQvJJOE03HgsDzAgeACCFoNO4oilIw9oPwf6NanBjGvusFrh95AWFWB8HIcZI4/ihO5/8vD80nS1bH/Y4lt3qS6lmPFmz0xLaFBEfz42D6ZpG/Oytunxnge0WiNVg1AGubrT6+0cSGKT/29VEYrm5ee7kwyVbXYBs0aDb7MlujyLPVhk7HdtqOzYycjuMw1qBtu49u0H/18opYk8Ra+YA6KXONcq32CYAMx33B+AcpANiEcItlN8bj/CSR5vZ8L9Yhoitn9ZML4eGKvvsso12Edk2zgNUcxjkN5xHc9f2jSYI+iJNZZ8RUz9aN55Ipl+6a69jcM6yCNTw07WKP4Bxo5r7jF7wQpKvilyqOeyx7pGkXI7fO8RURnIniOUSXvFAhCGJFxTeu1yBGfnfnt/D9AEIVIRUAJIqSrncVGQMARRESmwRB+GE0fwDvaqBGWUTpEwAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="float"
        title="float"
        src="/blog/static/cc0caed79c59f71a2e8a24b390734ec9/c0efa/float.png"
        srcset="/blog/static/cc0caed79c59f71a2e8a24b390734ec9/e1650/float.png 210w,
/blog/static/cc0caed79c59f71a2e8a24b390734ec9/8cae7/float.png 420w,
/blog/static/cc0caed79c59f71a2e8a24b390734ec9/c0efa/float.png 564w"
        sizes="(max-width: 564px) 100vw, 564px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<h3 id="2-是否建议使用浮动布局？" style="position:relative;"><a href="#2-%E6%98%AF%E5%90%A6%E5%BB%BA%E8%AE%AE%E4%BD%BF%E7%94%A8%E6%B5%AE%E5%8A%A8%E5%B8%83%E5%B1%80%EF%BC%9F" aria-label="2 是否建议使用浮动布局？ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 是否建议使用浮动布局？</h3>
<p>不建议现在（2018/04/22）用于浮动布局，因为：</p>
<ol>
<li>布局容错性差</li>
<li>性能比 flex 差</li>
<li>hack 模式较多</li>
</ol>
<h3 id="3-code-classlanguage-textclearbothcode" style="position:relative;"><a href="#3-code-classlanguage-textclearbothcode" aria-label="3 code classlanguage textclearbothcode permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. <code class="language-text">clear:both</code></h3>
<p><strong><code class="language-text">clear</code>属性的含义：</strong></p>
<p>元素盒子的边不能和前面的浮动元素相邻，本质是让自己不和 float 元素在一行显示</p>
<p><strong>正确的观点：</strong></p>
<ul>
<li><strong>浮动一直存在并没有清除</strong></li>
<li><code class="language-text">clear</code>属性只有<strong>块级元素</strong>才生效，因此如果使用伪类消除浮动影响需要设置 display:table/block 等值</li>
</ul>
<div class="gatsby-highlight" data-language="css"><pre class="language-css"><code class="language-css"><span class="token selector">.clear:after</span> <span class="token punctuation">{</span>
  <span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">;</span>
  <span class="token property">display</span><span class="token punctuation">:</span> table<span class="token punctuation">;</span>
  <span class="token property">clear</span><span class="token punctuation">:</span> both<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<h2 id="bfc块级格式化上下文" style="position:relative;"><a href="#bfc%E5%9D%97%E7%BA%A7%E6%A0%BC%E5%BC%8F%E5%8C%96%E4%B8%8A%E4%B8%8B%E6%96%87" aria-label="bfc块级格式化上下文 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>BFC——块级格式化上下文</h2>
<p><strong>BFC(Block Formatting Context) 块级格式化上下文，通过特定属性创造一个封闭空间，内外不会产生影响。</strong>可用于：</p>
<ul>
<li>清除浮动</li>
<li>消除 margin 层叠问题</li>
</ul>
<p><strong>开启办法：</strong></p>
<ul>
<li><code class="language-text">html</code>根元素</li>
<li><code class="language-text">float</code>不为<code class="language-text">none</code></li>
<li><mark><code class="language-text">overflow</code>为<code class="language-text">auto</code>、<code class="language-text">scroll</code>、<code class="language-text">hidden</code></mark></li>
<li><code class="language-text">display</code>为<code class="language-text">table-cell</code>、<code class="language-text">table-caption</code>、 <mark><code class="language-text">inline-block</code> </mark></li>
<li><mark><code class="language-text">position</code>不为<code class="language-text">relative</code>、<code class="language-text">static</code></mark>（就是要脱离文档流才能形成 BFC，absolute/fixed）</li>
<li>设置伪类，如下</li>
</ul>
<div class="gatsby-highlight" data-language="css"><pre class="language-css"><code class="language-css"><span class="token selector">.parent:before</span> <span class="token punctuation">{</span>
  <span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">" "</span><span class="token punctuation">;</span>
  <span class="token property">display</span><span class="token punctuation">:</span> table<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<h2 id="overflow" style="position:relative;"><a href="#overflow" aria-label="overflow permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Overflow</h2>
<ul>
<li>裁剪边界：border-box 的内边缘（padding-box 外边缘，和 absolute 的最大尺寸相同）</li>
<li>在 PC 端，滚动条都来自 html 元素，而不是 body 元素</li>
<li>window 系统的滚动条宽度均为 17px</li>
<li>即使使用 hidden 属性，内容元素也是可以通过 js 滚动的，<strong>差别在于是否存在滚动条</strong></li>
</ul>
<h2 id="锚点定位" style="position:relative;"><a href="#%E9%94%9A%E7%82%B9%E5%AE%9A%E4%BD%8D" aria-label="锚点定位 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>锚点定位</h2>
<blockquote>
<p>基础部分不清楚，汗颜，其本质就是通过<code class="language-text">scrollTop</code>、<code class="language-text">scrollLeft</code>进行滚动。</p>
</blockquote>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html"><span class="token comment">&lt;!-- 点击链接 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#target<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Jump<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>

<span class="token comment">&lt;!-- 滚动到指定位置 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>target<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> target name <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>target id<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">></span></span> <span class="token comment">&lt;!-- 推荐 --></span></code></pre></div>
<p>触发锚点定位的两种情况：</p>
<ul>
<li>URL 中的 hash 锚点有对应的页面元素 -> 会触发<strong>由内而外</strong>的容器滚动行为</li>
<li>可 focus 的锚点元素处于 focus 状态 -> 只要 focus 元素在浏览器的窗体中，就不会触发流体滚动</li>
</ul>
<p>以上，根据情况活用。</p>
<h2 id="position-absolute" style="position:relative;"><a href="#position-absolute" aria-label="position absolute permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>position: absolute</h2>
<ul>
<li>position: absolute/fixed -> display: block/table，这个是自动设置的（根据情况对应）</li>
<li>absolute 具有尺寸包裹性，设置方位后具有自适应特性（常用的 top:0; left:0; right:0; bottom:0）</li>
<li>absolute 相对于不为<code class="language-text">static</code>的<strong>祖先元素</strong>计算指定定位</li>
<li>尺寸边界 -> padding-box（包含块）</li>
<li>当未设置定位属性时（和 fixed 类似），1）相对于原有位置定位；2）只是脱离文档流（而已）</li>
</ul>
<h2 id="write-mode-改变文档流方向" style="position:relative;"><a href="#write-mode-%E6%94%B9%E5%8F%98%E6%96%87%E6%A1%A3%E6%B5%81%E6%96%B9%E5%90%91" aria-label="write mode 改变文档流方向 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>write-mode 改变文档流方向</h2>
<p>由之前的水平规则完全变为垂直规则，这能衍生出很多 hack 技巧，这是一个打开思路的属性！！！</p>
<h2 id="思维导图" style="position:relative;"><a href="#%E6%80%9D%E7%BB%B4%E5%AF%BC%E5%9B%BE" aria-label="思维导图 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>思维导图</h2>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 749px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 132.85714285714286%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAbCAYAAAB836/YAAAACXBIWXMAAAsSAAALEgHS3X78AAAC6UlEQVRIx41V2XKjMBD0/3/d1uZhN4njk/sQEGyDsVOz3YNEAJNkH1QgIbW6Z3qGVd5cxbSd6BPDzbNLq4Pz/r1/pnY9PTfDHreP51YDWAswvHNeXDvZp4Uc8lKCspZtYiSuL/p8izKsV/LsJ+JXJ9lnpeywl6AK+MmwU4ZGbwabCdurAipbjLpppTSlGFyYzxmODxV8r8+6qbjedCSnRqL3swRgs4ly+bU+yDZM5Xm9l5edJy9eLGvMeX4G2KpkgnAtBEAEcEp27Dg/Qu4mzmUHqTEuy2yMFxj2ixwEZfyOptLgk+WfQ6gx3GG8BgliV+g3xtvY2PPskBRH2c1LgJbdTZmSoQ+mfvEuIeQXt7sU3X3Ym4/i/QA4tpEC42CF0TOFCkhtcMmJsW67idW+BHSe5JwMOQKN6UU8SN5AvpeaId4ObAAcWySf2SWwUslQ1xHXuqql4vwrhuMsjT9m1j6UrQwRvyOMvYVVQgAbyzBvR4BcSM+PgGTFRMwvyZHx6sLBsHQ9WDOSXN0+pELWcifXhqCvXWejTi0UlCfxUXJpEEsUZpKdH1WtgiSXvR9LxYNYKNvrxAo0MuvV+TOCdA+16+MCx24CmODDAaVT8SNi5uMCM0sSn1oxkJsgyybJpCjqISlmDFhCbtbYTA/J+AR0bYrVEp8uKv0Nclk1rsPMsnzVzenoY5+ovuto3UIigZ62npYdM05AD4ljfB9swywTYHybmhkyWbsEpGWeYZffm6MSYDzn7CY+5Ca+l7ZGeTOzzzomGC9kctiq5pcvlh4Dzn7IJBX2AsplhyZT1rOr6yVmD4AJZDNbMQ6nKPwM89C2eFrHdZ18wQGLgEyKYxih15WXvnlubf/7e4z0P7PUECaA40bgzMs+aGz3fr9/KDPK/glssWO77HEwu2S4hu+eNt63UhcZUnKAPpfAX2bwYqvW4Q/Kee6/AIcnDc54kiGAmBAa2NnqR8lTP9kWZT+q4Rd65Xeg/wBndxZjAklFdgAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="margin"
        title="margin"
        src="/blog/static/63f607bede7434349a63f43d05ef5156/d2e7b/margin.png"
        srcset="/blog/static/63f607bede7434349a63f43d05ef5156/e1650/margin.png 210w,
/blog/static/63f607bede7434349a63f43d05ef5156/8cae7/margin.png 420w,
/blog/static/63f607bede7434349a63f43d05ef5156/d2e7b/margin.png 749w"
        sizes="(max-width: 749px) 100vw, 749px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 840px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 49.047619047619044%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABjUlEQVQoz5VSS0sCURT2Zwa1DIrIpGghuChJNIo2bcpVhIpGbnLTw025LERIDR/4IId8YTrjODmv+3WuOqFhYAc+Pu695/Gdc48NCxpjbCE/27wgzhZ+30ej1/D7zxAMBRAOhxCJhEccCFyi2WxQQitwAjaPp+zo+BBr66twOnfhcjnh9Xngdu/Bbt9AtVoZJ4RpghE4zzPDMOjJHKEnShAlCeZQhq5rBH30bhUetWxp4KxSULvziWQ6jUpNIGc6t9vodDqQ+jJaH1W0Ww1oSh/m1Gh4Mc428gTzXwDBK5in59AybzAo8UCWoarqTMs8+VCmxFIPg4Hyx6c0mmC+E4CSsn0vjGQKOleqm6R2XF3TNKgExsyfqXS7XcRiN4jHH/CUeMTd/S0EoTbVMpdONKSZlFtdJFKvSJXeMRhqyOdzqAkC6vU6stkMRFFEju6WV5aw5djEgceN7R0HXl6eJ58yNUduX6Sup6joq/p4ThNZfE7WJ3DVxWIBBUK5XEapVIKiKLNrw+asyX8X+xvWzO6klCo9CAAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="size"
        title="size"
        src="/blog/static/243195ea2d185bb5899d674f053fd4b6/f88f5/size.png"
        srcset="/blog/static/243195ea2d185bb5899d674f053fd4b6/e1650/size.png 210w,
/blog/static/243195ea2d185bb5899d674f053fd4b6/8cae7/size.png 420w,
/blog/static/243195ea2d185bb5899d674f053fd4b6/f88f5/size.png 840w,
/blog/static/243195ea2d185bb5899d674f053fd4b6/57a2b/size.png 1260w,
/blog/static/243195ea2d185bb5899d674f053fd4b6/ef9fb/size.png 1650w"
        sizes="(max-width: 840px) 100vw, 840px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>]]></description><link>https://xiangst0816.github.io/blog/css-xin-shi-jie/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/css-xin-shi-jie/</guid><category><![CDATA[总结]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Sat, 14 Apr 2018 01:52:40 GMT</pubDate></item><item><title><![CDATA[如何处理滚动优化]]></title><description><![CDATA[<p>解决题述的问题需要清楚用户在滑动页面时，Chrome 在背后的工作过程，了解了工作过程解题就会水到渠成。</p>
<h2 id="基础：chrome-线程化渲染框架" style="position:relative;"><a href="#%E5%9F%BA%E7%A1%80%EF%BC%9Achrome-%E7%BA%BF%E7%A8%8B%E5%8C%96%E6%B8%B2%E6%9F%93%E6%A1%86%E6%9E%B6" aria-label="基础：chrome 线程化渲染框架 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>基础：Chrome 线程化渲染框架</h2>
<p>之前提到过这样的一个浏览器渲染线性流程，这里简单说下：</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 23.809523809523807%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsSAAALEgHS3X78AAABLUlEQVQY05WLO0vDYBhG8zs6+EMEER1ExD8gYt3Ezc3L4A07KA7aQdBJ2qYx9uKdClYLielFqm5Ca2JrExSXWouiLVWOX9BZ8IWH8/JwHun5C2qf4LLusgEvLbh7aqHnb0hdFbkuOjRF99GEhsjbr+/uaoKvglXRvwtHMtRNjJhCRg2S2A2Q1ee41GbJGj4Oj/bIqxskYhEWTw7wp0IsnUUJx3bJbQfETsZQQ8T3I1xo48inGpI51c6trx9rsoPUcg920kM12YZ17GFndYTKTDcJ3zBDwVHG1D68yiDr814q010UF3opTHQS9w9QT0qsqStIsmai6BZh3SRslNnKiKQtlHQZJWMTzdnivyconIBWEDSRz0vCt37i7sVOSZdQszYSf9zjg4Pj2PznvgHYB023mqSpDQAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="20161021092408423"
        title="20161021092408423"
        src="/blog/static/4685e854d72d62a815631ba167d61b78/978d5/20161021092408423.png"
        srcset="/blog/static/4685e854d72d62a815631ba167d61b78/e1650/20161021092408423.png 210w,
/blog/static/4685e854d72d62a815631ba167d61b78/8cae7/20161021092408423.png 420w,
/blog/static/4685e854d72d62a815631ba167d61b78/978d5/20161021092408423.png 600w"
        sizes="(max-width: 600px) 100vw, 600px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<p>在传统浏览器中，主线程的执行是<strong>单线程渲染模式</strong>，JS 执行及页面布局渲染在一个线程中串行执行（根据修改的 CSS 元素不同会跳过部分执行阶段）。为了保证 UI 流畅需要每一帧上述的处理时间小于 10ms。</p>
<p>为了优化上述过程，Chrome 浏览器内核对<strong>Composite 部分</strong>从主线程拆分出来到<strong>Compositor 线程</strong>，并行执行 UI 渲染工作，因此效率会高很多。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 600px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 47.142857142857146%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAACV0lEQVQoz0WR3UtTcRzGD0T/QpdddN9Vl110UQRR0cW6mSWoZCZG9GJ5IWiCGZQQSjeFUMbIplRqWpup2/EFbTqPm9ucW27TuU1dTo/OvXm2Tz816YHnB9/nB9+X55FUVWV3d5fNRJy1LQ2T5R2KSYfHUkxXdx2tnW14rDdQRmuYGSql+ZMBS18ZtsEqlJ/FGL40cuvDErfbfTzuXERSFAW73c5y0EcwDnNyJUwdA+cJZvvPYuzQi1oC+ykYl3hvKKNgPQ7KSaFJTPWc4ULLIpdaXRS1zSPlcjkymQz7yAn2DhuxmctxWKro6H5Ja5cBh7Uam+Upv4ae0Gw0YjXXMm1tYFbohu7XlLfPc6fdQU2nG4l/KBQK5PMaahoSKVDFjMgGyO4Ysi/AyIKgL4TsWkf2hkW9iLwQZNwfYsK1xrhjnSnPH6RAIIDL5WJpaQlV3f7XXdt/mA9kKH9bS/33K7wYqKD221Uq3jRx33idJtNNnptLePT5MroGM+cf2NE3TCNFo1H8fj/J5A55seWelj9amhlvCn1LLXX9Op79qKTmqw79q0bufiyi0VRGfV8J94zXOPewh9OlI1ysHvt/8hFSWY3llShJkfzG9h5j7gjDdoUe6yi2hd+MOKMMTjvplUeZ8HiZFidbZqIM2CLISgzp0Lv8wYlpEU54bZNgJE5cmLma2GZ9M0lCGKom90hmCqipHFtJwZ0caZFiZC3BTjpDVrRI7eUPG+5zH7FYDK93nshK+GBAKBTE43azuho7+A+Hl5mcnGRuzkkhrx1o2WwGTdOOkuUvGqZaxqhwic8AAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="20161021092419096"
        title="20161021092419096"
        src="/blog/static/e02e99bf9df278a30a574b44d67b1791/978d5/20161021092419096.png"
        srcset="/blog/static/e02e99bf9df278a30a574b44d67b1791/e1650/20161021092419096.png 210w,
/blog/static/e02e99bf9df278a30a574b44d67b1791/8cae7/20161021092419096.png 420w,
/blog/static/e02e99bf9df278a30a574b44d67b1791/978d5/20161021092419096.png 600w"
        sizes="(max-width: 600px) 100vw, 600px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<p>由图可看出，第 N 帧的内容一旦准备完毕就交给<strong>Compositor Thread</strong>进行渲染。</p>
<p><strong>到这里你需要知道：</strong></p>
<ul>
<li><mark><strong>JS 执行线程</strong>和<strong>Render 线程</strong>是在同一个<strong>内核线程</strong>中</mark></li>
<li><mark><strong>内核线程</strong>完成布局和绘制记录操作，<strong>Compositor Thread</strong>完成帧渲染</mark></li>
<li><mark>两个线程并行执行</mark></li>
</ul>
<h2 id="基础：passive-event-listeners" style="position:relative;"><a href="#%E5%9F%BA%E7%A1%80%EF%BC%9Apassive-event-listeners" aria-label="基础：passive event listeners permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>基础：Passive Event Listeners</h2>
<h3 id="存在的问题" style="position:relative;"><a href="#%E5%AD%98%E5%9C%A8%E7%9A%84%E9%97%AE%E9%A2%98" aria-label="存在的问题 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>存在的问题</h3>
<p>在滚屏事件中（mousewheel、touchmove）如果调用了<code class="language-text">preventDefault()</code>后会阻止默认行为——<strong>禁止滚屏行为</strong>。因此，传统浏览器会将绑定的事件处理程序作为 Task 传到 Task Queue 中等待主线程空闲后执行。因此，这里会有个等待执行的延迟。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 840px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 75.23809523809524%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDAFA3PEY8MlBGQUZaVVBfeMiCeG5uePWvuZHI////////////////////////////////////////////////////2wBDAVVaWnhpeOuCguv/////////////////////////////////////////////////////////////////////////wgARCAAPABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEC/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAdzaCq//xAAWEAADAAAAAAAAAAAAAAAAAAAAICH/2gAIAQEAAQUCKv8A/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAGxAAAgIDAQAAAAAAAAAAAAAAAAERIRBBUZH/2gAIAQEAAT8hbc0mTw/BOdQWXj//2gAMAwEAAgADAAAAEP8AD//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EAB4QAAIBAwUAAAAAAAAAAAAAAAARASExQWFxgdHh/9oACAEBAAE/ELcFo2T5LsUbbiasHAh5P//Z'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="ontouchmove"
        title="ontouchmove"
        src="/blog/static/27979223b5c4680796e3ad3ff0800079/17354/ontouchmove.jpg"
        srcset="/blog/static/27979223b5c4680796e3ad3ff0800079/58c35/ontouchmove.jpg 210w,
/blog/static/27979223b5c4680796e3ad3ff0800079/0d24e/ontouchmove.jpg 420w,
/blog/static/27979223b5c4680796e3ad3ff0800079/17354/ontouchmove.jpg 840w,
/blog/static/27979223b5c4680796e3ad3ff0800079/61048/ontouchmove.jpg 1024w"
        sizes="(max-width: 840px) 100vw, 840px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<p>当执行完毕后会确认是否有<code class="language-text">preventDefault()</code>调用，如果没调用则将布局信息传给<strong>Compositor Thread</strong>进行渲染。</p>
<h3 id="解决方案" style="position:relative;"><a href="#%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88" aria-label="解决方案 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>解决方案</h3>
<p>Chrome51 之后版本对上述问题进行了优化：<strong>Passive Event Listeners</strong>。</p>
<p>可以在注册事件时，给第三个参数传递<code class="language-text">{passive:true}</code>，主动告知 Chrome 绑定的事件中没有调用<code class="language-text">preventDefault()</code>的行为，因此 Chrome 浏览器就能不等待主线程执行事件处理程序，直接将 Layout 等信息交给<strong>Compositor Thread</strong>进行渲染。如下面代码所示：</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">handler</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// log event type</span>
<span class="token punctuation">}</span>
document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"mousewheel"</span><span class="token punctuation">,</span> handler<span class="token punctuation">,</span> <span class="token punctuation">{</span> passive<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<h3 id="其他" style="position:relative;"><a href="#%E5%85%B6%E4%BB%96" aria-label="其他 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>其他</h3>
<p>如果在上述代码的回调中调用了<code class="language-text">preventDefault()</code>会如何？</p>
<p>浏览器发出 Error，页面不会因此停止滚动。</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">Error: Unable to preventDefault inside passive event listener invocation.</code></pre></div>
<p><strong>这个过程你需要知道：</strong></p>
<ul>
<li>滚屏事件中如果不调用<code class="language-text">preventDefault()</code>则加上<code class="language-text">{passive:true}</code>参数</li>
<li><strong>Passive Event Listeners</strong>特性是为滚动流畅性而设计</li>
<li>Chrome51+支持</li>
</ul>
<h2 id="基础：css-中的code-classlanguage-texttouch-actioncode属性" style="position:relative;"><a href="#%E5%9F%BA%E7%A1%80%EF%BC%9Acss-%E4%B8%AD%E7%9A%84code-classlanguage-texttouch-actioncode%E5%B1%9E%E6%80%A7" aria-label="基础：css 中的code classlanguage texttouch actioncode属性 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>基础：CSS 中的<code class="language-text">touch-action</code>属性</h2>
<p>上面提到的阻止默认行为，通过 CSS 的<code class="language-text">touch-action</code>也能做到。</p>
<blockquote>
<p>CSS 属性<code class="language-text">touch-action</code>用于指定某个给定的区域是否允许用户操作，以及如何响应用户操作。</p>
</blockquote>
<p>当元素 CSS 属性设置了<code class="language-text">touch-action: none;</code>时，在它上面拖动是不会有效果的，类似于设置了<code class="language-text">preventDefault()</code>，但是没有主线程参与这个过程。</p>
<h2 id="基础：css-中的code-classlanguage-textevent-pointercode属性" style="position:relative;"><a href="#%E5%9F%BA%E7%A1%80%EF%BC%9Acss-%E4%B8%AD%E7%9A%84code-classlanguage-textevent-pointercode%E5%B1%9E%E6%80%A7" aria-label="基础：css 中的code classlanguage textevent pointercode属性 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>基础：CSS 中的<code class="language-text">event-pointer</code>属性</h2>
<p>滚动时如果触及到的元素具有 hover 属性后会触发 hover 特性，页面会进行 Paint，通过 event-pointer: none 禁止鼠标行为，减少不必要的 RePaint。</p>
<h2 id="结论：滚动优化方案" style="position:relative;"><a href="#%E7%BB%93%E8%AE%BA%EF%BC%9A%E6%BB%9A%E5%8A%A8%E4%BC%98%E5%8C%96%E6%96%B9%E6%A1%88" aria-label="结论：滚动优化方案 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>结论：滚动优化方案</h2>
<p>以上的基础介绍估计你就知道如何进行滚动性能优化了：</p>
<ul>
<li>事件注册使用 passive 属性</li>
<li>使用 event-pointer 属性禁止触发元素滚动，或者指定滚动方向</li>
</ul>
<p>此外，还需要通过 JS 手段对滚动进行节流，比如将滚动事件回调放在<code class="language-text">requestAnimationFrame</code>中执行。如果滚动事件中有 DOM 尺寸读取或者修改，遵循这样的方式：</p>
<ul>
<li>先读取想获取的 DOM 尺寸</li>
<li>元素修改在<code class="language-text">requestAnimationFrame</code>中进行</li>
</ul>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">el<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"touchmove"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Read</span>
  <span class="token keyword">var</span> h2 <span class="token operator">=</span> element2<span class="token punctuation">.</span>clientHeight<span class="token punctuation">;</span>
  <span class="token comment">// Write</span>
  <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    element2<span class="token punctuation">.</span>style<span class="token punctuation">.</span>height <span class="token operator">=</span> h2 <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token string">"px"</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<h2 id="查看控制台" style="position:relative;"><a href="#%E6%9F%A5%E7%9C%8B%E6%8E%A7%E5%88%B6%E5%8F%B0" aria-label="查看控制台 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>查看控制台</h2>
<p>打开启控制台，选择 Performance，然后录制滚动过程，查看滚动式的 FPS 及此时的 JS 调用栈及使用时间，比如下面的例子。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 840px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 70.95238095238095%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsSAAALEgHS3X78AAACYklEQVQ4y5WS227aQBCGees+Sa/6AL2o1IumVaVSkpRzRJMGMMbGGNuYY6DmYIxtsP11DaQkraqoI/2a3dH+n2Z2NzMaDRnYNv2+RbpudyVaWp1G+w5JuUc3OzREbusSit5CUuuoPfmw1q0OPbsr9grj8Rij1yNTqtxQrtYoVW8pVmoUyhUakoSstJFkmbaqoWpdmrJCQ1aRVZ3v9xKXxSq5fIXLfOGg60KZbO6KTEe9R5HKyHefaN1+RGtmMZUCRruApRawtSJ2p8CwW2BqlJiZFR6MCqb8FbWRw7BMIUOoh6ZrZExDQVWqolDDGLQO6lm36EYVvXdDp1tBauXFOBU0s0zXuhKjXmNZeUaTBpPVT+bbDQ/ehpnrknGcJXPHZTbSsRvvmTTfMVJNBqMdfhySRnzSwod1ELD2A9ztjkgUwzDCHZRYahdMlS9kkiQ+mILVQIz6lm/FV/TNGoEw7+MAkuQoEra7hOeREAmqO6nRkd9Qu31NJo5jEqEU60w86p+buDP3ePzASg5KzV6Y/N4fawhgRCTyUJ7QysuPQHFAIP2Ry+rDmN3QPwLj5AQ+Zm93Bj3mWHSYejc/HOZXw6fAhGC6ZX5hE47+F5jg1h3srH4GpuX9IsS5nrKfhc9MLwHT2MhLrKx2Ah7uRLxYsGU66JJeyqHnP+7rDDzXUn8cRwTLNevJ6gwUiWi3wrVzzx7jpUdJ/VG0J9kv8fztIzA+HRCtrUz+Fd5f3+YI5FTeegLYH0xZux5bP2Qmfv2Du2C+dlh6Lv25zWQ5xQ/3BOIDLzbH/FR+sGe1cZmuZvwUvl/w4yCDqNKegwAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="scroll"
        title="scroll"
        src="/blog/static/7b02be8ad56ba19e889956fdf532af5a/f88f5/scroll.png"
        srcset="/blog/static/7b02be8ad56ba19e889956fdf532af5a/e1650/scroll.png 210w,
/blog/static/7b02be8ad56ba19e889956fdf532af5a/8cae7/scroll.png 420w,
/blog/static/7b02be8ad56ba19e889956fdf532af5a/f88f5/scroll.png 840w,
/blog/static/7b02be8ad56ba19e889956fdf532af5a/1b492/scroll.png 939w"
        sizes="(max-width: 840px) 100vw, 840px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<p>可以自己体验下：<a href="http://xiangsongtao.com/" target="_target" rel="nofollow">http://xiangsongtao.com/</a>。</p>
<p>每一帧大概在 16ms 左右，页面滚动的回调函数包裹在<code class="language-text">requestAnimationFrame</code>中执行，且每次执行时间没超过 5ms，帧数在 60fps 左右。</p>
<h2 id="参考" style="position:relative;"><a href="#%E5%8F%82%E8%80%83" aria-label="参考 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>参考</h2>
<ul>
<li><a href="https://developers.google.com/web/fundamentals/performance/rendering/debounce-your-input-handlers" target="_target" rel="nofollow">使输入处理程序去除抖动</a></li>
<li><a href="http://geek.csdn.net/news/detail/109167?locationNum=9&#x26;fps=1" target="_target" rel="nofollow">让页面滑动流畅得飞起的新特性：Passive Event Listeners</a></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/touch-action" target="_target" rel="nofollow">MDN: touch-action</a></li>
</ul>]]></description><link>https://xiangst0816.github.io/blog/ru-he-chu-li-gun/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/ru-he-chu-li-gun/</guid><category><![CDATA[总结]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Wed, 11 Apr 2018 09:21:24 GMT</pubDate></item><item><title><![CDATA[CSSConf 总结]]></title><description><![CDATA[<blockquote>
<p>PDF 下载地址：<a href="/blog/post-asset//01e4d94470123db12c12f09115b68604/CSSConf.pdf">CSSConf.pdf</a></p>
</blockquote>
<p>这个 Slides 是参加 CSS 大会的总结，因为要对小伙伴们分享，因此这个总结会比较“大”。是的，我搜集了<strong>四届</strong>的大会报告做了总结，引用的文章在每个 Slide 的页脚。</p>
<p>所谓<strong>一通百通</strong>，我希望这个 Slides 能帮到你理清 CSS 的脉络！</p>
<h2 id="bigmap" style="position:relative;"><a href="#bigmap" aria-label="bigmap permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>BigMap</h2>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 840px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 56.19047619047619%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDAFA3PEY8MlBGQUZaVVBfeMiCeG5uePWvuZHI////////////////////////////////////////////////////2wBDAVVaWnhpeOuCguv/////////////////////////////////////////////////////////////////////////wgARCAALABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAQACA//EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAepoCY//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAEFAl//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAE/IV//2gAMAwEAAgADAAAAEAMP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGRAAAgMBAAAAAAAAAAAAAAAAETEAEEEB/9oACAEBAAE/EAJupwUOFZX/2Q=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="CSSConf 003"
        title="CSSConf 003"
        src="/blog/static/46658185c201160e49448f6b95430574/17354/CSSConf.003.jpg"
        srcset="/blog/static/46658185c201160e49448f6b95430574/58c35/CSSConf.003.jpg 210w,
/blog/static/46658185c201160e49448f6b95430574/0d24e/CSSConf.003.jpg 420w,
/blog/static/46658185c201160e49448f6b95430574/17354/CSSConf.003.jpg 840w,
/blog/static/46658185c201160e49448f6b95430574/f694e/CSSConf.003.jpg 1260w,
/blog/static/46658185c201160e49448f6b95430574/33475/CSSConf.003.jpg 1680w,
/blog/static/46658185c201160e49448f6b95430574/f502c/CSSConf.003.jpg 1920w"
        sizes="(max-width: 840px) 100vw, 840px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<p>根据我搜集的 21 个报告做的如下分类。根据 CSS 展开，包括：组件库中 CSS 的位置、响应式、CSS 编译器、动画及性能、CSS 技巧、工程化相关、新规范和其他。</p>
<h2 id="组件" style="position:relative;"><a href="#%E7%BB%84%E4%BB%B6" aria-label="组件 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>组件</h2>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 840px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 56.19047619047619%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDAFA3PEY8MlBGQUZaVVBfeMiCeG5uePWvuZHI////////////////////////////////////////////////////2wBDAVVaWnhpeOuCguv/////////////////////////////////////////////////////////////////////////wgARCAALABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAED/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB1SgH/8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQABBQJf/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQABPyFf/9oADAMBAAIAAwAAABAwD//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABgQAAMBAQAAAAAAAAAAAAAAAAABERAh/9oACAEBAAE/EJBEE+4z/9k='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="CSSConf 005"
        title="CSSConf 005"
        src="/blog/static/d783e7254c83abc2747a2302255c15df/17354/CSSConf.005.jpg"
        srcset="/blog/static/d783e7254c83abc2747a2302255c15df/58c35/CSSConf.005.jpg 210w,
/blog/static/d783e7254c83abc2747a2302255c15df/0d24e/CSSConf.005.jpg 420w,
/blog/static/d783e7254c83abc2747a2302255c15df/17354/CSSConf.005.jpg 840w,
/blog/static/d783e7254c83abc2747a2302255c15df/f694e/CSSConf.005.jpg 1260w,
/blog/static/d783e7254c83abc2747a2302255c15df/33475/CSSConf.005.jpg 1680w,
/blog/static/d783e7254c83abc2747a2302255c15df/f502c/CSSConf.005.jpg 1920w"
        sizes="(max-width: 840px) 100vw, 840px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 840px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 56.19047619047619%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDAFA3PEY8MlBGQUZaVVBfeMiCeG5uePWvuZHI////////////////////////////////////////////////////2wBDAVVaWnhpeOuCguv/////////////////////////////////////////////////////////////////////////wgARCAALABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAED/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB1SgH/8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQABBQJf/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQABPyFf/9oADAMBAAIAAwAAABAwD//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABkQAAIDAQAAAAAAAAAAAAAAAAABEBGBIf/aAAgBAQABPxBIrdKE+lR//9k='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="CSSConf 006"
        title="CSSConf 006"
        src="/blog/static/b9b9b09d3d6a4c3ae91d92095068d887/17354/CSSConf.006.jpg"
        srcset="/blog/static/b9b9b09d3d6a4c3ae91d92095068d887/58c35/CSSConf.006.jpg 210w,
/blog/static/b9b9b09d3d6a4c3ae91d92095068d887/0d24e/CSSConf.006.jpg 420w,
/blog/static/b9b9b09d3d6a4c3ae91d92095068d887/17354/CSSConf.006.jpg 840w,
/blog/static/b9b9b09d3d6a4c3ae91d92095068d887/f694e/CSSConf.006.jpg 1260w,
/blog/static/b9b9b09d3d6a4c3ae91d92095068d887/33475/CSSConf.006.jpg 1680w,
/blog/static/b9b9b09d3d6a4c3ae91d92095068d887/f502c/CSSConf.006.jpg 1920w"
        sizes="(max-width: 840px) 100vw, 840px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<p>组件库的构建套路固定，会一个其他的都类似。需要关注的是<strong>结构与表象分离</strong>的思想。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 840px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 56.19047619047619%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDAFA3PEY8MlBGQUZaVVBfeMiCeG5uePWvuZHI////////////////////////////////////////////////////2wBDAVVaWnhpeOuCguv/////////////////////////////////////////////////////////////////////////wgARCAALABQDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAP/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAGoAP/EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEAAQUCX//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABUQAQEAAAAAAAAAAAAAAAAAABAB/9oACAEBAAE/IWP/2gAMAwEAAgADAAAAEBAP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGBAAAwEBAAAAAAAAAAAAAAAAAAERQRD/2gAIAQEAAT8QUWi0g3Gf/9k='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="CSSConf 007"
        title="CSSConf 007"
        src="/blog/static/c142e6ac07d0d6d9b77dd4d35f9c020f/17354/CSSConf.007.jpg"
        srcset="/blog/static/c142e6ac07d0d6d9b77dd4d35f9c020f/58c35/CSSConf.007.jpg 210w,
/blog/static/c142e6ac07d0d6d9b77dd4d35f9c020f/0d24e/CSSConf.007.jpg 420w,
/blog/static/c142e6ac07d0d6d9b77dd4d35f9c020f/17354/CSSConf.007.jpg 840w,
/blog/static/c142e6ac07d0d6d9b77dd4d35f9c020f/f694e/CSSConf.007.jpg 1260w,
/blog/static/c142e6ac07d0d6d9b77dd4d35f9c020f/33475/CSSConf.007.jpg 1680w,
/blog/static/c142e6ac07d0d6d9b77dd4d35f9c020f/f502c/CSSConf.007.jpg 1920w"
        sizes="(max-width: 840px) 100vw, 840px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<p><strong>结构与表象分离</strong>目前都是通过插件解决，比如：<code class="language-text">babel-plugin-import</code>、<code class="language-text">babel-plugin-components</code>，我这里举个我正在做的插件<code class="language-text">babel-plugin-vimo</code>，思路其实都是想通的。</p>
<p>我这里举的例子有点特殊，我是想说明，<strong>如何分离</strong>是需要根据实际情况来看的。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 840px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 56.19047619047619%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDAFA3PEY8MlBGQUZaVVBfeMiCeG5uePWvuZHI////////////////////////////////////////////////////2wBDAVVaWnhpeOuCguv/////////////////////////////////////////////////////////////////////////wgARCAALABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAED/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB0oRR/8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQABBQJf/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAFxABAAMAAAAAAAAAAAAAAAAAEAERIf/aAAgBAQABPyGcaf/aAAwDAQACAAMAAAAQkw//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAZEAADAQEBAAAAAAAAAAAAAAAAARExIRD/2gAIAQEAAT8QbC01XpKQ+tESUXn/2Q=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="CSSConf 009"
        title="CSSConf 009"
        src="/blog/static/908f40e2380a2674fb64bb1ebb8b50bb/17354/CSSConf.009.jpg"
        srcset="/blog/static/908f40e2380a2674fb64bb1ebb8b50bb/58c35/CSSConf.009.jpg 210w,
/blog/static/908f40e2380a2674fb64bb1ebb8b50bb/0d24e/CSSConf.009.jpg 420w,
/blog/static/908f40e2380a2674fb64bb1ebb8b50bb/17354/CSSConf.009.jpg 840w,
/blog/static/908f40e2380a2674fb64bb1ebb8b50bb/f694e/CSSConf.009.jpg 1260w,
/blog/static/908f40e2380a2674fb64bb1ebb8b50bb/33475/CSSConf.009.jpg 1680w,
/blog/static/908f40e2380a2674fb64bb1ebb8b50bb/f502c/CSSConf.009.jpg 1920w"
        sizes="(max-width: 840px) 100vw, 840px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<p>组件样式系统是层层构建的，类似于一个金字塔，上面的部分依赖下面部分。此外，还需要一个<strong>书写规范（BEM）</strong>做指引，满足工程化还需要再加上一个<strong>预处理器（SCSS）</strong>。这里举的例子是大多数项目在用的方案。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 840px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 56.19047619047619%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDAFA3PEY8MlBGQUZaVVBfeMiCeG5uePWvuZHI////////////////////////////////////////////////////2wBDAVVaWnhpeOuCguv/////////////////////////////////////////////////////////////////////////wgARCAALABQDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAP/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAGoAP/EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEAAQUCX//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEAAT8hX//aAAwDAQACAAMAAAAQEA//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAZEAADAAMAAAAAAAAAAAAAAAAAAREQMWH/2gAIAQEAAT8QhOsaFvDP/9k='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="CSSConf 011"
        title="CSSConf 011"
        src="/blog/static/2c87fff449f37c4061ff0a8517d50337/17354/CSSConf.011.jpg"
        srcset="/blog/static/2c87fff449f37c4061ff0a8517d50337/58c35/CSSConf.011.jpg 210w,
/blog/static/2c87fff449f37c4061ff0a8517d50337/0d24e/CSSConf.011.jpg 420w,
/blog/static/2c87fff449f37c4061ff0a8517d50337/17354/CSSConf.011.jpg 840w,
/blog/static/2c87fff449f37c4061ff0a8517d50337/f694e/CSSConf.011.jpg 1260w,
/blog/static/2c87fff449f37c4061ff0a8517d50337/33475/CSSConf.011.jpg 1680w,
/blog/static/2c87fff449f37c4061ff0a8517d50337/f502c/CSSConf.011.jpg 1920w"
        sizes="(max-width: 840px) 100vw, 840px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<p>组件需要对外暴露样式修改接口，如图。</p>
<h2 id="响应式" style="position:relative;"><a href="#%E5%93%8D%E5%BA%94%E5%BC%8F" aria-label="响应式 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>响应式</h2>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 840px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 56.19047619047619%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDAFA3PEY8MlBGQUZaVVBfeMiCeG5uePWvuZHI////////////////////////////////////////////////////2wBDAVVaWnhpeOuCguv/////////////////////////////////////////////////////////////////////////wgARCAALABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAIB/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAb3RKkf/xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAEFAl//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAYEAACAwAAAAAAAAAAAAAAAAABEAARIf/aAAgBAQABPyEHVcD/AP/aAAwDAQACAAMAAAAQ0y//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAZEAEAAwEBAAAAAAAAAAAAAAABABEhIDH/2gAIAQEAAT8QspUcF1gk84f/2Q=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="CSSConf 014"
        title="CSSConf 014"
        src="/blog/static/8621b0000f6063ba716ab6c024ca27a9/17354/CSSConf.014.jpg"
        srcset="/blog/static/8621b0000f6063ba716ab6c024ca27a9/58c35/CSSConf.014.jpg 210w,
/blog/static/8621b0000f6063ba716ab6c024ca27a9/0d24e/CSSConf.014.jpg 420w,
/blog/static/8621b0000f6063ba716ab6c024ca27a9/17354/CSSConf.014.jpg 840w,
/blog/static/8621b0000f6063ba716ab6c024ca27a9/f694e/CSSConf.014.jpg 1260w,
/blog/static/8621b0000f6063ba716ab6c024ca27a9/33475/CSSConf.014.jpg 1680w,
/blog/static/8621b0000f6063ba716ab6c024ca27a9/f502c/CSSConf.014.jpg 1920w"
        sizes="(max-width: 840px) 100vw, 840px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<p>熟悉响应式常用的属性即可。</p>
<h2 id="编译器" style="position:relative;"><a href="#%E7%BC%96%E8%AF%91%E5%99%A8" aria-label="编译器 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>编译器</h2>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 840px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 56.19047619047619%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDAFA3PEY8MlBGQUZaVVBfeMiCeG5uePWvuZHI////////////////////////////////////////////////////2wBDAVVaWnhpeOuCguv/////////////////////////////////////////////////////////////////////////wgARCAALABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAQAD/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB1GCY/8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQABBQJf/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQABPyFf/9oADAMBAAIAAwAAABBTD//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABkQAQEAAwEAAAAAAAAAAAAAAAABESEx4f/aAAgBAQABPxCRdeuow4//2Q=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="CSSConf 017"
        title="CSSConf 017"
        src="/blog/static/49e0f012210bd850b800b2c77b7db393/17354/CSSConf.017.jpg"
        srcset="/blog/static/49e0f012210bd850b800b2c77b7db393/58c35/CSSConf.017.jpg 210w,
/blog/static/49e0f012210bd850b800b2c77b7db393/0d24e/CSSConf.017.jpg 420w,
/blog/static/49e0f012210bd850b800b2c77b7db393/17354/CSSConf.017.jpg 840w,
/blog/static/49e0f012210bd850b800b2c77b7db393/f694e/CSSConf.017.jpg 1260w,
/blog/static/49e0f012210bd850b800b2c77b7db393/33475/CSSConf.017.jpg 1680w,
/blog/static/49e0f012210bd850b800b2c77b7db393/f502c/CSSConf.017.jpg 1920w"
        sizes="(max-width: 840px) 100vw, 840px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<p>编译器的出现是为了解决 CSS 的问题（废话）。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 840px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 56.19047619047619%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDAFA3PEY8MlBGQUZaVVBfeMiCeG5uePWvuZHI////////////////////////////////////////////////////2wBDAVVaWnhpeOuCguv/////////////////////////////////////////////////////////////////////////wgARCAALABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAECA//EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAek0Io//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAEFAl//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAXEAEAAwAAAAAAAAAAAAAAAAARACAh/9oACAEBAAE/IY6V/9oADAMBAAIAAwAAABDTD//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABsQAAMAAgMAAAAAAAAAAAAAAAABERAhMVGB/9oACAEBAAE/EOGlobLqPBEVsVx//9k='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="CSSConf 021"
        title="CSSConf 021"
        src="/blog/static/5bc933b6f7a84e09c9a6f1ecbe26975f/17354/CSSConf.021.jpg"
        srcset="/blog/static/5bc933b6f7a84e09c9a6f1ecbe26975f/58c35/CSSConf.021.jpg 210w,
/blog/static/5bc933b6f7a84e09c9a6f1ecbe26975f/0d24e/CSSConf.021.jpg 420w,
/blog/static/5bc933b6f7a84e09c9a6f1ecbe26975f/17354/CSSConf.021.jpg 840w,
/blog/static/5bc933b6f7a84e09c9a6f1ecbe26975f/f694e/CSSConf.021.jpg 1260w,
/blog/static/5bc933b6f7a84e09c9a6f1ecbe26975f/33475/CSSConf.021.jpg 1680w,
/blog/static/5bc933b6f7a84e09c9a6f1ecbe26975f/f502c/CSSConf.021.jpg 1920w"
        sizes="(max-width: 840px) 100vw, 840px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<p>PostCSS 需要关注，常用插件需要熟悉。对新规范的各种 Polyfill 需要知道有哪些是没实现的，别被插件带偏！！！</p>
<h2 id="动画" style="position:relative;"><a href="#%E5%8A%A8%E7%94%BB" aria-label="动画 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>动画</h2>
<blockquote>
<p>PS: 大漠的 PPT 稍微改下就能在很多地方讲。另外，干货少，报告更像是科普（没诚意）。</p>
</blockquote>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 840px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 56.19047619047619%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDAFA3PEY8MlBGQUZaVVBfeMiCeG5uePWvuZHI////////////////////////////////////////////////////2wBDAVVaWnhpeOuCguv/////////////////////////////////////////////////////////////////////////wgARCAALABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEC/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3VCD/8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQABBQJf/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAGBAAAwEBAAAAAAAAAAAAAAAAARAhABH/2gAIAQEAAT8hvTqg/wD/2gAMAwEAAgADAAAAEHDP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGxABAQEAAgMAAAAAAAAAAAAAAREAECFRYYH/2gAIAQEAAT8QFAQnrBXbfmmAK+eK7//Z'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="CSSConf 031"
        title="CSSConf 031"
        src="/blog/static/d3bdb1d195a03aabc51ce63648a8ad46/17354/CSSConf.031.jpg"
        srcset="/blog/static/d3bdb1d195a03aabc51ce63648a8ad46/58c35/CSSConf.031.jpg 210w,
/blog/static/d3bdb1d195a03aabc51ce63648a8ad46/0d24e/CSSConf.031.jpg 420w,
/blog/static/d3bdb1d195a03aabc51ce63648a8ad46/17354/CSSConf.031.jpg 840w,
/blog/static/d3bdb1d195a03aabc51ce63648a8ad46/f694e/CSSConf.031.jpg 1260w,
/blog/static/d3bdb1d195a03aabc51ce63648a8ad46/33475/CSSConf.031.jpg 1680w,
/blog/static/d3bdb1d195a03aabc51ce63648a8ad46/f502c/CSSConf.031.jpg 1920w"
        sizes="(max-width: 840px) 100vw, 840px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<p>看看上面的优缺点，根据场景选择使用。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 840px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 56.19047619047619%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDAFA3PEY8MlBGQUZaVVBfeMiCeG5uePWvuZHI////////////////////////////////////////////////////2wBDAVVaWnhpeOuCguv/////////////////////////////////////////////////////////////////////////wgARCAALABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAED/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB0URR/8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQABBQJf/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAFhAAAwAAAAAAAAAAAAAAAAAAACAh/9oACAEBAAE/ISr/AP/aAAwDAQACAAMAAAAQ0w//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAbEAACAQUAAAAAAAAAAAAAAAAAAUEQESExgf/aAAgBAQABPxCzg4MyLdGf/9k='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="CSSConf 032"
        title="CSSConf 032"
        src="/blog/static/a68122c36729bd9dea7b2259bbd7ec51/17354/CSSConf.032.jpg"
        srcset="/blog/static/a68122c36729bd9dea7b2259bbd7ec51/58c35/CSSConf.032.jpg 210w,
/blog/static/a68122c36729bd9dea7b2259bbd7ec51/0d24e/CSSConf.032.jpg 420w,
/blog/static/a68122c36729bd9dea7b2259bbd7ec51/17354/CSSConf.032.jpg 840w,
/blog/static/a68122c36729bd9dea7b2259bbd7ec51/f694e/CSSConf.032.jpg 1260w,
/blog/static/a68122c36729bd9dea7b2259bbd7ec51/33475/CSSConf.032.jpg 1680w,
/blog/static/a68122c36729bd9dea7b2259bbd7ec51/f502c/CSSConf.032.jpg 1920w"
        sizes="(max-width: 840px) 100vw, 840px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<p>渲染过程要了然于胸，还是不清楚的下载 pdf 进入图片左下角的链接学习下。</p>
<p>总的来说，将网上的<strong>最佳实践</strong>对应到上图各个流程中，跟着走一遍，死记硬背是不管用的。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 840px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 56.19047619047619%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDAFA3PEY8MlBGQUZaVVBfeMiCeG5uePWvuZHI////////////////////////////////////////////////////2wBDAVVaWnhpeOuCguv/////////////////////////////////////////////////////////////////////////wgARCAALABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAED/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB0URR/8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQABBQJf/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAFxAAAwEAAAAAAAAAAAAAAAAAABEgYf/aAAgBAQABPyEWz//aAAwDAQACAAMAAAAQ0w//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAbEAACAgMBAAAAAAAAAAAAAAAAARExEEFRgf/aAAgBAQABPxCOOCS2EvRXij//2Q=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="CSSConf 035"
        title="CSSConf 035"
        src="/blog/static/2a82d0290fb23f52d698151af093d946/17354/CSSConf.035.jpg"
        srcset="/blog/static/2a82d0290fb23f52d698151af093d946/58c35/CSSConf.035.jpg 210w,
/blog/static/2a82d0290fb23f52d698151af093d946/0d24e/CSSConf.035.jpg 420w,
/blog/static/2a82d0290fb23f52d698151af093d946/17354/CSSConf.035.jpg 840w,
/blog/static/2a82d0290fb23f52d698151af093d946/f694e/CSSConf.035.jpg 1260w,
/blog/static/2a82d0290fb23f52d698151af093d946/33475/CSSConf.035.jpg 1680w,
/blog/static/2a82d0290fb23f52d698151af093d946/f502c/CSSConf.035.jpg 1920w"
        sizes="(max-width: 840px) 100vw, 840px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<p>另外，<strong>Reflow</strong>、<strong>Repaint</strong>这两个词要改下了，因为那是在<strong>FireFox</strong>上的称呼，<strong>Chrome</strong>叫<strong>Layout</strong>和<strong>Paint</strong>！</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 840px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 56.19047619047619%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDAFA3PEY8MlBGQUZaVVBfeMiCeG5uePWvuZHI////////////////////////////////////////////////////2wBDAVVaWnhpeOuCguv/////////////////////////////////////////////////////////////////////////wgARCAALABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAED/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB0UAf/8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQABBQJf/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAFRABAQAAAAAAAAAAAAAAAAAAIIH/2gAIAQEAAT8hi//aAAwDAQACAAMAAAAQ0A//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAbEAEBAAEFAAAAAAAAAAAAAAABABEQITFRgf/aAAgBAQABPxBU4UZ6fbEO+jf/2Q=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="CSSConf 041"
        title="CSSConf 041"
        src="/blog/static/02736a81246a10e181b8d63e8c399a52/17354/CSSConf.041.jpg"
        srcset="/blog/static/02736a81246a10e181b8d63e8c399a52/58c35/CSSConf.041.jpg 210w,
/blog/static/02736a81246a10e181b8d63e8c399a52/0d24e/CSSConf.041.jpg 420w,
/blog/static/02736a81246a10e181b8d63e8c399a52/17354/CSSConf.041.jpg 840w,
/blog/static/02736a81246a10e181b8d63e8c399a52/f694e/CSSConf.041.jpg 1260w,
/blog/static/02736a81246a10e181b8d63e8c399a52/33475/CSSConf.041.jpg 1680w,
/blog/static/02736a81246a10e181b8d63e8c399a52/f502c/CSSConf.041.jpg 1920w"
        sizes="(max-width: 840px) 100vw, 840px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<p>WebAnimation 虽然浏览器支持度够呛，单已经有<a href="https://github.com/web-animations/web-animations-js" target="_target" rel="nofollow">Polyfill</a>了，现在可以在项目中用用。</p>
<h2 id="技巧" style="position:relative;"><a href="#%E6%8A%80%E5%B7%A7" aria-label="技巧 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>技巧</h2>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 840px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 56.19047619047619%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDAFA3PEY8MlBGQUZaVVBfeMiCeG5uePWvuZHI////////////////////////////////////////////////////2wBDAVVaWnhpeOuCguv/////////////////////////////////////////////////////////////////////////wgARCAALABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAECA//EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAdZoEMP/xAAWEAADAAAAAAAAAAAAAAAAAAAAICH/2gAIAQEAAQUCKv8A/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAFxAAAwEAAAAAAAAAAAAAAAAAACAxof/aAAgBAQABPyEqav8A/9oADAMBAAIAAwAAABBTD//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABoQAQADAAMAAAAAAAAAAAAAAAEAESEQMVH/2gAIAQEAAT8QrGjYOCK9gGtKYd8M/9k='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="CSSConf 044"
        title="CSSConf 044"
        src="/blog/static/94fe81ae7ccc71beac6499fe2b315ec4/17354/CSSConf.044.jpg"
        srcset="/blog/static/94fe81ae7ccc71beac6499fe2b315ec4/58c35/CSSConf.044.jpg 210w,
/blog/static/94fe81ae7ccc71beac6499fe2b315ec4/0d24e/CSSConf.044.jpg 420w,
/blog/static/94fe81ae7ccc71beac6499fe2b315ec4/17354/CSSConf.044.jpg 840w,
/blog/static/94fe81ae7ccc71beac6499fe2b315ec4/f694e/CSSConf.044.jpg 1260w,
/blog/static/94fe81ae7ccc71beac6499fe2b315ec4/33475/CSSConf.044.jpg 1680w,
/blog/static/94fe81ae7ccc71beac6499fe2b315ec4/f502c/CSSConf.044.jpg 1920w"
        sizes="(max-width: 840px) 100vw, 840px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<p>技巧使用的都是不太常用的功能，比较有新意。</p>
<blockquote>
<p>是不是我突发奇想实现一个很酷炫的功能是不是也能去 CSSConf 上讲讲了？heh…</p>
</blockquote>
<h2 id="工程化" style="position:relative;"><a href="#%E5%B7%A5%E7%A8%8B%E5%8C%96" aria-label="工程化 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>工程化</h2>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 840px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 56.19047619047619%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDAFA3PEY8MlBGQUZaVVBfeMiCeG5uePWvuZHI////////////////////////////////////////////////////2wBDAVVaWnhpeOuCguv/////////////////////////////////////////////////////////////////////////wgARCAALABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAED/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB0UQH/8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQABBQJf/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAGBAAAgMAAAAAAAAAAAAAAAAAABABITH/2gAIAQEAAT8hWuKP/9oADAMBAAIAAwAAABDTz//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABkQAQADAQEAAAAAAAAAAAAAAAEAESEQUf/aAAgBAQABPxCb7cKFmkOAFGE//9k='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="CSSConf 046"
        title="CSSConf 046"
        src="/blog/static/4600626955c4e8fd4c211a8b82ada41c/17354/CSSConf.046.jpg"
        srcset="/blog/static/4600626955c4e8fd4c211a8b82ada41c/58c35/CSSConf.046.jpg 210w,
/blog/static/4600626955c4e8fd4c211a8b82ada41c/0d24e/CSSConf.046.jpg 420w,
/blog/static/4600626955c4e8fd4c211a8b82ada41c/17354/CSSConf.046.jpg 840w,
/blog/static/4600626955c4e8fd4c211a8b82ada41c/f694e/CSSConf.046.jpg 1260w,
/blog/static/4600626955c4e8fd4c211a8b82ada41c/33475/CSSConf.046.jpg 1680w,
/blog/static/4600626955c4e8fd4c211a8b82ada41c/f502c/CSSConf.046.jpg 1920w"
        sizes="(max-width: 840px) 100vw, 840px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<p>做工程化关键是要有心。话说条条大路通罗马，唱反调的说上图的内容我就喜欢人肉搞，😔，加班有成就感存在感，你高兴就好。</p>
<h2 id="新规范" style="position:relative;"><a href="#%E6%96%B0%E8%A7%84%E8%8C%83" aria-label="新规范 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>新规范</h2>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 840px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 56.19047619047619%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDAFA3PEY8MlBGQUZaVVBfeMiCeG5uePWvuZHI////////////////////////////////////////////////////2wBDAVVaWnhpeOuCguv/////////////////////////////////////////////////////////////////////////wgARCAALABQDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAP/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAGoAP/EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEAAQUCX//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEAAT8hX//aAAwDAQACAAMAAAAQEA//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAZEAADAAMAAAAAAAAAAAAAAAAAAREQYXH/2gAIAQEAAT8QS0TpBYZ//9k='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="CSSConf 049"
        title="CSSConf 049"
        src="/blog/static/a3bae9bf47987e3c0366cd6ec3ffb3ad/17354/CSSConf.049.jpg"
        srcset="/blog/static/a3bae9bf47987e3c0366cd6ec3ffb3ad/58c35/CSSConf.049.jpg 210w,
/blog/static/a3bae9bf47987e3c0366cd6ec3ffb3ad/0d24e/CSSConf.049.jpg 420w,
/blog/static/a3bae9bf47987e3c0366cd6ec3ffb3ad/17354/CSSConf.049.jpg 840w,
/blog/static/a3bae9bf47987e3c0366cd6ec3ffb3ad/f694e/CSSConf.049.jpg 1260w,
/blog/static/a3bae9bf47987e3c0366cd6ec3ffb3ad/33475/CSSConf.049.jpg 1680w,
/blog/static/a3bae9bf47987e3c0366cd6ec3ffb3ad/f502c/CSSConf.049.jpg 1920w"
        sizes="(max-width: 840px) 100vw, 840px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 840px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 56.19047619047619%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDAFA3PEY8MlBGQUZaVVBfeMiCeG5uePWvuZHI////////////////////////////////////////////////////2wBDAVVaWnhpeOuCguv/////////////////////////////////////////////////////////////////////////wgARCAALABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAED/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB0URR/8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQABBQJf/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQABPyFf/9oADAMBAAIAAwAAABCzD//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABoQAAICAwAAAAAAAAAAAAAAAAABESEQUWH/2gAIAQEAAT8QcLhK2ynYsM//2Q=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="CSSConf 050"
        title="CSSConf 050"
        src="/blog/static/ca4491bbdd14791241409e22a3106407/17354/CSSConf.050.jpg"
        srcset="/blog/static/ca4491bbdd14791241409e22a3106407/58c35/CSSConf.050.jpg 210w,
/blog/static/ca4491bbdd14791241409e22a3106407/0d24e/CSSConf.050.jpg 420w,
/blog/static/ca4491bbdd14791241409e22a3106407/17354/CSSConf.050.jpg 840w,
/blog/static/ca4491bbdd14791241409e22a3106407/f694e/CSSConf.050.jpg 1260w,
/blog/static/ca4491bbdd14791241409e22a3106407/33475/CSSConf.050.jpg 1680w,
/blog/static/ca4491bbdd14791241409e22a3106407/f502c/CSSConf.050.jpg 1920w"
        sizes="(max-width: 840px) 100vw, 840px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<p>开启新规范需要按照上图指示手动开启（2018/04/01），这里不确定未来是不是已自动集成了新特性。</p>
<p>新规范的位置我大概标了下，如果不对可以交流交流。</p>
<h2 id="其他" style="position:relative;"><a href="#%E5%85%B6%E4%BB%96" aria-label="其他 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>其他</h2>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 840px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 56.19047619047619%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDAFA3PEY8MlBGQUZaVVBfeMiCeG5uePWvuZHI////////////////////////////////////////////////////2wBDAVVaWnhpeOuCguv/////////////////////////////////////////////////////////////////////////wgARCAALABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAED/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB0oRR/8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQABBQJf/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAFxAAAwEAAAAAAAAAAAAAAAAAESAhMf/aAAgBAQABPyGnI3//2gAMAwEAAgADAAAAEBMP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGxABAAMAAwEAAAAAAAAAAAAAAQARMRAhUXH/2gAIAQEAAT8QUELLXyZesOy6r7DeGf/Z'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="CSSConf 057"
        title="CSSConf 057"
        src="/blog/static/c5d5b2a83f3525855bf12d6e43199f3f/17354/CSSConf.057.jpg"
        srcset="/blog/static/c5d5b2a83f3525855bf12d6e43199f3f/58c35/CSSConf.057.jpg 210w,
/blog/static/c5d5b2a83f3525855bf12d6e43199f3f/0d24e/CSSConf.057.jpg 420w,
/blog/static/c5d5b2a83f3525855bf12d6e43199f3f/17354/CSSConf.057.jpg 840w,
/blog/static/c5d5b2a83f3525855bf12d6e43199f3f/f694e/CSSConf.057.jpg 1260w,
/blog/static/c5d5b2a83f3525855bf12d6e43199f3f/33475/CSSConf.057.jpg 1680w,
/blog/static/c5d5b2a83f3525855bf12d6e43199f3f/f502c/CSSConf.057.jpg 1920w"
        sizes="(max-width: 840px) 100vw, 840px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<p>学好 CSS 关键在于看书多练习，如果一次搞透那最好。</p>
<blockquote>
<p>我不是书托 😀</p>
</blockquote>
<h2 id="总结" style="position:relative;"><a href="#%E6%80%BB%E7%BB%93" aria-label="总结 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>总结</h2>
<ul>
<li>共性问题通过工具解决，别“Don’t Repeat Youself”</li>
<li>精⼒够的话再朝工程化⽅向发展，解决大多数人的效率问题</li>
<li>前端很简单，多思考练习</li>
</ul>]]></description><link>https://xiangst0816.github.io/blog/css-zong-jie/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/css-zong-jie/</guid><category><![CDATA[总结]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Tue, 10 Apr 2018 14:26:25 GMT</pubDate></item><item><title><![CDATA[SSR相关]]></title><description><![CDATA[<h3 id="1-什么是-ssr？什么情况下需要使用-ssr？" style="position:relative;"><a href="#1-%E4%BB%80%E4%B9%88%E6%98%AF-ssr%EF%BC%9F%E4%BB%80%E4%B9%88%E6%83%85%E5%86%B5%E4%B8%8B%E9%9C%80%E8%A6%81%E4%BD%BF%E7%94%A8-ssr%EF%BC%9F" aria-label="1 什么是 ssr？什么情况下需要使用 ssr？ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 什么是 SSR？什么情况下需要使用 SSR？</h3>
<p>SSR（Server Side Render）<strong>服务端渲染</strong>，这里主要是为了解决 SPA 应用首屏<mark>加载缓慢、白屏</mark>的问题。用户在访问 SPA 应用时，服务端（Nodejs）先获取页面需要的数据<strong>生成 HTML 字符串</strong>传递给客户端用于首屏显示，随后再加载其余资源进行<strong>渲染结果比对</strong>和<strong>后渲染</strong>流程。</p>
<h3 id="2-传统-spa-渲染过程和-ssr-渲染过程有何不同？" style="position:relative;"><a href="#2-%E4%BC%A0%E7%BB%9F-spa-%E6%B8%B2%E6%9F%93%E8%BF%87%E7%A8%8B%E5%92%8C-ssr-%E6%B8%B2%E6%9F%93%E8%BF%87%E7%A8%8B%E6%9C%89%E4%BD%95%E4%B8%8D%E5%90%8C%EF%BC%9F" aria-label="2 传统 spa 渲染过程和 ssr 渲染过程有何不同？ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 传统 SPA 渲染过程和 SSR 渲染过程有何不同？</h3>
<p>下面是两种方式的时序图：</p>
<p><strong>客户端渲染</strong></p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 840px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 96.19047619047618%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAAsSAAALEgHS3X78AAADPElEQVQ4y5VU3UtTYRh/zznbmWem5jK3aWu7GFksbE1YZsIoCcI79x8EI0SSwotCL2qUMIJpCAl60Y1ML/VCRBRD0anzI+dExQvF7w8GgthFedP6Pcez6T4KeuDZ++45z/t7n4/f8zIGaW1tpYX5/X6ho6ND6urqktra2tRMkZ6eHr6/v186OTnJisViUl1dHU/25uZmvrOzU5qenpba29vFuD/b2dkRaD06OqqdnZ09GxkZOdvd3Q3Evy8uLrpXV1d/z83NRZeXl38tLS25yb61tfUMfj/C4fDPw8PDcZvNJuOw7e1t+caNjQ03PiwcHByENzc3/XHAtbU1VzQajezt7U3u7+8vQKrJjksewh5CIN8pgKamposokQq7JBz95OXliRqNJhtbNUuRFH85oL6+vvSPlZWVvFarzVar1QRkgjqg5qKiouuo8YNU4MbGRs5sNquSjDMzM4m9wWBQAeyaIAgG/L0NLSHgqqqqQtTOV1FRIR/2er2yf1lZGVdQUCBnYDKZzkEmJyc5dFKYn5/n0UGV3W4nhyzoVcocegWi9ng8uaIocilB0v+LCAmMpYs2JycnF6sRqofmpjqoVOcYDoeDczqdcjNKSkoSoE9GR0e/Dg8Pf0b6HnDxOcwiapOPlbSYMgKIQbmEImdjY2Mso4yPj7sA9mVwcPAjePYpEom8Jbvb7dZStFRa6C2lSVboTZRAokBramruDQwMyLxcX1/nWDAYTEoZvHKA+e9p7/P5RA6i1IgadUcBZ+i6hlb4WuIBgC1coo4TExNyp0BoF4j+mvZIuQiLhbZQHUWmlCC1KWJa2pgQmZyYkkcA/0COiMKi0OZGaWlpMS72xv0xu5cBhQRQb28v1VCFeRWVMXStrKy8ob3FYqEI7VQ/Ij+a8NRoNMqH6+vr5fOoJYeJkrPDQKQ36Pj4+H4oFHpHvlartRCrTUn5glPJB5N5iAjz0ZiXKO4rDP+LqampWhA8SMRuaGgQeJ4ngovd3d2svLxcEz+n0+kyAw4NDd3FkxVDVLHT09MYnqRvAKzO8ACwTI9EGmAgENAiwsdEbtSxqqWlxanwLZMIf7Hz7B8i6PV6GVCSJHos2P/IHw3RRzPEVYZaAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="SPA"
        title="SPA"
        src="/blog/static/99ef46391c0a4a25b884d71946a2b44e/f88f5/SPA.png"
        srcset="/blog/static/99ef46391c0a4a25b884d71946a2b44e/e1650/SPA.png 210w,
/blog/static/99ef46391c0a4a25b884d71946a2b44e/8cae7/SPA.png 420w,
/blog/static/99ef46391c0a4a25b884d71946a2b44e/f88f5/SPA.png 840w,
/blog/static/99ef46391c0a4a25b884d71946a2b44e/9f657/SPA.png 948w"
        sizes="(max-width: 840px) 100vw, 840px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<p><strong>服务端渲染</strong></p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 840px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 75.23809523809524%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAACqUlEQVQ4y5VUT0iaYRh/X+3z37SaSzHbOsQ0i+Fau8koiEYgeNlhCLtvjLwVg1DqsGOXDXQn12GnWp5WJP5J0/6pFGIeKqJAQaRT0qWL4H7Pt89hkYw98PC+7/M+3/P8fr/34WOrq6usXq8zsnw+bwuHw1P7+/vDdD49PVVub2+PpVKpiWKx2EMx3PWn0+mJnZ2diYODg0cUw93LbDb7GusAi8VirNFoyOiiUqkEq9Vq4+Li4iedETdgf1UqlRrlcvktxc7Pzz9JZ8p7Q7HLy8tsrVaj2BcWCAToQxEhOhqPj4+fr6ysDOCoN5vNxvX1dVsul7MVCoVOysG+G02fIncIqJqxfpztGxsbvaxpy8vLrMUEjUbTh7V7enraiqIO7OV6vX4Iq8lut/c6nU4VJe7t7fHWD9nS0hK7ublhEkXmcrmEJmKys7OzEWjzgfYGg2GUkEOm8cPDQ7ukKb++vuaTk5NCMBi8XVwyOZzPzc2JuoLqs0wm8x5bGRDasFrgCsq5810Ha2NC6+Hk5GRkd3f3G+0XFhaEDpjUVHZvwUQiweLxuDwUChFVrlaruxA2KhSKJ1h75ufnR0D7lSSJiEqn03FBEOQiHbn8nwjFS865AIod9yBhEt2/lba2tpjD4fjDLJlMKjY3Nz9j/Y7B/uh2uwe1Wu0grsxNnSwWCxVWwx/AVU2d73bxeDwiZdXa2tovFC3gNX+g2zuMhBH3SowOia8BWpKhH04yPIY/pOKgTk2E2dlZM15+rB1doqiF9jrSkApLqGiIrfAuKUdlMpkIOff7/d0A9EL8GvOkjEajX/GSIYyHNxKJTGGmCGEnkPW1vCiXJoC3NL5lMzMzjF5Yhmkfhn6jR0dH1sXFxXGfz6e85xFYuxh+IMzr9craUda3jABn/2m/ARDgFqjQKFJ8AAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="SSR"
        title="SSR"
        src="/blog/static/a852d8c00f308f274cb618361a9adddc/f88f5/SSR.png"
        srcset="/blog/static/a852d8c00f308f274cb618361a9adddc/e1650/SSR.png 210w,
/blog/static/a852d8c00f308f274cb618361a9adddc/8cae7/SSR.png 420w,
/blog/static/a852d8c00f308f274cb618361a9adddc/f88f5/SSR.png 840w,
/blog/static/a852d8c00f308f274cb618361a9adddc/13e46/SSR.png 1252w"
        sizes="(max-width: 840px) 100vw, 840px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<p><strong>注意：</strong></p>
<ul>
<li>SSR 可以在<code class="language-text">window.onload</code> 事件前（css 已在页面中，js 等资源还未加载完）就能显示页面内容</li>
<li>
<p>对于同一个组件，服务端通过执行部分钩子代码完成“可视”部分渲染，不同框架不太一样</p>
<p>  	- React：<code class="language-text">componentWillMount/render</code>
- Vue：<code class="language-text">beforeCreate/create</code></p>
</li>
<li>针对 SSR，为了保证组件的完整生命周期及事件处理，客户端需要再次渲染（包括和客户端已有界面数据的比对校验）</li>
</ul>
<h3 id="3-支持-ssr-的后端服务有哪些？" style="position:relative;"><a href="#3-%E6%94%AF%E6%8C%81-ssr-%E7%9A%84%E5%90%8E%E7%AB%AF%E6%9C%8D%E5%8A%A1%E6%9C%89%E5%93%AA%E4%BA%9B%EF%BC%9F" aria-label="3 支持 ssr 的后端服务有哪些？ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. 支持 SSR 的后端服务有哪些？</h3>
<p>只有 Nodejs。</p>
<h3 id="4-nodejs-端和客户端为什么会有两个入口？" style="position:relative;"><a href="#4-nodejs-%E7%AB%AF%E5%92%8C%E5%AE%A2%E6%88%B7%E7%AB%AF%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BC%9A%E6%9C%89%E4%B8%A4%E4%B8%AA%E5%85%A5%E5%8F%A3%EF%BC%9F" aria-label="4 nodejs 端和客户端为什么会有两个入口？ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. Nodejs 端和客户端为什么会有两个入口？</h3>
<p>这里指的是<code class="language-text">server.js/client.js</code>两个入口文件。</p>
<ul>
<li>服务端需要开启服务，并通过路由导航到正确的页面</li>
<li>客户端就是完整的基于 router 的 SPA</li>
<li>两个通过 Router 连接到公共代码</li>
</ul>
<p><figure class="gatsby-resp-image-figure" style="">
    <span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 836px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 65.71428571428571%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAACVElEQVQ4y5WTTYhSURTH73t+TEY1UaO0aPpgxs+xwk0igQ0RQ9kqcjEoidYmps2QlC5aCa7VjeIuaCUE6kYUnEUoDuKAZuqYiPj9AWouFBQXdu7jabiw8MDhnfd/95z3O+feixCY0WjED6RWq5Hdbmem02l2oVBg22w2lkajIfA3q9XKPDs7Y1cqFbbL5WIZDAZKN5vNSCwWo4VxuVwUDodJHOdyubvtdvtHo9GIQWK03+//zOfzD7Va7YVutxtpNpuJcrn8HeJCqVR6iXPOz88ZuODcl2wymWxAoedAchyLxT5Go9HXwWDwmk6nI0B/kslk3kciEfPp6embVCp1A60ykUi0pVQqb0J4EWjvjUajGTZIejxfY7FYrgyHw99Yhx8egUTq9frrAoHgMpBtgnPACSQUCgn8olKpNnAiUNyqVqtfWq3WV5ijBGtQgwgEAldhHI5arfYtHo8/BXlLLpfflkgk25CPnQfFGYjP568CZ4HjwZP0OxucuWrx0vz29vbQ/v4+FXs8HkzEwHE2m90G4g/FYvHdycnJJk1LwkZQO3xwcIB2dnZwl3+LASblsBBxOBxKgwIUSb1efzWjLZFI3McatEuaTCbE4/GQQqFAUqkUQdsU4e7u7jK2TCajnkBDEcBu8vx+/9tQKHTo8/kuYc3r9S6t/a85nU6qLZrwcDqdtuA4/QLqR7RGonXM7XYvZtjpdI5wu+PxeAbn8BnW4HCvVxCu1aIg3Jjj+QyB8AVNyFiroMPhQHCwCfpaPRgMBp97vd6nZDJ5B2twFYl/5f8Bal00/MafpbkAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="(two-entry"
        title="(two-entry"
        src="/blog/static/df3040e0fd9a8f3d5a099484f1525230/d356c/two-entry.png"
        srcset="/blog/static/df3040e0fd9a8f3d5a099484f1525230/e1650/two-entry.png 210w,
/blog/static/df3040e0fd9a8f3d5a099484f1525230/8cae7/two-entry.png 420w,
/blog/static/df3040e0fd9a8f3d5a099484f1525230/d356c/two-entry.png 836w"
        sizes="(max-width: 836px) 100vw, 836px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span>
    <figcaption class="gatsby-resp-image-figcaption">(two-entry</figcaption>
  </figure></p>
<h3 id="5-两种方式的组件生命周期有何不等" style="position:relative;"><a href="#5-%E4%B8%A4%E7%A7%8D%E6%96%B9%E5%BC%8F%E7%9A%84%E7%BB%84%E4%BB%B6%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E6%9C%89%E4%BD%95%E4%B8%8D%E7%AD%89" aria-label="5 两种方式的组件生命周期有何不等 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>5. 两种方式的组件生命周期有何不等?</h3>
<ul>
<li>服务端：componentWillMount( node 端 ) -> render( node 端 )</li>
<li>客户端：SPA 的方式</li>
</ul>
<h3 id="6-拉取数据后如何处理呢？" style="position:relative;"><a href="#6-%E6%8B%89%E5%8F%96%E6%95%B0%E6%8D%AE%E5%90%8E%E5%A6%82%E4%BD%95%E5%A4%84%E7%90%86%E5%91%A2%EF%BC%9F" aria-label="6 拉取数据后如何处理呢？ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>6. 拉取数据后如何处理呢？</h3>
<ul>
<li>服务端获取数据组装 HTML 页面</li>
<li>将组装页面用到的数据嵌入 HTML 中一同发送</li>
<li><strong>客户端提取 HTML 中数据校验服务端 HTML 是否正确</strong>，并初始化客户端 Store</li>
</ul>
<h3 id="7-上一步中，校验是如何进行的？" style="position:relative;"><a href="#7-%E4%B8%8A%E4%B8%80%E6%AD%A5%E4%B8%AD%EF%BC%8C%E6%A0%A1%E9%AA%8C%E6%98%AF%E5%A6%82%E4%BD%95%E8%BF%9B%E8%A1%8C%E7%9A%84%EF%BC%9F" aria-label="7 上一步中，校验是如何进行的？ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>7. 上一步中，校验是如何进行的？</h3>
<p><code class="language-text">ReactDOMServer.renderToString</code> 返回的 HTML 字符串带有自定义属性，例如：<code class="language-text">data-reactid</code>、<code class="language-text">data-react-checksum</code>。客户端从 HTML 中获取页面数据然后渲染计算得到的 checksum 与页面中的 checksum 比对，如果不一致则从新渲染，出现闪屏现象。</p>
<h3 id="8-生成两个入口的-webpack-配置如何不同？" style="position:relative;"><a href="#8-%E7%94%9F%E6%88%90%E4%B8%A4%E4%B8%AA%E5%85%A5%E5%8F%A3%E7%9A%84-webpack-%E9%85%8D%E7%BD%AE%E5%A6%82%E4%BD%95%E4%B8%8D%E5%90%8C%EF%BC%9F" aria-label="8 生成两个入口的 webpack 配置如何不同？ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>8. 生成两个入口的 webpack 配置如何不同？</h3>
<ul>
<li>前端：JSX+ES6/7 -> es5</li>
<li>后端：JSX+ES6/7 -> nodejs</li>
</ul>
<h3 id="9-服务端如何知道-path-对应的页面应该使用哪个接口数据？" style="position:relative;"><a href="#9-%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%A6%82%E4%BD%95%E7%9F%A5%E9%81%93-path-%E5%AF%B9%E5%BA%94%E7%9A%84%E9%A1%B5%E9%9D%A2%E5%BA%94%E8%AF%A5%E4%BD%BF%E7%94%A8%E5%93%AA%E4%B8%AA%E6%8E%A5%E5%8F%A3%E6%95%B0%E6%8D%AE%EF%BC%9F" aria-label="9 服务端如何知道 path 对应的页面应该使用哪个接口数据？ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>9. 服务端如何知道 path 对应的页面应该使用哪个接口数据？</h3>
<p>path -> match/RouterContext -> async 获取数据 -> render 组件 -> send</p>
<h3 id="10-客户端和服务端渲染不一致该如何排查？" style="position:relative;"><a href="#10-%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%92%8C%E6%9C%8D%E5%8A%A1%E7%AB%AF%E6%B8%B2%E6%9F%93%E4%B8%8D%E4%B8%80%E8%87%B4%E8%AF%A5%E5%A6%82%E4%BD%95%E6%8E%92%E6%9F%A5%EF%BC%9F" aria-label="10 客户端和服务端渲染不一致该如何排查？ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>10. 客户端和服务端渲染不一致该如何排查？</h3>
<p>服务端只执行<code class="language-text">componentWillMount/render</code>两个钩子，因此不要在这里执行会存在差异的代码，比如平台判断等。</p>
<h3 id="11-掘金主页加载时的-ssr-示例" style="position:relative;"><a href="#11-%E6%8E%98%E9%87%91%E4%B8%BB%E9%A1%B5%E5%8A%A0%E8%BD%BD%E6%97%B6%E7%9A%84-ssr-%E7%A4%BA%E4%BE%8B" aria-label="11 掘金主页加载时的 ssr 示例 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>11. 掘金主页加载时的 SSR 示例</h3>
<p>骨架 Nuxt + 异步数据渲染</p>
<p><figure class="gatsby-resp-image-figure" style="">
    <span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 840px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 53.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDAFA3PEY8MlBGQUZaVVBfeMiCeG5uePWvuZHI////////////////////////////////////////////////////2wBDAVVaWnhpeOuCguv/////////////////////////////////////////////////////////////////////////wgARCAALABQDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAL/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAFMikj/xAAXEAADAQAAAAAAAAAAAAAAAAACEBEg/9oACAEBAAEFAiUx/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAGhAAAgIDAAAAAAAAAAAAAAAAABEBEEFRYf/aAAgBAQABPyFXAuUwOd1//9oADAMBAAIAAwAAABAQD//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EAB0QAQABBQADAAAAAAAAAAAAAAEAETFBUWFxgZH/2gAIAQEAAT8QIpBaxBZo9SjYeZt2dn2KuWf/2Q=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="SSR-juejin"
        title="SSR-juejin"
        src="/blog/static/f4ba33008c16b3914bd880d93a7c13bd/17354/SSR-juejin.jpg"
        srcset="/blog/static/f4ba33008c16b3914bd880d93a7c13bd/58c35/SSR-juejin.jpg 210w,
/blog/static/f4ba33008c16b3914bd880d93a7c13bd/0d24e/SSR-juejin.jpg 420w,
/blog/static/f4ba33008c16b3914bd880d93a7c13bd/17354/SSR-juejin.jpg 840w,
/blog/static/f4ba33008c16b3914bd880d93a7c13bd/61048/SSR-juejin.jpg 1024w"
        sizes="(max-width: 840px) 100vw, 840px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span>
    <figcaption class="gatsby-resp-image-figcaption">SSR-juejin</figcaption>
  </figure></p>
<h2 id="参考" style="position:relative;"><a href="#%E5%8F%82%E8%80%83" aria-label="参考 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>参考</h2>
<ul>
<li><a href="https://www.cnblogs.com/BestMePeng/p/react_ssr.html" target="_target" rel="nofollow">React 服务端渲染总结</a></li>
<li><a href="https://juejin.im/post/598aabe96fb9a03c335a8dde" target="_target" rel="nofollow">美团点评点餐 Nuxt.js 实战</a></li>
</ul>]]></description><link>https://xiangst0816.github.io/blog/ssr-xiang-guan-wen-da/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/ssr-xiang-guan-wen-da/</guid><category><![CDATA[总结]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Thu, 29 Mar 2018 15:10:39 GMT</pubDate></item><item><title><![CDATA[JS高程问答]]></title><description><![CDATA[<h2 id="缘由" style="position:relative;"><a href="#%E7%BC%98%E7%94%B1" aria-label="缘由 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>缘由</h2>
<p>记得第一次看《JavaScript 高级程序设计》这本书是在两年前刚接触前端，花了一点时间大致翻阅了下，随后就把这本书当做工具书来用。工作两年后，虽然面对的业务千奇百怪但都能查查手册 Cover 住，但是深究起来就不知所以，比如：</p>
<blockquote>
<p>函数执行时内部会有哪些操作？<br>
顺便讲讲其中涉及的闭包、变量提升、作用域链？</p>
</blockquote>
<p><figure class="gatsby-resp-image-figure" style="">
    <span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 800px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 66.19047619047619%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDAFA3PEY8MlBGQUZaVVBfeMiCeG5uePWvuZHI////////////////////////////////////////////////////2wBDAVVaWnhpeOuCguv/////////////////////////////////////////////////////////////////////////wgARCAANABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAIDBP/EABQBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAbish6Qn/8QAFxAAAwEAAAAAAAAAAAAAAAAAAAEQAv/aAAgBAQABBQJic1f/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAZEAACAwEAAAAAAAAAAAAAAAABEQAQIVH/2gAIAQEAAT8hNKdqyBHor//aAAwDAQACAAMAAAAQ+8//xAAWEQADAAAAAAAAAAAAAAAAAAABEBH/2gAIAQMBAT8QgX//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAaEAACAwEBAAAAAAAAAAAAAAABEQAQYSEx/9oACAEBAAE/EFSTiNE0bWwGeXpr/9k='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="JS高程"
        title="JS高程"
        src="/blog/static/a7bb8ebc409f3c935ae73d97f206b4e1/040f2/book.jpg"
        srcset="/blog/static/a7bb8ebc409f3c935ae73d97f206b4e1/58c35/book.jpg 210w,
/blog/static/a7bb8ebc409f3c935ae73d97f206b4e1/0d24e/book.jpg 420w,
/blog/static/a7bb8ebc409f3c935ae73d97f206b4e1/040f2/book.jpg 800w"
        sizes="(max-width: 800px) 100vw, 800px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span>
    <figcaption class="gatsby-resp-image-figcaption">JS高程</figcaption>
  </figure></p>
<p>作为两年前端再搞不明白，那真是惭愧。</p>
<p>最近抽了工作之余和下班之余重新翻看，为了避免枯燥我就以问答的形式总结，把书中的问题和我自己遇到的问题按照书中章节归类。其中较为基础或者冷门的部分我就不再重述。</p>
<h2 id="目录" style="position:relative;"><a href="#%E7%9B%AE%E5%BD%95" aria-label="目录 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>目录</h2>
<ul>
<li>第一章 JavaScript 介绍</li>
<li>第二章 在 HTML 中使用 JavaScript</li>
<li>第三章 基本概念</li>
<li><a href="/blog/di-si-zhang-bian-liang/">第四章 变量-作用域和内存问题</a></li>
<li><a href="/blog/di-wu-zhang-yin-yong-lei-xing/">第五章 引用类型</a></li>
<li><a href="/blog/di-liu-lu-zhang-mian-xiang-dui-xiang/">第六章 面相对象的程序设计</a></li>
<li><a href="/blog/di-qi-zhang-han-shu-shuo-biao-da-shi/">第七章 函数表达式</a></li>
<li><a href="/blog/di-ba-zhang-BOM/">第八章 BOM</a></li>
<li><a href="/blog/di-jiu-zhang-ke-hu-duan-jian-ce/">第九章 客户端检测</a></li>
<li><a href="/blog/di-shi-zhang-DOM/">第十章 DOM</a></li>
<li><a href="/blog/di-shi-yi-zhang-DOM-tuo-ta-zhi-zhan/">第十一章 DOM 拓展</a></li>
<li><a href="/blog/di-shi-er-zhang-DOM2-he-huo-hu-DOM3/">第十二章 DOM2 和 DOM3</a></li>
<li><a href="/blog/di-shi-san-zhang-shi-jian/">第十三章 事件</a></li>
<li>第十四章 表单脚本</li>
<li>第十五章 使用 Canvas 绘图</li>
<li>第十六章 HTML5 脚本编程</li>
<li><a href="/blog/di-shi-qi-zhang-cuo/">第十七章 错误处理及调试</a></li>
<li>第十八章 JavaScript 与 XML</li>
<li>第十九章 E4X</li>
<li><a href="/blog/di-20-zhang-json/">第二十章 JSON</a></li>
<li><a href="/blog/di-er-shi-yi-zhang/">第二十一章 Ajax 与 Comet</a></li>
<li><a href="/blog/di-er-shi-er-zhang/">第二十二章 高级技巧</a></li>
<li><a href="/blog/di-er-shi-san-zhang/">第二十三章 离线应用与客户端存储</a></li>
<li>第二十四章 最佳实践</li>
<li>第二十五章 新兴的 API</li>
</ul>
<h2 id="其他" style="position:relative;"><a href="#%E5%85%B6%E4%BB%96" aria-label="其他 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>其他</h2>
<p>如果文章中有错误的表述，可以从文章 Title 下方的 Github 进入页面原文提交 PR，谢谢了！</p>]]></description><link>https://xiangst0816.github.io/blog/js-gao-cheng-wen-da/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/js-gao-cheng-wen-da/</guid><category><![CDATA[JS高程]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Tue, 27 Mar 2018 14:38:11 GMT</pubDate></item><item><title><![CDATA[JS事件机制及Tasks和microtasks的区别]]></title><description><![CDATA[<blockquote>
<p>这里所指都是在浏览器环境中，而不是 Nodejs 环境。</p>
</blockquote>
<h2 id="js-异步机制" style="position:relative;"><a href="#js-%E5%BC%82%E6%AD%A5%E6%9C%BA%E5%88%B6" aria-label="js 异步机制 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>JS 异步机制</h2>
<blockquote>
<p>关于 JS 简要的运行机制及事件队列等知识<strong>强烈</strong>希望能翻墙看下这个视频：<a href="https://www.youtube.com/watch?v=8aGhZQkoFbQ" target="_target" rel="nofollow">地址</a>。</p>
</blockquote>
<p>这里有个很重要的图需要深刻理解：</p>
<p><figure class="gatsby-resp-image-figure" style="">
    <span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 840px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 56.19047619047619%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAACJElEQVQoz21STW/TQBDN3+KKUIXgUnHgX8CVQ6VegAMS4lJKUQ9QDhw4ViKIgrggQJQkTQOUKCEf5KP5cBzXXnvtXa/tx+y6DQ1gabSjGb+3b+dNoXRYQrVWQeloH5trN1F8tIZa/QDlahnv9/fwufwWFepXDr8solzNo0LY0ulZ/VomnjIKgWCI0xBh4uPZjy20Bs+hEg4F4Ki5g05vl/IMUcwgqS7ojJMAKuWQykcoGfUC09NRCKWPBIJ+EEizEClixJnAzBnDZRPY7hizk5H5WVEvpYuciGPkzCEp1xXd0xw6FoRapTAgAUm5T3UuA6oDQiUEVFBBH7N3d9Et3ka7eAfj1+vgnTeGVJEYlUU5YXqOMCeP0LEG6LtdsKCIufsCTEaYtj6iuXERjY0VNB5eRv3+BdifNgkDMwJDGMXLCpMsl24Pe/A8m56+jsHoBnwlwac1HD+5gp/bq6hvXcNw+xLcg6dm3sn/COVCIcfcphklAo73mEgf0FwjMsuDdBvwJt/BpnXEbhOCj83ME0TnCeUSoW6w8ARzz4JFhlhkUEJO66fpzxcCPOYm12RawBnuX4VUJN9I2YyILDisTU5/o16H1qNNq9IC4y1w4RsjNEZj/yJcVqiX4Xjaw3TO4Lj30O2toD9cpbiOX/2rmFi3SC/NDTnZGeHp2rA/pqjAnPomL7BJCa2OKFG+S/krij14/CX88ANdLsnEwGDMjmb5DH8DVRozD2fPyKoAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Chrome中JS运行机制"
        title="Chrome中JS运行机制"
        src="/blog/static/81273561d5de2c2910bbea2112432038/f88f5/js-in-chrome.png"
        srcset="/blog/static/81273561d5de2c2910bbea2112432038/e1650/js-in-chrome.png 210w,
/blog/static/81273561d5de2c2910bbea2112432038/8cae7/js-in-chrome.png 420w,
/blog/static/81273561d5de2c2910bbea2112432038/f88f5/js-in-chrome.png 840w,
/blog/static/81273561d5de2c2910bbea2112432038/a4e06/js-in-chrome.png 1023w"
        sizes="(max-width: 840px) 100vw, 840px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span>
    <figcaption class="gatsby-resp-image-figcaption">Chrome中JS运行机制</figcaption>
  </figure></p>
<ul>
<li>Chrome 中的 V8 只处理 JS 的解析及执行（可能有歧义）</li>
<li>JS 运行在单线程上，通过 event loop 完成异步调度</li>
<li>DOM、XMLHTTPREquest、setTimeout、setInterval 等是异步的 WebAPIs</li>
<li>异步代码会被推入 callback queue（Tasks）中，当 stack 空闲时挨个推入 stack</li>
<li>PS: microtasks 稍后介绍</li>
</ul>
<p>这里是 Video 中关于执行一个异步操作时的图示：</p>
<p><figure class="gatsby-resp-image-figure" style="">
    <span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 840px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 56.19047619047619%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAACJUlEQVQoz31SO2/TUBT2n2JGQkL8Aub+BUYWJNgYECoMTAUhdUAUQZSkSZMWBiTUoRBEUprGCAGJ49pxcm1f+/r9+Di+TlAZYPh8Hj73nO88lKc372Lv/g4674/Q6rax32+ie9hB/10P7d4+Wgdt9I+66JFv781LNFqv13aX4pvYfbGLRruB3tsD6VeWx9/h6wwJcsR5hLwMUSIDUBBy0iq9lHZBUZB2vvaVSBHTd2PnUHxyuKkPbbWEyRgsk2HFdFjODFw4EIlAVkRULEBWBkiLAAnZZvMW1AdXMHt0FYtX13BxvIU4sqF4kYcscRAKEwk9SsuYOIRUKyQ7RJgFxDqiZCkxLCVS0t3BM1jd27A6d+Ce3IPz8wnShEPRuAfNC6BxH1Obk7QwdXXMOYNO/mXgyVZs7xCGtQ2LPUYYf77UdD2cCikVVgzuQtUNzJiNhRAwfReG75DukS7AY18+Yu5D/Ph1HdrFDfhhk8ZA0yyou0LUkOMIoXB/heFoAGuly4GXcsiJlAW1XSCiwAQi+gDd3MHSfo4oPSNfTowCySorI5lMMqTdIs4EtZBQulj+zP4ERXKOlm1Qy7Q40wbjsWRcJbgcu4FS/WDuAroxhUtsqwKyWgVaUlWMC0asOOmeRJILWahaYo1aly1v7o0a+Ou+NogpaG7N1/dX/Af1fSqT0wFUwrevlfyEyaiGWsnhR5wTxl9OMD4f4mwy+ifG6ggT9RS/AV4BMhEAn1UeAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="JS运行时"
        title="JS运行时"
        src="/blog/static/5be09d41c91a9c861541a681bb601c7d/f88f5/js-run.png"
        srcset="/blog/static/5be09d41c91a9c861541a681bb601c7d/e1650/js-run.png 210w,
/blog/static/5be09d41c91a9c861541a681bb601c7d/8cae7/js-run.png 420w,
/blog/static/5be09d41c91a9c861541a681bb601c7d/f88f5/js-run.png 840w,
/blog/static/5be09d41c91a9c861541a681bb601c7d/57a2b/js-run.png 1260w,
/blog/static/5be09d41c91a9c861541a681bb601c7d/b5d14/js-run.png 1680w,
/blog/static/5be09d41c91a9c861541a681bb601c7d/1bf6b/js-run.png 2561w"
        sizes="(max-width: 840px) 100vw, 840px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span>
    <figcaption class="gatsby-resp-image-figcaption">JS运行时</figcaption>
  </figure></p>
<ul>
<li>当浏览器开始执行我们的代码时，会将 Script 推入 Tasks 中（就是<code class="language-text">&lt;script&gt;</code>中的代码）</li>
<li>当 stack 为空，则 event loop 从 task queue 中取出一个任务执行</li>
<li>运行代码打印<code class="language-text">Hi</code></li>
<li>遇到<code class="language-text">setTimeout</code>时，将回调推入 webapis 管理（里面有一个定时队列）</li>
<li>代码继续向下执行，输出<code class="language-text">JSConfEU</code>，随后 stack 清空，<strong>UI 刷新</strong></li>
<li>当定时时间到了，webapis 将回调推入 task queue 中，stack 此时为空，event loop 取一个任务推入 stack 执行</li>
<li>代码输出<code class="language-text">there</code></li>
</ul>
<p>以上就是 JS 的异步执行过程，<strong>Tasks</strong>就是上图中的 task queue，<strong>microtasks</strong>在下面介绍。</p>
<h2 id="tasksmicrotasks-的区别" style="position:relative;"><a href="#tasksmicrotasks-%E7%9A%84%E5%8C%BA%E5%88%AB" aria-label="tasksmicrotasks 的区别 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Tasks/microtasks 的区别</h2>
<p>Google Chrome 的开发者 Jake 对存在 microtasks 时的情况有篇博文介绍的很详细，<a href="https://jakearchibald.com/2015/tasks-microtasks-queues-and-schedules/" target="_target" rel="nofollow">地址</a>，建议精读。以下通过代码解读用于区别 Tasks 和 microtasks。</p>
<h3 id="代码解读-1" style="position:relative;"><a href="#%E4%BB%A3%E7%A0%81%E8%A7%A3%E8%AF%BB-1" aria-label="代码解读 1 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>代码解读 1:</h3>
<p>当<code class="language-text">setTimeout</code>和<code class="language-text">Promise</code>同时存在时，代码示例及执行顺序说明如下：</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"script start"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"setTimeout"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"promise1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"promise2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"script end"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>下图中需要重点理解 Tasks、Microtasks、JS stack 这三个栈</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 681px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 72.38095238095238%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsSAAALEgHS3X78AAAB+UlEQVQ4y5XSXW/SUBgH8PNBJhdQoC0M2RjtCpSx0fImiNdG4AIvlAvDTBa/mFd4u2ySDUaQCPIy4kycLS1oYuLl39OSLHqhdBe/PCdtzvP8e04Jz/Nwu91gGAYej8euDOP9AwOv1+sYSaVSSCQSd2KxfUqERNlVkiAIIiU4QkqlEsrlMrLZLIrFIlQ1hUz2AIp6sK5KGslk8q+h/0OsBKnDIyjpNOKxOMQITbS7B0kUENwOwOdbf8r6KDYjIt1YzGWRowllWYZMp+xLISTkMEQpiEhkBxzHw+/3g2XZjWhDETsPt2FdjvWA4zi6maM1CNbPg2N5BPjA3ftNjYmVKpfLQ1UUZDIqXWdoOhH5goIjemExIQEpGoMQjSIUCtkDreb/QsLhMAr5AvUIsqQgGVfp4Uaxu+eDn/XYv9LWgy24XC5HSK1WQ7P5Gm9OmjhuPKEeo/nqKZrHL9BoPEe9XkelUkG1WnWEdC4v0OsN8GV+AXN8Av3jSyy/vsP3H7+wWpnUCsvl0jHS7XZxdnaOweADlsYNDEPDYmFC13VqQdf3Q66uOjh/f4nr8Slue8+gf34L3fiJhf7NcRNruKZpdiWdToemG2A+n0HXbmij23slspoYhmEfjWmaIMPhEKPRCJ/GY0yn15hMptTEsdlshn6/j1arhXa7jd8q+pKalcJ2dQAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="tasks microtasks"
        title="tasks microtasks"
        src="/blog/static/08b396c7fcd545e1bd2ccc198980df51/d868b/tasks-microtasks.png"
        srcset="/blog/static/08b396c7fcd545e1bd2ccc198980df51/e1650/tasks-microtasks.png 210w,
/blog/static/08b396c7fcd545e1bd2ccc198980df51/8cae7/tasks-microtasks.png 420w,
/blog/static/08b396c7fcd545e1bd2ccc198980df51/d868b/tasks-microtasks.png 681w"
        sizes="(max-width: 681px) 100vw, 681px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<p><strong>第一次 Task 执行：</strong></p>
<ul>
<li>将当前的 script 推入 Tasks 中</li>
<li>执行第一段代码，输出<code class="language-text">script start</code></li>
<li>setTimout 回调推入 webapis 的定时栈中</li>
<li>Promise 的第一个 then 回调推入 Microtasks</li>
<li>执行最后一句输出<code class="language-text">script end</code></li>
<li><strong>检查 Microtasks 中是否有任务</strong></li>
<li>执行推入的第一个 Promise 的 then 回调</li>
<li>输出<code class="language-text">promise1</code>，之后将第二个 then 回调推入 Microtasks</li>
<li>检查 Microtasks 中是否有任务</li>
<li>执行推入的第二个 Promise 的 then 回调</li>
<li>输出<code class="language-text">promise2</code></li>
<li>第一个 Tasks 执行完毕，<strong>刷新 UI</strong></li>
</ul>
<p><strong>第二次 Task 执行：</strong></p>
<ul>
<li>webapis 根据定时将 setTimeout 回调推入 Tasks 中</li>
<li>Event loop 从 Tasks 取出任务执行</li>
<li>输出<code class="language-text">setTimeout</code></li>
<li><strong>检查 Microtasks 中没有任务</strong></li>
<li>当前 Task 执行完毕，<strong>刷新 UI</strong></li>
</ul>
<h4 id="tasks-和-microtasks-所涉及的-api：" style="position:relative;"><a href="#tasks-%E5%92%8C-microtasks-%E6%89%80%E6%B6%89%E5%8F%8A%E7%9A%84-api%EF%BC%9A" aria-label="tasks 和 microtasks 所涉及的 api： permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Tasks 和 microtasks 所涉及的 API：</h4>
<ul>
<li><strong>Tasks</strong>: setTimeout, setInterval, (setImmediate, I/O,) UI rendering</li>
<li><strong>microtasks</strong>: (process.nextTick,) Promise, MutationObserver</li>
</ul>
<h4 id="需要注意的地方：" style="position:relative;"><a href="#%E9%9C%80%E8%A6%81%E6%B3%A8%E6%84%8F%E7%9A%84%E5%9C%B0%E6%96%B9%EF%BC%9A" aria-label="需要注意的地方： permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>需要注意的地方：</h4>
<ul>
<li>microtasks 不是 webapis，他的优先级比 Tasks 高，每轮主流任务执行完毕都会检查 microtasks，检查完毕后这轮 Task 才结束</li>
<li>micrtasks 为 js 逻辑的一部分，不涉及到 UI 等 web 功能，因此功能上应该和 setTimeout 等 webapis 作区分</li>
<li><strong>每轮 Task 结束都会渲染 UI，为了防止 UI 卡死</strong></li>
<li>setTimeout 由 webapis 管理，当定时时间到了，就推入 Tasks 中等待执行（不是立即执行）</li>
<li>setTimeout 最短执行时间为 4ms，即使定时时间为 0</li>
</ul>
<h3 id="代码解读-2" style="position:relative;"><a href="#%E4%BB%A3%E7%A0%81%E8%A7%A3%E8%AF%BB-2" aria-label="代码解读 2 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>代码解读 2</h3>
<p>两个父子关系的 div 绑定 click 事件，根据回调输出 log。</p>
<p><figure class="gatsby-resp-image-figure" style="">
    <span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 701px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 37.61904761904762%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAAA0ElEQVQoz5WRTQqDMBCFvf8lqnbVXEBxJegVVMS1fys1MVFUfG1SlFar0gfDkJfMl2FGq+satKGglKKqKrC2hfLo22uaBpwLLJpnGTOOpHHO0XWdCsYY+r5XWfotaxVUCIFpmjCO4wo7gmo4UVmW8H0fnufBdV3EcbzCDoHL5Tak8jwHIQSGbuBu3hEEwX/A7eOiKEAeBPpNh2mYCMPwGvh52M4nyzI4jgPbtmFZFqIwugYOw6AG/qvDrwW9ti/z9vMdMEkSpGm6gx0VnHUn9QTf9mr/pOmqAwAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="事件测试"
        title="事件测试"
        src="/blog/static/edfa7d3104f0b66995eb8175c5f40fe9/3914f/js-click.png"
        srcset="/blog/static/edfa7d3104f0b66995eb8175c5f40fe9/e1650/js-click.png 210w,
/blog/static/edfa7d3104f0b66995eb8175c5f40fe9/8cae7/js-click.png 420w,
/blog/static/edfa7d3104f0b66995eb8175c5f40fe9/3914f/js-click.png 701w"
        sizes="(max-width: 701px) 100vw, 701px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span>
    <figcaption class="gatsby-resp-image-figcaption">事件测试</figcaption>
  </figure></p>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>outer<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>inner<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></code></pre></div>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// Let's get hold of those elements</span>
<span class="token keyword">var</span> outer <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">".outer"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> inner <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">".inner"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Let's listen for attribute changes on the</span>
<span class="token comment">// outer element</span>
<span class="token keyword">new</span> <span class="token class-name">MutationObserver</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"mutate"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span>outer<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  attributes<span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Here's a click listener…</span>
<span class="token keyword">function</span> <span class="token function">onClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"click"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"timeout"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"promise"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  outer<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"data-random"</span><span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// …which we'll attach to both elements</span>
inner<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"click"</span><span class="token punctuation">,</span> onClick<span class="token punctuation">)</span><span class="token punctuation">;</span>
outer<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"click"</span><span class="token punctuation">,</span> onClick<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>点击内部 div 后的执行过程如下：</p>
<p><strong>脚本执行：</strong></p>
<ul>
<li>将 script 推如 Tasks，因为 stack 空闲，执行 script 脚本，完成事件绑定</li>
</ul>
<p><strong>用户点击：</strong></p>
<ul>
<li>用户点击 inner div</li>
<li>因为是在冒泡阶段触发，因此 inner 元素的 click 事件先触发，回调推入 Tasks 中</li>
<li>冒泡向上，outer 元素的 click 事件触发，回调推入 Tasks 中</li>
<li>当前没有 microtasks，Tasks 执行完毕，UI 更新</li>
</ul>
<p><strong>第一个事件回调（inner）：</strong></p>
<ul>
<li>从 Tasks 中取出任务（inner 元素的事件回调）</li>
<li>打印<code class="language-text">click</code>，</li>
<li>setTimout 回调推入 webapis 的定时栈中</li>
<li>将 Promise 的第一个 then 推入 microtasks 中</li>
<li>修改 outer 的属性触发监听，将 MutationObserver 推入 microtasks</li>
<li>检查 microtasks 中任务并执行</li>
<li>打印 <code class="language-text">promise</code>和<code class="language-text">mutate</code></li>
<li>第一个回调执行完毕，执行第二个 click 事件回调</li>
</ul>
<p><strong>第二个事件回调（outer）：</strong></p>
<ul>
<li>从 Tasks 中取出任务（outer 元素的事件回调）</li>
<li>打印<code class="language-text">click</code>，</li>
<li>setTimout 回调推入 webapis 的定时栈中</li>
<li>将 Promise 的第一个 then 推入 microtasks 中</li>
<li>修改 outer 的属性触发监听，将 MutationObserver 推入 microtasks</li>
<li>检查 microtasks 中任务并执行</li>
<li>打印 <code class="language-text">promise</code>和<code class="language-text">mutate</code></li>
<li>第二个回调执行完毕</li>
</ul>
<p><strong>setTimeout 回调：</strong></p>
<ul>
<li>上两个 Tasks 执行完毕，检查 webapis 是否有定时任务</li>
<li>将 inner 中的 setTimeout 推入 Tasks</li>
<li>执行回调输出<code class="language-text">timeout</code></li>
<li>检查 webapis 是否有定时任务</li>
<li>将 outer 中的 setTimeout 推入 Tasks</li>
<li>执行回调输出<code class="language-text">timeout</code></li>
</ul>
<h4 id="需要注意的地方" style="position:relative;"><a href="#%E9%9C%80%E8%A6%81%E6%B3%A8%E6%84%8F%E7%9A%84%E5%9C%B0%E6%96%B9" aria-label="需要注意的地方 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>需要注意的地方</h4>
<ul>
<li>注意冒泡过程添加 Tasks 的顺序</li>
<li>Tasks 中的任务遵循先进先出的规则</li>
<li>microtasks 中的任务在每次 Tasks 时都必须检查并执行完毕</li>
</ul>
<h2 id="参考" style="position:relative;"><a href="#%E5%8F%82%E8%80%83" aria-label="参考 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>参考</h2>
<ul>
<li><a href="https://jakearchibald.com/2015/tasks-microtasks-queues-and-schedules/" target="_target" rel="nofollow">Tasks, microtasks, queues and schedules</a></li>
<li><a href="https://www.youtube.com/watch?v=8aGhZQkoFbQ" target="_target" rel="nofollow">Philip Roberts: What the heck is the event loop anyway? | JSConf EU 2014</a></li>
</ul>]]></description><link>https://xiangst0816.github.io/blog/js-shi-jian-ji-zhi/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/js-shi-jian-ji-zhi/</guid><category><![CDATA[JavaScript]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Sat, 24 Mar 2018 14:36:23 GMT</pubDate></item><item><title><![CDATA[从输入URL到页面显示过程中发生的事儿]]></title><description><![CDATA[<blockquote>
<p>占坑，内容会陆续补齐</p>
</blockquote>
<h3 id="1-url-ip" style="position:relative;"><a href="#1-url-ip" aria-label="1 url ip permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. URL->IP</h3>
<p>将输入的域名转化为真实的 IP 地址，这里涉及到 DNS 层层向外查找等内容。</p>
<h3 id="2-ip-http" style="position:relative;"><a href="#2-ip-http" aria-label="2 ip http permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. IP->HTTP</h3>
<p>拿到远端的 IP 地址，浏览器向服务器发送 HTTP 请求，包括相应的请求头</p>
<h3 id="3-http-tcp" style="position:relative;"><a href="#3-http-tcp" aria-label="3 http tcp permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. HTTP->TCP</h3>
<h3 id="4-服务端部分" style="position:relative;"><a href="#4-%E6%9C%8D%E5%8A%A1%E7%AB%AF%E9%83%A8%E5%88%86" aria-label="4 服务端部分 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. 服务端部分</h3>
<h4 id="41-负载均衡" style="position:relative;"><a href="#41-%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1" aria-label="41 负载均衡 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4.1 负载均衡</h4>
<h3 id="5-浏览器接收数据" style="position:relative;"><a href="#5-%E6%B5%8F%E8%A7%88%E5%99%A8%E6%8E%A5%E6%94%B6%E6%95%B0%E6%8D%AE" aria-label="5 浏览器接收数据 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>5. 浏览器接收数据</h3>
<h3 id="6-浏览器解析-html-流程" style="position:relative;"><a href="#6-%E6%B5%8F%E8%A7%88%E5%99%A8%E8%A7%A3%E6%9E%90-html-%E6%B5%81%E7%A8%8B" aria-label="6 浏览器解析 html 流程 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>6. 浏览器解析 HTML 流程</h3>
<p>浏览器渲染过程，资源加载同步异步</p>
<h3 id="7-浏览器资源加载过程" style="position:relative;"><a href="#7-%E6%B5%8F%E8%A7%88%E5%99%A8%E8%B5%84%E6%BA%90%E5%8A%A0%E8%BD%BD%E8%BF%87%E7%A8%8B" aria-label="7 浏览器资源加载过程 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>7. 浏览器资源加载过程</h3>
<p>keep-alive、缓存、HTTP1.0、HTTP1.1、HTTPS、HTTP2.0</p>
<h3 id="8-浏览器渲染过程" style="position:relative;"><a href="#8-%E6%B5%8F%E8%A7%88%E5%99%A8%E6%B8%B2%E6%9F%93%E8%BF%87%E7%A8%8B" aria-label="8 浏览器渲染过程 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>8. 浏览器渲染过程</h3>
<h3 id="9-渲染过程各个阶段及事件" style="position:relative;"><a href="#9-%E6%B8%B2%E6%9F%93%E8%BF%87%E7%A8%8B%E5%90%84%E4%B8%AA%E9%98%B6%E6%AE%B5%E5%8F%8A%E4%BA%8B%E4%BB%B6" aria-label="9 渲染过程各个阶段及事件 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>9. 渲染过程各个阶段及事件</h3>
<h3 id="10-javascript-执行时机及流程" style="position:relative;"><a href="#10-javascript-%E6%89%A7%E8%A1%8C%E6%97%B6%E6%9C%BA%E5%8F%8A%E6%B5%81%E7%A8%8B" aria-label="10 javascript 执行时机及流程 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>10. JavaScript 执行时机及流程</h3>
<p>JS 加载阻塞 HTML 解析，建议在 DOMContentLoaded 事件后操作 DOM。</p>
<h3 id="11-异步请求过程及跨域" style="position:relative;"><a href="#11-%E5%BC%82%E6%AD%A5%E8%AF%B7%E6%B1%82%E8%BF%87%E7%A8%8B%E5%8F%8A%E8%B7%A8%E5%9F%9F" aria-label="11 异步请求过程及跨域 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>11. 异步请求过程及跨域</h3>
<p>XMLHTTPRequest、XDomainRequest、cookie 等</p>
<h3 id="12-异步数据更新页面过程" style="position:relative;"><a href="#12-%E5%BC%82%E6%AD%A5%E6%95%B0%E6%8D%AE%E6%9B%B4%E6%96%B0%E9%A1%B5%E9%9D%A2%E8%BF%87%E7%A8%8B" aria-label="12 异步数据更新页面过程 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>12. 异步数据更新页面过程</h3>
<p>Layout->Paint->Composite</p>]]></description><link>https://xiangst0816.github.io/blog/cong-shu-ru-url-dao/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/cong-shu-ru-url-dao/</guid><category><![CDATA[随笔]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Thu, 22 Mar 2018 08:23:57 GMT</pubDate></item><item><title><![CDATA[无服务端的自动静态化Web应用]]></title><description><![CDATA[<blockquote>
<p>这里介绍的不是 SPA 和 PWA。</p>
</blockquote>
<p>我觉得这可能是未来<strong>前后端分离的新方式</strong>，因为：</p>
<h3 id="更快的页面显示" style="position:relative;"><a href="#%E6%9B%B4%E5%BF%AB%E7%9A%84%E9%A1%B5%E9%9D%A2%E6%98%BE%E7%A4%BA" aria-label="更快的页面显示 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>更快的页面显示</h3>
<p>项目在构建时就能生成对应路由的静态页面，用户访问网页就能提前触发<code class="language-text">DomContentLoaded</code>事件并渲染页面。这个在后面的一篇文章<a href="/blog/ssr-xiang-guan-wen-da/">《SSR 相关》</a>有介绍。</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 840px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 53.333333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDAFA3PEY8MlBGQUZaVVBfeMiCeG5uePWvuZHI////////////////////////////////////////////////////2wBDAVVaWnhpeOuCguv/////////////////////////////////////////////////////////////////////////wgARCAALABQDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAL/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAFMikj/xAAXEAADAQAAAAAAAAAAAAAAAAACEBEg/9oACAEBAAEFAiUx/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAGhAAAgIDAAAAAAAAAAAAAAAAABEBEEFRYf/aAAgBAQABPyFXAuUwOd1//9oADAMBAAIAAwAAABAQD//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EAB0QAQABBQADAAAAAAAAAAAAAAEAETFBUWFxgZH/2gAIAQEAAT8QIpBaxBZo9SjYeZt2dn2KuWf/2Q=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="SSR juejin"
        title="SSR juejin"
        src="/blog/static/f4ba33008c16b3914bd880d93a7c13bd/17354/SSR-juejin.jpg"
        srcset="/blog/static/f4ba33008c16b3914bd880d93a7c13bd/58c35/SSR-juejin.jpg 210w,
/blog/static/f4ba33008c16b3914bd880d93a7c13bd/0d24e/SSR-juejin.jpg 420w,
/blog/static/f4ba33008c16b3914bd880d93a7c13bd/17354/SSR-juejin.jpg 840w,
/blog/static/f4ba33008c16b3914bd880d93a7c13bd/61048/SSR-juejin.jpg 1024w"
        sizes="(max-width: 840px) 100vw, 840px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<h3 id="更方便的部署" style="position:relative;"><a href="#%E6%9B%B4%E6%96%B9%E4%BE%BF%E7%9A%84%E9%83%A8%E7%BD%B2" aria-label="更方便的部署 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>更方便的部署</h3>
<p>前端项目骨架都静态化，因此资源可以走 CDN，这个没什么好说的。页面动态部分通过接口获取，可以使用 RESTAPI 也可以是 GraphQL。这样相对于传统的网页项目来说，静态化的方案可以大大节省服务器的资源。</p>
<h3 id="解决方案成熟" style="position:relative;"><a href="#%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E6%88%90%E7%86%9F" aria-label="解决方案成熟 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>解决方案成熟</h3>
<p><strong>1. React -> Gatsby</strong></p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 775px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 86.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsSAAALEgHS3X78AAACE0lEQVQ4y3VUyW4TQRD1//8BcEfcuHCJkODEASFxSSISyYeExQErxLN4eu9+VFV3jSdDMlbZ4+pXr2t53ZtSCqoBOWey0iyBXMD+C3D5EuXiFcqfr8jkKoTjmJyW+MqziSHB2QBrgjgTgWJMCD7C+QKzu4bbvkf+8RG5u0GIgCe8I7ySckzwCcy14T/d/YSbb3uMnSVw5LwENB4Mvm973O0CjANtQNmVjIH8P7f3GB4MpsEhuCTVMalkyNnxYv8wwbsgGXoXBZAS7xxoIy9rgSsi/NgZdH8nmKOXaqoRYa2/9oQ//J6kN3kuJ0b+LbNP+8WPxCeNoR7KQinzwuMmZwkqV6/FKsEC0/AyPaFhQnZQXKYMuMylcTskEbMD7J28J8p2jWOfEOZGWNouTMp90P7x9Pn58PYKZ28uaoapZqYYxVdSzbCxr0l14p/PrvHp3WUjrNmkZ0hlys+R1ilnmj7J4zCQP0rZiluSaos2Gvg0KYFJyb7JguW0xinpTMhfusv/pFl0ZkYnAj6S9risp3CnDBvhknRpkTKzJhIxnZajO01/gUGbvhCKoJtQZ8HOF0YTb3BiRYW8wFVD1StPeRboStQiYC4nerpp6LY5f7FaL49OyXxSZom4KGd6Gr3YsXfSv9+3B9yeb8X2v3rxKYbN2ZPAgw5FJ10PvRWy4WAx9lYujaEjf1/XdJ2N35lQ45nrH8gEMgvJ7lWKAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="gatsby"
        title="gatsby"
        src="/blog/static/066d0f4484f98775350d61a0584ca603/ae83b/gatsby.png"
        srcset="/blog/static/066d0f4484f98775350d61a0584ca603/e1650/gatsby.png 210w,
/blog/static/066d0f4484f98775350d61a0584ca603/8cae7/gatsby.png 420w,
/blog/static/066d0f4484f98775350d61a0584ca603/ae83b/gatsby.png 775w"
        sizes="(max-width: 775px) 100vw, 775px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<p><strong>2. Vue -> Nuxt</strong></p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 840px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 58.57142857142858%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAABs0lEQVQoz41Tz0sCURD2n+hvqEv9DV07dLZDUoegIDoUlFARBEIQQRgIIdGlS4eoQ3TIDhVBRQcTDAwqZatdXfeHqz7ddX99PVfXdFNy2OG9mfd2Zr5v5vlAxbZttK+utPt7qfc/n7uxmk6OyNhOnOFLzndN4hXvuc/NZFqW4winLjAYmcVYcAlSpeT4qqoKXddhmiZUVUOtpkOUFeozuldo2Y1gz0IaIyeLGJrwY2B4FKtHUVimhcvre8Ru7lEmFVzdPiDx8oqneNKx/wSsG27AU+YRK7FDrIX2ENzcxcZBFCJR8M3yiCdTyDDfeEszYLM8ZKUIq4nqD2Q4XzOL/ntomTYKRQJSUWEYJpRSY18mKjRN72hYB2TXoVFuPhgO7xkOOV5GXqDVcSK4nEQ5K0GQirQ6iaqIvKj0DujlgahVlKnW1xptBqlUW1qivGlarecEtCp0x4aVRATCIczt72A6soXzmzv4Z5YxtbCOwPwqxicXEDk8blBCOfy3Qt00wORzyPBZMEIORUJoM1ikaUMynyyl45NCL3SF2xGwnyHu566v2zOrj5Grjk2htav3SbbLD2JojAqkN9oQAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="ssr nuxt"
        title="ssr nuxt"
        src="/blog/static/e086affc2033c78f88bff4a9b88e56ea/f88f5/ssr-nuxt.png"
        srcset="/blog/static/e086affc2033c78f88bff4a9b88e56ea/e1650/ssr-nuxt.png 210w,
/blog/static/e086affc2033c78f88bff4a9b88e56ea/8cae7/ssr-nuxt.png 420w,
/blog/static/e086affc2033c78f88bff4a9b88e56ea/f88f5/ssr-nuxt.png 840w,
/blog/static/e086affc2033c78f88bff4a9b88e56ea/61546/ssr-nuxt.png 982w"
        sizes="(max-width: 840px) 100vw, 840px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></p>
<h2 id="参考" style="position:relative;"><a href="#%E5%8F%82%E8%80%83" aria-label="参考 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>参考</h2>
<ul>
<li><a href="https://www.gatsbyjs.org/blog/2017-09-13-why-is-gatsby-so-fast/" target="_target" rel="nofollow">Web Performance 101—also, why is Gatsby so fast?</a></li>
<li><a href="https://www.gatsbyjs.org/" target="_target" rel="nofollow">Gatsby</a></li>
<li><a href="https://zh.nuxtjs.org/" target="_target" rel="nofollow">Nuxtjs</a></li>
</ul>]]></description><link>https://xiangst0816.github.io/blog/wu-fu-wu-duan-de/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/wu-fu-wu-duan-de/</guid><category><![CDATA[静态化]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Thu, 22 Mar 2018 05:38:46 GMT</pubDate></item><item><title><![CDATA[第二十二章 高级技巧]]></title><description><![CDATA[<h3 id="1-类型检测的方式有哪些-使用场景是" style="position:relative;"><a href="#1-%E7%B1%BB%E5%9E%8B%E6%A3%80%E6%B5%8B%E7%9A%84%E6%96%B9%E5%BC%8F%E6%9C%89%E5%93%AA%E4%BA%9B-%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF%E6%98%AF" aria-label="1 类型检测的方式有哪些 使用场景是 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 类型检测的方式有哪些, 使用场景是?</h3>
<ul>
<li>使用 typeof 检测基础类型</li>
<li>使用 instanceof 检测引用类型</li>
<li>使用 Object.prototype.toString.call(value)可以处理大部分情况</li>
</ul>
<h3 id="2-如果类没有用code-classlanguage-textnewcode关键字初始化一般会造成什么后果-怎么避免" style="position:relative;"><a href="#2-%E5%A6%82%E6%9E%9C%E7%B1%BB%E6%B2%A1%E6%9C%89%E7%94%A8code-classlanguage-textnewcode%E5%85%B3%E9%94%AE%E5%AD%97%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%80%E8%88%AC%E4%BC%9A%E9%80%A0%E6%88%90%E4%BB%80%E4%B9%88%E5%90%8E%E6%9E%9C-%E6%80%8E%E4%B9%88%E9%81%BF%E5%85%8D" aria-label="2 如果类没有用code classlanguage textnewcode关键字初始化一般会造成什么后果 怎么避免 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 如果类没有用<code class="language-text">new</code>关键字初始化一般会造成什么后果, 怎么避免?</h3>
<p>在构造函数中的属性会污染全局变量<code class="language-text">window</code>, 可以在构造函数中通过<code class="language-text">instanceof</code>判断下当前实例的构造函数是不是自己, 如果不是则使用<code class="language-text">new</code>方法返回.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> job</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token keyword">instanceof</span> <span class="token class-name">Person</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>job <span class="token operator">=</span> job<span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> job<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<h3 id="3-补充一个完整类继承及实例化的示例" style="position:relative;"><a href="#3-%E8%A1%A5%E5%85%85%E4%B8%80%E4%B8%AA%E5%AE%8C%E6%95%B4%E7%B1%BB%E7%BB%A7%E6%89%BF%E5%8F%8A%E5%AE%9E%E4%BE%8B%E5%8C%96%E7%9A%84%E7%A4%BA%E4%BE%8B" aria-label="3 补充一个完整类继承及实例化的示例 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. 补充一个完整类继承及实例化的示例?</h3>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// 1. 父类定义</span>
<span class="token keyword">function</span> <span class="token function">SuperType</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token keyword">instanceof</span> <span class="token class-name">SuperType</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"red"</span><span class="token punctuation">,</span> <span class="token string">"blue"</span><span class="token punctuation">,</span> <span class="token string">"green"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">SuperType</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token class-name">SuperType</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">sayName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 2. 子类定义</span>
<span class="token keyword">function</span> <span class="token function">SubType</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token keyword">instanceof</span> <span class="token class-name">SubType</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 2.1 继承了 SuperType 构造函数中定义的属性</span>
    <span class="token function">SuperType</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 2.2 子类自己的属性</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">SubType</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> age<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 父类原型链复制</span>
<span class="token class-name">SubType</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">SuperType</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 因为使用“.prototype =...”后,constructor会改变为“=...”的那个</span>
<span class="token comment">// constructor，所以要重新指定.constructor 为自身。</span>
<span class="token class-name">SubType</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> SubType<span class="token punctuation">;</span>
<span class="token class-name">SubType</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">sayAge</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<p><strong>补充 Object.create 的 polyfill:</strong></p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>create <span class="token operator">===</span> <span class="token string">'undefined'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">create</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">proto</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">function</span> <span class="token constant">F</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
            <span class="token class-name">F</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> proto
            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div>
<h3 id="4-讲一个惰性函数的实例场景-优缺点" style="position:relative;"><a href="#4-%E8%AE%B2%E4%B8%80%E4%B8%AA%E6%83%B0%E6%80%A7%E5%87%BD%E6%95%B0%E7%9A%84%E5%AE%9E%E4%BE%8B%E5%9C%BA%E6%99%AF-%E4%BC%98%E7%BC%BA%E7%82%B9" aria-label="4 讲一个惰性函数的实例场景 优缺点 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. 讲一个惰性函数的实例场景, 优缺点?</h3>
<ul>
<li>优点: 避免不必要分支执行</li>
<li>缺点: 运行第一次牺牲点性能</li>
<li>适用于初次运行就能确定分支方向的场景, 比如能力判断/平台判断等</li>
</ul>
<p><strong>两种写法:</strong></p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>xx1<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">doSomething</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">doSomething</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token function">doSomething</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> doSomething <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>xx1<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<h3 id="5-code-classlanguage-textbindcode函数使用场景及优缺点" style="position:relative;"><a href="#5-code-classlanguage-textbindcode%E5%87%BD%E6%95%B0%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF%E5%8F%8A%E4%BC%98%E7%BC%BA%E7%82%B9" aria-label="5 code classlanguage textbindcode函数使用场景及优缺点 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>5. <code class="language-text">bind()</code>函数使用场景及优缺点?</h3>
<p>支持原生<code class="language-text">bind()</code>函数的浏览器有: IE9+/Firefox4+/Chrome 等, 其他浏览器需要 Polyfill:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>bind <span class="token operator">===</span> <span class="token string">"undefined"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Function</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">bind</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> _self <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">_self</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<ul>
<li><code class="language-text">bind()</code>函数固定了执行环境, 对于异步环境保持<code class="language-text">this</code>指向有很大帮助</li>
<li>类似于: <code class="language-text">setTimeout</code>/<code class="language-text">setInterval</code>/事件绑定等</li>
<li>与普通函数相比会使用更多开销和内存, 使用时注意</li>
</ul>
<h3 id="6-如何理解函数柯里化" style="position:relative;"><a href="#6-%E5%A6%82%E4%BD%95%E7%90%86%E8%A7%A3%E5%87%BD%E6%95%B0%E6%9F%AF%E9%87%8C%E5%8C%96" aria-label="6 如何理解函数柯里化 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>6. 如何理解函数柯里化?</h3>
<p>函数柯里化：用于创建一个已经设置好一个或多个参数的函数。简单的说，对函数的一次分装，简化操作的方式。这个过程需要创建一个闭包，指定某个入参后返回新函数。</p>
<p>这个过程可能会用到：<code class="language-text">call</code>、<code class="language-text">apply</code>、<code class="language-text">Array.prototype.slice.call(arguments, n)</code>、<code class="language-text">bind</code>等函数。</p>
<h3 id="7-在编写库时-如何防止核心对象被意外修改" style="position:relative;"><a href="#7-%E5%9C%A8%E7%BC%96%E5%86%99%E5%BA%93%E6%97%B6-%E5%A6%82%E4%BD%95%E9%98%B2%E6%AD%A2%E6%A0%B8%E5%BF%83%E5%AF%B9%E8%B1%A1%E8%A2%AB%E6%84%8F%E5%A4%96%E4%BF%AE%E6%94%B9" aria-label="7 在编写库时 如何防止核心对象被意外修改 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>7. 在编写库时, 如何防止核心对象被意外修改?</h3>
<p>根据对象防篡改等级, 可以分为以下几种:</p>
<h4 id="第一级-不可扩展对象code-classlanguage-textobjectpreventextensionsobjcode" style="position:relative;"><a href="#%E7%AC%AC%E4%B8%80%E7%BA%A7-%E4%B8%8D%E5%8F%AF%E6%89%A9%E5%B1%95%E5%AF%B9%E8%B1%A1code-classlanguage-textobjectpreventextensionsobjcode" aria-label="第一级 不可扩展对象code classlanguage textobjectpreventextensionsobjcode permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>第一级: <strong>不可扩展对象<code class="language-text">Object.preventExtensions(obj)</code></strong></h4>
<ul>
<li>不可再添加属性和方法</li>
<li>已有属性和方法不受影响</li>
<li>通过<code class="language-text">Object.isExtensible(obj)</code>判断是否可拓展</li>
</ul>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> person <span class="token operator">=</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">"Nicholas"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
Object<span class="token punctuation">.</span><span class="token function">preventExtensions</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">;</span>

person<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">29</span><span class="token punctuation">;</span>
<span class="token function">alert</span><span class="token punctuation">(</span>person<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//undefined</span></code></pre></div>
<h4 id="第二级-密封对象code-classlanguage-textobjectsealobjcode" style="position:relative;"><a href="#%E7%AC%AC%E4%BA%8C%E7%BA%A7-%E5%AF%86%E5%B0%81%E5%AF%B9%E8%B1%A1code-classlanguage-textobjectsealobjcode" aria-label="第二级 密封对象code classlanguage textobjectsealobjcode permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>第二级: <strong>密封对象<code class="language-text">Object.seal(obj)</code></strong></h4>
<ul>
<li>继承上一级</li>
<li>已有成员不可删除, 但属性值可修改</li>
<li>通过<code class="language-text">Object.isSealed(obj)</code>判断是否被密封</li>
</ul>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> person <span class="token operator">=</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">"Nicholas"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
Object<span class="token punctuation">.</span><span class="token function">seal</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">;</span>

person<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">29</span><span class="token punctuation">;</span>
<span class="token function">alert</span><span class="token punctuation">(</span>person<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//undefined</span>

<span class="token keyword">delete</span> person<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
<span class="token function">alert</span><span class="token punctuation">(</span>person<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//"Nicholas"</span></code></pre></div>
<h4 id="第三级-冻结对象code-classlanguage-textobjectfreezeobjcode" style="position:relative;"><a href="#%E7%AC%AC%E4%B8%89%E7%BA%A7-%E5%86%BB%E7%BB%93%E5%AF%B9%E8%B1%A1code-classlanguage-textobjectfreezeobjcode" aria-label="第三级 冻结对象code classlanguage textobjectfreezeobjcode permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>第三级: <strong>冻结对象<code class="language-text">Object.freeze(obj)</code></strong></h4>
<ul>
<li>继承上两级</li>
<li>以后成员不可修改</li>
<li>如果要修改需要重新定义<code class="language-text">[[set]]</code>函数</li>
<li>通过<code class="language-text">Object.isFrozen(obj)</code>判断是否被冻结</li>
</ul>
<h4 id="函数设计的意义" style="position:relative;"><a href="#%E5%87%BD%E6%95%B0%E8%AE%BE%E8%AE%A1%E7%9A%84%E6%84%8F%E4%B9%89" aria-label="函数设计的意义 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>函数设计的意义</h4>
<p>对 JavaScript 库的作者而言，冻结对象是很有用的。因为 JavaScript 库最怕有人意外（或有意）地修 改了库中的核心对象。冻结（或密封）主要的库对象能够防止这些问题的发生。</p>
<h3 id="8-javascript-的定时器相关点" style="position:relative;"><a href="#8-javascript-%E7%9A%84%E5%AE%9A%E6%97%B6%E5%99%A8%E7%9B%B8%E5%85%B3%E7%82%B9" aria-label="8 javascript 的定时器相关点 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>8. JavaScript 的定时器相关点</h3>
<ul>
<li>JavaScript 运行在<strong>单线程</strong>环境中, 某个时刻只有一个代码在执行.</li>
<li>异步代码会被推入独立的<strong>异步队列(Tasks)</strong></li>
<li>在 JavaScript 中<strong>代码不会立刻执行</strong>的，但<strong>一旦进程空闲则尽快执行</strong></li>
<li>浏览器在这个过程中只负责排序调度, 指派某段代码在某个时间点运行的优先级.</li>
<li>定时器队列是一个特殊的队列, 当定时的时间到了, 就将代码插入异步队列</li>
<li>定时器中设定的时间<strong>表示何时将定时器的代码添加到异步队列</strong>, 而不是何时执行代码</li>
<li>队列中的所有代码都要<strong>等到 JavaScript 进程空闲后才能执行</strong>, 而不管他们是如何添加到队列中</li>
<li>即使执行完一个异步代码(Tasks）, <strong>也会有一个很短的时间间隔</strong>, 用于处理页面上的其他事情(UI 更新), 防止页面锁定</li>
</ul>
<h3 id="9-每个-tasks-异步都是紧挨着立即执行吗" style="position:relative;"><a href="#9-%E6%AF%8F%E4%B8%AA-tasks-%E5%BC%82%E6%AD%A5%E9%83%BD%E6%98%AF%E7%B4%A7%E6%8C%A8%E7%9D%80%E7%AB%8B%E5%8D%B3%E6%89%A7%E8%A1%8C%E5%90%97" aria-label="9 每个 tasks 异步都是紧挨着立即执行吗 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>9. 每个 Tasks 异步都是紧挨着立即执行吗?</h3>
<p>不是, 中间会有段时间间隔以便 UI 等工作，当 JavaScript 主进程空闲时, 才将 Tasks 中的异步代码插入 stack 中。</p>
<h3 id="10-当code-classlanguage-textsetintervalcode中的函数处理时间超过设置的间隔会发生什么问题-怎么避免或修复" style="position:relative;"><a href="#10-%E5%BD%93code-classlanguage-textsetintervalcode%E4%B8%AD%E7%9A%84%E5%87%BD%E6%95%B0%E5%A4%84%E7%90%86%E6%97%B6%E9%97%B4%E8%B6%85%E8%BF%87%E8%AE%BE%E7%BD%AE%E7%9A%84%E9%97%B4%E9%9A%94%E4%BC%9A%E5%8F%91%E7%94%9F%E4%BB%80%E4%B9%88%E9%97%AE%E9%A2%98-%E6%80%8E%E4%B9%88%E9%81%BF%E5%85%8D%E6%88%96%E4%BF%AE%E5%A4%8D" aria-label="10 当code classlanguage textsetintervalcode中的函数处理时间超过设置的间隔会发生什么问题 怎么避免或修复 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>10. 当<code class="language-text">setInterval</code>中的函数处理时间超过设置的间隔会发生什么问题, 怎么避免或修复?</h3>
<p><strong>注意点：</strong></p>
<p>当在 Tasks 队列中<strong>没有</strong>该定时器的任何其他代码实例时，<strong>才将定时器代码添加到队列中</strong>。这确保<strong>定时器代码被加入到 Tasks 队列中</strong>的<strong>最短时间间隔</strong>为指定的间隔。<mark>这里是加入到 Tasks 队列，不是立即执行。</mark></p>
<p>因此：</p>
<ul>
<li>某些定时器回调会被<strong>跳过</strong></li>
<li>多个定时器代码<strong>执行之间的间隔</strong>会比预期小</li>
</ul>
<p>可以使用两个<code class="language-text">setTimeout</code>解决：</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//处理中</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span>arguments<span class="token punctuation">.</span>callee<span class="token punctuation">,</span> interval<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> interval<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<h3 id="11-如果一个-js-函数执行时间接近-1s-如何优化执行不会让-ui-卡顿" style="position:relative;"><a href="#11-%E5%A6%82%E6%9E%9C%E4%B8%80%E4%B8%AA-js-%E5%87%BD%E6%95%B0%E6%89%A7%E8%A1%8C%E6%97%B6%E9%97%B4%E6%8E%A5%E8%BF%91-1s-%E5%A6%82%E4%BD%95%E4%BC%98%E5%8C%96%E6%89%A7%E8%A1%8C%E4%B8%8D%E4%BC%9A%E8%AE%A9-ui-%E5%8D%A1%E9%A1%BF" aria-label="11 如果一个 js 函数执行时间接近 1s 如何优化执行不会让 ui 卡顿 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>11. 如果一个 JS 函数执行时间接近 1s, 如何优化执行不会让 UI 卡顿?</h3>
<ul>
<li>不必要的<strong>同步部分</strong>放入 setTimeout 中</li>
<li>使用问题 10 中的方式处理，间隔时间设为 0</li>
</ul>
<h3 id="12-函数防抖是如何控制调用执行的次数的" style="position:relative;"><a href="#12-%E5%87%BD%E6%95%B0%E9%98%B2%E6%8A%96%E6%98%AF%E5%A6%82%E4%BD%95%E6%8E%A7%E5%88%B6%E8%B0%83%E7%94%A8%E6%89%A7%E8%A1%8C%E7%9A%84%E6%AC%A1%E6%95%B0%E7%9A%84" aria-label="12 函数防抖是如何控制调用执行的次数的 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>12. 函数防抖是如何控制调用执行的次数的?</h3>
<p><code class="language-text">clearTimeout</code>和<code class="language-text">setTimeout</code>的组合使用</p>
<h3 id="13-debounce-和-throttle-两个函数的区别" style="position:relative;"><a href="#13-debounce-%E5%92%8C-throttle-%E4%B8%A4%E4%B8%AA%E5%87%BD%E6%95%B0%E7%9A%84%E5%8C%BA%E5%88%AB" aria-label="13 debounce 和 throttle 两个函数的区别 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>13. debounce 和 throttle 两个函数的区别?</h3>
<p><strong>debounce</strong>：</p>
<p>防抖函数，多次触发只执行最后一次，保证 ideal 时间。比如 input 联想、window 的 resize 事件。</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">debounce</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> delay<span class="token punctuation">,</span> context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  fn<span class="token punctuation">.</span>timer <span class="token operator">&amp;&amp;</span> <span class="token function">clearTimeout</span><span class="token punctuation">(</span>fn<span class="token punctuation">.</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>
  fn<span class="token punctuation">.</span>timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">clearTimeout</span><span class="token punctuation">(</span>fn<span class="token punctuation">.</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>
    fn<span class="token punctuation">.</span>timer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> delay<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">clear</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">clearTimeout</span><span class="token punctuation">(</span>fn<span class="token punctuation">.</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>
      fn<span class="token punctuation">.</span>timer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p><strong>需要注意的地方:</strong></p>
<ul>
<li>计时器 timer 放在要处理的函数上, 因为是引用关系, 下次进入能携带 timer 信息</li>
<li>每次执行完毕记得清理 timer 信息, 防止下次调用产生问题</li>
<li>clear 主要作用是清理定时器</li>
</ul>
<p><strong>throttle</strong>：</p>
<p>节流函数，根据时间节奏触发，保证间隔。比如点击事件保证间隔，scroll 时控制在 16.6ms 内执行一次等。</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">throttle</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> delay<span class="token punctuation">,</span> context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>fn<span class="token punctuation">.</span>timer<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
  fn<span class="token punctuation">.</span>timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">clearTimeout</span><span class="token punctuation">(</span>fn<span class="token punctuation">.</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>
    fn<span class="token punctuation">.</span>timer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> delay<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">clear</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">clearTimeout</span><span class="token punctuation">(</span>fn<span class="token punctuation">.</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>
      fn<span class="token punctuation">.</span>timer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p><strong>需要注意的地方:</strong></p>
<ul>
<li>计时器 timer 放在要处理的函数上, 因为是引用关系, 下次进入能携带 timer 信息</li>
<li>每次执行完毕记得清理 timer 信息, 防止下次调用产生问题</li>
<li>先设置定时, 再去 call 函数</li>
</ul>
<h3 id="14-实现一个自定义事件库需要用到哪个设计模式" style="position:relative;"><a href="#14-%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E8%87%AA%E5%AE%9A%E4%B9%89%E4%BA%8B%E4%BB%B6%E5%BA%93%E9%9C%80%E8%A6%81%E7%94%A8%E5%88%B0%E5%93%AA%E4%B8%AA%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F" aria-label="14 实现一个自定义事件库需要用到哪个设计模式 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>14. 实现一个自定义事件库需要用到哪个设计模式?</h3>
<p>观察者模式</p>
<h3 id="15-设计自定义事件库必须具备的功能有哪些" style="position:relative;"><a href="#15-%E8%AE%BE%E8%AE%A1%E8%87%AA%E5%AE%9A%E4%B9%89%E4%BA%8B%E4%BB%B6%E5%BA%93%E5%BF%85%E9%A1%BB%E5%85%B7%E5%A4%87%E7%9A%84%E5%8A%9F%E8%83%BD%E6%9C%89%E5%93%AA%E4%BA%9B" aria-label="15 设计自定义事件库必须具备的功能有哪些 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>15. 设计自定义事件库必须具备的功能有哪些?</h3>
<ul>
<li>定义一个 hash 对象，key 为事件名，value 为回调函数数组</li>
<li>事件包括的方法有：on、off、once、emit</li>
<li>参考这个库的设计: <a href="https://github.com/typescript-practice/events" target="_target" rel="nofollow">events</a></li>
</ul>
<h3 id="16-简述拖放实现的方式是" style="position:relative;"><a href="#16-%E7%AE%80%E8%BF%B0%E6%8B%96%E6%94%BE%E5%AE%9E%E7%8E%B0%E7%9A%84%E6%96%B9%E5%BC%8F%E6%98%AF" aria-label="16 简述拖放实现的方式是 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>16. 简述拖放实现的方式是?</h3>
<p>监听 mousedown、mouseup、mousemove 事件然后进行相应处理。</p>
<ul>
<li>mousedown：记录拖动元素</li>
<li>mousemove：对拖动元素修改 style 的 top、left 属性</li>
<li>mouseup：清理操作</li>
</ul>]]></description><link>https://xiangst0816.github.io/blog/di-er-shi-er-zhang/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/di-er-shi-er-zhang/</guid><category><![CDATA[JS高程]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Wed, 21 Mar 2018 12:14:54 GMT</pubDate></item><item><title><![CDATA[第二十一章 Ajax与Comet]]></title><description><![CDATA[<h3 id="1-xmlhttprequestd-对象发送请求的步骤-使用code-classlanguage-textgetcode和code-classlanguage-textpostcode方法举例" style="position:relative;"><a href="#1-xmlhttprequestd-%E5%AF%B9%E8%B1%A1%E5%8F%91%E9%80%81%E8%AF%B7%E6%B1%82%E7%9A%84%E6%AD%A5%E9%AA%A4-%E4%BD%BF%E7%94%A8code-classlanguage-textgetcode%E5%92%8Ccode-classlanguage-textpostcode%E6%96%B9%E6%B3%95%E4%B8%BE%E4%BE%8B" aria-label="1 xmlhttprequestd 对象发送请求的步骤 使用code classlanguage textgetcode和code classlanguage textpostcode方法举例 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. XMLHttpRequestd 对象发送请求的步骤, 使用<code class="language-text">get</code>和<code class="language-text">post</code>方法举例?</h3>
<ol>
<li>创建 xhr 实例</li>
<li>open 一个请求</li>
<li>设置 header</li>
<li>send 请求</li>
<li>如果满足条件可以 abort</li>
</ol>
<p><strong>get()同步示例:</strong></p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">"get"</span><span class="token punctuation">,</span> <span class="token string">"example.txt"</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
xhr<span class="token punctuation">.</span><span class="token function">setRequestHeader</span><span class="token punctuation">(</span><span class="token string">"MyHeader"</span><span class="token punctuation">,</span> <span class="token string">"MyValue"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>status <span class="token operator">>=</span> <span class="token number">200</span> <span class="token operator">&amp;&amp;</span> xhr<span class="token punctuation">.</span>status <span class="token operator">&lt;</span> <span class="token number">300</span><span class="token punctuation">)</span> <span class="token operator">||</span> xhr<span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token number">304</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>responseText<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"Request was unsuccessful: "</span> <span class="token operator">+</span> xhr<span class="token punctuation">.</span>status<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p><strong>get()异步示例:</strong></p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
xhr<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>readyState <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>status <span class="token operator">>=</span> <span class="token number">200</span> <span class="token operator">&amp;&amp;</span> xhr<span class="token punctuation">.</span>status <span class="token operator">&lt;</span> <span class="token number">300</span><span class="token punctuation">)</span> <span class="token operator">||</span> xhr<span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token number">304</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">alert</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>responseText<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"Request was unsuccessful: "</span> <span class="token operator">+</span> xhr<span class="token punctuation">.</span>status<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">"get"</span><span class="token punctuation">,</span> <span class="token string">"example.txt"</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
xhr<span class="token punctuation">.</span><span class="token function">setRequestHeader</span><span class="token punctuation">(</span><span class="token string">"MyHeader"</span><span class="token punctuation">,</span> <span class="token string">"MyValue"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p><strong>post()示例:</strong></p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
xhr<span class="token punctuation">.</span><span class="token function-variable function">onreadystatechange</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>readyState <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>status <span class="token operator">>=</span> <span class="token number">200</span> <span class="token operator">&amp;&amp;</span> xhr<span class="token punctuation">.</span>status <span class="token operator">&lt;</span> <span class="token number">300</span><span class="token punctuation">)</span> <span class="token operator">||</span> xhr<span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token number">304</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">alert</span><span class="token punctuation">(</span>xhr<span class="token punctuation">.</span>responseText<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"Request was unsuccessful: "</span> <span class="token operator">+</span> xhr<span class="token punctuation">.</span>status<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">"post"</span><span class="token punctuation">,</span> <span class="token string">"postexample.php"</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 模拟表单</span>
xhr<span class="token punctuation">.</span><span class="token function">setRequestHeader</span><span class="token punctuation">(</span><span class="token string">"Content-Type"</span><span class="token punctuation">,</span> <span class="token string">"application/x-www-form-urlencoded"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> form <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"user-info"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span>form<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p><strong>注意点:</strong></p>
<ul>
<li>如果是相对路径, 则 URL 相对于执行代码的当前页面</li>
<li>调用** <code class="language-text">open()</code> 方法并不会真正发送请求， 而只是启动一个请求以备发送**</li>
<li>调用 <code class="language-text">send()</code> 之后，请求就会被分派到服务器</li>
<li>通过<code class="language-text">xhr.status</code>来检测返回状态, responseText 返回响应结果</li>
<li>异步需要注册<code class="language-text">xhr.onreadystatechange</code>回调, 通过<code class="language-text">xhr.readyState</code>查看请求状态(0: 请求未初始化; 1: 请求已建立但未发送; 2: 请求已发送在处理; 3: 请求在处理, 数据没全部接受, 可多次触发; 4: 响应已完成;), 通过<code class="language-text">xhr.status</code>判断结果状态</li>
<li>在接收到响应之前还可以调用 <code class="language-text">abort()</code> 方法来取消异步请求, 执行之后 XHR 不再触发事件.</li>
<li>要成功发送请求头部信息，必须在调用 open()方法之后且调用 send()方法 之前调用 setRequestHeader()</li>
<li>只有部分的浏览器头部信息可以重写, 这个和浏览器有关</li>
<li>如果设置了超时, 则超时后会触发<code class="language-text">xhr.readyState == 4</code>的状态, 但是 xhr 对象不可再访问, 建议在 try-catch 包裹</li>
</ul>
<h3 id="2-上传文件的思路是什么-如何给出进度信息" style="position:relative;"><a href="#2-%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6%E7%9A%84%E6%80%9D%E8%B7%AF%E6%98%AF%E4%BB%80%E4%B9%88-%E5%A6%82%E4%BD%95%E7%BB%99%E5%87%BA%E8%BF%9B%E5%BA%A6%E4%BF%A1%E6%81%AF" aria-label="2 上传文件的思路是什么 如何给出进度信息 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 上传文件的思路是什么, 如何给出进度信息?</h3>
<ul>
<li>onloadstart 事件开始</li>
<li>onprogress 事件在接收期间不断响应</li>
</ul>
<h3 id="3-解释下跨域" style="position:relative;"><a href="#3-%E8%A7%A3%E9%87%8A%E4%B8%8B%E8%B7%A8%E5%9F%9F" aria-label="3 解释下跨域 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. 解释下跨域?</h3>
<p>当协议(protocol)/IP/端口(port)三者一个不相同就出现跨域.</p>
<h3 id="4-preflight-request-是什么-跨域时发送的code-classlanguage-textoptionscode请求的原因" style="position:relative;"><a href="#4-preflight-request-%E6%98%AF%E4%BB%80%E4%B9%88-%E8%B7%A8%E5%9F%9F%E6%97%B6%E5%8F%91%E9%80%81%E7%9A%84code-classlanguage-textoptionscode%E8%AF%B7%E6%B1%82%E7%9A%84%E5%8E%9F%E5%9B%A0" aria-label="4 preflight request 是什么 跨域时发送的code classlanguage textoptionscode请求的原因 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. Preflight Request 是什么? 跨域时发送的<code class="language-text">OPTIONS</code>请求的原因?</h3>
<p><strong>CORS</strong>（Cross-Origin Resource Sharing，跨源资源共享）背后的基本思想:</p>
<blockquote>
<p><strong>使用自定义的 HTTP 头部让浏览器与服务器沟通, 从而决定请求或响应是应该成功, 还是应该失败.</strong></p>
</blockquote>
<p>CORS 通过 Preflight Request 机制向服务器验证请求. 这种请求使用<code class="language-text">OPTIONS</code>方法发送, 包含:</p>
<ul>
<li>Origin：与简单的请求相同。</li>
<li>Access-Control-Request-Method：请求自身使用的方法。</li>
<li>Access-Control-Request-Headers：（可选）自定义的头部信息，多个头部以逗号分隔。</li>
</ul>
<p>服务器根据发来的请求判断是否回应, 如果回应则发送下列信息:</p>
<ul>
<li>Access-Control-Allow-Origin：与简单的请求相同。</li>
<li>Access-Control-Allow-Methods：允许的方法，多个方法以逗号分隔。</li>
<li>Access-Control-Allow-Headers：允许的头部，多个头部以逗号分隔。</li>
<li>Access-Control-Max-Age：应该将这个 Preflight 请求缓存多长时间（以秒表示）。</li>
</ul>
<p>为此付出的代价<strong>只是第一次发送这种请求时会多一次 HTTP 请求</strong>.</p>
<blockquote>
<p>注意:</p>
<ol>
<li>这个机制, <strong>IE 10 及更早版本</strong>都不支持</li>
<li>这个过程一般是<strong>不携带 cookie 等信息</strong>, 除非设置<code class="language-text">xhr.withCredentials=true</code></li>
<li>如果发送的是带凭证的请求但是服务器响应中没包含这个头部, 则浏览器就不会把响应交给 JavaScript. 于是，responseText 中将是空字符串，status 的值为 0，而且会调用 onerror()事件处理程序</li>
</ol>
</blockquote>
<h3 id="5-使用-axios-在-ie10-跨域发送code-classlanguage-textoptioncode无法携带-cookie-等验证信息怎么解决" style="position:relative;"><a href="#5-%E4%BD%BF%E7%94%A8-axios-%E5%9C%A8-ie10-%E8%B7%A8%E5%9F%9F%E5%8F%91%E9%80%81code-classlanguage-textoptioncode%E6%97%A0%E6%B3%95%E6%90%BA%E5%B8%A6-cookie-%E7%AD%89%E9%AA%8C%E8%AF%81%E4%BF%A1%E6%81%AF%E6%80%8E%E4%B9%88%E8%A7%A3%E5%86%B3" aria-label="5 使用 axios 在 ie10 跨域发送code classlanguage textoptioncode无法携带 cookie 等验证信息怎么解决 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>5. 使用 axios 在 IE10-跨域发送<code class="language-text">option</code>无法携带 cookie 等验证信息怎么解决?</h3>
<p>在 IE10-中, 当 axios 在检测到发送的是跨域请求时(非同源), 使用的是微软特殊的 XDomainRequest 而不是一般的 XMLHttpRequest 实现的, XDomainRequest 在请求时为了安全会做出以下限制:</p>
<ul>
<li>cookie 不会随之发送</li>
<li>只能设置请求头部信息中的 Content-Type 字段</li>
<li>不能访问响应头部信息</li>
<li>只支持 GET 和 POST 请求</li>
</ul>
<p>因此, 在 IE10-情况下, 跨域验证只能想别的办法. 如果是其余浏览器, 需要将<code class="language-text">withCredentials</code>手动设置为 true, 可以指定某个请求应该发送凭据.</p>
<blockquote>
<p>axios 中<code class="language-text">xhr.withCredentials</code>默认为<code class="language-text">false</code></p>
</blockquote>
<h3 id="6-跨域联调需要做好哪些设置" style="position:relative;"><a href="#6-%E8%B7%A8%E5%9F%9F%E8%81%94%E8%B0%83%E9%9C%80%E8%A6%81%E5%81%9A%E5%A5%BD%E5%93%AA%E4%BA%9B%E8%AE%BE%E7%BD%AE" aria-label="6 跨域联调需要做好哪些设置 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>6. 跨域联调需要做好哪些设置?</h3>
<ol>
<li>服务端需要设置好<code class="language-text">Access-Control-Allow-Origin</code>规则,</li>
<li>如果需要在<code class="language-text">OPTIONS</code>发送额外验证信息, 需要开启<code class="language-text">xhr.withCredentials</code>属性, 这个属性只在 IE11+上有用, 默认为<code class="language-text">false</code></li>
<li>如果是内部联调, 开发可以使用代理转发的方式避免跨域</li>
<li>如果跨域请求并携带 cookie 验证, 服务端验证通过但客户端还是报错, 需要检查下服务端是否返回这个: <code class="language-text">Access-Control-Allow-Credentials: true</code></li>
</ol>
<h3 id="7-有些网页功能只能在内网环境下工作-在外网需要隐藏-这个功能如何实现" style="position:relative;"><a href="#7-%E6%9C%89%E4%BA%9B%E7%BD%91%E9%A1%B5%E5%8A%9F%E8%83%BD%E5%8F%AA%E8%83%BD%E5%9C%A8%E5%86%85%E7%BD%91%E7%8E%AF%E5%A2%83%E4%B8%8B%E5%B7%A5%E4%BD%9C-%E5%9C%A8%E5%A4%96%E7%BD%91%E9%9C%80%E8%A6%81%E9%9A%90%E8%97%8F-%E8%BF%99%E4%B8%AA%E5%8A%9F%E8%83%BD%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0" aria-label="7 有些网页功能只能在内网环境下工作 在外网需要隐藏 这个功能如何实现 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>7. 有些网页功能只能在内网环境下工作, 在外网需要隐藏, 这个功能如何实现?</h3>
<blockquote>
<p>提示: 内网可能会有多个 ip/端口/内部域名, 但共同点是内网在外部都无法访问.</p>
</blockquote>
<p>使用图像 ping 方式. 尝试请求内网的图片, 如果成功执行<code class="language-text">onload</code>回调, 如果失败执行<code class="language-text">onerror</code>回调.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> img <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
img<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"Error!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
img<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"Done!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
img<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">"http://www.example.com/test?name=Nicholas"</span><span class="token punctuation">;</span></code></pre></div>
<h3 id="8-如何统计-jsdk-的使用信息" style="position:relative;"><a href="#8-%E5%A6%82%E4%BD%95%E7%BB%9F%E8%AE%A1-jsdk-%E7%9A%84%E4%BD%BF%E7%94%A8%E4%BF%A1%E6%81%AF" aria-label="8 如何统计 jsdk 的使用信息 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>8. 如何统计 JSDK 的使用信息?</h3>
<p>使用图像 ping 方式. 请求远程服务的 gif 图片并在 url 参数中携带使用信息.</p>
<h3 id="9-jsonp-的实现方式及存在的问题" style="position:relative;"><a href="#9-jsonp-%E7%9A%84%E5%AE%9E%E7%8E%B0%E6%96%B9%E5%BC%8F%E5%8F%8A%E5%AD%98%E5%9C%A8%E7%9A%84%E9%97%AE%E9%A2%98" aria-label="9 jsonp 的实现方式及存在的问题 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>9. JSONP 的实现方式及存在的问题?</h3>
<ul>
<li>callback 函数需要放到 window 上(全局)</li>
<li>外部源如果不安全会出现漏洞, XSS/CSRF 等</li>
</ul>
<h3 id="10-jsonp-和-ajax-的关系" style="position:relative;"><a href="#10-jsonp-%E5%92%8C-ajax-%E7%9A%84%E5%85%B3%E7%B3%BB" aria-label="10 jsonp 和 ajax 的关系 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>10. JSONP 和 Ajax 的关系?</h3>
<p>两者没关系.</p>
<p>JSONP 过程:</p>
<ul>
<li>创建 JS 脚本</li>
<li>向服务端请求数据并在 url 参数中携带 callback 函数,</li>
<li>服务器获得请求将 callback 对应的函数名与数据结合发送给客户端</li>
<li>脚本加载完成, 客户端执行 callback 函数并处理包含的数据</li>
</ul>
<h3 id="11-comet-长轮询和短轮询的过程及问题点" style="position:relative;"><a href="#11-comet-%E9%95%BF%E8%BD%AE%E8%AF%A2%E5%92%8C%E7%9F%AD%E8%BD%AE%E8%AF%A2%E7%9A%84%E8%BF%87%E7%A8%8B%E5%8F%8A%E9%97%AE%E9%A2%98%E7%82%B9" aria-label="11 comet 长轮询和短轮询的过程及问题点 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>11. Comet, 长轮询和短轮询的过程及问题点?</h3>
<p>有两种实现 Comet 的方式：轮询和流. 轮询分为长轮询和短轮询.</p>
<p><strong>短轮询:</strong></p>
<p>客户端定时发送请求.</p>
<p><strong>长轮询:</strong></p>
<p>客户端发送请求, 服务端有数据后再返回, 客户端接收后随即再发起请求.</p>
<p><strong>HTTP 流</strong></p>
<p>流不同于上述两种轮询，因为它在页面的整个生命周期内只 使用一个 HTTP 连接。服务端不断向客户端吐数据, 客户端通过<code class="language-text">xhr.readyState == 3</code> 截取收到的东西, 这里说明两个接口.</p>
<h3 id="12-sse-和-websockets-的区别" style="position:relative;"><a href="#12-sse-%E5%92%8C-websockets-%E7%9A%84%E5%8C%BA%E5%88%AB" aria-label="12 sse 和 websockets 的区别 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>12. SSE 和 WebSockets 的区别</h3>
<ul>
<li>SSE API(服务器发送事件), IE 不支持, 使用 XHR 也可以实现</li>
<li>Web Sockets, 使用自定义协议, 双向通信, 需要专门服务器, 使用 SSE 和 XHR 可能实现</li>
</ul>
<h3 id="13-如何保证接口安全-可用的措施是" style="position:relative;"><a href="#13-%E5%A6%82%E4%BD%95%E4%BF%9D%E8%AF%81%E6%8E%A5%E5%8F%A3%E5%AE%89%E5%85%A8-%E5%8F%AF%E7%94%A8%E7%9A%84%E6%8E%AA%E6%96%BD%E6%98%AF" aria-label="13 如何保证接口安全 可用的措施是 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>13. 如何保证接口安全, 可用的措施是?</h3>
<p>为确保通过 XHR 访问的 URL 安全，通行的做法就是验证发送请求者是否有权限访问相应的资源。 有下列几种方式可供选择</p>
<ul>
<li>要求以 SSL 连接来访问可以通过 XHR 请求的资源。</li>
<li>要求每一次请求都要附带经过相应算法计算得到的验证码。</li>
<li>都走 post 请求, 请求 body 加密(网易云音乐接口)</li>
</ul>
<h3 id="14-http-keep-alive-和-tcp-keepalive-的区别" style="position:relative;"><a href="#14-http-keep-alive-%E5%92%8C-tcp-keepalive-%E7%9A%84%E5%8C%BA%E5%88%AB" aria-label="14 http keep alive 和 tcp keepalive 的区别 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>14. HTTP keep-alive 和 TCP keepalive 的区别?</h3>
<h4 id="http-建立在-tcp-之上" style="position:relative;"><a href="#http-%E5%BB%BA%E7%AB%8B%E5%9C%A8-tcp-%E4%B9%8B%E4%B8%8A" aria-label="http 建立在 tcp 之上 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>HTTP 建立在 TCP 之上</h4>
<p>TCP 协议对应于传输层，而 HTTP 协议对应于应用层，从本质上来说，二者没有可比性。</p>
<h4 id="tcp-keepalive" style="position:relative;"><a href="#tcp-keepalive" aria-label="tcp keepalive permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>TCP keepalive</h4>
<blockquote>
<p><strong>保活, 心跳, 检测连接错误</strong></p>
</blockquote>
<p>双方建立交互的链接不一定一直存在数据交互, 期间使用保活报文探测对方是否还在. 中间过程会遇到防火墙等中间设备, 会对 TCP 保活产生影响.</p>
<h4 id="http-keep-alive" style="position:relative;"><a href="#http-keep-alive" aria-label="http keep alive permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>HTTP keep-alive</h4>
<blockquote>
<p><strong>连接复用</strong></p>
</blockquote>
<p>在一个 TCP 链接上进行多次 HTTP 请求从而提高性能.</p>
<p>Httpd 守护进程，一般都提供了 keep-alive timeout 时间设置参数. 正常情况下, 一个 HTTP 产生的 TCP 链接在传送完最后一个响应后, 马上主动关闭响应的 TCP 链接, 但是设置了 timeout 后, httpd 守护进程会等待以下, 如果还未有数据交互, 则关闭 HTTP 连接.</p>
<p><figure class="gatsby-resp-image-figure" style="">
    <span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 840px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 62.38095238095238%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAACbElEQVQoz2VTS2gTURQ9b77NJDOZyW9iPjWTxgTbpAVj8VO0fiKIWCsKAamlIqgYirow6MKVbtwVFQTTRRHqB8EquHQhFHWjiHWjoEJX7hRx43K8M5NJR71w571337mf8+4dwBWujz4l0gxjKYlBCQOKCTCLbAbWRHNwDIgxHiFaZSCcIv8i2dMuQnnPSeIU4sJ6bVQKV7SAs0I6AI7zbB94AedgYos4hq2bkgFciLQAiF3fT6KMR1Axu70fBTuUwKph4ZuhY7UgYUKFG9UGbkgiLTJrbjDNwrxZxA+9zL5GE/hsxXA16UXewRyM/EaAcZvlRzq4mJpGJ3oBC8ZezGV05F26iXKxV04/JlOH0Rk6wZa0k3isD+NJ0cRkugdotvlE8xSKe/ZVxmvGW8pkM+/mnkSsNZ99xsq4O5O3YgdY28jgd2Q/lpMVPN+YRivlUefTgac4pu6GLdfxKtXAy1wZyyMR7Iw7N+vQoO8ZePQn0gepwm1YSQzgu5rEgq6i7jxNlDSP11Uh+qyE7Fy8tOuBcDr5i9L4KWij+vvrMN3KZVSNo7iWmcHTaAuL0QpeVE2cdcvnEFJQu8X0ehu55HSuhpJNZdsKmB2O4F2ex2BvZH7SaFFr9PvQBu+gkXVsK7jMn6f2Rmh2KL3ikvFlBoesS7ibnsK8MYtFYzMeWhEMx7zbMdykobRpVMdpBkMBFnQUqDa1S0WgV+OUjwLMJd4Y+sKOy1dwhLPR6jbGyezz5romjioxAs/C8z4uIILk/CV/WaARiGW9E3On19shT9oXgMpuM/4RFgbvBMUo0fNLIRXxv4he3DXfIO4PaLRglUXbJz4AAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="HTTP Keep-Alive模型"
        title="HTTP Keep-Alive模型"
        src="/blog/static/8f6f66911ea7769142c4501ce2a1e455/f88f5/keep-alive.png"
        srcset="/blog/static/8f6f66911ea7769142c4501ce2a1e455/e1650/keep-alive.png 210w,
/blog/static/8f6f66911ea7769142c4501ce2a1e455/8cae7/keep-alive.png 420w,
/blog/static/8f6f66911ea7769142c4501ce2a1e455/f88f5/keep-alive.png 840w,
/blog/static/8f6f66911ea7769142c4501ce2a1e455/1084e/keep-alive.png 1000w"
        sizes="(max-width: 840px) 100vw, 840px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span>
    <figcaption class="gatsby-resp-image-figcaption">HTTP Keep-Alive模型</figcaption>
  </figure></p>
<p>HTTP1.0 中默认是关闭的，需要在 HTTP 头加入”Connection: Keep-Alive”，才能启用 Keep-Alive；HTTP1.1 中默认启用 Keep-Alive，加入”Connection: close “，才关闭。</p>
<h4 id="两者的关系" style="position:relative;"><a href="#%E4%B8%A4%E8%80%85%E7%9A%84%E5%85%B3%E7%B3%BB" aria-label="两者的关系 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>两者的关系</h4>
<p>http keep-alive 与 tcp keep-alive，不是同一回事，意图不一样。http keep-alive 是为了让 tcp 活得更久一点，以便在同一个连接上传送多个 http，提高 socket 的效率。而 tcp keep-alive 是 TCP 的一种检测 TCP 连接状况的保鲜机制。</p>
<h4 id="参考" style="position:relative;"><a href="#%E5%8F%82%E8%80%83" aria-label="参考 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>参考</h4>
<ul>
<li><a href="https://www.cnblogs.com/laowenBlog/p/6096239.html" target="_target" rel="nofollow">HTTP Keep-Alive 模式</a></li>
<li><a href="https://www.jianshu.com/p/e99e0e505c79" target="_target" rel="nofollow">Http keep-alive 分析</a></li>
</ul>]]></description><link>https://xiangst0816.github.io/blog/di-er-shi-yi-zhang/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/di-er-shi-yi-zhang/</guid><category><![CDATA[JS高程]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Tue, 20 Mar 2018 05:31:33 GMT</pubDate></item><item><title><![CDATA[第十七章 错误处理及调试]]></title><description><![CDATA[<h3 id="1-try-catch" style="position:relative;"><a href="#1-try-catch" aria-label="1 try catch permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. try-catch</h3>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token comment">// 可能会导致错误的代码</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 在错误发生时怎么处理</span>
<span class="token punctuation">}</span></code></pre></div>
<ul>
<li>在<strong>可能发生错误的地方使用 try-catch 语句</strong></li>
<li>catch 中的 error 错误对象必须要写, 不可忽略</li>
<li>error.message: 错误消息</li>
<li>error.name: 错误名称</li>
</ul>
<h3 id="2-下面包含code-classlanguage-textfinallycode语句的代码返回值时" style="position:relative;"><a href="#2-%E4%B8%8B%E9%9D%A2%E5%8C%85%E5%90%ABcode-classlanguage-textfinallycode%E8%AF%AD%E5%8F%A5%E7%9A%84%E4%BB%A3%E7%A0%81%E8%BF%94%E5%9B%9E%E5%80%BC%E6%97%B6" aria-label="2 下面包含code classlanguage textfinallycode语句的代码返回值时 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 下面包含<code class="language-text">finally</code>语句的代码返回值时?</h3>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">testFinally</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token number">2</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<ul>
<li>finally 子句一经使用，其代码无论如何都会执行</li>
<li>如果 finally 包含 return, 则会忽略上面的所有 return</li>
<li>上例子中返回 0</li>
</ul>
<h3 id="3-报错的-error-类型种类-如何获取类型" style="position:relative;"><a href="#3-%E6%8A%A5%E9%94%99%E7%9A%84-error-%E7%B1%BB%E5%9E%8B%E7%A7%8D%E7%B1%BB-%E5%A6%82%E4%BD%95%E8%8E%B7%E5%8F%96%E7%B1%BB%E5%9E%8B" aria-label="3 报错的 error 类型种类 如何获取类型 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. 报错的 error 类型种类, 如何获取类型?</h3>
<ul>
<li>Error: 基类错误</li>
<li>EvalError: 执行 eval()错误</li>
<li>RangeError: 范围错误</li>
<li>ReferenceError: 对象中属性未找到</li>
<li>SyntaxError: 语法错误, 比如错误的字符串传入 <code class="language-text">JSON.parse()</code> / <code class="language-text">eval()</code></li>
<li>TypeError: 类型错误</li>
<li>URIError: 在使用 encodeURI()或 decodeURI(), uri 格式不对报错</li>
</ul>
<p>可以通过 <code class="language-text">instanceof</code>操作符 获取错误类型.</p>
<h3 id="4-如何创建自定义错误类型并抛出" style="position:relative;"><a href="#4-%E5%A6%82%E4%BD%95%E5%88%9B%E5%BB%BA%E8%87%AA%E5%AE%9A%E4%B9%89%E9%94%99%E8%AF%AF%E7%B1%BB%E5%9E%8B%E5%B9%B6%E6%8A%9B%E5%87%BA" aria-label="4 如何创建自定义错误类型并抛出 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. 如何创建自定义错误类型并抛出?</h3>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">CustomError</span><span class="token punctuation">(</span><span class="token parameter">message</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"CustomError"</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>message <span class="token operator">=</span> message<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token class-name">CustomError</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">CustomError</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> CustomError<span class="token punctuation">;</span>

<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">CustomError</span><span class="token punctuation">(</span><span class="token string">"This is a message!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<h3 id="5-在-try-catch-捕获错误和-throw-抛出错误两个阶段应该注意什么" style="position:relative;"><a href="#5-%E5%9C%A8-try-catch-%E6%8D%95%E8%8E%B7%E9%94%99%E8%AF%AF%E5%92%8C-throw-%E6%8A%9B%E5%87%BA%E9%94%99%E8%AF%AF%E4%B8%A4%E4%B8%AA%E9%98%B6%E6%AE%B5%E5%BA%94%E8%AF%A5%E6%B3%A8%E6%84%8F%E4%BB%80%E4%B9%88" aria-label="5 在 try catch 捕获错误和 throw 抛出错误两个阶段应该注意什么 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>5. 在 try-catch 捕获错误和 throw 抛出错误两个阶段应该注意什么?</h3>
<ul>
<li><strong>try-catch 捕获错误</strong>: 应该捕获确切知道如何处理的错误</li>
<li><strong>throw 抛出</strong>: 错误应该提供详细的信息</li>
</ul>
<h3 id="6-error-事件触发时机" style="position:relative;"><a href="#6-error-%E4%BA%8B%E4%BB%B6%E8%A7%A6%E5%8F%91%E6%97%B6%E6%9C%BA" aria-label="6 error 事件触发时机 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>6. error 事件触发时机?</h3>
<p>任何没有通过 try-catch 处理的错误都会<strong>触发 window 对象的 error 事件</strong>。</p>
<h3 id="7-error-事件监听" style="position:relative;"><a href="#7-error-%E4%BA%8B%E4%BB%B6%E7%9B%91%E5%90%AC" aria-label="7 error 事件监听 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>7. error 事件监听</h3>
<p><strong>只能这样使用!!</strong></p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">window<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">message<span class="token punctuation">,</span> url<span class="token punctuation">,</span> line</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token comment">// 阻止浏览器报告错误的默认行为</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<ul>
<li>通过<strong>返回 false</strong>，这个函数实际上就<strong>充当了整个文档中的 try-catch 语句</strong>，可以捕获所有无代码处理的运行时错误。</li>
<li>理想情况下，只要可能就不应该使用它</li>
<li>只要能够适当地使用 try-catch 语句，就不会有错误交给浏览器，也就不会触发 error 事件。</li>
</ul>
<h3 id="8-常见错误如何避免" style="position:relative;"><a href="#8-%E5%B8%B8%E8%A7%81%E9%94%99%E8%AF%AF%E5%A6%82%E4%BD%95%E9%81%BF%E5%85%8D" aria-label="8 常见错误如何避免 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>8. 常见错误如何避免?</h3>
<p><strong>类型转化错误</strong></p>
<ul>
<li>使用<strong>全等<code class="language-text">===</code></strong>和<strong>非全等<code class="language-text">!==</code></strong>操作符，可以避免发生因为使用相等和不相等操作符引发的类型 转换错误，因此我们强烈推荐使用</li>
<li>像 <code class="language-text">if</code> 之类的语句在确定下一步操作之前， 会<strong>自动把任何值转换成布尔值</strong>, 避免错误就要做到在条件比较时<strong>切实传入布尔值</strong>。</li>
</ul>
<p><strong>数据类型错误</strong></p>
<ul>
<li>传参需要手动判断下类型, 避免错误</li>
<li><strong>基本类型</strong>的值应该使用 <code class="language-text">typeof</code> 来检测, string/number/function/boolean</li>
<li><strong>对象</strong>的值则应该使用 <code class="language-text">instanceof</code> 来检测, array/object</li>
<li>基本库<strong>必须</strong>进行入参类型检查!</li>
</ul>
<p><strong>通信错误</strong></p>
<ul>
<li>url 编码错误, 比如没正确使用<code class="language-text">encodeURIComponent</code>函数, 解决方式如下:</li>
</ul>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">addQueryStringArg</span><span class="token punctuation">(</span><span class="token parameter">url<span class="token punctuation">,</span> name<span class="token punctuation">,</span> value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>url<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">"?"</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    url <span class="token operator">+=</span> <span class="token string">"?"</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    url <span class="token operator">+=</span> <span class="token string">"&amp;"</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  url <span class="token operator">+=</span> <span class="token function">encodeURIComponent</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"="</span> <span class="token operator">+</span> <span class="token function">encodeURIComponent</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> url<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<ul>
<li>在服务器响应的数据不正确时，也会发生通信错误</li>
<li>动态加载脚本和动态加载样式</li>
</ul>
<h3 id="9-归一化-error-对象的方法" style="position:relative;"><a href="#9-%E5%BD%92%E4%B8%80%E5%8C%96-error-%E5%AF%B9%E8%B1%A1%E7%9A%84%E6%96%B9%E6%B3%95" aria-label="9 归一化 error 对象的方法 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>9. 归一化 error 对象的方法</h3>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">/**
 * 监听全局的js文件错误
 * @param {String}  message   错误信息
 * @param {String}  script    出错的文件
 * @param {String}  line      出错代码的行号
 * @param {String}  column    出错代码的列号
 * @param {Object}  errorObj  错误的详细信息，Anything
 */</span>
window<span class="token punctuation">[</span><span class="token string">"onerror"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">message<span class="token punctuation">,</span> script<span class="token punctuation">,</span> line<span class="token punctuation">,</span> column<span class="token punctuation">,</span> errorObj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  _ins<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>
    <span class="token function">normalizeError</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      message<span class="token operator">:</span> message<span class="token punctuation">,</span>
      name<span class="token operator">:</span> <span class="token operator">!</span><span class="token operator">!</span>errorObj <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>errorObj<span class="token punctuation">.</span>message <span class="token operator">||</span> message<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">":"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      script<span class="token operator">:</span> script<span class="token punctuation">,</span>
      line<span class="token operator">:</span> line<span class="token punctuation">,</span>
      stack<span class="token operator">:</span> <span class="token operator">!</span><span class="token operator">!</span>errorObj <span class="token operator">&amp;&amp;</span> errorObj<span class="token punctuation">.</span>stack
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// Normalize Error objects across all browsers into something semi-standard.</span>
<span class="token comment">// Not all properties are will be available, but if they are, they'll at</span>
<span class="token comment">// least have a predictable property name.</span>
<span class="token keyword">function</span> <span class="token function">normalizeError</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> o <span class="token operator">=</span> <span class="token punctuation">{</span>
    message<span class="token operator">:</span> err<span class="token punctuation">.</span>message<span class="token punctuation">,</span>
    script<span class="token operator">:</span> err<span class="token punctuation">.</span>fileName <span class="token operator">||</span> err<span class="token punctuation">.</span>sourceURL <span class="token operator">||</span> err<span class="token punctuation">.</span>script<span class="token punctuation">,</span>
    name<span class="token operator">:</span> err<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
    line<span class="token operator">:</span> err<span class="token punctuation">.</span>lineNumber <span class="token operator">||</span> err<span class="token punctuation">.</span>line<span class="token punctuation">,</span>
    stack<span class="token operator">:</span> err<span class="token punctuation">.</span>stackTrace <span class="token operator">||</span> err<span class="token punctuation">.</span>stack
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token comment">// Chrome doesn't provide script/line # properties in Error objects, and</span>
  <span class="token comment">// only reports the script/line # of where an error was last rethrown (as</span>
  <span class="token comment">// opposed to the original throw point).  So we scrape the stack trace to</span>
  <span class="token comment">// get that info</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>
    window<span class="token punctuation">.</span>chrome <span class="token operator">&amp;&amp;</span>
    err<span class="token punctuation">.</span>stack <span class="token operator">&amp;&amp;</span>
    <span class="token regex">/(\w{3,5}:\/\/[^:]+):(\d+)/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span>stack<span class="token punctuation">)</span>
  <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    o<span class="token punctuation">.</span>script <span class="token operator">=</span> RegExp<span class="token punctuation">.</span>$<span class="token number">1</span><span class="token punctuation">;</span>
    o<span class="token punctuation">.</span>line <span class="token operator">=</span> RegExp<span class="token punctuation">.</span>$<span class="token number">2</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// Clear out undefined properties</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> k <span class="token keyword">in</span> o<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>o<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token keyword">null</span> <span class="token operator">||</span> o<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">delete</span> o<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> o<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<h3 id="10-如何捕获code-classlanguage-textpromisecode抛出的错误？" style="position:relative;"><a href="#10-%E5%A6%82%E4%BD%95%E6%8D%95%E8%8E%B7code-classlanguage-textpromisecode%E6%8A%9B%E5%87%BA%E7%9A%84%E9%94%99%E8%AF%AF%EF%BC%9F" aria-label="10 如何捕获code classlanguage textpromisecode抛出的错误？ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>10. 如何捕获<code class="language-text">Promise</code>抛出的错误？</h3>
<h4 id="主动捕获" style="position:relative;"><a href="#%E4%B8%BB%E5%8A%A8%E6%8D%95%E8%8E%B7" aria-label="主动捕获 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>主动捕获</h4>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">"a:1"</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span>parse<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>
    <span class="token parameter">json</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"不会执行到这里"</span><span class="token punctuation">,</span> json<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token parameter">err</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token comment">//这儿捕获的是上一个JSON.parse时的错误</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"上面err在这里被处理"</span><span class="token punctuation">,</span> err<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">//Unexpected token a</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"不会触发这个error"</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"任然执行"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<h4 id="被动监听" style="position:relative;"><a href="#%E8%A2%AB%E5%8A%A8%E7%9B%91%E5%90%AC" aria-label="被动监听 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>被动监听</h4>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// 浏览器</span>
window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"unhandledrejection"</span><span class="token punctuation">,</span> <span class="token parameter">e</span> <span class="token operator">=></span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// nodejs</span>
process<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">"unhandledRejection"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">reason<span class="token punctuation">,</span> promise</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>reason<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [Error: unhandledrejection]</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>promise<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Promise { &lt;rejected> [Error: unhandledrejection] }</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>参考这篇文章，<a href="http://2ality.com/2016/04/unhandled-rejections.html" target="_target" rel="nofollow">Tracking unhandled rejected Promises</a></p>]]></description><link>https://xiangst0816.github.io/blog/di-shi-qi-zhang-cuo/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/di-shi-qi-zhang-cuo/</guid><category><![CDATA[JS高程]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Mon, 19 Mar 2018 03:48:41 GMT</pubDate></item><item><title><![CDATA[第二十三章 离线应用与客户端存储]]></title><description><![CDATA[<h3 id="1-如何判断在线状态" style="position:relative;"><a href="#1-%E5%A6%82%E4%BD%95%E5%88%A4%E6%96%AD%E5%9C%A8%E7%BA%BF%E7%8A%B6%E6%80%81" aria-label="1 如何判断在线状态 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 如何判断在线状态?</h3>
<p><strong>属性:</strong></p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">navigator<span class="token punctuation">.</span>onLine<span class="token punctuation">;</span></code></pre></div>
<p><strong>事件:</strong></p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">EventUtil<span class="token punctuation">.</span><span class="token function">addHandler</span><span class="token punctuation">(</span>window<span class="token punctuation">,</span> <span class="token string">"online"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"Online"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
EventUtil<span class="token punctuation">.</span><span class="token function">addHandler</span><span class="token punctuation">(</span>window<span class="token punctuation">,</span> <span class="token string">"offline"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"Offline"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<h3 id="2-manifest-应用缓存" style="position:relative;"><a href="#2-manifest-%E5%BA%94%E7%94%A8%E7%BC%93%E5%AD%98" aria-label="2 manifest 应用缓存 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. manifest 应用缓存</h3>
<p>看下 Gatsby 的实现. 书上说的和 Gatsby 实现的方式不一样.</p>
<ul>
<li>gatsby-plugin-offline</li>
<li>gatsby-plugin-manifest</li>
</ul>
<h3 id="3-cookie-相关" style="position:relative;"><a href="#3-cookie-%E7%9B%B8%E5%85%B3" aria-label="3 cookie 相关 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. Cookie 相关</h3>
<p><strong>作用:</strong></p>
<p>在客户端用于存储会话信息的</p>
<p><strong>限制:</strong></p>
<ul>
<li>一个域下的所有 cookie 长度限制在 4095B(含)以内</li>
<li>每个域名下 cookie 个数不超过 50 个(一般最大)</li>
<li>每次请求会携带 cookie, 不建议存储大信息量</li>
<li>cookie 不会区分大小写, 内部”名称”, “值”都是经过 URL 编码的</li>
</ul>
<p><strong>组成:</strong></p>
<p>名称, 值, 域, 路径, 失效时间, 安全标志</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">name=value; expires=Mon, 22-Jan-07 07:10:24 GMT; domain=.wrox.com
name=value; domain=.wrox.com; path=/; secure

// 格式
name=value; expires=expiration_time; path=domain_path;
domain=domain_name; secure;</code></pre></div>
<p><strong>注意:</strong></p>
<ul>
<li>域、路径、失效时间和 secure 标志<strong>都是服务器给浏览器的指示</strong>，以指定何时应该发送 cookie。</li>
<li>这些参数并不会作为发送到服务器的 cookie 信息的一部分，<strong>只有名值对儿才会被发送</strong>。</li>
</ul>
<p><strong>获取:</strong></p>
<p><code class="language-text">document.cookie</code> 返回当前页面<strong>可用的</strong>（根据 cookie 的域、路径、失效时间和安全设置）所有 cookie 的字符串，一系列由分号隔开的名值对儿.</p>
<p><strong>设置格式:</strong></p>
<p>name=value; expires=expiration<em>time; path=domain</em>path; domain=domain_name; secure</p>
<p><strong>HTTP 专有 cookie(HTTP only)</strong></p>
<p>可以从浏览器或者服务器设置，但<strong>是只能从服务器端读取</strong>，因为 JavaScript 无法获取 HTTP 专有 cookie 的值。</p>
<p>HTTPOnly 是一个方式 XSS 的手段, 是不再允许出现 js 操作 cookie 的场景了，但是自己也没法儿使用 js 操作 cookie 了. 会造成使用上和迁移上的麻烦.</p>
<p><strong>javaEE 服务端这样设置:</strong></p>
<div class="gatsby-highlight" data-language="java"><pre class="language-java"><code class="language-java">response<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">"Set-Cookie"</span><span class="token punctuation">,</span> "cookiename<span class="token operator">=</span>value<span class="token punctuation">;</span>
<span class="token class-name">Path</span><span class="token operator">=</span><span class="token operator">/</span><span class="token punctuation">;</span><span class="token class-name">Domain</span><span class="token operator">=</span>domainvalue<span class="token punctuation">;</span><span class="token class-name">Max</span><span class="token operator">-</span><span class="token class-name">Age</span><span class="token operator">=</span>seconds<span class="token punctuation">;</span><span class="token class-name">HTTPOnly</span>"<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<h3 id="4-sessionstorage-localstorage" style="position:relative;"><a href="#4-sessionstorage-localstorage" aria-label="4 sessionstorage localstorage permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. sessionStorage, localStorage</h3>
<ul>
<li>storage 事件, 用于跨 tab 通信</li>
<li>5MB 存储限制</li>
</ul>
<h3 id="5-如果-cookie-中未设置过期时间会如何" style="position:relative;"><a href="#5-%E5%A6%82%E6%9E%9C-cookie-%E4%B8%AD%E6%9C%AA%E8%AE%BE%E7%BD%AE%E8%BF%87%E6%9C%9F%E6%97%B6%E9%97%B4%E4%BC%9A%E5%A6%82%E4%BD%95" aria-label="5 如果 cookie 中未设置过期时间会如何 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>5. 如果 cookie 中未设置过期时间会如何?</h3>
<p>服务器设置的 cookie 只在当期会话有效, 关闭浏览器后删除对应 cookie.</p>
<h3 id="6-js-本地操作-cookie-的处理流程有哪些" style="position:relative;"><a href="#6-js-%E6%9C%AC%E5%9C%B0%E6%93%8D%E4%BD%9C-cookie-%E7%9A%84%E5%A4%84%E7%90%86%E6%B5%81%E7%A8%8B%E6%9C%89%E5%93%AA%E4%BA%9B" aria-label="6 js 本地操作 cookie 的处理流程有哪些 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>6. JS 本地操作 cookie 的处理流程有哪些?</h3>
<p>一般分为: <code class="language-text">get()</code> / <code class="language-text">set()</code> / <code class="language-text">remove()</code></p>
<p><strong><code class="language-text">get(name)</code></strong></p>
<blockquote>
<p><strong>注意<code class="language-text">name</code>需要<code class="language-text">encodeURIComponent</code>处理, 返回的值需要<code class="language-text">decodeURIComponent</code></strong></p>
</blockquote>
<ul>
<li>找到<code class="language-text">name</code>的 startIndex</li>
<li>从 index 开始找结尾标志<code class="language-text">;</code>的 endIndex, 如果未找到则到了 cookie 末端, endIndex 为 cookie 字符串长度</li>
<li>根据起止位置用 <code class="language-text">substring(startIndex+name.length, endIndex)</code> 截取字符串返回</li>
</ul>
<p><strong><code class="language-text">set(name, value, expires, path, domain, secure)</code></strong></p>
<blockquote>
<p>设置 cookie 可以不用管原先已存储的值, 如果浏览器中 cookie 已存在则覆盖, 不存在则新增, 我们只需要传递修改的字符串即可</p>
</blockquote>
<ul>
<li>将<code class="language-text">name</code>和<code class="language-text">value</code>进行<code class="language-text">encodeURIComponent</code>, 根据传入的配置拼接字符串</li>
<li>将值转给<code class="language-text">document.cookie</code></li>
</ul>
<p><strong><code class="language-text">remove(key, options)</code></strong></p>
<blockquote>
<p>cookie 不可以删除, 需要使用相同的路径、域和安全选项再次设置 cookie，并将失效时间设置为过去的时间。</p>
</blockquote>
<p>等效代码:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> path<span class="token punctuation">,</span> domain<span class="token punctuation">,</span> secure<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<h3 id="7-sessionstorage-和-localstorage-使用的差别？" style="position:relative;"><a href="#7-sessionstorage-%E5%92%8C-localstorage-%E4%BD%BF%E7%94%A8%E7%9A%84%E5%B7%AE%E5%88%AB%EF%BC%9F" aria-label="7 sessionstorage 和 localstorage 使用的差别？ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>7. sessionStorage 和 localStorage 使用的差别？</h3>
<ul>
<li>sessionStorage 中的数据在<strong>当前会话期</strong>存在，而 localStorage 则一直存在</li>
<li><strong>localStorage 中新增数据可以在其他 Tab 中同步</strong>，但是 sessionStorage 不会同步</li>
</ul>]]></description><link>https://xiangst0816.github.io/blog/di-er-shi-san-zhang/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/di-er-shi-san-zhang/</guid><category><![CDATA[JS高程]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Sun, 18 Mar 2018 09:21:20 GMT</pubDate></item><item><title><![CDATA[第二十章 JSON]]></title><description><![CDATA[<h3 id="1-json-和-javascript-的关系" style="position:relative;"><a href="#1-json-%E5%92%8C-javascript-%E7%9A%84%E5%85%B3%E7%B3%BB" aria-label="1 json 和 javascript 的关系 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. JSON 和 JavaScript 的关系?</h3>
<ul>
<li>JSON 并不从属于 JavaScript</li>
<li>JSON 是一种数据格式, 而不是编程语言</li>
<li>JSON 可表示的数据类型有: 对象/数组/字符串/数字/布尔值/null, 其余类型忽略.</li>
</ul>
<h3 id="2-除了使用全局对象code-classlanguage-textjsoncode解析-json-还有什么方法-问题点是" style="position:relative;"><a href="#2-%E9%99%A4%E4%BA%86%E4%BD%BF%E7%94%A8%E5%85%A8%E5%B1%80%E5%AF%B9%E8%B1%A1code-classlanguage-textjsoncode%E8%A7%A3%E6%9E%90-json-%E8%BF%98%E6%9C%89%E4%BB%80%E4%B9%88%E6%96%B9%E6%B3%95-%E9%97%AE%E9%A2%98%E7%82%B9%E6%98%AF" aria-label="2 除了使用全局对象code classlanguage textjsoncode解析 json 还有什么方法 问题点是 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 除了使用全局对象<code class="language-text">JSON</code>解析 JSON 还有什么方法? 问题点是?</h3>
<p>还有<code class="language-text">eval()</code>方法可以解析, 问题点是:</p>
<ul>
<li><code class="language-text">eval()</code>中可能有恶意代码</li>
<li>性能不高</li>
</ul>
<blockquote>
<p>支持<code class="language-text">JSON</code>的的浏览器, IE8+</p>
</blockquote>
<h3 id="3-code-classlanguage-textjsonstringifyobjcode时的注意点" style="position:relative;"><a href="#3-code-classlanguage-textjsonstringifyobjcode%E6%97%B6%E7%9A%84%E6%B3%A8%E6%84%8F%E7%82%B9" aria-label="3 code classlanguage textjsonstringifyobjcode时的注意点 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. <code class="language-text">JSON.stringify(obj)</code>时的注意点?</h3>
<ul>
<li><strong>不能保存函数</strong>, 如果有函数会忽略</li>
<li>值为<strong><code class="language-text">undefined</code></strong>会被忽略</li>
</ul>
<h3 id="4-解释下执行code-classlanguage-textjsonstringifycode这个函数发生的内部流程" style="position:relative;"><a href="#4-%E8%A7%A3%E9%87%8A%E4%B8%8B%E6%89%A7%E8%A1%8Ccode-classlanguage-textjsonstringifycode%E8%BF%99%E4%B8%AA%E5%87%BD%E6%95%B0%E5%8F%91%E7%94%9F%E7%9A%84%E5%86%85%E9%83%A8%E6%B5%81%E7%A8%8B" aria-label="4 解释下执行code classlanguage textjsonstringifycode这个函数发生的内部流程 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. 解释下执行<code class="language-text">JSON.stringify</code>这个函数发生的内部流程?</h3>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token punctuation">{</span>
  str<span class="token operator">:</span> <span class="token string">"string"</span><span class="token punctuation">,</span>
  num<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
  <span class="token function-variable function">fn</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"num:"</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>num<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  trans<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">toJSON</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token string">"hello"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  arr<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<div class="gatsby-highlight" data-language="json"><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"str"</span><span class="token operator">:</span> <span class="token string">"string"</span><span class="token punctuation">,</span>
  <span class="token property">"num"</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
  <span class="token property">"trans"</span><span class="token operator">:</span> <span class="token string">"hello"</span><span class="token punctuation">,</span>
  <span class="token property">"arr"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span></code></pre></div>
<p><strong>流程</strong></p>
<ol>
<li>如果对象中存在 toJSON 方法, 则执行他获得有效值. 否则返回对象本身. (上面例子最外层对象没有)</li>
<li>如果提供了第二个参数, 则执行过滤操作. <strong>传入函数过滤器的(key, value)是第一步返回的值</strong></li>
<li>先从最外层对象开始, 如果内层遍历到对象, 则转到 1)</li>
<li>对第 2)返回的每个值进行序列化</li>
<li>如果提供了第三个参数, 则进行对应格式化</li>
</ol>
<blockquote>
<p>注意:</p>
<ol>
<li>可以控制整个对象的 toJSON 之外, 还可以控制某个属性的 toJSON.</li>
<li>第三个参数是格式化参数, 可以是字符串用于填充间隙</li>
</ol>
</blockquote>
<h3 id="5-code-classlanguage-textjsonparsecode中的还原函数" style="position:relative;"><a href="#5-code-classlanguage-textjsonparsecode%E4%B8%AD%E7%9A%84%E8%BF%98%E5%8E%9F%E5%87%BD%E6%95%B0" aria-label="5 code classlanguage textjsonparsecode中的还原函数 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>5. <code class="language-text">JSON.parse</code>中的还原函数?</h3>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> book <span class="token operator">=</span> <span class="token punctuation">{</span>
  title<span class="token operator">:</span> <span class="token string">"Professional JavaScript"</span><span class="token punctuation">,</span>
  authors<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"Nicholas C. Zakas"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  edition<span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
  year<span class="token operator">:</span> <span class="token number">2011</span><span class="token punctuation">,</span>
  releaseDate<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token number">2011</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>book<span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>
  <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>key <span class="token operator">===</span> <span class="token string">"releaseDate"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<ul>
<li><code class="language-text">JSON.stringify</code>时, <code class="language-text">Date</code>本身有自己的<code class="language-text">toJSON</code>方法</li>
<li><code class="language-text">JSON.parse</code>时, 是不会有上面的逆过程, 需要手动操作, 因为, string 类型的值不知道之前发生了什么…</li>
<li><code class="language-text">JSON.parse</code>第二个参数成为: 还原函数, 函数传参和<code class="language-text">JSON.stringify</code>的过滤函数一致(和<code class="language-text">array.prototype.filter</code>过滤函数的机制不一样, 需注意)</li>
</ul>]]></description><link>https://xiangst0816.github.io/blog/di-20-zhang-json/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/di-20-zhang-json/</guid><category><![CDATA[JS高程]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Sun, 18 Mar 2018 05:44:57 GMT</pubDate></item><item><title><![CDATA[中文测试(内容已改动)]]></title><description><![CDATA[<h2 id="欢迎来到-xxx" style="position:relative;"><a href="#%E6%AC%A2%E8%BF%8E%E6%9D%A5%E5%88%B0-xxx" aria-label="欢迎来到 xxx permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>欢迎来到 XXX</h2>
<p>XXX 是用于优美、流畅写作笔记和文章的应用。 上手和掌握 XXX 非常容易。现在 wo 就展示给你。</p>
<h2 id="xxx-界面包含三部分-" style="position:relative;"><a href="#xxx-%E7%95%8C%E9%9D%A2%E5%8C%85%E5%90%AB%E4%B8%89%E9%83%A8%E5%88%86-" aria-label="xxx 界面包含三部分  permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>XXX 界面包含三部分 📐</h2>
<p>XXX 包含三栏，供你创建、编辑和管理笔记：</p>
<ul>
<li><em>侧边栏</em>（左侧）：在笔记中加入标签后，XXX 就会将标签显示在侧边栏中。 你可以当作它们是在写作时可即时创建并使用的文件夹。</li>
<li><em>笔记列表</em>（中间）：你所有的笔记都在这里，按照修改日期排序。 你也可以 <em>置顶</em> 笔记。</li>
<li><em>编辑器</em>（右侧）：这里是创作的空间，也是你现在所处的位置。 😄</li>
</ul>
<h2 id="xxx-的样式-️" style="position:relative;"><a href="#xxx-%E7%9A%84%E6%A0%B7%E5%BC%8F-%EF%B8%8F" aria-label="xxx 的样式 ️ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>XXX 的样式 ✒️</h2>
<p>XXX 支持许多文本样式，包括：<em>粗体</em>、/斜体/、<em>下划线</em>、-删除线-、1 至 6 号标题以及更多内容。 你可以在 /格式面板/ 中快速找到它们：</p>
<ul>
<li>在 Mac 上，点击编辑器右下角的笔图标</li>
<li>在 iPhone 或 iPad 上，面板就是输入键盘上方的快捷工具条</li>
</ul>
<p>XXX 还提供一系列主题为你提供舒服、华丽的写作环境。 这些是在应用内订阅 <a href="XXX://x-callback-url/open-XXX-pro">XXX Pro</a> 后解锁的功能。</p>
<h2 id="将笔记链接起来-" style="position:relative;"><a href="#%E5%B0%86%E7%AC%94%E8%AE%B0%E9%93%BE%E6%8E%A5%E8%B5%B7%E6%9D%A5-" aria-label="将笔记链接起来  permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>将笔记链接起来 ⛓</h2>
<p>笔记链接是 XXX 既好玩又实用的功能之一。 你可通过链接在同一项目的多篇笔记之间快速条件，随心管理，或者像我们一样用多篇笔记介绍应用的功能。 比如，你可以通过链接访问下一篇教程 [[管理与发布]]。 😉</p>
<h2 id="管理与发布" style="position:relative;"><a href="#%E7%AE%A1%E7%90%86%E4%B8%8E%E5%8F%91%E5%B8%83" aria-label="管理与发布 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>管理与发布</h2>
<p>让我们一起了解更多你在 XXX 中能用到的超强功能。 你可以查看 XXX 教程的其他章节，上一部分 [[欢迎来到 XXX]] 或最后一部分 [[XXX Pro]]。</p>
<h2 id="在任何地点工作-️" style="position:relative;"><a href="#%E5%9C%A8%E4%BB%BB%E4%BD%95%E5%9C%B0%E7%82%B9%E5%B7%A5%E4%BD%9C-%EF%B8%8F" aria-label="在任何地点工作 ️ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>在任何地点工作 ☁️</h2>
<p>你在写作时笔记会自动保存：这就是没有保存按钮的原因。 😄</p>
<p>XXX 使用 Apple 的 CloudKit 实现同步，可在应用内订阅 <a href="XXX://x-callback-url/open-XXX-pro">XXX Pro</a> 获得此功能。 你所有的笔记都会在 iPad、iPhone 和 Mac 之间同步。</p>
<p>XXX 也支持在 iPad、iPhone 和 Mac 之间切换。 你可在一个设备上新建笔记并 <em>立刻</em> 切换到其他设备。</p>
<h2 id="在任何地方发布" style="position:relative;"><a href="#%E5%9C%A8%E4%BB%BB%E4%BD%95%E5%9C%B0%E6%96%B9%E5%8F%91%E5%B8%83" aria-label="在任何地方发布 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>在任何地方发布</h2>
<p>在编辑器中通过 ⓘ 按钮可访问 <em>信息面板</em>，在你需要将笔记或文章发布到其他地方时，这里提供了导出选项（需在应用内订阅 XXX Pro）。 你可将文字导出为 PDF、HTML、Word (DOCX) 等格式，甚至可以生成图片，便于你将其发布在对字数有限制的社交媒体上。</p>
<h2 id="详细信息" style="position:relative;"><a href="#%E8%AF%A6%E7%BB%86%E4%BF%A1%E6%81%AF" aria-label="详细信息 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>详细信息</h2>
<p>信息面板也会显示笔记的详细信息。 在 <em>字数统计工具</em> 中你可了解字符数、段落数和预估的 <em>阅读时间</em>。</p>
<h2 id="标签和子标签" style="position:relative;"><a href="#%E6%A0%87%E7%AD%BE%E5%92%8C%E5%AD%90%E6%A0%87%E7%AD%BE" aria-label="标签和子标签 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>标签和子标签</h2>
<p><em>标签</em> 是 XXX 的强大功能之一。 在词语左侧像这样#欢迎#加入井字，XXX 就会将其当做文件夹或分类，把所有具有相同标签的笔记整合起来。 利用这一功能，你可将类似内容的笔记按项目、主题或其他原则归类。</p>
<p>在每篇笔记中，你可任意添加标签，数量不限，即时生效。 你需要做的就是输入井字符，其他的事情由 XXX 完成。 所有标签都会显示在侧边栏，也就是 XXX 主窗口左边的面板。 阅读 [[欢迎来到 XXX]] 了解更多关于 XXX 排版布局的核心功能。</p>
<h3 id="别急，还有更多！" style="position:relative;"><a href="#%E5%88%AB%E6%80%A5%EF%BC%8C%E8%BF%98%E6%9C%89%E6%9B%B4%E5%A4%9A%EF%BC%81" aria-label="别急，还有更多！ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>别急，还有更多！</h3>
<p>XXX 还可通过子标签将标签联系起来。 例如：你添加了一个#欢迎/管理#的标签。 在侧边栏中，“管理”就会成为“欢迎”的子标签！</p>
<p>子标签在侧边栏的作用和文件夹类似。 点击标签旁边的按钮即可展开/关闭，方便查看子标签。 在 XXX 中你可以方便的管理标签，我们希望你在实际工作中可以尝试使用。** 12 **</p>
<h2 id="了解-xxx-pro" style="position:relative;"><a href="#%E4%BA%86%E8%A7%A3-xxx-pro" aria-label="了解 xxx pro permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>了解 XXX Pro</h2>
<p>继续阅读最后一部分教程 [[XXX Pro]] 了解我们最爱的功能和使用技巧。</p>
<h2 id="xxx-pro" style="position:relative;"><a href="#xxx-pro" aria-label="xxx pro permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>XXX Pro</h2>
<p>这是教程的最后一部分！ 你可以查看 XXX 教程的其他章节，[[欢迎来到 XXX]] 和 [[管理与发布]]。</p>
<h2 id="附加功能" style="position:relative;"><a href="#%E9%99%84%E5%8A%A0%E5%8A%9F%E8%83%BD" aria-label="附加功能 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>附加功能</h2>
<p>你可以在 iPad、iPhone 和 Mac 上使用 XXX 绝大多数的核心功能。 我们希望这独特的工具能让所有人都写出漂亮、整洁的笔记。</p>
<p>如果你想要解锁附加功能和漂亮的主题，并支持 XXX 的持续开发，你可以在应用内订阅 <a href="XXX://x-callback-url/open-XXX-pro">XXX Pro</a>。 订阅 XXX Pro 即可解锁：</p>
<ul>
<li>在 iPad、iPhone 和 Mac 上的 XXX 之间 <em>同步</em> 所有笔记。 本服务由 CloudKit 提供。 在 [[管理与发布]] 中了解更多关于 XXX 同步和自动保存的内容。</li>
<li>以多种文件格式 <em>导出</em> 并随意发布和分享。</li>
<li><em>漂亮的主题</em> - 目前已发布 8 款，更多即将到来。主题为你提供适合、舒服的写作环境，激发你的创造力。</li>
</ul>
<p>XXX Pro 提供免费试用。 包月订阅服务将赠送你一周免费试用期。 包年订阅服务则赠送一个月免费试用期。 在 iPad、iPhone 和 Mac 上的的应用内设置菜单中了解 <a href="XXX://x-callback-url/open-XXX-pro">XXX Pro</a>。</p>
<h2 id="高级搜索" style="position:relative;"><a href="#%E9%AB%98%E7%BA%A7%E6%90%9C%E7%B4%A2" aria-label="高级搜索 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>高级搜索</h2>
<p>在 XXX 中可即时搜索所有笔记，我们也提供一些 <em>特殊搜索</em> 功能，帮助你找到笔记中的特定内容。</p>
<p>例如，你可以将仍然需要执行的计划任务写在笔记中。 在 iOS 中，将快捷工具条左滑，选择任务按钮（中间有对勾的方块）。 在 Mac 上，则选择格式 -> 待办事项 -> 切换。</p>
<p>现在，在 XXX 的搜索框中，你可以输入 “@todo” 或 “@task” 来查找尚未完成的任务。 同时，你可以通过搜索 “@done” 找到已经完成的任务内容。</p>
<p>XXX 支持的搜索命令有：“@todo、@task、@done、@code、@tagged、@untagged、@files、@images、@attachments”。
<a href="https://vimeo.com/182400202" target="_target" rel="nofollow">查看此视频</a> 了解 XXX 的搜索功能如何使用。</p>
<p>最后，你还可以使用英文双引号来精确搜索词语，例如：「“XXX is cool”」。</p>
<h2 id="小技巧-" style="position:relative;"><a href="#%E5%B0%8F%E6%8A%80%E5%B7%A7-" aria-label="小技巧  permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>小技巧 🎩</h2>
<p>XXX 中所有的标签都可长按。 试试看，隐藏键盘后长按#欢迎/pro#包含此标签的所有笔记列表即会出现。</p>
<p>在 Mac 上，你可以隐藏侧边栏和/或笔记列表，享受无干扰的写作环境（iOS 上自动提供这种环境 😉）。 使用 <em>布局选择器</em> （右下角图标）查看可用选项</p>
<h2 id="反馈-" style="position:relative;"><a href="#%E5%8F%8D%E9%A6%88-" aria-label="反馈  permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>反馈 💬</h2>
<p>我们/希望/了解你的反馈，发信到 <a href="mailto:XXX@shinyfrog.net" target="_target" rel="nofollow">XXX@shinyfrog.net</a>。</p>
<p>感谢使用 XXX，祝你写作愉快！</p>
<p>🎉 🐻 🎉</p>
<p>首先介绍一下 XXX 是什么，XXX 是专业的 Markdown 写作、记笔记、静态博客生成软件。</p>
<p>然后这里<strong>重点说明</strong>一下：XXX 有<strong>两个模式</strong>，外部模式和文档库模式。外部模式中把本地硬盘或 Dropbox 等网盘的文件夹引入，就可以使用 XXX 的拖拽、粘贴插入图片、图床等特色功能。文档库模式设计为用于记笔记和静态博客生成。对于有<strong>同步和协作需求</strong>的朋友，请使用外部模式！使用视图菜单或者快捷键 <code class="language-text">CMD + E</code> 可以打开外部模式，<code class="language-text">CMD + L</code> 可以打开文档库。</p>
<h2 id="xxx-大概用法、视图模式和预览界面" style="position:relative;"><a href="#xxx-%E5%A4%A7%E6%A6%82%E7%94%A8%E6%B3%95%E3%80%81%E8%A7%86%E5%9B%BE%E6%A8%A1%E5%BC%8F%E5%92%8C%E9%A2%84%E8%A7%88%E7%95%8C%E9%9D%A2" aria-label="xxx 大概用法、视图模式和预览界面 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>XXX 大概用法、视图模式和预览界面</h2>
<p>XXX 使用菜单、快捷键和少量按钮完成所有操作，一般常用的操作都会有快捷键。整个界面使用三栏式结构，非常简洁。左边的第一第二栏是使用<strong>右键</strong>和底部的几个按钮操作，另外就是右上角有三个按钮了（外部模式是两个），快捷键分别是：<code class="language-text">CMD + 7/8/9</code>。另外就是切换视图模式的快捷键了，建议看一下 <code class="language-text">标记</code> 菜单和 <code class="language-text">视图</code> 菜单。</p>
<ul>
<li>快捷键：<code class="language-text">CMD + 1</code> 是在仅编辑器模式和三栏模式中切换。</li>
<li>快捷键：<code class="language-text">CMD + 2</code> 是在二栏模式和仅编辑器模式中切换。</li>
<li>快捷键：<code class="language-text">CMD + 3</code> 是在三栏模式和仅编辑器模式中切换。</li>
<li>快捷键：<code class="language-text">CMD + 4</code> 是在编辑器/预览模式和三栏模式中切换。</li>
<li>快捷键：<code class="language-text">CMD + R</code> 是在编辑器和预览模式中切换。</li>
</ul>
<p><strong>特别说明</strong>：当 <code class="language-text">偏好设置</code> - <code class="language-text">通用设置</code> 中 <code class="language-text">切换视图模式（二三栏）时，保持编辑器大小不变</code> 被勾选后，<code class="language-text">CMD + 1/2/3/4</code> 的行为会发生变化，具体如何，可以尝试一下。而 <code class="language-text">在新窗口中打开实时预览（CMD + R）</code> 这个选项被选中后，快捷键 <code class="language-text">CMD + R</code> 会打开新的窗口来预览文档。</p>
<h2 id="更多的了解-xxx" style="position:relative;"><a href="#%E6%9B%B4%E5%A4%9A%E7%9A%84%E4%BA%86%E8%A7%A3-xxx" aria-label="更多的了解 xxx permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>更多的了解 XXX</h2>
<ul>
<li>XXX 使用的是 Github Flavored Markdown 语法，请一定要打开 <code class="language-text">帮助</code> - <code class="language-text">Markdown 语法</code> 菜单看一下。</li>
<li>请一定要去官网首页看看，网址：<a href="http://zh.XXX.im" target="_target" rel="nofollow">http://zh.XXX.im</a>。</li>
<li>请一定要看一下官网的帮助，用菜单 <code class="language-text">帮助</code> - <code class="language-text">帮助...</code> 即可打开，也可以用网址：<a href="http://zh.XXX.im/help.html" target="_target" rel="nofollow">http://zh.XXX.im/help.html</a>。</li>
</ul>
<h2 id="帮助我们改进-xxx" style="position:relative;"><a href="#%E5%B8%AE%E5%8A%A9%E6%88%91%E4%BB%AC%E6%94%B9%E8%BF%9B-xxx" aria-label="帮助我们改进 xxx permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>帮助我们改进 XXX</h2>
<p>如果你喜欢 XXX，想让它变得更好，你可以：</p>
<ol>
<li>推荐 XXX，让更多的人知道。</li>
<li>给我们发反馈和建议：<a href="mailto:coderforart+233@gmail.com" target="_target" rel="nofollow">coderforart+233@gmail.com</a></li>
<li>在 Mac App Store 上评价 （如果是在 MAS 上购买的话）。</li>
</ol>
<h2 id="markdown-的设计哲学" style="position:relative;"><a href="#markdown-%E7%9A%84%E8%AE%BE%E8%AE%A1%E5%93%B2%E5%AD%A6" aria-label="markdown 的设计哲学 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Markdown 的设计哲学</h2>
<blockquote>
<p>Markdown 的目標是實現「易讀易寫」。不過最需要強調的便是它的可讀性。一份使用 Markdown 格式撰寫的文件應該可以直接以純文字發佈，並且看起來不會像是由許多標籤或是格式指令所構成。
Markdown 的語法有個主要的目的：用來作為一種網路內容的<em>寫作</em>用語言。</p>
</blockquote>
<!-- more -->
<h2 id="本文约定" style="position:relative;"><a href="#%E6%9C%AC%E6%96%87%E7%BA%A6%E5%AE%9A" aria-label="本文约定 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>本文约定</h2>
<p>如果有写 <code class="language-text">效果如下：</code>， 在 XXX 编辑状态下只有用 <code class="language-text">CMD + 4</code> 或 <code class="language-text">CMD + R</code> 预览才可以看效果。</p>
<h2 id="标题" style="position:relative;"><a href="#%E6%A0%87%E9%A2%98" aria-label="标题 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>标题</h2>
<p>Markdown 语法：</p>
<div class="gatsby-highlight" data-language="markdown"><pre class="language-markdown"><code class="language-markdown"><span class="token title important"><span class="token punctuation">#</span> 第一级标题 </span><span class="token code keyword">`&lt;h1>`</span>

<span class="token title important"><span class="token punctuation">##</span> 第二级标题 </span><span class="token code keyword">`&lt;h2>`</span>

<span class="token title important"><span class="token punctuation">######</span> 第六级标题 </span><span class="token code keyword">`&lt;h6>`</span></code></pre></div>
<p>效果如下：</p>
<h1 id="第一级标题-code-classlanguage-textlth1gtcode" style="position:relative;"><a href="#%E7%AC%AC%E4%B8%80%E7%BA%A7%E6%A0%87%E9%A2%98-code-classlanguage-textlth1gtcode" aria-label="第一级标题 code classlanguage textlth1gtcode permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>第一级标题 <code class="language-text">&lt;h1&gt;</code></h1>
<h2 id="第二级标题-code-classlanguage-textlth2gtcode" style="position:relative;"><a href="#%E7%AC%AC%E4%BA%8C%E7%BA%A7%E6%A0%87%E9%A2%98-code-classlanguage-textlth2gtcode" aria-label="第二级标题 code classlanguage textlth2gtcode permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>第二级标题 <code class="language-text">&lt;h2&gt;</code></h2>
<h6 id="第六级标题-code-classlanguage-textlth6gtcode" style="position:relative;"><a href="#%E7%AC%AC%E5%85%AD%E7%BA%A7%E6%A0%87%E9%A2%98-code-classlanguage-textlth6gtcode" aria-label="第六级标题 code classlanguage textlth6gtcode permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>第六级标题 <code class="language-text">&lt;h6&gt;</code></h6>
<h2 id="强调" style="position:relative;"><a href="#%E5%BC%BA%E8%B0%83" aria-label="强调 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>强调</h2>
<p>Markdown 语法：</p>
<div class="gatsby-highlight" data-language="markdown"><pre class="language-markdown"><code class="language-markdown"><span class="token italic"><span class="token punctuation">_</span><span class="token content">这些文字会生成`&lt;em>`</span><span class="token punctuation">_</span></span>
<span class="token italic"><span class="token punctuation">_</span><span class="token content">这些文字会生成`&lt;u>`</span><span class="token punctuation">_</span></span>

<span class="token bold"><span class="token punctuation">**</span><span class="token content">这些文字会生成`&lt;strong>`</span><span class="token punctuation">**</span></span>
<span class="token bold"><span class="token punctuation">**</span><span class="token content">这些文字会生成`&lt;strong>`</span><span class="token punctuation">**</span></span></code></pre></div>
<p>在 XXX 中的快捷键为： <code class="language-text">CMD + U</code>、<code class="language-text">CMD + I</code>、<code class="language-text">CMD + B</code>
效果如下：</p>
<p><em>这些文字会生成<code class="language-text">&lt;em&gt;</code></em>
<em>这些文字会生成<code class="language-text">&lt;u&gt;</code></em></p>
<p><strong>这些文字会生成<code class="language-text">&lt;strong&gt;</code></strong>
<strong>这些文字会生成<code class="language-text">&lt;strong&gt;</code></strong></p>
<h2 id="换行" style="position:relative;"><a href="#%E6%8D%A2%E8%A1%8C" aria-label="换行 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>换行</h2>
<p>四个及以上空格加回车。如果不想打这么多空格，只要回车就为换行，请勾选：<code class="language-text">Preferences</code> - <code class="language-text">Themes</code> - <code class="language-text">Translate newlines to &lt;br&gt; tags</code></p>
<h2 id="列表" style="position:relative;"><a href="#%E5%88%97%E8%A1%A8" aria-label="列表 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>列表</h2>
<h3 id="无序列表" style="position:relative;"><a href="#%E6%97%A0%E5%BA%8F%E5%88%97%E8%A1%A8" aria-label="无序列表 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>无序列表</h3>
<p>Markdown 语法：</p>
<div class="gatsby-highlight" data-language="markdown"><pre class="language-markdown"><code class="language-markdown"><span class="token list punctuation">-</span> 项目一 无序列表 <span class="token code keyword">`* + 空格键`</span>
<span class="token list punctuation">-</span> 项目二
<span class="token list punctuation">-</span> 项目二的子项目一 无序列表 <span class="token code keyword">`TAB + * + 空格键`</span>
<span class="token list punctuation">-</span> 项目二的子项目二</code></pre></div>
<p>在 XXX 中的快捷键为： <code class="language-text">Option + U</code>
效果如下：</p>
<ul>
<li>项目一 无序列表 <code class="language-text">* + 空格键</code></li>
<li>项目二</li>
<li>项目二的子项目一 无序列表 <code class="language-text">TAB + * + 空格键</code></li>
<li>项目二的子项目二</li>
</ul>
<h3 id="有序列表" style="position:relative;"><a href="#%E6%9C%89%E5%BA%8F%E5%88%97%E8%A1%A8" aria-label="有序列表 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>有序列表</h3>
<p>Markdown 语法：</p>
<div class="gatsby-highlight" data-language="markdown"><pre class="language-markdown"><code class="language-markdown"><span class="token list punctuation">1.</span>  项目一 有序列表 <span class="token code keyword">`数字 + . + 空格键`</span>
<span class="token list punctuation">2.</span>  项目二
<span class="token list punctuation">3.</span>  项目三
<span class="token list punctuation">4.</span>  项目三的子项目一 有序列表 <span class="token code keyword">`TAB + 数字 + . + 空格键`</span>
<span class="token list punctuation">5.</span>  项目三的子项目二</code></pre></div>
<p>效果如下：</p>
<ol>
<li>项目一 有序列表 <code class="language-text">数字 + . + 空格键</code></li>
<li>项目二</li>
<li>项目三</li>
<li>项目三的子项目一 有序列表 <code class="language-text">TAB + 数字 + . + 空格键</code></li>
<li>项目三的子项目二</li>
</ol>
<h3 id="任务列表（task-lists）" style="position:relative;"><a href="#%E4%BB%BB%E5%8A%A1%E5%88%97%E8%A1%A8%EF%BC%88task-lists%EF%BC%89" aria-label="任务列表（task lists） permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>任务列表（Task lists）</h3>
<p>Markdown 语法：</p>
<div class="gatsby-highlight" data-language="markdown"><pre class="language-markdown"><code class="language-markdown"><span class="token list punctuation">-</span> [ ] 任务一 未做任务 <span class="token code keyword">`- + 空格 + [ ]`</span>
<span class="token list punctuation">-</span> [x] 任务二 已做任务 <span class="token code keyword">`- + 空格 + [x]`</span></code></pre></div>
<p>效果如下：</p>
<ul>
<li class="task-list-item"><input type="checkbox" disabled> 任务一 未做任务 <code class="language-text">- + 空格 + [ ]</code></li>
<li class="task-list-item"><input type="checkbox" checked disabled> 任务二 已做任务 <code class="language-text">- + 空格 + [x]</code></li>
</ul>
<h2 id="图片" style="position:relative;"><a href="#%E5%9B%BE%E7%89%87" aria-label="图片 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>图片</h2>
<p>Markdown 语法：</p>
<div class="gatsby-highlight" data-language="markdown"><pre class="language-markdown"><code class="language-markdown"><span class="token url">![<span class="token content">GitHub set up</span>](http://zh.XXX.im/asset/img/set-up-git.gif)</span>
格式: <span class="token url">![<span class="token content">Alt Text</span>](url)</span></code></pre></div>
<p><code class="language-text">Control + Shift + I</code> 可插入 Markdown 语法。如果是 XXX 的文档库中的文档，还可以用拖放图片、<code class="language-text">CMD + V</code> 粘贴、<code class="language-text">CMD + Option + I</code> 导入这三种方式来增加图片。效果如下：</p>
<p><img src="http://zh.XXX.im/asset/img/set-up-git.gif" alt="GitHub set up"></p>
<p>XXX 引入的特别的语法来设置图片宽度，方法是在图片描述后加 <code class="language-text">-w + 图片宽度</code> 即可，比如说要设置上面的图片的宽度为 140，语法如下：</p>
<p><img src="http://zh.XXX.im/asset/img/set-up-git.gif" alt="GitHub set up-w140"></p>
<h2 id="链接" style="position:relative;"><a href="#%E9%93%BE%E6%8E%A5" aria-label="链接 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>链接</h2>
<p>Markdown 语法：</p>
<div class="gatsby-highlight" data-language="markdown"><pre class="language-markdown"><code class="language-markdown">email <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">mailto:</span>example@example.com</span><span class="token punctuation">></span></span>
<span class="token url">[<span class="token content">GitHub</span>](http://github.com)</span>
自动生成连接 &lt;http://www.github.com/></code></pre></div>
<p><code class="language-text">Control + Shift + L</code> 可插入 Markdown 语法。如果是 XXX 的文档库中的文档，拖放或<code class="language-text">CMD + Option + I</code> 导入非图片时，会生成连接。效果如下：</p>
<p>Email 连接： <a href="mailto:example@example.com" target="_target" rel="nofollow">example@example.com</a>
<a href="http://github.com" target="_target" rel="nofollow">连接标题 Github 网站</a>
自动生成连接像： <a href="http://www.github.com/" target="_target" rel="nofollow">http://www.github.com/</a> 这样</p>
<h2 id="区块引用" style="position:relative;"><a href="#%E5%8C%BA%E5%9D%97%E5%BC%95%E7%94%A8" aria-label="区块引用 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>区块引用</h2>
<p>Markdown 语法：</p>
<div class="gatsby-highlight" data-language="markdown"><pre class="language-markdown"><code class="language-markdown">某某说:

<span class="token blockquote punctuation">></span> 第一行引用第二行费用文字</code></pre></div>
<p><code class="language-text">CMD + Shift + B</code> 可插入 Markdown 语法。效果如下：</p>
<p>某某说:</p>
<blockquote>
<p>第一行引用第二行费用文字</p>
</blockquote>
<h2 id="行内代码" style="position:relative;"><a href="#%E8%A1%8C%E5%86%85%E4%BB%A3%E7%A0%81" aria-label="行内代码 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>行内代码</h2>
<p>Markdown 语法：</p>
<div class="gatsby-highlight" data-language="markdown"><pre class="language-markdown"><code class="language-markdown">像这样即可：<span class="token code keyword">`&lt;addr>`</span> <span class="token code keyword">`code`</span></code></pre></div>
<p><code class="language-text">CMD + K</code> 可插入 Markdown 语法。效果如下：</p>
<p>像这样即可：<code class="language-text">&lt;addr&gt;</code> <code class="language-text">code</code></p>
<h2 id="多行或者一段代码" style="position:relative;"><a href="#%E5%A4%9A%E8%A1%8C%E6%88%96%E8%80%85%E4%B8%80%E6%AE%B5%E4%BB%A3%E7%A0%81" aria-label="多行或者一段代码 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>多行或者一段代码</h2>
<p>Markdown 语法：</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">```js
function fancyAlert(arg) {
    if(arg) {
    $.facebox({div:&#39;#foo&#39;})
    }
}
```</code></pre></div>
<p><code class="language-text">CMD + Shift + K</code> 可插入 Markdown 语法。效果如下：</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">fancyAlert</span><span class="token punctuation">(</span><span class="token parameter">arg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>arg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    $<span class="token punctuation">.</span><span class="token function">facebox</span><span class="token punctuation">(</span><span class="token punctuation">{</span> div<span class="token operator">:</span> <span class="token string">"#foo"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<h2 id="顺序图或流程图" style="position:relative;"><a href="#%E9%A1%BA%E5%BA%8F%E5%9B%BE%E6%88%96%E6%B5%81%E7%A8%8B%E5%9B%BE" aria-label="顺序图或流程图 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>顺序图或流程图</h2>
<p>Markdown 语法：</p>
<div class="gatsby-highlight" data-language="markdown"><pre class="language-markdown"><code class="language-markdown">    ```sequence
    张三->李四: 嘿，小四儿, 写博客了没?
    Note right of 李四: 李四愣了一下，说：
    李四-->张三: 忙得吐血，哪有时间写。
    ```</code></pre></div>
<p>效果如下（ <code class="language-text">Preferences</code> - <code class="language-text">Themes</code> - <code class="language-text">Enable sequence &amp; flow chart</code> 才会看到效果 ）：</p>
<div class="gatsby-highlight" data-language="sequence"><pre class="language-sequence"><code class="language-sequence">Andrew-&gt;China: Says Hello
Note right of China: China thinks\nabout it
China--&gt;Andrew: How are you?
Andrew-&gt;&gt;China: I am good thanks!</code></pre></div>
<div class="gatsby-highlight" data-language="sequence"><pre class="language-sequence"><code class="language-sequence">张三-&gt;李四: 嘿，小四儿, 写博客了没?
Note right of 李四: 李四愣了一下，说：
李四--&gt;张三: 忙得吐血，哪有时间写。</code></pre></div>
<p>更多请参考：<a href="http://bramp.github.io/js-sequence-diagrams/" target="_target" rel="nofollow">http://bramp.github.io/js-sequence-diagrams/</a>, <a href="http://adrai.github.io/flowchart.js/" target="_target" rel="nofollow">http://adrai.github.io/flowchart.js/</a></p>
<h2 id="表格" style="position:relative;"><a href="#%E8%A1%A8%E6%A0%BC" aria-label="表格 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>表格</h2>
<p>Markdown 语法：</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">第一格表头 | 第二格表头
--------- | -------------
内容单元格 第一列第一格 | 内容单元格第二列第一格
内容单元格 第一列第二格 多加文字 | 内容单元格第二列第二格</code></pre></div>
<p>效果如下：</p>
<table>
<thead>
<tr>
<th>第一格表头</th>
<th>第二格表头</th>
</tr>
</thead>
<tbody>
<tr>
<td>内容单元格 第一列第一格</td>
<td>内容单元格第二列第一格</td>
</tr>
<tr>
<td>内容单元格 第一列第二格 多加文字</td>
<td>内容单元格第二列第二格</td>
</tr>
</tbody>
</table>
<h2 id="删除线" style="position:relative;"><a href="#%E5%88%A0%E9%99%A4%E7%BA%BF" aria-label="删除线 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>删除线</h2>
<p>Markdown 语法：</p>
<p>加删除线像这样用： <del>删除这些</del></p>
<p>效果如下：</p>
<p>加删除线像这样用： <del>删除这些</del></p>
<h2 id="分隔线" style="position:relative;"><a href="#%E5%88%86%E9%9A%94%E7%BA%BF" aria-label="分隔线 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>分隔线</h2>
<p>以下三种方式都可以生成分隔线：</p>
<hr>
<hr>
<hr>
<p>效果如下：</p>
<hr>
<hr>
<hr>
<h2 id="math" style="position:relative;"><a href="#math" aria-label="math permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Math</h2>
<p>Markdown 语法：</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">块级公式：
$$	x = \dfrac{-b \pm \sqrt{b^2 - 4ac}}{2a} $$


行内公式： $\Gamma(n) = (n-1)!\quad\forall n\in\mathbb N$</code></pre></div>
<p>效果如下（<code class="language-text">Preferences</code> - <code class="language-text">Themes</code> - <code class="language-text">Enable MathJax</code> 才会看到效果）：</p>
<p>块级公式：
<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mo>=</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mrow><mo>−</mo><mi>b</mi><mo>±</mo><msqrt><mrow><msup><mi>b</mi><mn>2</mn></msup><mo>−</mo><mn>4</mn><mi>a</mi><mi>c</mi></mrow></msqrt></mrow><mrow><mn>2</mn><mi>a</mi></mrow></mfrac></mstyle></mrow><annotation encoding="application/x-tex">x = \dfrac{-b \pm \sqrt{b^2 - 4ac}}{2a}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.276389em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.590389em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mord mathdefault">a</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">−</span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">±</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.913389em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">4</span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span></span></span><span style="top:-2.873389em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,
-10,-9.5,-14c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54c44.2,-33.3,65.8,
-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10s173,378,173,378c0.7,0,
35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429c69,-144,104.5,-217.7,106.5,
-221c5.3,-9.3,12,-14,20,-14H400000v40H845.2724s-225.272,467,-225.272,467
s-235,486,-235,486c-2.7,4.7,-9,7,-19,7c-6,0,-10,-1,-12,-3s-194,-422,-194,-422
s-65,47,-65,47z M834 80H400000v40H845z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.12661100000000003em;"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p>
<p>行内公式： <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Γ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">!</mo><mspace width="1em"/><mi mathvariant="normal">∀</mi><mi>n</mi><mo>∈</mo><mi mathvariant="double-struck">N</mi></mrow><annotation encoding="application/x-tex">\Gamma(n) = (n-1)!\quad\forall n\in\mathbb N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Γ</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mclose">!</span><span class="mspace" style="margin-right:1em;"></span><span class="mord">∀</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68889em;vertical-align:0em;"></span><span class="mord mathbb">N</span></span></span></span></p>
<h2 id="脚注（footnote）" style="position:relative;"><a href="#%E8%84%9A%E6%B3%A8%EF%BC%88footnote%EF%BC%89" aria-label="脚注（footnote） permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>脚注（Footnote）</h2>
<p>Markdown 语法：</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">这是一个脚注：[^sample_footnote]</code></pre></div>
<p>效果如下：</p>
<p>这是一个脚注：<sup id="fnref-1"><a href="#fn-1" class="footnote-ref">1</a></sup>, <sup id="fnref-2"><a href="#fn-2" class="footnote-ref">2</a></sup></p>
<h2 id="注释和阅读更多" style="position:relative;"><a href="#%E6%B3%A8%E9%87%8A%E5%92%8C%E9%98%85%E8%AF%BB%E6%9B%B4%E5%A4%9A" aria-label="注释和阅读更多 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>注释和阅读更多</h2>
<!-- comment -->
<!-- more -->
<p>Actions->Insert Read More Comment <em>或者</em> <code class="language-text">Command + .</code>
<strong>注</strong> 阅读更多的功能只用在生成网站或博客时，插入时注意要后空一行。</p>
<div class="footnotes">
<hr>
<ol>
<li id="fn-1">
<p>这里是脚注信息 1</p>
<a href="#fnref-1" class="footnote-backref">↩</a>
</li>
<li id="fn-2">
<p>这里是脚注信息 2</p>
<a href="#fnref-2" class="footnote-backref">↩</a>
</li>
</ol>
</div>]]></description><link>https://xiangst0816.github.io/blog/zhongwen-test/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/zhongwen-test/</guid><category><![CDATA[Test]]></category><dc:creator><![CDATA[WALL-E]]></dc:creator><pubDate>Fri, 16 Mar 2018 07:49:24 GMT</pubDate></item><item><title><![CDATA[英文测试(内容已改动)]]></title><description><![CDATA[<p><img src="http://macdown.uranusjr.com/static/images/logo-160.png" alt="MacDown logo"></p>
<p>Hello there! I’m <strong>MacDown</strong>, the open source Markdown editor for OS X.</p>
<p>Let me introduce myself.</p>
<h2 id="markdown-and-i" style="position:relative;"><a href="#markdown-and-i" aria-label="markdown and i permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Markdown and I</h2>
<p><strong>Markdown</strong> is a plain text formatting syntax created by John Gruber, aiming to provide a easy-to-read and feasible markup. The original Markdown syntax specification can be found <a href="http://daringfireball.net/projects/markdown/syntax" target="_target" rel="nofollow">here</a>.</p>
<p><strong>MacDown</strong> is created as a simple-to-use editor for Markdown documents. I render your Markdown contents real-time into HTML, and display them in a preview panel.</p>
<p><img src="http://d.pr/i/10UGP+" alt="MacDown Screenshot"></p>
<p>I support all the original Markdown syntaxes. But I can do so much more! Various popular but non-standard syntaxes can be turned on/off from the <a href="#markdown-pane"><strong>Markdown</strong> preference pane</a>.</p>
<p>You can specify extra HTML rendering options through the <a href="#rendering-pane"><strong>Rendering</strong> preference pane</a>.</p>
<p>You can customize the editor window to you liking in the <a href="#editor-pane"><strong>Editor</strong> preferences pane</a>:</p>
<p>You can configure various application (that’s me!) behaviors in the <a href="#general-pane"><strong>General</strong> preference pane</a>.</p>
<h2 id="the-basics" style="position:relative;"><a href="#the-basics" aria-label="the basics permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>The Basics</h2>
<p>Before I tell you about all the extra syntaxes and capabilities I have, I’ll introduce you to the basics of standard markdown. If you already know markdown, and want to jump straight to learning about the fancier things I can do, I suggest you skip to the <a href="#markdown-pane"><strong>Markdown</strong> preference pane</a>. Lets jump right in.</p>
<h3 id="line-breaks" style="position:relative;"><a href="#line-breaks" aria-label="line breaks permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Line Breaks</h3>
<p>To force a line break, put two spaces and a newline (return) at the end of the line.</p>
<ul>
<li>This two-line bullet
won’t break</li>
<li>This two-line bullet<br>
will break</li>
</ul>
<p>Here is the code:</p>
<div class="gatsby-highlight" data-language="markdown"><pre class="language-markdown"><code class="language-markdown"><span class="token list punctuation">-</span> This two-line bullet
  won't break

<span class="token list punctuation">-</span> This two-line bullet  
  will break</code></pre></div>
<h3 id="strong-and-emphasize" style="position:relative;"><a href="#strong-and-emphasize" aria-label="strong and emphasize permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Strong and Emphasize</h3>
<p><strong>Strong</strong>: <code class="language-text">**Strong**</code> or <code class="language-text">__Strong__</code><br>
<em>Emphasize</em>: <code class="language-text">*Emphasize*</code> or <code class="language-text">_Emphasize_</code><sup id="fnref-2"><a href="#fn-2" class="footnote-ref">2</a></sup></p>
<h3 id="headers-like-this-one" style="position:relative;"><a href="#headers-like-this-one" aria-label="headers like this one permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Headers (like this one!)</h3>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">Header 1
========

Header 2
--------</code></pre></div>
<p>or</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text"># Header 1
## Header 2
### Header 3
#### Header 4
##### Header 5
###### Header 6</code></pre></div>
<h3 id="links-and-email" style="position:relative;"><a href="#links-and-email" aria-label="links and email permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Links and Email</h3>
<h4 id="inline" style="position:relative;"><a href="#inline" aria-label="inline permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Inline</h4>
<p>Just put angle brackets around an email and it becomes clickable: <a href="mailto:uranusjr@gmail.com" target="_target" rel="nofollow">uranusjr@gmail.com</a><br>
<code class="language-text">&lt;uranusjr@gmail.com&gt;</code></p>
<p>Same thing with urls: <a href="http://macdown.uranusjr.com" target="_target" rel="nofollow">http://macdown.uranusjr.com</a><br>
<code class="language-text">&lt;http://macdown.uranusjr.com&gt;</code></p>
<p>Perhaps you want to some link text like this: <a href="http://macdown.uranusjr.com" title="Title" target="_target" rel="nofollow">Macdown Website</a><br>
<code class="language-text">[Macdown Website](http://macdown.uranusjr.com &quot;Title&quot;)</code> (The title is optional)</p>
<h4 id="reference-style" style="position:relative;"><a href="#reference-style" aria-label="reference style permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Reference style</h4>
<p>Sometimes it looks too messy to include big long urls inline, or you want to keep all your urls together.</p>
<p>Make <a href="http://macdown.uranusjr.com" title="Title" target="_target" rel="nofollow">a link</a> <code class="language-text">[a link][arbitrary_id]</code> then on it’s own line anywhere else in the file:<br>
<code class="language-text">[arbitrary_id]: http://macdown.uranusjr.com &quot;Title&quot;</code></p>
<p>If the link text itself would make a good id, you can link <a href="http://macdown.uranusjr.com" target="_target" rel="nofollow">like this</a> <code class="language-text">[like this][]</code>, then on it’s own line anywhere else in the file:<br>
<code class="language-text">[like this]: http://macdown.uranusjr.com</code></p>
<h3 id="images" style="position:relative;"><a href="#images" aria-label="images permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Images</h3>
<h4 id="inline-1" style="position:relative;"><a href="#inline-1" aria-label="inline 1 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Inline</h4>
<p><code class="language-text">![Alt Image Text](path/or/url/to.jpg &quot;Optional Title&quot;)</code></p>
<h4 id="reference-style-1" style="position:relative;"><a href="#reference-style-1" aria-label="reference style 1 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Reference style</h4>
<p><code class="language-text">![Alt Image Text][image-id]</code><br>
on it’s own line elsewhere:<br>
<code class="language-text">[image-id]: path/or/url/to.jpg &quot;Optional Title&quot;</code></p>
<h3 id="lists" style="position:relative;"><a href="#lists" aria-label="lists permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Lists</h3>
<ul>
<li>Lists must be preceded by a blank line (or block element)</li>
<li>Unordered lists start each item with a <code class="language-text">*</code></li>
<li><code class="language-text">-</code> works too * Indent a level to make a nested list 1. Ordered lists are supported. 2. Start each item (number-period-space) like <code class="language-text">1.</code> 42. It doesn’t matter what number you use, I will render them sequentially 1. So you might want to start each line with <code class="language-text">1.</code> and let me sort it out</li>
</ul>
<p>Here is the code:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">* Lists must be preceded by a blank line (or block element)
* Unordered lists start each item with a `*`
- `-` works too
	* Indent a level to make a nested list
		1. Ordered lists are supported.
		2. Start each item (number-period-space) like `1. `
		42. It doesn&#39;t matter what number you use, I will render them sequentially
		1. So you might want to start each line with `1.` and let me sort it out</code></pre></div>
<h3 id="block-quote" style="position:relative;"><a href="#block-quote" aria-label="block quote permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Block Quote</h3>
<blockquote>
<p>Angle brackets <code class="language-text">&gt;</code> are used for block quotes.<br>
Technically not every line needs to start with a <code class="language-text">&gt;</code> as long as
there are no empty lines between paragraphs.<br>
Looks kinda ugly though.</p>
<blockquote>
<p>Block quotes can be nested.</p>
<blockquote>
<p>Multiple Levels</p>
</blockquote>
</blockquote>
<p>Most markdown syntaxes work inside block quotes.</p>
<ul>
<li>Lists</li>
<li><a href="http://macdown.uranusjr.com" title="Title" target="_target" rel="nofollow">Links</a></li>
<li>Etc.</li>
</ul>
</blockquote>
<p>Here is the code:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">&gt; Angle brackets `&gt;` are used for block quotes.
Technically not every line needs to start with a `&gt;` as long as
there are no empty lines between paragraphs.
&gt; Looks kinda ugly though.
&gt; &gt; Block quotes can be nested.
&gt; &gt; &gt; Multiple Levels
&gt;
&gt; Most markdown syntaxes work inside block quotes.
&gt;
&gt; * Lists
&gt; * [Links][arbitrary_id]
&gt; * Etc.</code></pre></div>
<h3 id="inline-code" style="position:relative;"><a href="#inline-code" aria-label="inline code permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Inline Code</h3>
<p><code class="language-text">Inline code</code> is indicated by surrounding it with backticks:<br>
<code class="language-text">`Inline code`</code></p>
<p>If your <code class="language-text">code has `backticks`</code> that need to be displayed, you can use double backticks:<br>
<code class="language-text">``Code with</code>backticks<code class="language-text">``</code> (mind the spaces preceding the final set of backticks)</p>
<h3 id="block-code" style="position:relative;"><a href="#block-code" aria-label="block code permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Block Code</h3>
<p>If you indent at least four spaces or one tab, I’ll display a code block.</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">print(&#39;This is a code block&#39;)
print(&#39;The block must be preceded by a blank line&#39;)
print(&#39;Then indent at least 4 spaces or 1 tab&#39;)
	print(&#39;Nesting does nothing. Your code is displayed Literally&#39;)</code></pre></div>
<p>I also know how to do something called <a href="#fenced-code-block">Fenced Code Blocks</a> which I will tell you about later.</p>
<h3 id="horizontal-rules" style="position:relative;"><a href="#horizontal-rules" aria-label="horizontal rules permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Horizontal Rules</h3>
<p>If you type three asterisks <code class="language-text">***</code> or three dashes <code class="language-text">---</code> on a line, I’ll display a horizontal rule:</p>
<hr>
<h2 id="a-namemarkdown-paneathe-markdown-preference-pane" style="position:relative;"><a href="#a-namemarkdown-paneathe-markdown-preference-pane" aria-label="a namemarkdown paneathe markdown preference pane permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><a name="markdown-pane"></a>The Markdown Preference Pane</h2>
<p>This is where I keep all preferences related to how I parse markdown into html.<br>
<img src="http://d.pr/i/RQEi+" alt="Markdown preferences pane"></p>
<h3 id="document-formatting" style="position:relative;"><a href="#document-formatting" aria-label="document formatting permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Document Formatting</h3>
<p>The <strong><em>Smartypants</em></strong> extension automatically transforms straight quotes (<code class="language-text">&quot;</code> and <code class="language-text">&#39;</code>) in your text into typographer’s quotes (<code class="language-text">“</code>, <code class="language-text">”</code>, <code class="language-text">‘</code>, and <code class="language-text">’</code>) according to the context. Very useful if you’re a typography freak like I am. Quote and Smartypants are syntactically incompatible. If both are enabled, Quote takes precedence.</p>
<h3 id="block-formatting" style="position:relative;"><a href="#block-formatting" aria-label="block formatting permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Block Formatting</h3>
<h4 id="table" style="position:relative;"><a href="#table" aria-label="table permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Table</h4>
<p>This is a table:</p>
<table>
<thead>
<tr>
<th>First Header</th>
<th>Second Header</th>
</tr>
</thead>
<tbody>
<tr>
<td>Content Cell</td>
<td>Content Cell</td>
</tr>
<tr>
<td>Content Cell</td>
<td>Content Cell</td>
</tr>
</tbody>
</table>
<p>You can align cell contents with syntax like this:</p>
<table>
<thead>
<tr>
<th align="left">Left Aligned</th>
<th align="center">Center Aligned</th>
<th align="right">Right Aligned</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">col 3 is</td>
<td align="center">some wordy text</td>
<td align="right">$1600</td>
</tr>
<tr>
<td align="left">col 2 is</td>
<td align="center">centered</td>
<td align="right">$12</td>
</tr>
<tr>
<td align="left">zebra stripes</td>
<td align="center">are neat</td>
<td align="right">$1</td>
</tr>
</tbody>
</table>
<p>The left- and right-most pipes (<code class="language-text">|</code>) are only aesthetic, and can be omitted. The spaces don’t matter, either. Alignment depends solely on <code class="language-text">:</code> marks.</p>
<h4 id="a-namefenced-code-blockfenced-code-blocka" style="position:relative;"><a href="#a-namefenced-code-blockfenced-code-blocka" aria-label="a namefenced code blockfenced code blocka permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><a name="fenced-code-block">Fenced Code Block</a></h4>
<p>This is a fenced code block:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">print(&#39;Hello world!&#39;)</code></pre></div>
<p>You can also use waves (<code class="language-text">~</code>) instead of back ticks (<code class="language-text">`</code>):</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">print(&#39;Hello world!&#39;)</code></pre></div>
<p>You can add an optional language ID at the end of the first line. The language ID will only be used to highlight the code inside if you tick the <strong><em>Enable highlighting in code blocks</em></strong> option. This is what happens if you enable it:</p>
<p><img src="http://d.pr/i/9HM6+" alt="Syntax highlighting example"></p>
<p>I support many popular languages as well as some generic syntax descriptions that can be used if your language of choice is not supported. See <a href="http://macdown.uranusjr.com/features/" target="_target" rel="nofollow">relevant sections on the official site</a> for a full list of supported syntaxes.</p>
<h3 id="inline-formatting" style="position:relative;"><a href="#inline-formatting" aria-label="inline formatting permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Inline Formatting</h3>
<p>The following is a list of optional inline markups supported:</p>
<table>
<thead>
<tr>
<th>Option name</th>
<th>Markup</th>
<th>Result if enabled</th>
</tr>
</thead>
<tbody>
<tr>
<td>Intra-word emphasis</td>
<td>So A*maz*ing</td>
<td>So A<em>maz</em>ing</td>
</tr>
<tr>
<td>Strikethrough</td>
<td>~~Much wow~~</td>
<td><del>Much wow</del></td>
</tr>
<tr>
<td>Quote <sup id="fnref-4"><a href="#fn-4" class="footnote-ref">4</a></sup></td>
<td>”Such editor”</td>
<td>“Such editor”</td>
</tr>
<tr>
<td>Highlight</td>
<td><code class="language-text">&lt;mark&gt;So good&lt;/mark&gt;</code></td>
<td><mark>So good</mark></td>
</tr>
<tr>
<td>Superscript</td>
<td>hoge<sup>fuga</sup></td>
<td>hoge<sup>fuga</sup></td>
</tr>
<tr>
<td>Autolink</td>
<td><a href="http://t.co" target="_target" rel="nofollow">http://t.co</a></td>
<td><a href="http://t.co" target="_target" rel="nofollow">http://t.co</a></td>
</tr>
<tr>
<td>Footnotes</td>
<td>[^4] and [^4]:</td>
<td><sup id="fnref-1"><a href="#fn-1" class="footnote-ref">1</a></sup> and <sup id="fnref-1"><a href="#fn-1" class="footnote-ref">1</a></sup></td>
</tr>
</tbody>
</table>
<h2 id="a-namerendering-paneathe-rendering-preference-pane" style="position:relative;"><a href="#a-namerendering-paneathe-rendering-preference-pane" aria-label="a namerendering paneathe rendering preference pane permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><a name="rendering-pane"></a>The Rendering Preference Pane</h2>
<p>This is where I keep preferences relating to how I render and style the parsed markdown in the preview window.<br>
<img src="http://d.pr/i/rT4d+" alt="Rendering preferences pane"></p>
<h3 id="css" style="position:relative;"><a href="#css" aria-label="css permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>CSS</h3>
<p>You can choose different css files for me to use to render your html. You can even customize or add your own custom css files.</p>
<h3 id="syntax-highlighting" style="position:relative;"><a href="#syntax-highlighting" aria-label="syntax highlighting permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Syntax Highlighting</h3>
<p>You have already seen how I can syntax highlight your fenced code blocks. See the <a href="#fenced-code-block">Fenced Code Block</a> section if you haven’t! You can also choose different themes for syntax highlighting.</p>
<h3 id="katex" style="position:relative;"><a href="#katex" aria-label="katex permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>KaTeX</h3>
<p>I can also render math syntaxes, if you allow me to.<sup id="fnref-5"><a href="#fn-5" class="footnote-ref">5</a></sup> I can do inline math like this: \( 1 + 1 \) or this (in MathML): <math><mn>1</mn><mo>+</mo><mn>1</mn></math>, and block math:</p>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mo>∫</mo><mi mathvariant="normal">_</mi><msup><mrow><mo>−</mo><mi mathvariant="normal">∞</mi></mrow><mi mathvariant="normal">∞</mi></msup><mover accent="true"><mi>f</mi><mo>^</mo></mover><mo stretchy="false">(</mo><mi>ξ</mi><mo stretchy="false">)</mo><mtext> </mtext><msup><mi>e</mi><mrow><mn>2</mn><mi>π</mi><mi>i</mi><mi>ξ</mi><mi>x</mi></mrow></msup><mtext> </mtext><mi>d</mi><mi>ξ</mi></mrow><annotation encoding="application/x-tex">f(x) = \int\_{-\infty}^\infty
\hat f(\xi)\,e^{2 \pi i \xi x}
\,d\xi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.22225em;vertical-align:-0.86225em;"></span><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord"><span class="mord"><span class="mord">−</span><span class="mord">∞</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">∞</span></span></span></span></span></span></span></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9578799999999998em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span></span><span style="top:-3.26344em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.08332999999999999em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.04601em;">ξ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">π</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.04601em;">ξ</span><span class="mord mathdefault mtight">x</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right:0.04601em;">ξ</span></span></span></span></span>
<h3 id="task-list-syntax" style="position:relative;"><a href="#task-list-syntax" aria-label="task list syntax permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Task List Syntax</h3>
<ol>
<li class="task-list-item">
<p><input type="checkbox" checked disabled> I can render checkbox list syntax</p>
<ul>
<li class="task-list-item"><input type="checkbox" checked disabled> I support nesting</li>
<li class="task-list-item"><input type="checkbox" checked disabled> I support ordered <em>and</em> unordered lists</li>
</ul>
</li>
<li class="task-list-item"><input type="checkbox" disabled> I don’t support clicking checkboxes directly in the html window</li>
</ol>
<h3 id="jekyll-front-matter" style="position:relative;"><a href="#jekyll-front-matter" aria-label="jekyll front matter permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Jekyll front-matter</h3>
<p>If you like, I can display Jekyll front-matter in a nice table. Just make sure you put the front-matter at the very beginning of the file, and fence it with <code class="language-text">---</code>. For example:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">---
title: &quot;Macdown is my friend&quot;
date: 2014-06-06 20:00:00
---</code></pre></div>
<h3 id="render-newline-literally" style="position:relative;"><a href="#render-newline-literally" aria-label="render newline literally permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Render newline literally</h3>
<p>Normally I require you to put two spaces and a newline (aka return) at the end of a line in order to create a line break. If you like, I can render a newline any time you end a line with a newline. However, if you enable this, markdown that looks lovely when I render it might look pretty funky when you let some <em>other</em> program render it.</p>
<h2 id="a-namegeneral-paneathe-general-preferences-pane" style="position:relative;"><a href="#a-namegeneral-paneathe-general-preferences-pane" aria-label="a namegeneral paneathe general preferences pane permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><a name="general-pane"></a>The General Preferences Pane</h2>
<p>This is where I keep preferences related to application behavior.<br>
<img src="http://d.pr/i/rvwu+" alt="General preferences pane"></p>
<p>The General Preferences Pane allows you to tell me how you want me to behave. For example, do you want me to make sure there is a document open when I launch? You can also tell me if I should constantly update the preview window as you type, or wait for you to hit <code class="language-text">command-R</code> instead. Maybe you prefer your editor window on the right? Or to see the word-count as you type. This is also the place to tell me if you are interested in pre-releases of me, or just want to stick to better-tested official releases.</p>
<h2 id="a-nameeditor-paneathe-editor-preference-pane" style="position:relative;"><a href="#a-nameeditor-paneathe-editor-preference-pane" aria-label="a nameeditor paneathe editor preference pane permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><a name="editor-pane"></a>The Editor Preference Pane</h2>
<p>This is where I keep preferences related to the behavior and styling of the editing window.<br>
<img src="http://d.pr/i/6OL5+" alt="Editor preferences pane"></p>
<h3 id="styling" style="position:relative;"><a href="#styling" aria-label="styling permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Styling</h3>
<p>My editor provides syntax highlighting. You can edit the base font and the coloring/sizing theme. I provided some default themes (courtesy of <a href="http://mouapp.com" target="_target" rel="nofollow">Mou</a>’s creator, Chen Luo) if you don’t know where to start.</p>
<p>You can also edit, or even add new themes if you want to! Just click the <strong><em>Reveal</em></strong> button, and start moving things around. Remember to use the correct file extension (<code class="language-text">.styles</code>), though. I’m picky about that.</p>
<p>I offer auto-completion and other functions to ease your editing experience. If you don’t like it, however, you can turn them off.</p>
<h2 id="hack-on" style="position:relative;"><a href="#hack-on" aria-label="hack on permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Hack On</h2>
<p>That’s about it. Thanks for listening. I’ll be quiet from now on (unless there’s an update about the app—I’ll remind you for that!).</p>
<p>Happy writing!</p>
<h2 id="video" style="position:relative;"><a href="#video" aria-label="video permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Video</h2>
<p><code class="language-text">video: https://www.youtube.com/embed/2Xc9gXyf2G4</code>
<code class="language-text">youtube: https://www.youtube.com/watch?v=2Xc9gXyf2G4</code>
<code class="language-text">youtube: 2Xc9gXyf2G4</code></p>
<p><code class="language-text">vimeo: https://vimeo.com/5299404</code>
<code class="language-text">vimeo: 5299404</code></p>
<h2 id="iframe" style="position:relative;"><a href="#iframe" aria-label="iframe permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>iframe</h2>
<div class="gatsby-resp-iframe-wrapper" style="padding-bottom: 51%; position: relative; height: 0; overflow: hidden; margin-bottom: 1.0725rem" > <iframe src="http://player.youku.com/embed/XMzM3MTIzMTM0OA==" frameborder="0" 'allowfullscreen' style=" position: absolute; top: 0; left: 0; width: 100%; height: 100%; "></iframe> </div>
<h2 id="codepen" style="position:relative;"><a href="#codepen" aria-label="codepen permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>codepen</h2>
<iframe height='465' scrolling='no' title='3D Sphere' src='//codepen.io/BrianDGLS/embed/dNpGqo/?height=265&theme-id=0&default-tab=js,result&embed-version=2' frameborder='no' allowtransparency='true' allowfullscreen='true' style='width: 100%;'>See the Pen <a href='https://codepen.io/BrianDGLS/pen/dNpGqo/'>3D Sphere</a> by BrianDGLS (<a href='https://codepen.io/BrianDGLS'>@BrianDGLS</a>) on <a href='https://codepen.io'>CodePen</a>.
</iframe>
<h2 id="codesandbox" style="position:relative;"><a href="#codesandbox" aria-label="codesandbox permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>codesandbox</h2>
<iframe src="https://codesandbox.io/embed/vue" style="width:100%; height:500px; border:0; border-radius: 4px; overflow:hidden;" sandbox="allow-modals allow-forms allow-popups allow-scripts allow-same-origin"></iframe>
<div class="footnotes">
<hr>
<ol>
<li id="fn-1">
<p>  You don’t have to use a number. Arbitrary things like <code class="language-text">[^footy note4]</code> and <code class="language-text">[^footy note4]:</code> will also work. But they will <em>render</em> as numbered footnotes. Also, no need to keep your footnotes in order, I will sort out the order for you so they appear in the same order they were referenced in the text body. You can even keep some footnotes near where you referenced them, and collect others at the bottom of the file in the traditional place for footnotes.</p>
<a href="#fnref-1" class="footnote-backref">↩</a>
</li>
<li id="fn-2">
<p>  If <strong>Underlines</strong> is turned on, <code class="language-text">_this notation_</code> will render as underlined instead of emphasized</p>
<a href="#fnref-2" class="footnote-backref">↩</a>
</li>
<li id="fn-3">
<p>  If <strong>Underline</strong> is disabled <code class="language-text">_this_</code> will be rendered as <em>emphasized</em> instead of being underlined.</p>
<a href="#fnref-3" class="footnote-backref">↩</a>
</li>
<li id="fn-4">
<p>  <strong>Quote</strong> replaces literal <code class="language-text">&quot;</code> characters with html <code class="language-text">&lt;q&gt;</code> tags. <strong>Quote</strong> and <strong>Smartypants</strong> are syntactically incompatible. If both are enabled, <strong>Quote</strong> takes precedence. Note that <strong>Quote</strong> is different from <em>blockquote</em>, which is part of standard Markdown.</p>
<a href="#fnref-4" class="footnote-backref">↩</a>
</li>
<li id="fn-5">
<p>Internet connection required.</p>
<a href="#fnref-5" class="footnote-backref">↩</a>
</li>
</ol>
</div>]]></description><link>https://xiangst0816.github.io/blog/MacDown-test/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/MacDown-test/</guid><category><![CDATA[Test]]></category><dc:creator><![CDATA[WALL-E]]></dc:creator><pubDate>Fri, 16 Mar 2018 07:34:40 GMT</pubDate></item><item><title><![CDATA[第十三章 事件]]></title><description><![CDATA[<blockquote>
<p>这里所说的事件是指: JavaScript 和 HTML 之间交互的事件. 也就是说, 浏览器文档在交互的过程中会以事件的方式通知绑定的<strong>监听器</strong>. 这里使用了传统软件工程的<strong>观察者模式</strong>的设计模型, 实现<strong>JavaScript</strong>与<strong>文档(HTML/CSS)</strong>之间的解耦.</p>
</blockquote>
<h3 id="1-事件流理解" style="position:relative;"><a href="#1-%E4%BA%8B%E4%BB%B6%E6%B5%81%E7%90%86%E8%A7%A3" aria-label="1 事件流理解 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 事件流理解?</h3>
<p>事件流描述的是从页面中接收事件的顺序.</p>
<p>“DOM2 级事件” 规定的事件流包括三个阶段：事件捕获阶段、处于目标阶段和事件冒泡阶段。</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">从Document开始 -- 捕获阶段 --&gt; ( 目标阶段 -- 冒泡阶段 --&gt; Document)</code></pre></div>
<p>目标阶段是冒泡阶段的一部分.</p>
<h3 id="2-这样绑定事件处理程序的问题" style="position:relative;"><a href="#2-%E8%BF%99%E6%A0%B7%E7%BB%91%E5%AE%9A%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%E7%A8%8B%E5%BA%8F%E7%9A%84%E9%97%AE%E9%A2%98" aria-label="2 这样绑定事件处理程序的问题 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 这样绑定事件处理程序的问题?</h3>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Click Me<span class="token punctuation">"</span></span> <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>alert(this.value)<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></code></pre></div>
<ul>
<li>定义绑定事件的函数可能晚于用户点击交互导致报错</li>
<li>这样扩展事件处理程序的作用域链在不同浏览器中会导致不同结果</li>
<li>耦合紧密, 维护麻烦</li>
<li>只能绑定一个</li>
</ul>
<h3 id="3-下面这样添加事件处理程序的问题" style="position:relative;"><a href="#3-%E4%B8%8B%E9%9D%A2%E8%BF%99%E6%A0%B7%E6%B7%BB%E5%8A%A0%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%E7%A8%8B%E5%BA%8F%E7%9A%84%E9%97%AE%E9%A2%98" aria-label="3 下面这样添加事件处理程序的问题 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. 下面这样添加事件处理程序的问题?</h3>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> btn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"myBtn"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
btn<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//"myBtn"</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<ul>
<li>只能绑定一个</li>
</ul>
<h3 id="4-code-classlanguage-textbtnaddeventlistenereventname-handler-usecapturecode接收的第三个参数是" style="position:relative;"><a href="#4-code-classlanguage-textbtnaddeventlistenereventname-handler-usecapturecode%E6%8E%A5%E6%94%B6%E7%9A%84%E7%AC%AC%E4%B8%89%E4%B8%AA%E5%8F%82%E6%95%B0%E6%98%AF" aria-label="4 code classlanguage textbtnaddeventlistenereventname handler usecapturecode接收的第三个参数是 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. <code class="language-text">btn.addEventListener(eventName, handler, useCapture)</code>接收的第三个参数是?</h3>
<p>最后这个布尔值参数如果是 true，表示在捕获 阶段调用事件处理程序；如果是 false，表示在冒泡阶段调用事件处理程序</p>
<blockquote>
<p>IE9、Firefox、Safari、Chrome 和 Opera 支持 DOM2 级事件处理程序。</p>
</blockquote>
<h3 id="5-在-ie-中使用code-classlanguage-textbtnattacheventcode的问题" style="position:relative;"><a href="#5-%E5%9C%A8-ie-%E4%B8%AD%E4%BD%BF%E7%94%A8code-classlanguage-textbtnattacheventcode%E7%9A%84%E9%97%AE%E9%A2%98" aria-label="5 在 ie 中使用code classlanguage textbtnattacheventcode的问题 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>5. 在 IE 中使用<code class="language-text">btn.attachEvent</code>的问题?</h3>
<ul>
<li>事件处理函数中的 this 指向的是 window</li>
<li>可添加多个事件, 但是是<strong>以相反的顺序被触发的</strong></li>
<li>只在冒泡阶段触发</li>
</ul>
<blockquote>
<p>IE8-</p>
</blockquote>
<h3 id="6-事件对象中-code-classlanguage-textthiscode--code-classlanguage-texttargetcode--code-classlanguage-textcurrenttargetcode三个属性的含义" style="position:relative;"><a href="#6-%E4%BA%8B%E4%BB%B6%E5%AF%B9%E8%B1%A1%E4%B8%AD-code-classlanguage-textthiscode--code-classlanguage-texttargetcode--code-classlanguage-textcurrenttargetcode%E4%B8%89%E4%B8%AA%E5%B1%9E%E6%80%A7%E7%9A%84%E5%90%AB%E4%B9%89" aria-label="6 事件对象中 code classlanguage textthiscode  code classlanguage texttargetcode  code classlanguage textcurrenttargetcode三个属性的含义 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>6. 事件对象中, <code class="language-text">this</code> / <code class="language-text">target</code> / <code class="language-text">currentTarget</code>三个属性的含义?</h3>
<ul>
<li><code class="language-text">this</code>: 指向<strong>绑定事件处理函数的元素</strong></li>
<li><code class="language-text">currentTarget</code>: 同<code class="language-text">this</code></li>
<li><code class="language-text">target</code>: 指向<strong>事件真正的目标</strong>, 可能因为真正的目标没绑定这个事件处理函数, 因此冒泡到了外面</li>
</ul>
<p>如果绑定的元素没有子元素, 则, 三者相等; 如果是事件代理, 则<code class="language-text">target</code>指向真正触发事件的元素. 事件代理可以对<code class="language-text">target</code>进行判断.</p>
<h3 id="7-事件对象中的code-classlanguage-texteventtypecode有什么作用" style="position:relative;"><a href="#7-%E4%BA%8B%E4%BB%B6%E5%AF%B9%E8%B1%A1%E4%B8%AD%E7%9A%84code-classlanguage-texteventtypecode%E6%9C%89%E4%BB%80%E4%B9%88%E4%BD%9C%E7%94%A8" aria-label="7 事件对象中的code classlanguage texteventtypecode有什么作用 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>7. 事件对象中的<code class="language-text">event.type</code>有什么作用?</h3>
<p>如果监听被触发, 则<code class="language-text">event.type</code>和绑定时的<code class="language-text">eventName</code>相同, 一般用于区分在元素上绑定的事件类型, 处理不同类型的事件绑定情形.</p>
<h3 id="8-事件对象中的code-classlanguage-textpreventdefaultcode有什么作用" style="position:relative;"><a href="#8-%E4%BA%8B%E4%BB%B6%E5%AF%B9%E8%B1%A1%E4%B8%AD%E7%9A%84code-classlanguage-textpreventdefaultcode%E6%9C%89%E4%BB%80%E4%B9%88%E4%BD%9C%E7%94%A8" aria-label="8 事件对象中的code classlanguage textpreventdefaultcode有什么作用 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>8. 事件对象中的<code class="language-text">preventDefault()</code>有什么作用?</h3>
<p>阻止特定事件的默认行为, 只有 cancelable 属性设置为 true 的事件，才可以使用 preventDefault()来取消其默认行为。</p>
<p>例如，链接的默认行为就是在 被单击时会导航到其 href 特性指定的 URL。</p>
<h3 id="9-事件对象中的code-classlanguage-texteventstoppropagationcode有什么作用" style="position:relative;"><a href="#9-%E4%BA%8B%E4%BB%B6%E5%AF%B9%E8%B1%A1%E4%B8%AD%E7%9A%84code-classlanguage-texteventstoppropagationcode%E6%9C%89%E4%BB%80%E4%B9%88%E4%BD%9C%E7%94%A8" aria-label="9 事件对象中的code classlanguage texteventstoppropagationcode有什么作用 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>9. 事件对象中的<code class="language-text">event.stopPropagation()</code>有什么作用?</h3>
<p>立即停止事件在 DOM 层次中的传播(<strong>Stop Propagation</strong>)，即取消进一步的事件 <strong>捕获或冒泡</strong>。</p>
<h3 id="10-事件对象中的code-classlanguage-texteventphasecode含义" style="position:relative;"><a href="#10-%E4%BA%8B%E4%BB%B6%E5%AF%B9%E8%B1%A1%E4%B8%AD%E7%9A%84code-classlanguage-texteventphasecode%E5%90%AB%E4%B9%89" aria-label="10 事件对象中的code classlanguage texteventphasecode含义 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>10. 事件对象中的<code class="language-text">eventPhase</code>含义?</h3>
<ul>
<li><code class="language-text">eventPhase===1</code>: 在<strong>捕获阶段</strong>调用的事件处理程序</li>
<li><code class="language-text">eventPhase===2</code>: 如果事件处理程序处于目标对象上时(实测没出现过)</li>
<li><code class="language-text">eventPhase===3</code>: 在<strong>冒泡阶段</strong>调用的事件处理程序</li>
</ul>
<h3 id="11-判断页面加载完毕的属性和事件有哪些" style="position:relative;"><a href="#11-%E5%88%A4%E6%96%AD%E9%A1%B5%E9%9D%A2%E5%8A%A0%E8%BD%BD%E5%AE%8C%E6%AF%95%E7%9A%84%E5%B1%9E%E6%80%A7%E5%92%8C%E4%BA%8B%E4%BB%B6%E6%9C%89%E5%93%AA%E4%BA%9B" aria-label="11 判断页面加载完毕的属性和事件有哪些 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>11. 判断页面加载完毕的属性和事件有哪些?</h3>
<p><strong>判断</strong></p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">document<span class="token punctuation">.</span>readyState <span class="token operator">===</span> <span class="token string">"complete"</span><span class="token punctuation">;</span></code></pre></div>
<p><strong>监听</strong></p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">window<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"load"</span><span class="token punctuation">,</span> completed<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"DOMContentLoaded"</span><span class="token punctuation">,</span> completed<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p><strong>load</strong>和<strong>DOMContentLoaded</strong>两个事件的区别?</p>
<ul>
<li>当初始 HTML 文档被完全加载和解析时，DOMContentLoaded 事件被触发，而无需等待样式表、图像和子框架完成加载。</li>
<li>另一个不同的事件 load <strong>会在页面中的一切都加载完毕时触发</strong>。</li>
<li>DOMContentLoaded 这个事件始终都会在 load 事件之前触发</li>
<li>DOMContentLoaded 目标实际上是 document</li>
<li>在不同页面中，load 事件与 readystatechange 事件并 不能保证以相同的顺序触发</li>
</ul>
<p>所以可以知道，当一个页面加载时应<strong>先触发 DOMContentLoaded 然后才是 onload</strong>. 类似的事件及区别包括以下几类：</p>
<ul>
<li>DOMContentLoaded: 在形成完整的 DOM 树之后就会触发， 不理会图像、JavaScript 文件、CSS 文件或其他资源是否已经下载完毕。</li>
<li>readystatechange: 一个 document 的 Document.readyState 属性描述了文档的加载状态，当这个状态发生了变化，就会触发该事件；</li>
<li>load: 在页面中的一切都加载完毕时触发，但这个<strong>过程可能会因为要加载的外部资源过多而颇费周折</strong>。</li>
<li>beforeunload: 当浏览器窗口，文档或其资源将要卸载时，会触发 beforeunload 事件。</li>
<li>unload: 当文档或一个子资源正在被卸载时, 触发 unload 事件。</li>
</ul>
<h3 id="12-能发出-load-事件的地方有哪些" style="position:relative;"><a href="#12-%E8%83%BD%E5%8F%91%E5%87%BA-load-%E4%BA%8B%E4%BB%B6%E7%9A%84%E5%9C%B0%E6%96%B9%E6%9C%89%E5%93%AA%E4%BA%9B" aria-label="12 能发出 load 事件的地方有哪些 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>12. 能发出 load 事件的地方有哪些?</h3>
<ul>
<li>window</li>
<li>img</li>
<li>script</li>
<li>link</li>
</ul>
<h3 id="13-code-classlanguage-textresizecode和code-classlanguage-textscrollcode事件使用注意" style="position:relative;"><a href="#13-code-classlanguage-textresizecode%E5%92%8Ccode-classlanguage-textscrollcode%E4%BA%8B%E4%BB%B6%E4%BD%BF%E7%94%A8%E6%B3%A8%E6%84%8F" aria-label="13 code classlanguage textresizecode和code classlanguage textscrollcode事件使用注意 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>13. <code class="language-text">resize</code>和<code class="language-text">scroll</code>事件使用注意?</h3>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"scroll"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> scrollTop <span class="token operator">=</span> document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>scrollTop<span class="token punctuation">;</span> <span class="token comment">// 获取scrollTop</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<ul>
<li><strong>scroll 事件是在 window 对象上发生的</strong>，但它实际表示的则是页面中相应元素的变化</li>
<li>所有浏览器都会通过<code class="language-text">&lt;html&gt;</code>元素来反映这一变化, 就是<code class="language-text">document.documentElement</code></li>
<li>监听函数会频繁执行, 1) 函数节流; 2)有必要尽量保持事件处理程序的代码简单; 3)使用 raf</li>
<li>scroll 也可以在元素上监听</li>
</ul>
<h3 id="14-焦点事件有哪些-使用场景是" style="position:relative;"><a href="#14-%E7%84%A6%E7%82%B9%E4%BA%8B%E4%BB%B6%E6%9C%89%E5%93%AA%E4%BA%9B-%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF%E6%98%AF" aria-label="14 焦点事件有哪些 使用场景是 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>14. 焦点事件有哪些, 使用场景是?</h3>
<p>用于获取用户在页面上的行踪.</p>
<p><strong>document 上:</strong></p>
<ul>
<li>document.hasFocus()</li>
<li>document.activeElement</li>
</ul>
<p><strong>元素上:</strong></p>
<ul>
<li>focusin</li>
<li>focus</li>
<li>focusout</li>
</ul>
<h3 id="15-关于鼠标事件的一些注意点" style="position:relative;"><a href="#15-%E5%85%B3%E4%BA%8E%E9%BC%A0%E6%A0%87%E4%BA%8B%E4%BB%B6%E7%9A%84%E4%B8%80%E4%BA%9B%E6%B3%A8%E6%84%8F%E7%82%B9" aria-label="15 关于鼠标事件的一些注意点 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>15. 关于鼠标事件的一些注意点</h3>
<ul>
<li>除了 mouseenter 和 mouseleave，所有鼠标事件都会冒泡， 也可以被取消，而取消鼠标事件将会影响浏览器的默认行为</li>
<li>只有在同一个元素上相继触发 mousedown 和 mouseup 事件， 才会触发 click 事件；如果 mousedown 或 mouseup 中的一个被取消，就不会触发 click 事件.</li>
</ul>
<h3 id="16-鼠标事件对象中的位置属性-clientxpagexscreenx-等的含义" style="position:relative;"><a href="#16-%E9%BC%A0%E6%A0%87%E4%BA%8B%E4%BB%B6%E5%AF%B9%E8%B1%A1%E4%B8%AD%E7%9A%84%E4%BD%8D%E7%BD%AE%E5%B1%9E%E6%80%A7-clientxpagexscreenx-%E7%AD%89%E7%9A%84%E5%90%AB%E4%B9%89" aria-label="16 鼠标事件对象中的位置属性 clientxpagexscreenx 等的含义 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>16. 鼠标事件对象中的位置属性 clientX/pageX/screenX 等的含义</h3>
<ul>
<li>clientX/clientY: 以<strong>浏览器页面窗口为边距</strong>的位置</li>
<li>pageX/pageY: 以<strong>页面为边距</strong>的位置, 比如存在 scroll 时</li>
<li>screenX/screenY: 以<strong>系统的显示器为边距</strong>的位置</li>
</ul>
<h3 id="17-鼠标键和修改键的组合如何实现" style="position:relative;"><a href="#17-%E9%BC%A0%E6%A0%87%E9%94%AE%E5%92%8C%E4%BF%AE%E6%94%B9%E9%94%AE%E7%9A%84%E7%BB%84%E5%90%88%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0" aria-label="17 鼠标键和修改键的组合如何实现 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>17. 鼠标键和修改键的组合如何实现?</h3>
<p>这些修改键就是 Shift、Ctrl、Alt 和 Meta（在 Windows 键盘中是 Windows 键，在苹果机中 是 Cmd 键），它们经常被用来修改鼠标事件的行为。DOM 为此规定了 4 个属性，表示这些修改键的状态：shiftKey、ctrlKey、altKey 和 metaKey。例如:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>shiftKey<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  keys<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">"shift"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<h3 id="18-鼠标右键单击事件如何实现" style="position:relative;"><a href="#18-%E9%BC%A0%E6%A0%87%E5%8F%B3%E9%94%AE%E5%8D%95%E5%87%BB%E4%BA%8B%E4%BB%B6%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0" aria-label="18 鼠标右键单击事件如何实现 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>18. 鼠标右键单击事件如何实现?</h3>
<p>对于 mousedown 和 mouseup 事件来说，则在其 event 对象存在一个 button 属性， 表示按下或释放的按钮。</p>
<p>DOM 的 button 属性可能有如下 3 个值：0 表示主鼠标按钮，1 表示中间的鼠 标按钮（鼠标滚轮按钮），2 表示次鼠标按钮。</p>
<p>但是 IE8-的返回值有比较大的差异, 需要注意!.</p>
<h3 id="19-textinput-事件和-keypress-事件的区别" style="position:relative;"><a href="#19-textinput-%E4%BA%8B%E4%BB%B6%E5%92%8C-keypress-%E4%BA%8B%E4%BB%B6%E7%9A%84%E5%8C%BA%E5%88%AB" aria-label="19 textinput 事件和 keypress 事件的区别 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>19. textInput 事件和 keypress 事件的区别?</h3>
<ul>
<li>textInput 事件主要考虑的是<strong>字符</strong>，因此它的 event 对象中还包含一个 data 属性，这个属 性的值就是用户输入的字符（而非字符编码）</li>
<li>是任何可以获得焦点的元素都可以触发 keypress 事件，但<strong>只有可编辑区域才能触发 textInput 事件</strong></li>
<li>textInput 事件只会在<strong>用户按下能够输入实际字符的键</strong>时才会被触发，而 keypress 事件则在按下那些能够影响文本显示的键时也会触发（例如退格键）</li>
<li>支持 textInput 属 性的浏览器有 IE9+、Safari 和 Chrome。</li>
</ul>
<h3 id="20-dom-变动增删改是否能检测-如何检测" style="position:relative;"><a href="#20-dom-%E5%8F%98%E5%8A%A8%E5%A2%9E%E5%88%A0%E6%94%B9%E6%98%AF%E5%90%A6%E8%83%BD%E6%A3%80%E6%B5%8B-%E5%A6%82%E4%BD%95%E6%A3%80%E6%B5%8B" aria-label="20 dom 变动增删改是否能检测 如何检测 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>20. DOM 变动(增删改)是否能检测, 如何检测?</h3>
<ul>
<li>DOMSubtreeModified: 整个 DOM 结构变更是触发</li>
<li>DOMNodeInserted: 子节点插入另一个节点时触发</li>
<li>DOMNodeRemoved: 节点从其父节点移除时触发</li>
<li>DOMNodeInsertedIntoDocument: 节点插入到<strong>文档中</strong>时触发</li>
<li>DOMNodeRemovedFromDocument: 节点从<strong>文档中</strong>删除时触发</li>
<li>DOMAttrModified: 节点属性被修改时触发</li>
<li>DOMCharacterDataModified: 文本节点的值发生变化时触发</li>
</ul>
<p>IE9+</p>
<p><strong><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/MutationObserver" target="_target" rel="nofollow">MutationObserver</a></strong></p>
<blockquote>
<p>MutationObserver 给开发者们提供了一种能在某个范围内的 DOM 树发生变化时作出适当反应的能力.该 API 设计用来替换掉在 DOM3 事件规范中引入的 Mutation 事件.</p>
</blockquote>
<ul>
<li>它等待所有脚本任务完成后，才会运行，即采用异步方式。</li>
<li>它把 DOM 变动记录封装成一个数组进行处理，而不是一条条地个别处理 DOM 变动。</li>
<li>它既可以观察发生在 DOM 的所有类型变动，也可以观察某一类变动。</li>
</ul>
<p>IE11+</p>
<h3 id="21-内存和性能注意点" style="position:relative;"><a href="#21-%E5%86%85%E5%AD%98%E5%92%8C%E6%80%A7%E8%83%BD%E6%B3%A8%E6%84%8F%E7%82%B9" aria-label="21 内存和性能注意点 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>21: 内存和性能注意点</h3>
<ul>
<li>事件委托</li>
</ul>
<p>通过<code class="language-text">event.target</code>获取点击的元素; 通过<code class="language-text">event.type</code>获取事件类型.</p>
<ul>
<li>移除无用的事件</li>
</ul>
<p>比如删除 DOM 后移除绑定的事件, 只能手动解除.</p>
<h3 id="22-模拟事件的过程是怎样的" style="position:relative;"><a href="#22-%E6%A8%A1%E6%8B%9F%E4%BA%8B%E4%BB%B6%E7%9A%84%E8%BF%87%E7%A8%8B%E6%98%AF%E6%80%8E%E6%A0%B7%E7%9A%84" aria-label="22 模拟事件的过程是怎样的 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>22. 模拟事件的过程是怎样的?</h3>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> btn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"myBtn"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//创建事件对象</span>
<span class="token keyword">var</span> event <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createEvent</span><span class="token punctuation">(</span><span class="token string">"MouseEvents"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//初始化事件对象</span>
event<span class="token punctuation">.</span><span class="token function">initMouseEvent</span><span class="token punctuation">(</span>
  <span class="token string">"click"</span><span class="token punctuation">,</span>
  <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token boolean">true</span><span class="token punctuation">,</span>
  document<span class="token punctuation">.</span>defaultView<span class="token punctuation">,</span>
  <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token keyword">null</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//触发事件</span>
btn<span class="token punctuation">.</span><span class="token function">dispatchEvent</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>这里的事件包括:</p>
<ul>
<li>UIEvents: UIEvent, initUIEvent</li>
<li>MouseEvents: MouseEvent, initMouseEvent</li>
<li>MutationEvents: MutationEvent, initMutationEvent</li>
<li>HTMLEvents: 一般化的 HTML 事件</li>
<li>CustomEvents: CustomEvent, initCustomEvent, 自定义事件</li>
</ul>
<p>例如 HTMLEvents 事件:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> event <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createEvent</span><span class="token punctuation">(</span><span class="token string">"HTMLEvents"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
event<span class="token punctuation">.</span><span class="token function">initEvent</span><span class="token punctuation">(</span><span class="token string">"focus"</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
target<span class="token punctuation">.</span><span class="token function">dispatchEvent</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<h3 id="23-如何自定义事件并触发" style="position:relative;"><a href="#23-%E5%A6%82%E4%BD%95%E8%87%AA%E5%AE%9A%E4%B9%89%E4%BA%8B%E4%BB%B6%E5%B9%B6%E8%A7%A6%E5%8F%91" aria-label="23 如何自定义事件并触发 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>23. 如何自定义事件并触发?</h3>
<p><strong>event.initCustomEvent</strong></p>
<ul>
<li>type（字符串）：触发的事件类型，例如”keydown”。</li>
<li>bubbles（布尔值）：表示事件是否应该冒泡。</li>
<li>cancelable（布尔值）：表示事件是否可以取消。</li>
<li>detail（对象）：任意值，保存在 event 对象的 detail 属性中。</li>
</ul>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> event <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createEvent</span><span class="token punctuation">(</span><span class="token string">"CustomEvent"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
event<span class="token punctuation">.</span><span class="token function">initCustomEvent</span><span class="token punctuation">(</span><span class="token string">"myevent"</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token string">"Hello world!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
div<span class="token punctuation">.</span><span class="token function">dispatchEvent</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<h3 id="24-多点手势的原理" style="position:relative;"><a href="#24-%E5%A4%9A%E7%82%B9%E6%89%8B%E5%8A%BF%E7%9A%84%E5%8E%9F%E7%90%86" aria-label="24 多点手势的原理 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>24. 多点手势的原理?</h3>
<h3 id="25-code-classlanguage-textaddeventlistenercode传参的第三个参数中有哪些属性，含义是？" style="position:relative;"><a href="#25-code-classlanguage-textaddeventlistenercode%E4%BC%A0%E5%8F%82%E7%9A%84%E7%AC%AC%E4%B8%89%E4%B8%AA%E5%8F%82%E6%95%B0%E4%B8%AD%E6%9C%89%E5%93%AA%E4%BA%9B%E5%B1%9E%E6%80%A7%EF%BC%8C%E5%90%AB%E4%B9%89%E6%98%AF%EF%BC%9F" aria-label="25 code classlanguage textaddeventlistenercode传参的第三个参数中有哪些属性，含义是？ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>25. <code class="language-text">addEventListener</code>传参的第三个参数中有哪些属性，含义是？</h3>
<h4 id="code-classlanguage-textcapturecode" style="position:relative;"><a href="#code-classlanguage-textcapturecode" aria-label="code classlanguage textcapturecode permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code class="language-text">capture</code></h4>
<p>默认为 false。如果设为 true，则表示在 capture 阶段触发事件。</p>
<h4 id="code-classlanguage-textoncecode" style="position:relative;"><a href="#code-classlanguage-textoncecode" aria-label="code classlanguage textoncecode permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code class="language-text">once</code></h4>
<p>默认为 false。如果为 true，表示事件只触发一次。事件处理函数会在被调用后自动移除。</p>
<h4 id="code-classlanguage-textpassivecode" style="position:relative;"><a href="#code-classlanguage-textpassivecode" aria-label="code classlanguage textpassivecode permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code class="language-text">passive</code></h4>
<p>表示 listener 永远不会调用 <code class="language-text">preventDefault()</code>。如果 listener 仍然调用了这个函数，客户端将会忽略它并抛出一个控制台警告。</p>
<p>这个属性存在的含义主要是为了<strong>优化滚屏性能</strong>，也就是说，当添加了<code class="language-text">passive</code>属性后，<strong><code class="language-text">touchmove</code>事件不会阻塞页面的滚动</strong>（同样适用于鼠标的滚轮事件）。</p>]]></description><link>https://xiangst0816.github.io/blog/di-shi-san-zhang-shi-jian/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/di-shi-san-zhang-shi-jian/</guid><category><![CDATA[JS高程]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Mon, 05 Mar 2018 04:44:25 GMT</pubDate></item><item><title><![CDATA[第十二章 DOM2和DOM3]]></title><description><![CDATA[<h3 id="1-为什么code-classlanguage-textelestylecode属性获取到的样式信息不全" style="position:relative;"><a href="#1-%E4%B8%BA%E4%BB%80%E4%B9%88code-classlanguage-textelestylecode%E5%B1%9E%E6%80%A7%E8%8E%B7%E5%8F%96%E5%88%B0%E7%9A%84%E6%A0%B7%E5%BC%8F%E4%BF%A1%E6%81%AF%E4%B8%8D%E5%85%A8" aria-label="1 为什么code classlanguage textelestylecode属性获取到的样式信息不全 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 为什么<code class="language-text">ele.style</code>属性获取到的样式信息不全?</h3>
<p>这个 style 对象 是 CSSStyleDeclaration 的实例，包含着<strong>通过 HTML 的 style 特性指定</strong>的所有样式信息，但<strong>不包含</strong>与<strong>外部</strong>样式表或<strong>嵌入</strong>样式表经层叠而来的样式。</p>
<blockquote>
<p>不同方式定义的样式(<code class="language-text">&lt;link&gt;</code>/<code class="language-text">&lt;script&gt;</code>/在元素上定义)是有差异的!!!</p>
</blockquote>
<p>使用<code class="language-text">getComputedStyle()</code>可以获取包含当前元素的<strong>所有计算的样式</strong>. 方法接收两个参数: 要取得计算样式的元素和一个伪元素字符串（例如”:after”）</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> myDiv <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"myDiv"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> computedStyle <span class="token operator">=</span> document<span class="token punctuation">.</span>defaultView<span class="token punctuation">.</span><span class="token function">getComputedStyle</span><span class="token punctuation">(</span>myDiv<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<ul>
<li>注意<strong>综合属性</strong>的返回值, 比如 border</li>
<li>无论在哪个浏览器中，最重要的一条是要记住所有计算的样式都是<strong>只读</strong>的</li>
</ul>
<h3 id="2-getboundingclientrect获取元素尺寸" style="position:relative;"><a href="#2-getboundingclientrect%E8%8E%B7%E5%8F%96%E5%85%83%E7%B4%A0%E5%B0%BA%E5%AF%B8" aria-label="2 getboundingclientrect获取元素尺寸 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. getBoundingClientRect()获取元素尺寸</h3>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">getBoundingClientRect</span><span class="token punctuation">(</span><span class="token parameter">element</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> scrollTop <span class="token operator">=</span> document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>scrollTop<span class="token punctuation">;</span>
  <span class="token keyword">var</span> scrollLeft <span class="token operator">=</span> document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>scrollLeft<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>element<span class="token punctuation">.</span>getBoundingClientRect<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> arguments<span class="token punctuation">.</span>callee<span class="token punctuation">.</span>offset <span class="token operator">!=</span> <span class="token string">"number"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">var</span> temp <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"div"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      temp<span class="token punctuation">.</span>style<span class="token punctuation">.</span>cssText <span class="token operator">=</span> <span class="token string">"position:absolute;left:0;top:0;"</span><span class="token punctuation">;</span>
      document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token punctuation">;</span>
      arguments<span class="token punctuation">.</span>callee<span class="token punctuation">.</span>offset <span class="token operator">=</span> <span class="token operator">-</span>temp<span class="token punctuation">.</span><span class="token function">getBoundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>top <span class="token operator">-</span> scrollTop<span class="token punctuation">;</span>
      document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token punctuation">;</span>
      temp <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">var</span> rect <span class="token operator">=</span> element<span class="token punctuation">.</span><span class="token function">getBoundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> offset <span class="token operator">=</span> arguments<span class="token punctuation">.</span>callee<span class="token punctuation">.</span>offset<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      left<span class="token operator">:</span> rect<span class="token punctuation">.</span>left <span class="token operator">+</span> offset<span class="token punctuation">,</span>
      right<span class="token operator">:</span> rect<span class="token punctuation">.</span>right <span class="token operator">+</span> offset<span class="token punctuation">,</span>
      top<span class="token operator">:</span> rect<span class="token punctuation">.</span>top <span class="token operator">+</span> offset<span class="token punctuation">,</span>
      bottom<span class="token operator">:</span> rect<span class="token punctuation">.</span>bottom <span class="token operator">+</span> offset
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> actualLeft <span class="token operator">=</span> <span class="token function">getElementLeft</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> actualTop <span class="token operator">=</span> <span class="token function">getElementTop</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      left<span class="token operator">:</span> actualLeft <span class="token operator">-</span> scrollLeft<span class="token punctuation">,</span>
      right<span class="token operator">:</span> actualLeft <span class="token operator">+</span> element<span class="token punctuation">.</span>offsetWidth <span class="token operator">-</span> scrollLeft<span class="token punctuation">,</span>
      top<span class="token operator">:</span> actualTop <span class="token operator">-</span> scrollTop<span class="token punctuation">,</span>
      bottom<span class="token operator">:</span> actualTop <span class="token operator">+</span> element<span class="token punctuation">.</span>offsetHeight <span class="token operator">-</span> scrollTop
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<h3 id="3-dom-遍历接口" style="position:relative;"><a href="#3-dom-%E9%81%8D%E5%8E%86%E6%8E%A5%E5%8F%A3" aria-label="3 dom 遍历接口 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. DOM 遍历接口</h3>
<p>实际使用比较少, 可能会在 VDOM 中使用. IE9+</p>
<h3 id="4-如何获取页面滚动高度" style="position:relative;"><a href="#4-%E5%A6%82%E4%BD%95%E8%8E%B7%E5%8F%96%E9%A1%B5%E9%9D%A2%E6%BB%9A%E5%8A%A8%E9%AB%98%E5%BA%A6" aria-label="4 如何获取页面滚动高度 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. 如何获取页面滚动高度?</h3>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">let</span> scrollTop <span class="token operator">=</span> window<span class="token punctuation">.</span>scrollY<span class="token punctuation">;</span></code></pre></div>
<p><code class="language-text">document.documentElement.scrollTop</code>的兼容性不太好.</p>]]></description><link>https://xiangst0816.github.io/blog/di-shi-er-zhang-DOM2-he-huo-hu-DOM3/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/di-shi-er-zhang-DOM2-he-huo-hu-DOM3/</guid><category><![CDATA[JS高程]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Mon, 05 Mar 2018 03:54:46 GMT</pubDate></item><item><title><![CDATA[第十一章 DOM拓展]]></title><description><![CDATA[<h3 id="1-dom-选择符-api" style="position:relative;"><a href="#1-dom-%E9%80%89%E6%8B%A9%E7%AC%A6-api" aria-label="1 dom 选择符 api permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. DOM 选择符 API</h3>
<p>根据 <strong>CSS 选择符</strong> 选择与某个模式匹配的 DOM 元素.</p>
<ul>
<li><code class="language-text">querySelector()</code></li>
</ul>
<p>IE8+, 返回第一个匹配的 Node</p>
<ul>
<li><code class="language-text">querySelectorAll()</code></li>
</ul>
<p>IE8+, 返回 NodeList</p>
<ul>
<li><code class="language-text">matchesSelector()</code></li>
</ul>
<p>IE9+, 如果调用元素与该选择符匹配，返回 true；否则，返回 false。</p>
<p>这个 API 并未全部支持, 可用下面方式使用:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">matchesSelector</span><span class="token punctuation">(</span><span class="token parameter">element<span class="token punctuation">,</span> selector</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>element<span class="token punctuation">.</span>matchesSelector<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> element<span class="token punctuation">.</span><span class="token function">matchesSelector</span><span class="token punctuation">(</span>selector<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>element<span class="token punctuation">.</span>msMatchesSelector<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> element<span class="token punctuation">.</span><span class="token function">msMatchesSelector</span><span class="token punctuation">(</span>selector<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>element<span class="token punctuation">.</span>mozMatchesSelector<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> element<span class="token punctuation">.</span><span class="token function">mozMatchesSelector</span><span class="token punctuation">(</span>selector<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>element<span class="token punctuation">.</span>webkitMatchesSelector<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> element<span class="token punctuation">.</span><span class="token function">webkitMatchesSelector</span><span class="token punctuation">(</span>selector<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">"Not supported."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">matchesSelector</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>body<span class="token punctuation">,</span> <span class="token string">"body.page1"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//执行操作</span>
<span class="token punctuation">}</span></code></pre></div>
<h3 id="2-elementnode-类型-node-查询增强-api" style="position:relative;"><a href="#2-elementnode-%E7%B1%BB%E5%9E%8B-node-%E6%9F%A5%E8%AF%A2%E5%A2%9E%E5%BC%BA-api" aria-label="2 elementnode 类型 node 查询增强 api permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. ElementNode 类型 Node 查询增强 API</h3>
<ul>
<li>childElementCount：返回子元素（不包括文本节点和注释）的个数。</li>
<li>firstElementChild：指向第一个子元素；firstChild 的元素版。</li>
<li>lastElementChild：指向最后一个子元素；lastChild 的元素版。</li>
<li>previousElementSibling：指向前一个同辈元素；previousSibling 的元素版。</li>
<li>nextElementSibling：指向后一个同辈元素；nextSibling 的元素版。</li>
</ul>
<p>支持情况: IE 9+</p>
<h3 id="3-html5-中操作code-classlanguage-textclasscode属性的方法和传统方法的对比" style="position:relative;"><a href="#3-html5-%E4%B8%AD%E6%93%8D%E4%BD%9Ccode-classlanguage-textclasscode%E5%B1%9E%E6%80%A7%E7%9A%84%E6%96%B9%E6%B3%95%E5%92%8C%E4%BC%A0%E7%BB%9F%E6%96%B9%E6%B3%95%E7%9A%84%E5%AF%B9%E6%AF%94" aria-label="3 html5 中操作code classlanguage textclasscode属性的方法和传统方法的对比 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. HTML5 中操作<code class="language-text">class</code>属性的方法和传统方法的对比?</h3>
<ul>
<li>传统方法使用<code class="language-text">className</code>属性对字符串的处理来更改 class:</li>
</ul>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">//删除"user"类</span>

<span class="token comment">//首先，取得类名字符串并拆分成数组</span>
<span class="token keyword">var</span> classNames <span class="token operator">=</span> div<span class="token punctuation">.</span>className<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token regex">/\s+/</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//找到要删的类名 var pos = -1, i, len;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> len <span class="token operator">=</span> classNames<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>classNames<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"user"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    pos <span class="token operator">=</span> i<span class="token punctuation">;</span>
    <span class="token keyword">break</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">//删除类名</span>
classNames<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//把剩下的类名拼成字符串并重新设置</span>
div<span class="token punctuation">.</span>className <span class="token operator">=</span> classNames<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<ul>
<li>HTML5 使用<code class="language-text">classList</code>属性, Firefox 3.6+和 Chrome</li>
</ul>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">//删除"disabled"类</span>
div<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token string">"disabled"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//添加"current"类</span>
div<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"current"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//切换"user"类</span>
div<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">toggle</span><span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//确定元素中是否包含既定的类名</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>div<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"bd"</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>div<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">"disabled"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//执行操作</span>
<span class="token punctuation">}</span>

<span class="token comment">//迭代类名</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> len <span class="token operator">=</span> div<span class="token punctuation">.</span>classList<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">doSomething</span><span class="token punctuation">(</span>div<span class="token punctuation">.</span>classList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<h3 id="4-焦点管理" style="position:relative;"><a href="#4-%E7%84%A6%E7%82%B9%E7%AE%A1%E7%90%86" aria-label="4 焦点管理 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. 焦点管理</h3>
<ul>
<li><code class="language-text">document.activeElement()</code>: 始终会引用 DOM 中当前获得了焦点的元素</li>
<li><code class="language-text">document.hasFocus()</code>: 用于确定文档是否获得了焦点</li>
</ul>
<h3 id="5-htmldocument-的变化" style="position:relative;"><a href="#5-htmldocument-%E7%9A%84%E5%8F%98%E5%8C%96" aria-label="5 htmldocument 的变化 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>5. HTMLDocument 的变化</h3>
<h4 id="documentreadystate" style="position:relative;"><a href="#documentreadystate" aria-label="documentreadystate permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>document.readyState</h4>
<p>通过它来实现一个指示文档已经加载完成的指示器, 支持情况: IE4+</p>
<ul>
<li>loading，正在加载文档；</li>
<li>complete，已经加载完文档。</li>
</ul>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">docReady</span><span class="token punctuation">(</span><span class="token parameter">cb</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>
    document<span class="token punctuation">.</span>readyState <span class="token operator">===</span> <span class="token string">"complete"</span> <span class="token operator">||</span>
    document<span class="token punctuation">.</span>readyState <span class="token operator">===</span> <span class="token string">"interactive"</span>
  <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">cb</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"DOMContentLoaded"</span><span class="token punctuation">,</span> completed<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"load"</span><span class="token punctuation">,</span> completed<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/* istanbul ignore next */</span>
  <span class="token keyword">function</span> <span class="token function">completed</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    document<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">"DOMContentLoaded"</span><span class="token punctuation">,</span> completed<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    window<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">"load"</span><span class="token punctuation">,</span> completed<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">cb</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<h4 id="documentcompatmode" style="position:relative;"><a href="#documentcompatmode" aria-label="documentcompatmode permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>document.compatMode</h4>
<ul>
<li>标准模式(CSS1Compat), 比如 doctype 设置为<code class="language-text">&lt;!DOCTYPE html&gt;</code>时</li>
<li>混杂模式(BackCompat, 向后兼容模式)的 doctype 可以是:</li>
</ul>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">HTML</span> <span class="token name">PUBLIC</span> <span class="token string">"-//W3C//DTD HTML 4.01 Transitional//EN"</span><span class="token punctuation">></span></span></code></pre></div>
<p>判断代码:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">if</span> <span class="token punctuation">(</span>document<span class="token punctuation">.</span>compatMode <span class="token operator">==</span> <span class="token string">"CSS1Compat"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"标准模式"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  <span class="token comment">// "BackCompat"</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"混杂模式, 向后兼容模式"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<h4 id="documenthead" style="position:relative;"><a href="#documenthead" aria-label="documenthead permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>document.head</h4>
<p>作为对 document.body 引用文档的<body>元素的补充，HTML5 新增了 document.head 属性， 引用文档的<head>元素</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> head <span class="token operator">=</span> document<span class="token punctuation">.</span>head <span class="token operator">||</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">"head"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span></code></pre></div>
<h3 id="6-html5-中自定义数据属性的应用-如何兼容不支持浏览器" style="position:relative;"><a href="#6-html5-%E4%B8%AD%E8%87%AA%E5%AE%9A%E4%B9%89%E6%95%B0%E6%8D%AE%E5%B1%9E%E6%80%A7%E7%9A%84%E5%BA%94%E7%94%A8-%E5%A6%82%E4%BD%95%E5%85%BC%E5%AE%B9%E4%B8%8D%E6%94%AF%E6%8C%81%E6%B5%8F%E8%A7%88%E5%99%A8" aria-label="6 html5 中自定义数据属性的应用 如何兼容不支持浏览器 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>6. HTML5 中自定义数据属性的应用? 如何兼容不支持浏览器?</h3>
<ul>
<li>用于元素渲染外的信息, 需要添加”data-”头, 但是获取时不需要”data”.</li>
<li>用于<strong>跟踪连接/混搭引用/插件参数/埋点数据</strong>等应用</li>
<li>Firefox 6+和 Chrome</li>
</ul>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>myDiv<span class="token punctuation">"</span></span> <span class="token attr-name">data-appId</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>12345<span class="token punctuation">"</span></span> <span class="token attr-name">data-myname</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Nicholas<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></code></pre></div>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">//本例中使用的方法仅用于演示</span>
<span class="token keyword">var</span> div <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"myDiv"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//取得自定义属性的值</span>
<span class="token keyword">var</span> appId <span class="token operator">=</span> div<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>appId<span class="token punctuation">;</span>
<span class="token keyword">var</span> myName <span class="token operator">=</span> div<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>myname<span class="token punctuation">;</span>

<span class="token comment">//设置值</span>
div<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>appId <span class="token operator">=</span> <span class="token number">23456</span><span class="token punctuation">;</span>
div<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>myname <span class="token operator">=</span> <span class="token string">"Michael"</span><span class="token punctuation">;</span></code></pre></div>
<p>如果不兼容, 可参考下面代码:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">if</span> <span class="token punctuation">(</span>myDiv<span class="token punctuation">.</span>dataset<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  myDiv<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>attribute <span class="token operator">=</span> <span class="token string">"valueXX"</span><span class="token punctuation">;</span> <span class="token comment">// 设置自定义属性</span>
  <span class="token keyword">var</span> theValue <span class="token operator">=</span> myDiv<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>attribute<span class="token punctuation">;</span> <span class="token comment">// 获取自定义属性</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  myDiv<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"data-attribute"</span><span class="token punctuation">,</span> <span class="token string">"valueXX"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 设置自定义属性</span>
  <span class="token keyword">var</span> theValue <span class="token operator">=</span> myDiv<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">"data-attribute"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 获取自定义属性</span>
<span class="token punctuation">}</span></code></pre></div>
<h3 id="7-插入标记字符串的方式有哪些及优势和问题" style="position:relative;"><a href="#7-%E6%8F%92%E5%85%A5%E6%A0%87%E8%AE%B0%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E6%96%B9%E5%BC%8F%E6%9C%89%E5%93%AA%E4%BA%9B%E5%8F%8A%E4%BC%98%E5%8A%BF%E5%92%8C%E9%97%AE%E9%A2%98" aria-label="7 插入标记字符串的方式有哪些及优势和问题 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>7. 插入标记字符串的方式有哪些及优势和问题?</h3>
<p>传统的方式是通过创建一个个节点再拼接插入, 量大会比较麻烦, 有三种形式可以使用:</p>
<h4 id="innerhtml" style="position:relative;"><a href="#innerhtml" aria-label="innerhtml permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>innerHTML</h4>
<ul>
<li>读模式: 获取指定节点的<strong>所有子节点对应的 HTML 标记字符串</strong>.</li>
<li>写模式: 根据指定的值创建新的 DOM 树, 然后在用这个 DOM 数完全<strong>替换调用元素原先的所有子节点</strong></li>
<li><strong>不要指望所有浏览器返回的值时是一致的</strong></li>
<li><strong>写和读两次的值也可能不一样</strong>, 原因是返回的字符串是根据原始 HTML 字符串创建的 DOM 数经过序列化后的结果</li>
<li>插入<code class="language-text">&lt;script&gt;</code> 时可能会有些限制, 在大多数浏览器中，通过 innerHTML 插入 <code class="language-text">&lt;script&gt;</code> 元素并不会执行其中的脚本(<strong>IE8 及更早版本是唯一能在这种情况下执行脚本的浏览器</strong>，但必须满足一 些条件。解决办法就是在插入的 script 前再插入一个有作用域的元素, 比如文本/空字符的 div/<strong>隐藏的 input(首选)</strong>等).</li>
<li>插入脚本还是使用别的方式吧</li>
<li>插入<code class="language-text">&lt;style&gt;</code>大多数浏览器都支持, IE8 及更早版本的 Hack 这里不做说明, 代码如下:</li>
</ul>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">div<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">'&lt;style type="text/css">body {background-color: red; }&lt;/style>'</span><span class="token punctuation">;</span></code></pre></div>
<h4 id="outerhtml" style="position:relative;"><a href="#outerhtml" aria-label="outerhtml permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>outerHTML</h4>
<p>用法和 innerHTML 类似, 不过是所有结果都包含自身.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// 使用 outerHTML 属性以下面这种方式设置值：</span>
div<span class="token punctuation">.</span>outerHTML <span class="token operator">=</span> <span class="token string">"&lt;p>This is a paragraph.&lt;/p>"</span><span class="token punctuation">;</span>

<span class="token comment">// 这行代码完成的操作与下面这些 DOM 脚本代码一样：</span>
<span class="token keyword">var</span> p <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"p"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
p<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">createTextNode</span><span class="token punctuation">(</span><span class="token string">"This is a paragraph."</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
div<span class="token punctuation">.</span>parentNode<span class="token punctuation">.</span><span class="token function">replaceChild</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> div<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<h4 id="insertadjacenthtml" style="position:relative;"><a href="#insertadjacenthtml" aria-label="insertadjacenthtml permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>insertAdjacentHTML()</h4>
<p>四个插入位置的字符串说明如下代码所示, 字符串说明会比较难懂:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">//作为前一个同辈元素插入</span>
element<span class="token punctuation">.</span><span class="token function">insertAdjacentHTML</span><span class="token punctuation">(</span><span class="token string">"beforebegin"</span><span class="token punctuation">,</span> <span class="token string">"&lt;p>Hello world!&lt;/p>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//作为第一个子元素插入</span>
element<span class="token punctuation">.</span><span class="token function">insertAdjacentHTML</span><span class="token punctuation">(</span><span class="token string">"afterbegin"</span><span class="token punctuation">,</span> <span class="token string">"&lt;p>Hello world!&lt;/p>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//作为最后一个子元素插入</span>
element<span class="token punctuation">.</span><span class="token function">insertAdjacentHTML</span><span class="token punctuation">(</span><span class="token string">"beforeend"</span><span class="token punctuation">,</span> <span class="token string">"&lt;p>Hello world!&lt;/p>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//作为后一个同辈元素插入</span>
element<span class="token punctuation">.</span><span class="token function">insertAdjacentHTML</span><span class="token punctuation">(</span><span class="token string">"afterend"</span><span class="token punctuation">,</span> <span class="token string">"&lt;p>Hello world!&lt;/p>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<h4 id="内存与性能问题注意" style="position:relative;"><a href="#%E5%86%85%E5%AD%98%E4%B8%8E%E6%80%A7%E8%83%BD%E9%97%AE%E9%A2%98%E6%B3%A8%E6%84%8F" aria-label="内存与性能问题注意 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>内存与性能问题注意</h4>
<ul>
<li>使用上述 API 比单独创建元素要高效的多, 建议使用</li>
<li>删除元素前<strong>别忘记解绑事件监听</strong>, 否则出现内存泄露</li>
<li>这是 innerHTML 或者 outerHTML 会创建 HTML 解析器, 一次频繁创建会影响性能, <strong>建议控制调用上述三个 API 的次数</strong>, 比如缓存字符串中间结果</li>
</ul>
<h3 id="8-scrollintoview方法" style="position:relative;"><a href="#8-scrollintoview%E6%96%B9%E6%B3%95" aria-label="8 scrollintoview方法 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>8. scrollIntoView()方法</h3>
<h3 id="8-在移动端当键盘遮挡输入框该如何处理" style="position:relative;"><a href="#8-%E5%9C%A8%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%BD%93%E9%94%AE%E7%9B%98%E9%81%AE%E6%8C%A1%E8%BE%93%E5%85%A5%E6%A1%86%E8%AF%A5%E5%A6%82%E4%BD%95%E5%A4%84%E7%90%86" aria-label="8 在移动端当键盘遮挡输入框该如何处理 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>8. 在移动端当键盘遮挡输入框该如何处理?</h3>
<blockquote>
<p>文章来源: <a href="https://github.com/justjavac/the-front-end-knowledge-you-may-dont-know/issues/3" target="_target" rel="nofollow">https://github.com/justjavac/the-front-end-knowledge-you-may-dont-know/issues/3</a></p>
</blockquote>
<p>使用<code class="language-text">Element.scrollIntoViewIfNeeded(opt_center)</code>, 就是在需要的时候将元素滚动到可视区域。</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">//让元素可见, 窗口滚动 之后会让调用元素的顶部与视口顶部尽可能平齐</span>
document<span class="token punctuation">.</span>forms<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">scrollIntoView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span>forms<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">scrollIntoView</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Safari 和 Chrome 实现了这个方法</span>
document<span class="token punctuation">.</span>forms<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">scrollIntoViewIfNeeded</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 只是让元素可见</span>
document<span class="token punctuation">.</span>forms<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">scrollIntoView</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>]]></description><link>https://xiangst0816.github.io/blog/di-shi-yi-zhang-DOM-tuo-ta-zhi-zhan/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/di-shi-yi-zhang-DOM-tuo-ta-zhi-zhan/</guid><category><![CDATA[JS高程]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Sun, 04 Mar 2018 13:47:59 GMT</pubDate></item><item><title><![CDATA[第十章 DOM]]></title><description><![CDATA[<h3 id="1-对-dom-树形结构的理解" style="position:relative;"><a href="#1-%E5%AF%B9-dom-%E6%A0%91%E5%BD%A2%E7%BB%93%E6%9E%84%E7%9A%84%E7%90%86%E8%A7%A3" aria-label="1 对 dom 树形结构的理解 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 对 DOM 树形结构的理解?</h3>
<h4 id="dom-解释" style="position:relative;"><a href="#dom-%E8%A7%A3%E9%87%8A" aria-label="dom 解释 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>DOM 解释</h4>
<p><strong>DOM(文档对象模型)</strong>, 是针对类 HTML 层次化节点树<strong>操作</strong>的一个<strong>API(应用程序编程接口)</strong>集合. 用于更改底层文档及外观结构.</p>
<h4 id="根节点" style="position:relative;"><a href="#%E6%A0%B9%E8%8A%82%E7%82%B9" aria-label="根节点 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>根节点</h4>
<p>树中的节点可以由多种<strong>Node 类型</strong>组成, 根节点称之为<strong>文档元素</strong>(传说的<code class="language-text">document</code>), 即<code class="language-text">&lt;html&gt;&lt;/html&gt;</code>.</p>
<h4 id="node-类型" style="position:relative;"><a href="#node-%E7%B1%BB%E5%9E%8B" aria-label="node 类型 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Node 类型</h4>
<p>类型可以是:</p>
<ul>
<li><strong>Node.ELEMENT_NODE(1)</strong>；子元素</li>
<li>Node.ATTRIBUTE_NODE(2)；</li>
<li><strong>Node.TEXT_NODE(3)</strong>； 文本</li>
<li>Node.CDATA<em>SECTION</em>NODE(4)；</li>
<li>Node.ENTITY<em>REFERENCE</em>NODE(5)；</li>
<li>Node.ENTITY_NODE(6)；</li>
<li>Node.PROCESSING<em>INSTRUCTION</em>NODE(7)；</li>
<li><strong>Node.COMMENT_NODE(8)</strong>；注释</li>
<li><strong>Node.DOCUMENT_NODE(9)</strong>；表示整个 HTML 页面, document</li>
<li>Node.DOCUMENT<em>TYPE</em>NODE(10)；</li>
<li>Node.DOCUMENT<em>FRAGMENT</em>NODE(11)；</li>
<li>Node.NOTATION_NODE(12)</li>
</ul>
<p>每个类型所具有的 API 及同名 API 的含义不同, 使用前先判断下.</p>
<p>此外, <code class="language-text">NodeList</code>类型是类数组对象, 如果要像数组使用, 需要转化一下:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>xx<span class="token punctuation">.</span>childNodes<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<h4 id="node-查找-api" style="position:relative;"><a href="#node-%E6%9F%A5%E6%89%BE-api" aria-label="node 查找 api permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Node 查找 API</h4>
<p>关于 Node 前后的关系属性需要知道的名称有:</p>
<ul>
<li><code class="language-text">firstChild()</code></li>
<li><code class="language-text">lastChild()</code></li>
<li><code class="language-text">parentNode()</code></li>
<li><code class="language-text">childNodes()</code> (注意<code class="language-text">hanChildNodes()</code>函数判断是否有子节点)</li>
<li><code class="language-text">nextSlibing()</code></li>
<li><code class="language-text">previousSlibling()</code></li>
</ul>
<h4 id="node-操作-api" style="position:relative;"><a href="#node-%E6%93%8D%E4%BD%9C-api" aria-label="node 操作 api permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Node 操作 API</h4>
<ul>
<li><code class="language-text">appendChild()</code> 向 childNodes 列表的末尾添加一个节点, 更新完毕返回新增节点</li>
<li><code class="language-text">insertBefore()</code> 在某个特定的位置上插入节点</li>
<li><code class="language-text">replaceChild()</code></li>
<li><code class="language-text">removeChild()</code></li>
<li><code class="language-text">cloneNode()</code> 建议复制前先移除上面的事件绑定, IE 有问题</li>
</ul>
<h3 id="2-code-classlanguage-textltdoctypegtcode是什么含义-不写或写错会有什么后果" style="position:relative;"><a href="#2-code-classlanguage-textltdoctypegtcode%E6%98%AF%E4%BB%80%E4%B9%88%E5%90%AB%E4%B9%89-%E4%B8%8D%E5%86%99%E6%88%96%E5%86%99%E9%94%99%E4%BC%9A%E6%9C%89%E4%BB%80%E4%B9%88%E5%90%8E%E6%9E%9C" aria-label="2 code classlanguage textltdoctypegtcode是什么含义 不写或写错会有什么后果 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. <code class="language-text">&lt;!DOCTYPE&gt;</code>是什么含义, 不写或写错会有什么后果?</h3>
<p>用来声明文档类型, 通过<code class="language-text">document.doctype</code>获得. 用于告诉浏览器当前的文档所使用标记(标签)版本, <strong>影响最终的页面呈现效果</strong>!</p>
<p>如果页面没写着行说明, 则浏览器解析页面会出现怪异行为, 比如盒模型/size 解析/内联元素尺寸/图片对齐方式等.</p>
<h3 id="3-如何获取对-code-classlanguage-textbodycode--code-classlanguage-texthtmlcode-node-节点的引用" style="position:relative;"><a href="#3-%E5%A6%82%E4%BD%95%E8%8E%B7%E5%8F%96%E5%AF%B9-code-classlanguage-textbodycode--code-classlanguage-texthtmlcode-node-%E8%8A%82%E7%82%B9%E7%9A%84%E5%BC%95%E7%94%A8" aria-label="3 如何获取对 code classlanguage textbodycode  code classlanguage texthtmlcode node 节点的引用 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. 如何获取对 <code class="language-text">body</code> / <code class="language-text">html</code> Node 节点的引用?</h3>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> html <span class="token operator">=</span> document<span class="token punctuation">.</span>documentElement<span class="token punctuation">;</span>
<span class="token keyword">var</span> body <span class="token operator">=</span> document<span class="token punctuation">.</span>body<span class="token punctuation">;</span>
<span class="token comment">// 同理</span>
<span class="token keyword">var</span> head <span class="token operator">=</span> document<span class="token punctuation">.</span>head<span class="token punctuation">;</span></code></pre></div>
<h3 id="4-在code-classlanguage-textltdoctypegtcode前或者code-classlanguage-textlthtmlgtcode前后写注释会有什么影响" style="position:relative;"><a href="#4-%E5%9C%A8code-classlanguage-textltdoctypegtcode%E5%89%8D%E6%88%96%E8%80%85code-classlanguage-textlthtmlgtcode%E5%89%8D%E5%90%8E%E5%86%99%E6%B3%A8%E9%87%8A%E4%BC%9A%E6%9C%89%E4%BB%80%E4%B9%88%E5%BD%B1%E5%93%8D" aria-label="4 在code classlanguage textltdoctypegtcode前或者code classlanguage textlthtmlgtcode前后写注释会有什么影响 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. 在<code class="language-text">&lt;!DOCTYPE&gt;</code>前或者<code class="language-text">&lt;html&gt;</code>前后写注释会有什么影响?</h3>
<p>不同浏览器间对注释的解释不一致, 导致了位于<html>元素外部的注释没有什么用处.</p>
<p>另外, document 属性是只读的, 在其前后插入 Node 不可行.</p>
<h3 id="5-不同域或者子域因为跨域安全限制-不能-js-直接通信-怎么破" style="position:relative;"><a href="#5-%E4%B8%8D%E5%90%8C%E5%9F%9F%E6%88%96%E8%80%85%E5%AD%90%E5%9F%9F%E5%9B%A0%E4%B8%BA%E8%B7%A8%E5%9F%9F%E5%AE%89%E5%85%A8%E9%99%90%E5%88%B6-%E4%B8%8D%E8%83%BD-js-%E7%9B%B4%E6%8E%A5%E9%80%9A%E4%BF%A1-%E6%80%8E%E4%B9%88%E7%A0%B4" aria-label="5 不同域或者子域因为跨域安全限制 不能 js 直接通信 怎么破 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>5. 不同域或者子域因为跨域安全限制, 不能 JS 直接通信, 怎么破?</h3>
<ul>
<li>不同域无法破解</li>
<li>相同子域可修改<code class="language-text">document.domain</code>解决</li>
</ul>
<p>比如: p2p.wrox.com 和 wrox.com js 通信, 可在 p2p.wrox.com 的网页中设置:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">document<span class="token punctuation">.</span>domain <span class="token operator">=</span> <span class="token string">"wrox.com"</span><span class="token punctuation">;</span></code></pre></div>
<p>之后即可通讯, 如果 wrox.com -> p2p.wrox.com 这样是不行的.</p>
<h3 id="6-code-classlanguage-textdocumentwritecode在文档加载结束前后使用有什么差异" style="position:relative;"><a href="#6-code-classlanguage-textdocumentwritecode%E5%9C%A8%E6%96%87%E6%A1%A3%E5%8A%A0%E8%BD%BD%E7%BB%93%E6%9D%9F%E5%89%8D%E5%90%8E%E4%BD%BF%E7%94%A8%E6%9C%89%E4%BB%80%E4%B9%88%E5%B7%AE%E5%BC%82" aria-label="6 code classlanguage textdocumentwritecode在文档加载结束前后使用有什么差异 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>6. <code class="language-text">document.write()</code>在文档加载结束前后使用有什么差异?</h3>
<ul>
<li>文档加载结束前: 会在输出流中写入内部文本, 可<strong>用于动态包含外部资源</strong></li>
<li>文档加载结束后: 会用内部文本重写整个页面</li>
</ul>
<h3 id="7-这段代码的问题是" style="position:relative;"><a href="#7-%E8%BF%99%E6%AE%B5%E4%BB%A3%E7%A0%81%E7%9A%84%E9%97%AE%E9%A2%98%E6%98%AF" aria-label="7 这段代码的问题是 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>7. 这段代码的问题是?</h3>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>document.write() Example 2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
	document<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">"&lt;script type=\"text/javascript\" src=\"file.js\">"</span>
	<span class="token operator">+</span> "</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>");
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre></div>
<p>代码到这里<code class="language-text">+ &quot;&lt;/script&gt;&quot;);</code>会终止, 页面最后一行显示<code class="language-text">&quot;);</code>文本.</p>
<p>解决办法是将<code class="language-text">+ &quot;&lt;/script&gt;&quot;);</code>替换为<code class="language-text">+ &quot;&lt;\/script&gt;&quot;);</code></p>
<h3 id="8-动态插入脚本的一般过程" style="position:relative;"><a href="#8-%E5%8A%A8%E6%80%81%E6%8F%92%E5%85%A5%E8%84%9A%E6%9C%AC%E7%9A%84%E4%B8%80%E8%88%AC%E8%BF%87%E7%A8%8B" aria-label="8 动态插入脚本的一般过程 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>8. 动态插入脚本的一般过程?</h3>
<h4 id="插入外部文件" style="position:relative;"><a href="#%E6%8F%92%E5%85%A5%E5%A4%96%E9%83%A8%E6%96%87%E4%BB%B6" aria-label="插入外部文件 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>插入外部文件</h4>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">loadScript</span><span class="token punctuation">(</span><span class="token parameter">url</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> script <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"script"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  script<span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token string">"text/javascript"</span><span class="token punctuation">;</span>
  script<span class="token punctuation">.</span>src <span class="token operator">=</span> url<span class="token punctuation">;</span>
  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>script<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<h4 id="直接插入代码" style="position:relative;"><a href="#%E7%9B%B4%E6%8E%A5%E6%8F%92%E5%85%A5%E4%BB%A3%E7%A0%81" aria-label="直接插入代码 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>直接插入代码</h4>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">loadScriptString</span><span class="token punctuation">(</span><span class="token parameter">code</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> script <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"script"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  script<span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token string">"text/javascript"</span><span class="token punctuation">;</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    script<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">createTextNode</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    script<span class="token punctuation">.</span>text <span class="token operator">=</span> code<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>script<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<h3 id="9-插入样式的一般过程" style="position:relative;"><a href="#9-%E6%8F%92%E5%85%A5%E6%A0%B7%E5%BC%8F%E7%9A%84%E4%B8%80%E8%88%AC%E8%BF%87%E7%A8%8B" aria-label="9 插入样式的一般过程 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>9. 插入样式的一般过程?</h3>
<p><strong>!!样式插入到 head 中!!</strong></p>
<h4 id="插入外部文件-1" style="position:relative;"><a href="#%E6%8F%92%E5%85%A5%E5%A4%96%E9%83%A8%E6%96%87%E4%BB%B6-1" aria-label="插入外部文件 1 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>插入外部文件</h4>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">loadStyles</span><span class="token punctuation">(</span><span class="token parameter">url</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> link <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"link"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  link<span class="token punctuation">.</span>rel <span class="token operator">=</span> <span class="token string">"stylesheet"</span><span class="token punctuation">;</span>
  link<span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token string">"text/css"</span><span class="token punctuation">;</span>
  link<span class="token punctuation">.</span>href <span class="token operator">=</span> url<span class="token punctuation">;</span>
  <span class="token keyword">var</span> head <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">"head"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  head<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>link<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<h4 id="直接插入代码-1" style="position:relative;"><a href="#%E7%9B%B4%E6%8E%A5%E6%8F%92%E5%85%A5%E4%BB%A3%E7%A0%81-1" aria-label="直接插入代码 1 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>直接插入代码</h4>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">loadStyleString</span><span class="token punctuation">(</span><span class="token parameter">css</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> style <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"style"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  style<span class="token punctuation">.</span>type <span class="token operator">=</span> <span class="token string">"text/css"</span><span class="token punctuation">;</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    style<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">createTextNode</span><span class="token punctuation">(</span>css<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    style<span class="token punctuation">.</span>styleSheet<span class="token punctuation">.</span>cssText <span class="token operator">=</span> css<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">var</span> head <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">"head"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  head<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>style<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<h3 id="10-nodelist-特性理解" style="position:relative;"><a href="#10-nodelist-%E7%89%B9%E6%80%A7%E7%90%86%E8%A7%A3" aria-label="10 nodelist 特性理解 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>10. NodeList 特性理解?</h3>
<ul>
<li><strong>动态</strong>的集合, 当文档更新后再次获取 NodeList 能拿到更新结果</li>
<li>操作 DOM 很耗时, <strong>应该尽量减少访问 NodeList 的次数</strong>. 因为每次访问 NodeList，都会运行一次基于文档的查询.</li>
</ul>]]></description><link>https://xiangst0816.github.io/blog/di-shi-zhang-DOM/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/di-shi-zhang-DOM/</guid><category><![CDATA[JS高程]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Sun, 04 Mar 2018 07:17:28 GMT</pubDate></item><item><title><![CDATA[第八章 BOM]]></title><description><![CDATA[<h3 id="1-code-classlanguage-textwindowcodecode-classlanguage-texttopcodecode-classlanguage-textselfcodecode-classlanguage-textparentcodecode-classlanguage-textglobalcode这些对象的含义和区别" style="position:relative;"><a href="#1-code-classlanguage-textwindowcodecode-classlanguage-texttopcodecode-classlanguage-textselfcodecode-classlanguage-textparentcodecode-classlanguage-textglobalcode%E8%BF%99%E4%BA%9B%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%90%AB%E4%B9%89%E5%92%8C%E5%8C%BA%E5%88%AB" aria-label="1 code classlanguage textwindowcodecode classlanguage texttopcodecode classlanguage textselfcodecode classlanguage textparentcodecode classlanguage textglobalcode这些对象的含义和区别 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. <code class="language-text">window</code>/<code class="language-text">top</code>/<code class="language-text">self</code>/<code class="language-text">parent</code>/<code class="language-text">Global</code>这些对象的含义和区别?</h3>
<ul>
<li><code class="language-text">window</code>，它表示浏览器的一个实例</li>
<li><code class="language-text">window</code> 对象还是 ECMAScript 中的 <code class="language-text">Global</code> 对象，因而所有全局变量和函数都是它的属性，且所有原生的构造 函数及其他函数也都存在于它的命名空间下</li>
<li>此外, 页面可能包含很多 frames</li>
<li><code class="language-text">top</code> 对象始终指向最外围的框架(frames)，也就是整个浏览器窗口</li>
<li><code class="language-text">parent</code> 对象表示包含当前框架的框架，而 self 对象则回指 <code class="language-text">window</code></li>
<li>在没有框架的情况下，<code class="language-text">parent</code> 一定等于 <code class="language-text">top</code>（此时它们都等于 <code class="language-text">window</code>）</li>
<li>与框架有关的最后一个对象是 self，它始终指向 <code class="language-text">window</code>；实际上，<code class="language-text">self</code> 和 <code class="language-text">window</code> 对象可以互 换使用, 引入 <code class="language-text">self</code> 对象的目的只是为了与 <code class="language-text">top</code> 和 <code class="language-text">parent</code> 对象对应起来，因此它不格外包含其他值。</li>
</ul>
<h3 id="2-为什么不建议在全局对象上保存业务变量" style="position:relative;"><a href="#2-%E4%B8%BA%E4%BB%80%E4%B9%88%E4%B8%8D%E5%BB%BA%E8%AE%AE%E5%9C%A8%E5%85%A8%E5%B1%80%E5%AF%B9%E8%B1%A1%E4%B8%8A%E4%BF%9D%E5%AD%98%E4%B8%9A%E5%8A%A1%E5%8F%98%E9%87%8F" aria-label="2 为什么不建议在全局对象上保存业务变量 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 为什么不建议在全局对象上保存业务变量?</h3>
<ul>
<li>在全局作用域中定义了的变量和函数，它们被自动归在了 window 对象 名下</li>
<li><strong>注意:</strong> 在 window 对象上定义属性在 IE>=9 时能安全删除. “自动行为”不可以.</li>
<li>命名冲突等</li>
<li>以上就是可能存在的问题</li>
</ul>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> age <span class="token operator">=</span> <span class="token number">29</span><span class="token punctuation">;</span> <span class="token comment">// IE >=9 不能安全删除</span>
window<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">"red"</span><span class="token punctuation">;</span> <span class="token comment">// IE >=9 可安全删除</span>

<span class="token comment">//在 IE &lt; 9 时抛出错误，在其他所有浏览器中都返回 false</span>
<span class="token keyword">delete</span> window<span class="token punctuation">.</span>age<span class="token punctuation">;</span>

<span class="token comment">//在 IE &lt; 9 时抛出错误，在其他所有浏览器中都返回 true</span>
<span class="token keyword">delete</span> window<span class="token punctuation">.</span>color<span class="token punctuation">;</span> <span class="token comment">//returns true</span>

<span class="token function">alert</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//29</span>
<span class="token function">alert</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>color<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//undefined</span></code></pre></div>
<h3 id="3-获取窗口位置及移动窗口的接口有什么问题" style="position:relative;"><a href="#3-%E8%8E%B7%E5%8F%96%E7%AA%97%E5%8F%A3%E4%BD%8D%E7%BD%AE%E5%8F%8A%E7%A7%BB%E5%8A%A8%E7%AA%97%E5%8F%A3%E7%9A%84%E6%8E%A5%E5%8F%A3%E6%9C%89%E4%BB%80%E4%B9%88%E9%97%AE%E9%A2%98" aria-label="3 获取窗口位置及移动窗口的接口有什么问题 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. 获取窗口位置及移动窗口的接口有什么问题?</h3>
<ul>
<li><strong>无法在跨浏览器的条件下</strong>取得窗口左边和上边的<strong>精确坐标值</strong></li>
<li>使用 moveTo() 和 moveBy() 方法倒是有可能将窗口精确地移动到一个新位置, 但是不一定会生效, 因为可能会被浏览器禁用</li>
</ul>
<h3 id="4-浏览器窗口大小-api-有什么使用问题" style="position:relative;"><a href="#4-%E6%B5%8F%E8%A7%88%E5%99%A8%E7%AA%97%E5%8F%A3%E5%A4%A7%E5%B0%8F-api-%E6%9C%89%E4%BB%80%E4%B9%88%E4%BD%BF%E7%94%A8%E9%97%AE%E9%A2%98" aria-label="4 浏览器窗口大小 api 有什么使用问题 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. 浏览器窗口大小 api 有什么使用问题?</h3>
<ul>
<li>无法确定浏览器窗口本身的大小，但却可以取得页面视口的大小</li>
<li>使用 resizeTo()和 resizeBy()方法可以调整浏览器窗口的大小, 也有可能被浏览器禁用</li>
</ul>
<h3 id="5-使用-windowopen的问题" style="position:relative;"><a href="#5-%E4%BD%BF%E7%94%A8-windowopen%E7%9A%84%E9%97%AE%E9%A2%98" aria-label="5 使用 windowopen的问题 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>5. 使用 window.open()的问题?</h3>
<p>可能会因为<strong>安全问题</strong>屏蔽代码自动开启新窗口.</p>
<h3 id="6-historylength-的含义" style="position:relative;"><a href="#6-historylength-%E7%9A%84%E5%90%AB%E4%B9%89" aria-label="6 historylength 的含义 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>6. history.length 的含义?</h3>
<p>这个数量 包括所有历史记录，即所有向后和向前的记录。因此, <strong>无法通过这个判断当前页面进入的方式(前进/后退), 需要内建记录判断</strong>.</p>]]></description><link>https://xiangst0816.github.io/blog/di-ba-zhang-BOM/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/di-ba-zhang-BOM/</guid><category><![CDATA[JS高程]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Wed, 28 Feb 2018 02:15:18 GMT</pubDate></item><item><title><![CDATA[第九章 客户端检测]]></title><description><![CDATA[<p>至少是我这里的前端开发都是自顶向下的模式, 即先按照支持程度最高的浏览器上开发, 之后再适配其他浏览器. 因此, 适配过程就需要对不同的客户端.</p>
<h2 id="能力检测" style="position:relative;"><a href="#%E8%83%BD%E5%8A%9B%E6%A3%80%E6%B5%8B" aria-label="能力检测 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>能力检测</h2>
<p>H5 能力检测, 比如这个库: <a href="https://modernizr.com/" target="_target" rel="nofollow">modernizr</a></p>
<h2 id="怪癖检测bug-检测" style="position:relative;"><a href="#%E6%80%AA%E7%99%96%E6%A3%80%E6%B5%8Bbug-%E6%A3%80%E6%B5%8B" aria-label="怪癖检测bug 检测 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>怪癖检测(Bug 检测)</h2>
<p>一般情况下不推荐使用.</p>
<h2 id="useragent-检测" style="position:relative;"><a href="#useragent-%E6%A3%80%E6%B5%8B" aria-label="useragent 检测 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>userAgent 检测</h2>
<p>一般通过正则匹配 userAgent 进行平台鉴别. 例如:</p>
<ul>
<li><a href="https://faisalman.github.io/ua-parser-js/" target="_target" rel="nofollow">UAParser.js</a> Lightweight JavaScript-based User-Agent String Parser</li>
</ul>]]></description><link>https://xiangst0816.github.io/blog/di-jiu-zhang-ke-hu-duan-jian-ce/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/di-jiu-zhang-ke-hu-duan-jian-ce/</guid><category><![CDATA[JS高程]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Wed, 28 Feb 2018 01:59:29 GMT</pubDate></item><item><title><![CDATA[第六章 面相对象的程序设计]]></title><description><![CDATA[<h3 id="1-对象定义" style="position:relative;"><a href="#1-%E5%AF%B9%E8%B1%A1%E5%AE%9A%E4%B9%89" aria-label="1 对象定义 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 对象定义?</h3>
<p>无需属性的集合, 其属性可以包含基本值/对象/函数; 或者, <strong>没有特定顺序</strong>的散列表.</p>
<blockquote>
<p>或者, 使用 js 实现一个散列表?
答: var a = {};</p>
</blockquote>
<h3 id="2-code-classlanguage-textnewcode操作符执行的过程" style="position:relative;"><a href="#2-code-classlanguage-textnewcode%E6%93%8D%E4%BD%9C%E7%AC%A6%E6%89%A7%E8%A1%8C%E7%9A%84%E8%BF%87%E7%A8%8B" aria-label="2 code classlanguage textnewcode操作符执行的过程 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. <code class="language-text">new</code>操作符执行的过程?</h3>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// 代码</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Base</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 拆解</span>
<span class="token comment">// 1. 创建（或者说构造）一个全新的对象；</span>
<span class="token keyword">var</span> _obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 2. 我们将这个空对象的__proto__成员指向了Base函数对象prototype成员对象</span>
_obj<span class="token punctuation">.</span>__proto__ <span class="token operator">=</span> <span class="token class-name">Base</span><span class="token punctuation">.</span>prototype<span class="token punctuation">;</span>

<span class="token comment">// 3. 我们将Base函数对象的this指针替换成_obj，然后再调用Base函数</span>
<span class="token keyword">var</span> _return <span class="token operator">=</span> <span class="token function">Base</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>_obj<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 4 如果函数没有返回其他对象，那么new表达式中的函数调用会自动返回这个新对象</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> _return <span class="token operator">===</span> <span class="token string">"object"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  obj <span class="token operator">=</span> _return<span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  obj <span class="token operator">=</span> _obj<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<h3 id="3-下面的输出结果是" style="position:relative;"><a href="#3-%E4%B8%8B%E9%9D%A2%E7%9A%84%E8%BE%93%E5%87%BA%E7%BB%93%E6%9E%9C%E6%98%AF" aria-label="3 下面的输出结果是 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. 下面的输出结果是?</h3>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">Base</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"Name"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Base</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>constructor <span class="token operator">===</span> Base<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>constructor <span class="token operator">===</span> Object<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj <span class="token keyword">instanceof</span> <span class="token class-name">Base</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj <span class="token keyword">instanceof</span> <span class="token class-name">Object</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> obj <span class="token operator">===</span> <span class="token string">"object"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span></code></pre></div>
<h3 id="4-谈谈你对-prototype-的理解" style="position:relative;"><a href="#4-%E8%B0%88%E8%B0%88%E4%BD%A0%E5%AF%B9-prototype-%E7%9A%84%E7%90%86%E8%A7%A3" aria-label="4 谈谈你对 prototype 的理解 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. 谈谈你对 prototype 的理解?</h3>
<ul>
<li>每个函数都有一个<code class="language-text">[[Prototype]]</code>(原型)属性, 这个属性是一个指针, 指向 prototype 原型对象</li>
<li>prototype 原型对象的用途是包含可以由特定类型的<strong>所有实例共享的</strong>属性和方法</li>
<li>prototype 原型对象会自动获得 constructor(构造函数)属性</li>
<li><strong><em>实例的<code class="language-text">[[Prototype]]</code></em></strong>就是上面提到的<em>prototype 原型对象</em>, 在个别浏览器中则为可访问的<code class="language-text">__proto__</code>属性</li>
</ul>
<h3 id="5-解释为什么不建议在代码中使用code-classlanguage-text__proto__code属性" style="position:relative;"><a href="#5-%E8%A7%A3%E9%87%8A%E4%B8%BA%E4%BB%80%E4%B9%88%E4%B8%8D%E5%BB%BA%E8%AE%AE%E5%9C%A8%E4%BB%A3%E7%A0%81%E4%B8%AD%E4%BD%BF%E7%94%A8code-classlanguage-text__proto__code%E5%B1%9E%E6%80%A7" aria-label="5 解释为什么不建议在代码中使用code classlanguage text__proto__code属性 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>5. 解释为什么不建议在代码中使用<code class="language-text">__proto__</code>属性?</h3>
<p><strong>解释:</strong></p>
<p>首先, 每个实例都有一个指向<strong>原型对象</strong>的内部属性, 在规范中, 这个内部属性叫<code class="language-text">[[Prototype]]</code>, 虽然<code class="language-text">[[Prototype]]</code>ES 标准中没有直接访问的属性, 但是在 Firefox/Safari/Chrome 可以通过<code class="language-text">__proto__</code>属性访问, 别的浏览器就无法支持, 所以如问题描述.</p>
<p><strong>替代方案:</strong></p>
<ul>
<li>通过<code class="language-text">Object.getPrototypeOf()</code>返回<code class="language-text">[[Prototype]]</code>的值.</li>
</ul>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">Base</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"Name"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">Base</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">sayName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Base</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">getPrototypeOf</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token class-name">Base</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span></code></pre></div>
<ul>
<li>通过<code class="language-text">isPrototypeOf()</code>判断原型是否和实例的<code class="language-text">[[Prototype]]</code>相等.</li>
</ul>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Base</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">isPrototypeOf</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span></code></pre></div>
<h3 id="6-为什么不建议code-classlanguage-textobjectdefinepropertycode中的code-classlanguage-textgetcode和code-classlanguage-textsetcode函数分开使用" style="position:relative;"><a href="#6-%E4%B8%BA%E4%BB%80%E4%B9%88%E4%B8%8D%E5%BB%BA%E8%AE%AEcode-classlanguage-textobjectdefinepropertycode%E4%B8%AD%E7%9A%84code-classlanguage-textgetcode%E5%92%8Ccode-classlanguage-textsetcode%E5%87%BD%E6%95%B0%E5%88%86%E5%BC%80%E4%BD%BF%E7%94%A8" aria-label="6 为什么不建议code classlanguage textobjectdefinepropertycode中的code classlanguage textgetcode和code classlanguage textsetcode函数分开使用 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>6. 为什么不建议<code class="language-text">Object.defineProperty()</code>中的<code class="language-text">get</code>和<code class="language-text">set</code>函数分开使用?</h3>
<p>只设置其一会导致另一个功能不可用, 比如:</p>
<ul>
<li>只设置 get 函数, 则无法设置值</li>
<li>只设置 set 函数, 则获取值的值为 <code class="language-text">undefined</code></li>
</ul>
<h3 id="7-理解-ecmascript-中原型对象的性质" style="position:relative;"><a href="#7-%E7%90%86%E8%A7%A3-ecmascript-%E4%B8%AD%E5%8E%9F%E5%9E%8B%E5%AF%B9%E8%B1%A1%E7%9A%84%E6%80%A7%E8%B4%A8" aria-label="7 理解 ecmascript 中原型对象的性质 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>7. 理解 ECMAScript 中原型对象的性质</h3>
<p>我们创建的每个函数都有一个<code class="language-text">prototype</code>属性, 这个属性是一个指针, 指向一个对象. 而这个对象的用途是包含可以由特定类型的所有实例共享的属性和方法.</p>
<p>或者说, <code class="language-text">prototype</code>就是通过调用构造函数而创建的那个对象实例的<strong>原型对象</strong>. 各个实例之间<strong>共享同一个原型对象</strong>(包括属性和方法), 而不是各自保存一个相同副本.</p>
<p>默认情况下, 所有原型对象都会<strong>自动获得一个<code class="language-text">constructor</code>(构造函数)属性</strong>, 这个属性指向<code class="language-text">prototype</code>属性所在的函数(也就是构造函数本源). 如图:</p>
<p><figure class="gatsby-resp-image-figure" style="">
    <span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 703px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 82.85714285714286%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAIAAABSJhvpAAAACXBIWXMAAAsSAAALEgHS3X78AAACaUlEQVQ4y3VTDVPaQBDl//+P1tFqK0wp1ipSKa3COEUQR1qnkGJIgMtdLrnkvpNuAlar9k1ys5fc23u7766S/4ssy2wJCGBq75G/hIpSyivhOA7nfLFY9Pv9m5ubbrd7eno6GAxGo9FwOMQYw8q/qdfpKmmanpc4OjoC5nw+r9fr1VoNpu12u9PpNJtNCBBCQgjILkoAC8bKY8Uw8DRd+j48BOOIUkpIsFyGGAONlXBddzqdTiaTDdmWYnSpZGHMVZ5/BzmEnGH8DaGhtVfG+EEA+yZJMh6PW60WFALpHnZe9+SHlDtBsOO6b3y/Ruk+IfthWI+iX66bMgY10xIgG+JKYu1FGPaCoO15iPPf1r7FeHc2+5gkJ9YeMFZFqKU1TpLMGMhujFkbUTSMZ9mAkEuMe6sVFgLIDaVqy+WJ1k2t3xOy53ltawPG8nvOg1VPZP/UapeGr5xpnacNKffQasu9O5Tyv+SiYVlmbPEP2bwbRJ2ZN2B8bPLeipz56JrriPO1xeC21nrj8+PTVbyG5pmX54EWM8kmufXBARiFSISQLI7XnsVxDFkKMiHDu7uG6x5DLNWY0u043ve8rbn3mvMa51UhG5QuhFCE4IsSYRhKKQuy1lRKX8plQZZz1206ThOhr1k2UuqS0vMk6VOKjLFwxoIAymewLSivPOmBtdD+KM+Z1mGaIq2JtdTaCE4k9At8goO1vj+bmqPoGqxZLL5ArNRtoVMcrFZ7rrvNecPaQ62PGUPPml2SQXMcj+P4FmIhJrPZO8ep+v4HpTpStsPwE2Of4zh44Uo+/wQ7ZBsUAZRa3u7s+co/vD+7rTtUDzwAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="原型链"
        title="原型链"
        src="/blog/static/c531f9877e4d0d373a8579f55058d19b/5afcd/yuanxinglian.png"
        srcset="/blog/static/c531f9877e4d0d373a8579f55058d19b/e1650/yuanxinglian.png 210w,
/blog/static/c531f9877e4d0d373a8579f55058d19b/8cae7/yuanxinglian.png 420w,
/blog/static/c531f9877e4d0d373a8579f55058d19b/5afcd/yuanxinglian.png 703w"
        sizes="(max-width: 703px) 100vw, 703px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span>
    <figcaption class="gatsby-resp-image-figcaption">原型链</figcaption>
  </figure></p>
<h3 id="8-结合原型链谈谈对象中属性查找方式及优化点" style="position:relative;"><a href="#8-%E7%BB%93%E5%90%88%E5%8E%9F%E5%9E%8B%E9%93%BE%E8%B0%88%E8%B0%88%E5%AF%B9%E8%B1%A1%E4%B8%AD%E5%B1%9E%E6%80%A7%E6%9F%A5%E6%89%BE%E6%96%B9%E5%BC%8F%E5%8F%8A%E4%BC%98%E5%8C%96%E7%82%B9" aria-label="8 结合原型链谈谈对象中属性查找方式及优化点 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>8. 结合原型链谈谈对象中属性查找方式及优化点?</h3>
<ul>
<li><strong>对象实例</strong>上的属性增删改<strong>不会影响原型上的同名属性</strong>, 最终操作都是在实例上进行的,</li>
<li>在对象搜索属性名时, <strong>先从实例对象本身开始</strong>, 如果没有<strong>再到原型对象上找</strong>, 以此向下直到 Object 对象上, 未找到返回<code class="language-text">undefined</code></li>
<li>根据以上两点, 可以实现<strong>自定义属性屏蔽原型上属性</strong></li>
<li><strong>优化建议</strong>: 如果访问的属性在深层原型链上, 可以考虑局部缓存</li>
</ul>
<h3 id="9-如何检测一个属性是在实例对象中还是在原型对象中" style="position:relative;"><a href="#9-%E5%A6%82%E4%BD%95%E6%A3%80%E6%B5%8B%E4%B8%80%E4%B8%AA%E5%B1%9E%E6%80%A7%E6%98%AF%E5%9C%A8%E5%AE%9E%E4%BE%8B%E5%AF%B9%E8%B1%A1%E4%B8%AD%E8%BF%98%E6%98%AF%E5%9C%A8%E5%8E%9F%E5%9E%8B%E5%AF%B9%E8%B1%A1%E4%B8%AD" aria-label="9 如何检测一个属性是在实例对象中还是在原型对象中 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>9. 如何检测一个属性是在实例对象中还是在原型对象中?</h3>
<ul>
<li><code class="language-text">obj.hasOwnProperty(name)</code>: <strong>只有当给定属性存在实例对象中时才返回 true</strong>, 这里不考虑原型对象</li>
<li><code class="language-text">in</code>操作符: 在对象上能访问到给定属性时返回<code class="language-text">true</code>, <strong>包括实例对象和原型对象</strong></li>
</ul>
<p>示例:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">Base</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"Name"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token class-name">Base</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">sayName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Base</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true, 脑补new的过程</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span><span class="token string">"sayName"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false, sayName在原型上</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"name"</span> <span class="token keyword">in</span> obj<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"sayName"</span> <span class="token keyword">in</span> obj<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span></code></pre></div>
<p>总结:</p>
<ul>
<li>给定属性名<strong>只在实例对象</strong>中时</li>
</ul>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">obj<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<ul>
<li>给定属性名<strong>只在原型对象</strong>中时</li>
</ul>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">hasPrototypeProperty</span><span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span> name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token operator">!</span>obj<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> name <span class="token keyword">in</span> obj<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<h3 id="10-如何获取对象的上的所有可枚举的属性名" style="position:relative;"><a href="#10-%E5%A6%82%E4%BD%95%E8%8E%B7%E5%8F%96%E5%AF%B9%E8%B1%A1%E7%9A%84%E4%B8%8A%E7%9A%84%E6%89%80%E6%9C%89%E5%8F%AF%E6%9E%9A%E4%B8%BE%E7%9A%84%E5%B1%9E%E6%80%A7%E5%90%8D" aria-label="10 如何获取对象的上的所有可枚举的属性名 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>10. 如何获取对象的上的所有可枚举的属性名?</h3>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">Base</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"Name"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token class-name">Base</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">sayName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Base</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
obj<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ["name", "age"]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">getOwnPropertyNames</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ["name", "age"]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">getPrototypeOf</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ["sayName"]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token class-name">Base</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ["sayName"]</span></code></pre></div>
<p>注意, 这里在 chrome 实测是不返回 constructor 属性的.</p>
<h3 id="11-code-classlanguage-textpersonprototype--code方式设置原型对象有什么问题-如何修复" style="position:relative;"><a href="#11-code-classlanguage-textpersonprototype--code%E6%96%B9%E5%BC%8F%E8%AE%BE%E7%BD%AE%E5%8E%9F%E5%9E%8B%E5%AF%B9%E8%B1%A1%E6%9C%89%E4%BB%80%E4%B9%88%E9%97%AE%E9%A2%98-%E5%A6%82%E4%BD%95%E4%BF%AE%E5%A4%8D" aria-label="11 code classlanguage textpersonprototype  code方式设置原型对象有什么问题 如何修复 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>11. <code class="language-text">Person.prototype = {}</code>方式设置原型对象有什么问题? 如何修复?</h3>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token class-name">Person</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">"Nicholas"</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span> <span class="token number">29</span><span class="token punctuation">,</span>
  job<span class="token operator">:</span> <span class="token string">"Software Engineer"</span><span class="token punctuation">,</span>
  <span class="token function-variable function">sayName</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> friend <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>friend <span class="token keyword">instanceof</span> <span class="token class-name">Person</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>friend <span class="token keyword">instanceof</span> <span class="token class-name">Object</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>friend<span class="token punctuation">.</span>constructor <span class="token operator">===</span> Person<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false, 问题点</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>friend<span class="token punctuation">.</span>constructor <span class="token operator">===</span> Object<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span></code></pre></div>
<p>补充:</p>
<p><strong><code class="language-text">object instanceof constructor</code></strong></p>
<p><code class="language-text">instanceof</code> 运算符用来检测 <code class="language-text">constructor.prototype</code> 是否存在于参数 <code class="language-text">object</code> 的<strong>原型链</strong>(不是原型)上, 只要存在就返回 true, 不管是在哪个原型上.</p>
<p>问题:</p>
<ul>
<li>constructor 属性不再指向 <code class="language-text">Person</code> 了, 而是 <code class="language-text">Object</code> 对象</li>
</ul>
<p>解决方案:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token class-name">Person</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">"Nicholas"</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span> <span class="token number">29</span><span class="token punctuation">,</span>
  job<span class="token operator">:</span> <span class="token string">"Software Engineer"</span><span class="token punctuation">,</span>
  <span class="token function-variable function">sayName</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// constructor是不可枚举属性</span>
Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span><span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">,</span> <span class="token string">"constructor"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  enumerable<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  value<span class="token operator">:</span> Person
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> friend <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<h3 id="12-原型实例化后再修改原型-实例是否能正常调用修改的属性" style="position:relative;"><a href="#12-%E5%8E%9F%E5%9E%8B%E5%AE%9E%E4%BE%8B%E5%8C%96%E5%90%8E%E5%86%8D%E4%BF%AE%E6%94%B9%E5%8E%9F%E5%9E%8B-%E5%AE%9E%E4%BE%8B%E6%98%AF%E5%90%A6%E8%83%BD%E6%AD%A3%E5%B8%B8%E8%B0%83%E7%94%A8%E4%BF%AE%E6%94%B9%E7%9A%84%E5%B1%9E%E6%80%A7" aria-label="12 原型实例化后再修改原型 实例是否能正常调用修改的属性 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>12. 原型实例化后再修改原型, 实例是否能正常调用修改的属性?</h3>
<p>可以也不可以, 需要区分: 如何修改原型; 何时初始化的实例.</p>
<ul>
<li><strong>原型对象上添加</strong>: 实例调用时可以查找到添加的原型属性</li>
</ul>
<p><em>可以</em>, 实例与原型之间的松散连接关系. 因为实例与原型之间的连接只不过是一个指针, 而非一个副本.</p>
<ul>
<li><strong>覆盖原型对象</strong>: 实例中的原型<code class="language-text">[[prototype]]</code>还是指向原来的原型对象</li>
</ul>
<p><em>不可以</em>. 重写原型对象切断了现有原型与任何之前已经存在的对象实例之间的联系；它们引用的仍然是最初的原型。</p>
<p>或者说, <strong>原来的实例不受影响, 新创造的实例会获得最新原型对象</strong>.</p>
<blockquote>
<p>引用是按值传递, <strong>保存的是堆内存地址!!!</strong></p>
</blockquote>
<h3 id="13-写一个支持code-classlanguage-text39hello39includes39h39code的-polyfill-方法" style="position:relative;"><a href="#13-%E5%86%99%E4%B8%80%E4%B8%AA%E6%94%AF%E6%8C%81code-classlanguage-text39hello39includes39h39code%E7%9A%84-polyfill-%E6%96%B9%E6%B3%95" aria-label="13 写一个支持code classlanguage text39hello39includes39h39code的 polyfill 方法 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>13. 写一个支持<code class="language-text">&#39;Hello&#39;.includes(&#39;H&#39;)</code>的 polyfill 方法.</h3>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 可替代写法: String.prototype.hasOwnProperty('includes')</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token string">"includes"</span> <span class="token keyword">in</span> <span class="token class-name">String</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">includes</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">str</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<h3 id="14-组合使用构造函数模式和原型模式的好处" style="position:relative;"><a href="#14-%E7%BB%84%E5%90%88%E4%BD%BF%E7%94%A8%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E6%A8%A1%E5%BC%8F%E5%92%8C%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F%E7%9A%84%E5%A5%BD%E5%A4%84" aria-label="14 组合使用构造函数模式和原型模式的好处 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>14. 组合使用构造函数模式和原型模式的好处?</h3>
<ul>
<li>构造函数模式: 用于定义实例属性</li>
<li>原型模式: 用于定义方法和共享属性</li>
</ul>
<p>比如:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// 构造函数模式</span>
<span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> job</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>job <span class="token operator">=</span> job<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>friends <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"Shelby"</span><span class="token punctuation">,</span> <span class="token string">"Court"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 原型模式, 引用共享部分在这里定义</span>
<span class="token class-name">Person</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token punctuation">{</span>
  constructor<span class="token operator">:</span> Person<span class="token punctuation">,</span>
  <span class="token function-variable function">sayName</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> person1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Nicholas"</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token string">"Software Engineer"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> person2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">"Greg"</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token string">"Doctor"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<h3 id="15-如何构造一个安全的对象-让外部无法访问内部定义的属性" style="position:relative;"><a href="#15-%E5%A6%82%E4%BD%95%E6%9E%84%E9%80%A0%E4%B8%80%E4%B8%AA%E5%AE%89%E5%85%A8%E7%9A%84%E5%AF%B9%E8%B1%A1-%E8%AE%A9%E5%A4%96%E9%83%A8%E6%97%A0%E6%B3%95%E8%AE%BF%E9%97%AE%E5%86%85%E9%83%A8%E5%AE%9A%E4%B9%89%E7%9A%84%E5%B1%9E%E6%80%A7" aria-label="15 如何构造一个安全的对象 让外部无法访问内部定义的属性 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>15. 如何构造一个安全的对象, 让外部无法访问内部定义的属性?</h3>
<p><strong>闭包</strong>, 即, 在函数内部 return 一个对象, 对象的初始化过程对外封闭.</p>
<blockquote>
<p>这里脑补 new 执行的过程, 特别是 return 的判断.</p>
</blockquote>
<h3 id="16-如何确定原型和实例的关系" style="position:relative;"><a href="#16-%E5%A6%82%E4%BD%95%E7%A1%AE%E5%AE%9A%E5%8E%9F%E5%9E%8B%E5%92%8C%E5%AE%9E%E4%BE%8B%E7%9A%84%E5%85%B3%E7%B3%BB" aria-label="16 如何确定原型和实例的关系 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>16. 如何确定原型和实例的关系?</h3>
<ul>
<li><code class="language-text">object instanceof constructor</code></li>
</ul>
<p>只要构造函数<code class="language-text">constructor</code>在实例<code class="language-text">object</code>的原型链上出现过, 则返回 true</p>
<ul>
<li><code class="language-text">constructor.prototype.isPrototypeOf(object)</code></li>
</ul>
<p>同上!</p>
<h3 id="16-简单实现一个最理想的继承范式" style="position:relative;"><a href="#16-%E7%AE%80%E5%8D%95%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E6%9C%80%E7%90%86%E6%83%B3%E7%9A%84%E7%BB%A7%E6%89%BF%E8%8C%83%E5%BC%8F" aria-label="16 简单实现一个最理想的继承范式 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>16. 简单实现一个最理想的继承范式?</h3>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// 1. 父类定义</span>
<span class="token keyword">function</span> <span class="token function">SuperType</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"red"</span><span class="token punctuation">,</span> <span class="token string">"blue"</span><span class="token punctuation">,</span> <span class="token string">"green"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token class-name">SuperType</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">sayName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 2. 子类定义</span>
<span class="token keyword">function</span> <span class="token function">SubType</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 2.1 继承了 SuperType 构造函数中定义的属性</span>
  <span class="token function">SuperType</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 2.2 子类自己的属性</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 父类原型链复制</span>
<span class="token class-name">SubType</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">SuperType</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 因为使用“.prototype =...”后,constructor会改变为“=...”的那个</span>
<span class="token comment">// constructor，所以要重新指定.constructor 为自身。</span>
<span class="token class-name">SubType</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> SubType<span class="token punctuation">;</span>
<span class="token class-name">SubType</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">sayAge</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 3. 实例化</span>
<span class="token keyword">var</span> instance1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubType</span><span class="token punctuation">(</span><span class="token string">"name1"</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
instance1<span class="token punctuation">.</span>colors<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">"black"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
instance1<span class="token punctuation">.</span><span class="token function">sayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// name1</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>instance1<span class="token punctuation">.</span>colors<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//"red,blue,green,black"</span>

<span class="token keyword">var</span> instance2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubType</span><span class="token punctuation">(</span><span class="token string">"name2"</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
instance2<span class="token punctuation">.</span><span class="token function">sayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// name2</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>instance2<span class="token punctuation">.</span>colors<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//"red,blue,green"</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>
  Object<span class="token punctuation">.</span><span class="token function">getPrototypeOf</span><span class="token punctuation">(</span>instance1<span class="token punctuation">)</span><span class="token punctuation">.</span>sayName <span class="token operator">===</span>
    Object<span class="token punctuation">.</span><span class="token function">getPrototypeOf</span><span class="token punctuation">(</span>instance2<span class="token punctuation">)</span><span class="token punctuation">.</span>sayName
<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>

<span class="token comment">// 注意:</span>
<span class="token comment">// 1. for-in能遍历出constructor属性, 如何规避?</span>
<span class="token comment">// 2. Object.create的polyfill?</span></code></pre></div>
<h3 id="17-es6-中是-super-的意义" style="position:relative;"><a href="#17-es6-%E4%B8%AD%E6%98%AF-super-%E7%9A%84%E6%84%8F%E4%B9%89" aria-label="17 es6 中是 super 的意义 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>17. ES6 中是 super 的意义?</h3>
<p>执行父类构造函数, 获取父类的属性和原型方法, 获取 this.</p>
<h3 id="18-使用code-classlanguage-textobjectdefinepropertycode实现-vue" style="position:relative;"><a href="#18-%E4%BD%BF%E7%94%A8code-classlanguage-textobjectdefinepropertycode%E5%AE%9E%E7%8E%B0-vue" aria-label="18 使用code classlanguage textobjectdefinepropertycode实现 vue permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>18. 使用<code class="language-text">Object.defineProperty</code>实现 vue?</h3>
<p>vue 使用上述方法实现数据双向绑定.</p>]]></description><link>https://xiangst0816.github.io/blog/di-liu-lu-zhang-mian-xiang-dui-xiang/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/di-liu-lu-zhang-mian-xiang-dui-xiang/</guid><category><![CDATA[JS高程]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Fri, 26 Jan 2018 13:04:25 GMT</pubDate></item><item><title><![CDATA[第五章 引用类型]]></title><description><![CDATA[<h3 id="1-下面代码返回什么-位置-398-返回什么" style="position:relative;"><a href="#1-%E4%B8%8B%E9%9D%A2%E4%BB%A3%E7%A0%81%E8%BF%94%E5%9B%9E%E4%BB%80%E4%B9%88-%E4%BD%8D%E7%BD%AE-398-%E8%BF%94%E5%9B%9E%E4%BB%80%E4%B9%88" aria-label="1 下面代码返回什么 位置 398 返回什么 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 下面代码返回什么, 位置 3~98 返回什么?</h3>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"red"</span><span class="token punctuation">,</span> <span class="token string">"green"</span><span class="token punctuation">,</span> <span class="token string">"blue"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
colors<span class="token punctuation">[</span><span class="token number">99</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"black"</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>colors<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 100 3~98返回undefined</span></code></pre></div>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> colors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"red"</span><span class="token punctuation">,</span> <span class="token string">"green"</span><span class="token punctuation">,</span> <span class="token string">"blue"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
colors<span class="token punctuation">.</span>length <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>colors<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ["red", "green"]</span>
colors<span class="token punctuation">.</span>length <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>colors<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ["red", "green", undefined]</span>
colors<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"hello"</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>colors<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ["red", "green", undefined, undefined, 'hello']</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>colors<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 5</span></code></pre></div>
<p><strong>说明:</strong></p>
<ul>
<li>array 类型的 length 属性不是只读的, 设置 length 可以对数组<strong>动态</strong>缩减及扩容.</li>
<li>可根据需要动态添加数据, <strong>length 自动叠加</strong>, 中间未定义的数据为 undefined</li>
</ul>
<h3 id="2-数组复制的方法有哪些" style="position:relative;"><a href="#2-%E6%95%B0%E7%BB%84%E5%A4%8D%E5%88%B6%E7%9A%84%E6%96%B9%E6%B3%95%E6%9C%89%E5%93%AA%E4%BA%9B" aria-label="2 数组复制的方法有哪些 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 数组复制的方法有哪些?</h3>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> arrs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>arrs<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arrs<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arrs<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=></span> item<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>arrs<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

arrs<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">"test"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arrs<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<h3 id="3-不影响原值的情况下-获取数组最后一个元素的方法有哪些" style="position:relative;"><a href="#3-%E4%B8%8D%E5%BD%B1%E5%93%8D%E5%8E%9F%E5%80%BC%E7%9A%84%E6%83%85%E5%86%B5%E4%B8%8B-%E8%8E%B7%E5%8F%96%E6%95%B0%E7%BB%84%E6%9C%80%E5%90%8E%E4%B8%80%E4%B8%AA%E5%85%83%E7%B4%A0%E7%9A%84%E6%96%B9%E6%B3%95%E6%9C%89%E5%93%AA%E4%BA%9B" aria-label="3 不影响原值的情况下 获取数组最后一个元素的方法有哪些 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. 不影响原值的情况下, 获取数组最后一个元素的方法有哪些?</h3>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> arrs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arrs<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 6</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arrs<span class="token punctuation">[</span>arrs<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 6</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>arrs<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 6</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arrs<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>arrs<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 6</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arrs<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [1, 2, 3, 4, 5, 6]</span></code></pre></div>
<h3 id="4-理解-function-实现code-classlanguage-textobjectcreatecode方法的-polyfill" style="position:relative;"><a href="#4-%E7%90%86%E8%A7%A3-function-%E5%AE%9E%E7%8E%B0code-classlanguage-textobjectcreatecode%E6%96%B9%E6%B3%95%E7%9A%84-polyfill" aria-label="4 理解 function 实现code classlanguage textobjectcreatecode方法的 polyfill permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. 理解 Function, 实现<code class="language-text">Object.create()</code>方法的 polyfill?</h3>
<p><strong>函数名仅仅是指向函数的指针, 或者说, 是一个包含指针的变量而已!!!!</strong>.</p>
<p>这里, <code class="language-text">Object.create(proto[, propertiesObject])</code>表示使用指定的原型对象和属性去创建一个新的对象, 返回在原型对象上添加了指定属性的新对象(是在返回的对象的原型上加属性)</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> Object<span class="token punctuation">.</span>create <span class="token operator">!==</span> <span class="token string">"function"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  Object<span class="token punctuation">.</span><span class="token function-variable function">create</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">proto<span class="token punctuation">,</span> properitiesObject</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> proto <span class="token operator">!==</span> <span class="token string">"object"</span> <span class="token operator">||</span> <span class="token keyword">typeof</span> proto <span class="token operator">!==</span> <span class="token string">"function"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">TypeError</span><span class="token punctuation">(</span><span class="token string">'Object.create 方法的第一参数必须是对象或者函数!'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>proto <span class="token operator">===</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'浏览器未实现Object.create方法, 当前polyfill不支持第一个参数传null!'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> properitiesObject <span class="token operator">!==</span> <span class="token string">'undefined'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'浏览器未实现Object.create方法, 当前polyfill不支持第二个参数!'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">function</span> <span class="token constant">F</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token class-name">F</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> proto<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<h3 id="5-下面语句返回什么" style="position:relative;"><a href="#5-%E4%B8%8B%E9%9D%A2%E8%AF%AD%E5%8F%A5%E8%BF%94%E5%9B%9E%E4%BB%80%E4%B9%88" aria-label="5 下面语句返回什么 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>5. 下面语句返回什么</h3>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">num</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> num <span class="token operator">+</span> <span class="token number">100</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> storeAdd <span class="token operator">=</span> add<span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">num</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> num <span class="token operator">+</span> <span class="token number">200</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">add</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 300</span>
<span class="token function">storeAdd</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 400 第一个add函数被覆盖, 参考: 作用域链/函数内参数优先级/变量提升等</span></code></pre></div>
<h3 id="6-如何理解函数传参是按值传递的" style="position:relative;"><a href="#6-%E5%A6%82%E4%BD%95%E7%90%86%E8%A7%A3%E5%87%BD%E6%95%B0%E4%BC%A0%E5%8F%82%E6%98%AF%E6%8C%89%E5%80%BC%E4%BC%A0%E9%80%92%E7%9A%84" aria-label="6 如何理解函数传参是按值传递的 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>6. 如何理解函数传参是按值传递的?</h3>
<p><strong>答</strong>: 引用类型传递的是<strong>堆内存地址</strong>, 因此改变地址变更不会影响原来堆内存状态. 但是通过地址修改堆内存中的数据是会生效的.</p>
<h3 id="7-举例函数的内部属性属性方法有哪些及定义和作用" style="position:relative;"><a href="#7-%E4%B8%BE%E4%BE%8B%E5%87%BD%E6%95%B0%E7%9A%84%E5%86%85%E9%83%A8%E5%B1%9E%E6%80%A7%E5%B1%9E%E6%80%A7%E6%96%B9%E6%B3%95%E6%9C%89%E5%93%AA%E4%BA%9B%E5%8F%8A%E5%AE%9A%E4%B9%89%E5%92%8C%E4%BD%9C%E7%94%A8" aria-label="7 举例函数的内部属性属性方法有哪些及定义和作用 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>7. 举例函数的内部属性/属性/方法有哪些及定义和作用?</h3>
<p><strong>函数内部属性:</strong></p>
<ul>
<li><code class="language-text">arguments</code>: 是一个类数组对象, 包含着传入函数中的所有参数(<strong>实际传参</strong>), 可通过<code class="language-text">[].slice.call(arguments, 0)</code>转化为数组.</li>
<li><code class="language-text">arguments.callee</code>: 指向拥有这个 arguments 对象的函数</li>
<li><code class="language-text">arguments.callee.caller</code>: 这个属性保存着调用当前函数的函数引用, <strong>如果是全局调用则为 null</strong></li>
<li><code class="language-text">this</code>: 引用的是函数执行期间的<strong>环境对象</strong>, 全局环境则为 window, 或者说, this 值的指向<strong>取决于方法在那个对象上执行</strong>.</li>
</ul>
<p><strong>函数属性</strong>:</p>
<ul>
<li><code class="language-text">length</code>: 表示函数<strong>希望接收到</strong>的函数参数的个数, 形参个数</li>
<li><code class="language-text">prototype</code>: 保存所有<strong>实例方法</strong>的位置. 创建自定义引用类型和继承, 不可枚举</li>
</ul>
<p><strong>函数方法</strong>:</p>
<ul>
<li>
<p><code class="language-text">apply()和call()</code>: 设置函数内部的 this 对象的值. 用于在<strong>特定环境对象</strong>中调用函数, 扩充作用域, 解耦. 传参说明:</p>
<ul>
<li><code class="language-text">apply([thisObj [,argArray] ]);</code></li>
<li><code class="language-text">call([thisObject[,arg1 [,arg2 [,...,argn]]]]);</code></li>
</ul>
</li>
<li><code class="language-text">bing()</code>: IE9+, 创建一个<strong>指定环境对象</strong>的函数实例.</li>
<li><code class="language-text">toLocalString():</code> 返回函数代码(str)</li>
<li><code class="language-text">toString()</code>: 返回函数代码(str)</li>
<li><code class="language-text">valueOf()</code>: 返回函数引用</li>
</ul>
<h3 id="8-ie678-没有code-classlanguage-textbindcode实现方法-你做一个-polyfill-吧" style="position:relative;"><a href="#8-ie678-%E6%B2%A1%E6%9C%89code-classlanguage-textbindcode%E5%AE%9E%E7%8E%B0%E6%96%B9%E6%B3%95-%E4%BD%A0%E5%81%9A%E4%B8%80%E4%B8%AA-polyfill-%E5%90%A7" aria-label="8 ie678 没有code classlanguage textbindcode实现方法 你做一个 polyfill 吧 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>8. IE6/7/8 没有<code class="language-text">bind()</code>实现方法, 你做一个 polyfill 吧?</h3>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">bind</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>fn<span class="token punctuation">.</span>bind<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<h3 id="8-如何理解基础类型-例如-numberbooleanstring-会有类似对象的code-classlanguage-textcode操作方式" style="position:relative;"><a href="#8-%E5%A6%82%E4%BD%95%E7%90%86%E8%A7%A3%E5%9F%BA%E7%A1%80%E7%B1%BB%E5%9E%8B-%E4%BE%8B%E5%A6%82-numberbooleanstring-%E4%BC%9A%E6%9C%89%E7%B1%BB%E4%BC%BC%E5%AF%B9%E8%B1%A1%E7%9A%84code-classlanguage-textcode%E6%93%8D%E4%BD%9C%E6%96%B9%E5%BC%8F" aria-label="8 如何理解基础类型 例如 numberbooleanstring 会有类似对象的code classlanguage textcode操作方式 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>8. 如何理解基础类型, 例如: Number/Boolean/String 会有类似对象的<code class="language-text">.</code>操作方式?</h3>
<p>例如:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> s1 <span class="token operator">=</span> <span class="token string">"some string"</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> s2 <span class="token operator">=</span> s1<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p><strong>说明</strong>:</p>
<p>基础类型在<strong>读取</strong>时都会在后台有特殊处理而转化为对象, 例如:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> s1 <span class="token operator">=</span> <span class="token string">"some string"</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> _s1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">"some string"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 后台转化</span>
<span class="token keyword">var</span> s2 <span class="token operator">=</span> _s1<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
_s1 <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span> <span class="token comment">// 清理</span></code></pre></div>
<p><strong>包装类型</strong>, Number/Boolean/String, 只会存在于一行代码执行的瞬间, 然后立即被销毁. 以上, <strong>使得基本类型值可以当做对象访问</strong>.</p>
<h3 id="9-写书下面代码的输出值" style="position:relative;"><a href="#9-%E5%86%99%E4%B9%A6%E4%B8%8B%E9%9D%A2%E4%BB%A3%E7%A0%81%E7%9A%84%E8%BE%93%E5%87%BA%E5%80%BC" aria-label="9 写书下面代码的输出值 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>9. 写书下面代码的输出值?</h3>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> string <span class="token operator">=</span> <span class="token string">"hello world"</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>string<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 结果: 'lo world'</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>string<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 结果: 'lo world'</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>string<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 结果: 'lo world'</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>string<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 结果: 'lo w'</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>string<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 结果: 'lo w'</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>string<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 结果: 'lo worl'</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>string<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 结果: 'rld' 解释: string.slice(8)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>string<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 结果: 'hello world' 解释: string.substring(0)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>string<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 结果: 'rld' 解释: string.substr(8)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>string<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 结果: '' 解释: 不存在自动转化 string.slice(8, 4)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>string<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// '' 解释: 负数全部转为0 string.substring(0, 0)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>string<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// '' 解释: string.substring(8, 0)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>string<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 结果: 'l' 解释: string.slice(3, 4)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>string<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 'hel' 解释: 存在大小数自动转化 string.substring(3, 0) -> string.substring(0, 3)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>string<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// '' 解释: string.substring(3, 0)</span></code></pre></div>
<h3 id="10-函数的类型是对象" style="position:relative;"><a href="#10-%E5%87%BD%E6%95%B0%E7%9A%84%E7%B1%BB%E5%9E%8B%E6%98%AF%E5%AF%B9%E8%B1%A1" aria-label="10 函数的类型是对象 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>10. 函数的类型是对象?</h3>
<p>YES. 函数实际上是<code class="language-text">Function</code>的实例, 因此也是对象.</p>
<h3 id="11-下面类型检查返回什么" style="position:relative;"><a href="#11-%E4%B8%8B%E9%9D%A2%E7%B1%BB%E5%9E%8B%E6%A3%80%E6%9F%A5%E8%BF%94%E5%9B%9E%E4%BB%80%E4%B9%88" aria-label="11 下面类型检查返回什么 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>11. 下面类型检查返回什么?</h3>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// undefined</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// object</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// object</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// function</span>

<span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> arguments<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// object</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> <span class="token function-variable function">a</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// undefined 函数名b不能再外部引用,</span></code></pre></div>
<p>说明:</p>
<ul>
<li><code class="language-text">arguments</code>是类数组<strong>对象</strong></li>
<li>函数表达式不存在变量提升的情况, 因此<code class="language-text">b</code>不会再外部成为能访问的变量</li>
<li>但是<code class="language-text">b</code>能在<code class="language-text">b</code>函数内访问是因为函数内是能访问<strong>函数名</strong>的, 这里函数名就是<code class="language-text">b</code></li>
</ul>
<h3 id="12-对象的-delete-操作符的使用" style="position:relative;"><a href="#12-%E5%AF%B9%E8%B1%A1%E7%9A%84-delete-%E6%93%8D%E4%BD%9C%E7%AC%A6%E7%9A%84%E4%BD%BF%E7%94%A8" aria-label="12 对象的 delete 操作符的使用 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>12. 对象的 delete 操作符的使用?</h3>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">delete</span> x<span class="token punctuation">;</span>
  <span class="token keyword">return</span> x<span class="token punctuation">;</span> <span class="token comment">//1</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p><strong>说明</strong></p>
<ul>
<li>delete<strong>只能删除对象上的属性</strong>, 对其他变量或者函数名无效</li>
<li>delete 是不会直接释放内存, 而是<strong>中断对象引用</strong>(?)</li>
</ul>
<h3 id="13-下列code-classlanguage-texttypeofcode的使用的返回值" style="position:relative;"><a href="#13-%E4%B8%8B%E5%88%97code-classlanguage-texttypeofcode%E7%9A%84%E4%BD%BF%E7%94%A8%E7%9A%84%E8%BF%94%E5%9B%9E%E5%80%BC" aria-label="13 下列code classlanguage texttypeofcode的使用的返回值 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>13. 下列<code class="language-text">typeof</code>的使用的返回值?</h3>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// 逗号操作符的求值顺序, 返回最后一个操作对象的值</span>
<span class="token keyword">var</span> f <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token string">"1"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token keyword">function</span> <span class="token function">g</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 2</span>
<span class="token keyword">typeof</span> f<span class="token punctuation">;</span> <span class="token comment">//"number"</span></code></pre></div>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// typeof 返回的是string类型</span>
<span class="token keyword">typeof</span> <span class="token keyword">typeof</span> x<span class="token punctuation">;</span> <span class="token comment">// string</span></code></pre></div>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// 表达式的执行顺序考察, 变量提升(脑海中要有这个过程)</span>
<span class="token keyword">var</span> y <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>
  x <span class="token operator">=</span> <span class="token punctuation">(</span>y <span class="token operator">=</span> <span class="token keyword">typeof</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
x<span class="token punctuation">;</span> <span class="token comment">//"undefined"</span>

<span class="token comment">// 转化为</span>
<span class="token keyword">var</span> y <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> x <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
y <span class="token operator">=</span> <span class="token keyword">typeof</span> x<span class="token punctuation">;</span> <span class="token comment">// undefined</span>
x <span class="token operator">=</span> y<span class="token punctuation">;</span> <span class="token comment">// undefined</span>
x<span class="token punctuation">;</span> <span class="token comment">// undefined</span></code></pre></div>
<h3 id="14-下列code-classlanguage-textinstanceofcode的使用的返回值" style="position:relative;"><a href="#14-%E4%B8%8B%E5%88%97code-classlanguage-textinstanceofcode%E7%9A%84%E4%BD%BF%E7%94%A8%E7%9A%84%E8%BF%94%E5%9B%9E%E5%80%BC" aria-label="14 下列code classlanguage textinstanceofcode的使用的返回值 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>14. 下列<code class="language-text">instanceof</code>的使用的返回值?</h3>
<p>只要测试的构造函数在实例的原型链中出现过, 结果就会返回 true.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">SuperType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>property <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token class-name">SuperType</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getSuperValue</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>property<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">SubType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>subproperty <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//继承了 SuperType</span>
<span class="token class-name">SubType</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SuperType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">SubType</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getSubValue</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>subproperty<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SubType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>instance <span class="token keyword">instanceof</span> <span class="token class-name">Object</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>instance <span class="token keyword">instanceof</span> <span class="token class-name">SubType</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>instance <span class="token keyword">instanceof</span> <span class="token class-name">SuperType</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//true</span></code></pre></div>]]></description><link>https://xiangst0816.github.io/blog/di-wu-zhang-yin-yong-lei-xing/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/di-wu-zhang-yin-yong-lei-xing/</guid><category><![CDATA[JS高程]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Sun, 21 Jan 2018 02:13:24 GMT</pubDate></item><item><title><![CDATA[第四章 变量-作用域和内存问题]]></title><description><![CDATA[<h2 id="问答" style="position:relative;"><a href="#%E9%97%AE%E7%AD%94" aria-label="问答 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问答</h2>
<h3 id="1-何为基本类型和引用类型" style="position:relative;"><a href="#1-%E4%BD%95%E4%B8%BA%E5%9F%BA%E6%9C%AC%E7%B1%BB%E5%9E%8B%E5%92%8C%E5%BC%95%E7%94%A8%E7%B1%BB%E5%9E%8B" aria-label="1 何为基本类型和引用类型 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 何为基本类型和引用类型?</h3>
<p>基本类型: 简单的数据段, 类型如, undefined, null, boolean, string, number;</p>
<p>引用类型: 值保存在<strong>堆内存</strong>中的对象, 通过地址访问.</p>
<h3 id="2-函数传递参数时-基础类型是按值传递引用类型是按引用传递" style="position:relative;"><a href="#2-%E5%87%BD%E6%95%B0%E4%BC%A0%E9%80%92%E5%8F%82%E6%95%B0%E6%97%B6-%E5%9F%BA%E7%A1%80%E7%B1%BB%E5%9E%8B%E6%98%AF%E6%8C%89%E5%80%BC%E4%BC%A0%E9%80%92%E5%BC%95%E7%94%A8%E7%B1%BB%E5%9E%8B%E6%98%AF%E6%8C%89%E5%BC%95%E7%94%A8%E4%BC%A0%E9%80%92" aria-label="2 函数传递参数时 基础类型是按值传递引用类型是按引用传递 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 函数传递参数时, 基础类型是按值传递/引用类型是按引用传递?</h3>
<p>回答: <strong>全部是按值传递!!</strong></p>
<p>当在向参数传递引用类型的值时, 会把这个值在堆内存中的地址复制给一个局部变量. <strong>可以把 ECMAScript 函数的参数想象成局部变量</strong>(这部分结合作用域链/函数执行过程理解)</p>
<p>这两个在函数调用时都是按值传递, 需要指出的是, <strong>引用类型的值是堆内存地址</strong>.</p>
<h3 id="3-作用域链的作用" style="position:relative;"><a href="#3-%E4%BD%9C%E7%94%A8%E5%9F%9F%E9%93%BE%E7%9A%84%E4%BD%9C%E7%94%A8" aria-label="3 作用域链的作用 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. 作用域链的作用?</h3>
<p>保证对执行环境有权访问的所有变量和函数有序访问.</p>
<h3 id="4-类型如何检测" style="position:relative;"><a href="#4-%E7%B1%BB%E5%9E%8B%E5%A6%82%E4%BD%95%E6%A3%80%E6%B5%8B" aria-label="4 类型如何检测 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. 类型如何检测?</h3>
<p>基本类型可以通过<code class="language-text">typeof</code>判断, 引用类型都会返回<code class="language-text">object</code>. 对于引用类型可以使用<code class="language-text">instanceof</code>来判断.</p>
<h3 id="5-js-的垃圾搜集使用什么策略" style="position:relative;"><a href="#5-js-%E7%9A%84%E5%9E%83%E5%9C%BE%E6%90%9C%E9%9B%86%E4%BD%BF%E7%94%A8%E4%BB%80%E4%B9%88%E7%AD%96%E7%95%A5" aria-label="5 js 的垃圾搜集使用什么策略 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>5. JS 的垃圾搜集使用什么策略?</h3>
<p><strong>标记清除</strong>策略, 主流的垃圾搜集算法.</p>
<p>当变量<strong>进入环境</strong>时(比如<strong>在环境中声明一个变量</strong>), 就将这个变量标记为”进入环境”. 当变量离开环境时, 将其标记为”离开环境”.</p>
<p>此外, 还有<strong>引用计数</strong>, 会引起<strong>循环引用</strong>的问题. 知道就好, 主流浏览器已放弃.</p>
<p>为确保有效的回收内存, 建议及时解除不再使用的全局对象/全局属性.</p>
<h3 id="6-关于函数执行期的-arguments-的问题" style="position:relative;"><a href="#6-%E5%85%B3%E4%BA%8E%E5%87%BD%E6%95%B0%E6%89%A7%E8%A1%8C%E6%9C%9F%E7%9A%84-arguments-%E7%9A%84%E9%97%AE%E9%A2%98" aria-label="6 关于函数执行期的 arguments 的问题 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>6. 关于函数执行期的 arguments 的问题</h3>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">num1<span class="token punctuation">,</span> num2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  arguments<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
  arguments<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> arr <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>add<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 2, 表示支持两个参数</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arguments<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [Object Arguments]</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arguments<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [3]</span>
  <span class="token keyword">return</span> num1 <span class="token operator">+</span> num2<span class="token punctuation">;</span> <span class="token comment">// 3 + undefined</span>
<span class="token punctuation">}</span>
<span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// NaN</span></code></pre></div>
<p><strong>说明:</strong></p>
<ul>
<li>ECMAScript 中的函数并不关心传递的是什么参数/几个参数</li>
<li>函数参数在内部使用一个 Arguments 对象表示(类似数组), 可通过下标访问各个成员</li>
<li>并且 arguments 中的值和对应的命名参数保持一致, 上面的例子中, num1 保持同步一致, num2 因为没在 arguments 中出现, 因此不会同步.</li>
<li><strong>arguments 和对应的命名参数在存储上是独立的</strong>, 这部分参考原型链/函数执行过程</li>
</ul>]]></description><link>https://xiangst0816.github.io/blog/di-si-zhang-bian-liang/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/di-si-zhang-bian-liang/</guid><category><![CDATA[JS高程]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Sat, 20 Jan 2018 07:48:24 GMT</pubDate></item><item><title><![CDATA[第七章 函数表达式]]></title><description><![CDATA[<h2 id="问答" style="position:relative;"><a href="#%E9%97%AE%E7%AD%94" aria-label="问答 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问答</h2>
<h3 id="1-函数声明的语法是" style="position:relative;"><a href="#1-%E5%87%BD%E6%95%B0%E5%A3%B0%E6%98%8E%E7%9A%84%E8%AF%AD%E6%B3%95%E6%98%AF" aria-label="1 函数声明的语法是 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 函数声明的语法是?</h3>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span></code></pre></div>
<h3 id="2-函数表达式匿名函数的语法是" style="position:relative;"><a href="#2-%E5%87%BD%E6%95%B0%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%8C%BF%E5%90%8D%E5%87%BD%E6%95%B0%E7%9A%84%E8%AF%AD%E6%B3%95%E6%98%AF" aria-label="2 函数表达式匿名函数的语法是 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 函数表达式(匿名函数)的语法是?</h3>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> <span class="token function-variable function">test</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<h3 id="3-以下递归语句是否报错-报错原因是-如何改进" style="position:relative;"><a href="#3-%E4%BB%A5%E4%B8%8B%E9%80%92%E5%BD%92%E8%AF%AD%E5%8F%A5%E6%98%AF%E5%90%A6%E6%8A%A5%E9%94%99-%E6%8A%A5%E9%94%99%E5%8E%9F%E5%9B%A0%E6%98%AF-%E5%A6%82%E4%BD%95%E6%94%B9%E8%BF%9B" aria-label="3 以下递归语句是否报错 报错原因是 如何改进 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. 以下递归语句是否报错, 报错原因是? 如何改进?</h3>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">factorial</span><span class="token punctuation">(</span><span class="token parameter">num</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>num <span class="token operator">&lt;=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> num <span class="token operator">*</span> <span class="token function">factorial</span><span class="token punctuation">(</span>num <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> anotherFactorial <span class="token operator">=</span> factorial<span class="token punctuation">;</span>
factorial <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token function">anotherFactorial</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>错误: Uncaught TypeError: factorial is not a function</p>
<p>原因: 函数 factorial 内部的 factorial 指向 null, 因此报错.</p>
<p>方法 1: arguments.callee, <strong>它指向当前正在执行的函数指针</strong>. 但是严格模式不允许使用.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">factorial</span> <span class="token punctuation">(</span><span class="token parameter">num</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>num <span class="token operator">&lt;=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token number">1</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> num <span class="token operator">*</span> arguments<span class="token punctuation">.</span><span class="token function">callee</span><span class="token punctuation">(</span>num <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span></code></pre></div>
<p>方法 2: 函数表达式</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> <span class="token function-variable function">factorial</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token parameter">num</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>num <span class="token operator">&lt;=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> num <span class="token operator">*</span> <span class="token function">f</span><span class="token punctuation">(</span>num <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<h3 id="4-闭包的概念" style="position:relative;"><a href="#4-%E9%97%AD%E5%8C%85%E7%9A%84%E6%A6%82%E5%BF%B5" aria-label="4 闭包的概念 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. 闭包的概念?</h3>
<p>有权访问另一个函数作用域中的变量的函数(或其他). 只要不被垃圾回收机制回收即可, 不一定需要返回函数, 方式有:</p>
<ul>
<li>在一个函数中返回另一个函数, 返回的函数中包含上层函数的活动对象和全局对象(层层向外, 不止两层)</li>
<li>在函数中将内部状态保存在外部变量中.</li>
</ul>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> test <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> test <span class="token operator">=</span> <span class="token number">123</span><span class="token punctuation">;</span>
  <span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> test<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token constant">TEST</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    test<span class="token operator">:</span> test<span class="token punctuation">,</span>
    fn<span class="token operator">:</span> fn
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">TEST</span><span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 123 , 注意: window.TEST === TEST</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">TEST</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// {test:123, fn:f}</span></code></pre></div>
<h3 id="5-在闭包中-函数被调用的时候都发生了什么" style="position:relative;"><a href="#5-%E5%9C%A8%E9%97%AD%E5%8C%85%E4%B8%AD-%E5%87%BD%E6%95%B0%E8%A2%AB%E8%B0%83%E7%94%A8%E7%9A%84%E6%97%B6%E5%80%99%E9%83%BD%E5%8F%91%E7%94%9F%E4%BA%86%E4%BB%80%E4%B9%88" aria-label="5 在闭包中 函数被调用的时候都发生了什么 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>5. 在闭包中, 函数被调用的时候都发生了什么?</h3>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">createComparisonFunction</span><span class="token punctuation">(</span><span class="token parameter">propertyName</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">object1<span class="token punctuation">,</span> object2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> value1 <span class="token operator">=</span> object1<span class="token punctuation">[</span>propertyName<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> value2 <span class="token operator">=</span> object2<span class="token punctuation">[</span>propertyName<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>value1 <span class="token operator">&lt;</span> value2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>value1 <span class="token operator">></span> value2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 创建函数</span>
<span class="token keyword">var</span> compareNames <span class="token operator">=</span> <span class="token function">createComparisonFunction</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 调用函数</span>
<span class="token keyword">var</span> result <span class="token operator">=</span> <span class="token function">compareNames</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">"Nicholas"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">"Greg"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 解除对匿名函数的引用,释放内存</span>
compareNames <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span></code></pre></div>
<p><img src="http://upload-images.jianshu.io/upload_images/2036128-301cd9d6e78ff86b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="创建createComparisonFunction函数"></p>
<ol>
<li>当<strong>创建<code class="language-text">createComparisonFunction</code>函数时</strong>, 会创建一个预先包含<strong>全局变量对象</strong>的作用域链, 这个作用域链被保存在当前函数内部的<code class="language-text">[[Scopes]]</code>属性中.</li>
</ol>
<p><img src="http://upload-images.jianshu.io/upload_images/2036128-6a26a491737f55a4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="执行createComparisonFunction函数"></p>
<ol start="2">
<li>当<strong>执行<code class="language-text">createComparisonFunction</code>函数时</strong>, 会创建一个<strong>执行环境(execution context)</strong>, 通过复制函数的<code class="language-text">[[Scopes]]</code>属性中的对象构建起执行环境的<strong>作用域链</strong>.</li>
<li>使用<code class="language-text">arguments</code>和其他 <em>形参/变量/函数声明</em> 初始化函数的 <strong>活动对象(activation object)</strong>, 即另一种局部变量对象, 并被推入执行环境作用域链的顶端. 这里需要补充<strong>变量提升及优先级</strong>的说明.</li>
<li>
<p>此时, <code class="language-text">createComparisonFunction</code>函数的执行环境中的作用域链包含多个变量对象:</p>
<ul>
<li>0: 本地活动对象</li>
<li>1: 引用的外层函数变量对象</li>
<li>n-1: …</li>
<li>n: 全局变量对象.</li>
</ul>
</li>
<li>显然, <strong>作用域链的本质是一个指向变量对象的指针列表</strong>, 它只包含引用但不实际包含变量对象.</li>
<li>当在函数中访问一个变量时, 就会从作用域链中搜索具有相应名字的变量(变量标识符匹配过程). 这里可以补充优化机制.</li>
<li>当<strong><code class="language-text">createComparisonFunction</code>函数执行完毕时</strong>, 其<strong>执行环境的作用域链</strong>会被销毁.</li>
</ol>
<p><img src="http://upload-images.jianshu.io/upload_images/2036128-c107954d8c374586.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="创建闭包"></p>
<ol start="8">
<li>当匿名函数从<code class="language-text">createComparisonFunction</code>函数中返回后, 它的作用域链被初始化为包含<code class="language-text">createComparisonFunction</code>函数的活动对象和全局变量对象.</li>
</ol>
<p><img src="http://upload-images.jianshu.io/upload_images/2036128-fdd6a7e0274f0778.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="执行闭包"></p>
<ol start="9">
<li>因此, 即使<code class="language-text">createComparisonFunction</code>函数执行完毕, 但是它的活动对象仍然会留在内存中, 直到匿名函数主动销毁, <code class="language-text">createComparisonFunction()</code>的活动对象才会被销毁. 这里需要补充<strong>JS 垃圾回收及标记清除机制</strong>.</li>
</ol>
<p>注意:</p>
<ol>
<li><strong>闭包保存的是整个变量对象, 而不是某个特殊的变量</strong>.</li>
<li>只要没有形成闭包, 当函数执行完毕, 就可以立即销毁其作用域链和活动对象(变量对象).</li>
<li>如果形成闭包, 作用域链也会被销毁, 但是<strong>活动对象及变量对象不会销毁</strong>.</li>
<li>作用域链决定哪些数据能被函数访问</li>
</ol>
<h3 id="6-下面函数返回的是什么-为什么" style="position:relative;"><a href="#6-%E4%B8%8B%E9%9D%A2%E5%87%BD%E6%95%B0%E8%BF%94%E5%9B%9E%E7%9A%84%E6%98%AF%E4%BB%80%E4%B9%88-%E4%B8%BA%E4%BB%80%E4%B9%88" aria-label="6 下面函数返回的是什么 为什么 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>6. 下面函数返回的是什么, 为什么?</h3>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">"The Window"</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">"My Object"</span><span class="token punctuation">,</span>
  <span class="token function-variable function">getNameFunc</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// this只有执行时在确定指向谁, 当前this指定window</span>
      <span class="token comment">// 活动对象中只有window</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>object<span class="token punctuation">.</span><span class="token function">getNameFunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// The Window</span></code></pre></div>
<p>匿名函数的执行环境具有全局性, 因此其<code class="language-text">this</code>对象通常指向<code class="language-text">window</code>(这里可以使用<code class="language-text">call/apply</code>主动改变 this).</p>
<blockquote>
<p>this 的概念: 在函数运行时，基于调用位置的条件自动生成的内部对象，可以理解为动态绑定对象到 this 上。</p>
</blockquote>
<p>每个函数在被调用时都会自动取得两个特殊的变量: <code class="language-text">this</code>和<code class="language-text">arguments</code>. 内部函数在搜索这两个变量时, 只会搜索到其活动变量为止, 因此最后一个函数执行时, 外层 function 的活动对象只有 window, this 为 window, 即, <code class="language-text">this === window</code>.</p>
<p>因此, <strong>函数执行时才能确定 this</strong>, 且<strong>this 指向调用函数最近的一个对象</strong>.</p>
<h3 id="7-iife-能模仿块级作用域的原因" style="position:relative;"><a href="#7-iife-%E8%83%BD%E6%A8%A1%E4%BB%BF%E5%9D%97%E7%BA%A7%E4%BD%9C%E7%94%A8%E5%9F%9F%E7%9A%84%E5%8E%9F%E5%9B%A0" aria-label="7 iife 能模仿块级作用域的原因 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>7. IIFE 能模仿块级作用域的原因?</h3>
<p>JavaScript 是函数级作用域, 在立即执行函数内定义的变量是局部变量, 一般情况下, 使用完毕后会自动销毁.</p>
<h3 id="8-关于作用域链优化部分的理解" style="position:relative;"><a href="#8-%E5%85%B3%E4%BA%8E%E4%BD%9C%E7%94%A8%E5%9F%9F%E9%93%BE%E4%BC%98%E5%8C%96%E9%83%A8%E5%88%86%E7%9A%84%E7%90%86%E8%A7%A3" aria-label="8 关于作用域链优化部分的理解 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>8. 关于作用域链优化部分的理解?</h3>
<ul>
<li>缓存深层作用域链上的变量</li>
</ul>
<p>变量使用前都会在作用域链中查找, 因此<strong>将常用的跨作用域变量缓存为局部变量能减少变量查找时间</strong></p>
<ul>
<li>避免使用 with</li>
</ul>
<p>with 能动态改变作用域链, <strong>将指定的对象压入作用域链顶端</strong>, 造成原来局部变量对象转为第二位, 影响查找效率.</p>
<ul>
<li>catch 内部使用简化代码</li>
</ul>
<p>当 try 代码中发生错误时, 执行过程会自动跳转到 catch 中, 然后<strong>把异常对象推入一个变量对象并置于作用域的首位</strong>, 建议 catch 中不要放复杂的语句</p>
<ul>
<li>
<p>尽量不使用 eval()</p>
<p>  	- 非严格模式下, eval中的语句只有在执行时才知道是否有内部变量<strong>污染外部环境</strong>;
- 严格模式为eval中的变量为局部作用域
- 此外, <strong>js引擎无法对动态作用域进行优化</strong>, 只能按照作用域链查找的传统模式进行执行.</p>
</li>
</ul>]]></description><link>https://xiangst0816.github.io/blog/di-qi-zhang-han-shu-shuo-biao-da-shi/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/di-qi-zhang-han-shu-shuo-biao-da-shi/</guid><category><![CDATA[JS高程]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Mon, 08 Jan 2018 14:11:04 GMT</pubDate></item><item><title><![CDATA[闭包]]></title><description><![CDATA[<p>写代码的时候经常用到，但是被问起却哑口无言，或者只能说到表面，这里再详细总结写，查漏补缺。</p>
<h2 id="介绍" style="position:relative;"><a href="#%E4%BB%8B%E7%BB%8D" aria-label="介绍 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>介绍</h2>
<p>JavaScript 变量定义的作用域范围是<strong>函数级作用域</strong>，函数内部定义的变量在外部是访问不到的，但是有些场景需要能访问函数内部的状态，或者函数记录自己内部状态，因此引入闭包的概念。</p>
<blockquote>
<p>闭包：能够读取其他函数内部变量的函数，或者是“定义在一个函数内部的函数”。</p>
</blockquote>
<p>返回出来的函数为了保证自身运行依旧保留自身的作用域链关系，因此函数内部状态得以保存，而未被销毁。</p>
<h2 id="用途" style="position:relative;"><a href="#%E7%94%A8%E9%80%94" aria-label="用途 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>用途</h2>
<p>闭包的用途有两个：</p>
<ul>
<li>可以读取函数内部的变量</li>
<li>让这些变量值始终保持在内存中（Node 中使用会存在内存泄露）</li>
</ul>
<h2 id="测试" style="position:relative;"><a href="#%E6%B5%8B%E8%AF%95" aria-label="测试 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试</h2>
<h4 id="1-测试一" style="position:relative;"><a href="#1-%E6%B5%8B%E8%AF%95%E4%B8%80" aria-label="1 测试一 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 测试一</h4>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">"The Window"</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">"My Object"</span><span class="token punctuation">,</span>
  <span class="token function-variable function">getNameFunc</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token function">alert</span><span class="token punctuation">(</span>object<span class="token punctuation">.</span><span class="token function">getNameFunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 'The Window'</span></code></pre></div>
<p>说明：</p>
<p><code class="language-text">object.getNameFunc()</code>执行后返回的函数已经和 object 无关系，只是单纯的函数，之后在执行相当于是在 window 上执行，因此结果是<code class="language-text">The Window</code></p>
<h4 id="2-测试二" style="position:relative;"><a href="#2-%E6%B5%8B%E8%AF%95%E4%BA%8C" aria-label="2 测试二 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 测试二</h4>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">"The Window"</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> object <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">"My Object"</span><span class="token punctuation">,</span>
  <span class="token function-variable function">getNameFunc</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> that <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> that<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token function">alert</span><span class="token punctuation">(</span>object<span class="token punctuation">.</span><span class="token function">getNameFunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 'My Object'</span></code></pre></div>
<p>说明：</p>
<p>缓存的<code class="language-text">that</code>变量指向 object，内部变量被保存，形成闭包。</p>]]></description><link>https://xiangst0816.github.io/blog/bi-bao/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/bi-bao/</guid><category><![CDATA[JavaScript]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Mon, 01 Jan 2018 11:11:23 GMT</pubDate></item><item><title><![CDATA[IIFE立即执行函数]]></title><description><![CDATA[<p>就是下面这样的的代码：</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Hello!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<h2 id="关于-iife-书写方式" style="position:relative;"><a href="#%E5%85%B3%E4%BA%8E-iife-%E4%B9%A6%E5%86%99%E6%96%B9%E5%BC%8F" aria-label="关于 iife 书写方式 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>关于 IIFE 书写方式</h2>
<h4 id="第一种情况：" style="position:relative;"><a href="#%E7%AC%AC%E4%B8%80%E7%A7%8D%E6%83%85%E5%86%B5%EF%BC%9A" aria-label="第一种情况： permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>第一种情况：</h4>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">/* code */</span> <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// SyntaxError: Unexpected token (</span></code></pre></div>
<p>解释：JavaScript 在解析代码时，当遇到<code class="language-text">function</code>关键字时，会默认把它当做一个<strong>函数声明</strong>，而<strong>不是函数表达式</strong>，如果没有把它显式的写成函数表达式，就报错，<strong>因为函数声明需要一个函数名</strong>。上面的报错是因为没有函数名(第一个左括号)。</p>
<h4 id="第二种情况：" style="position:relative;"><a href="#%E7%AC%AC%E4%BA%8C%E7%A7%8D%E6%83%85%E5%86%B5%EF%BC%9A" aria-label="第二种情况： permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>第二种情况：</h4>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">/* code */</span> <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// SyntaxError: Unexpected token )</span></code></pre></div>
<p>解释：在表达式后面加括号表示执行；此外，在函数声明一个语句，在语句后面加括号可等价为：</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">/* code */</span> <span class="token punctuation">}</span>
<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// SyntaxError: Unexpected token )</span></code></pre></div>
<p>相当于声明了函数 foo，后面进行<code class="language-text">()</code>的表达式操作。<code class="language-text">()</code>表示分组操作符，内部<strong>表达式</strong>不能为空，所以报错，上面的报错是因为分组操作符内为空的错误。</p>
<h4 id="第三种情况：" style="position:relative;"><a href="#%E7%AC%AC%E4%B8%89%E7%A7%8D%E6%83%85%E5%86%B5%EF%BC%9A" aria-label="第三种情况： permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>第三种情况：</h4>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">/* code */</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>为什么这样就能立即执行并且不报错呢？因为在 javascript 里，括号内部不能包含语句，当解析器对代码进行解释的时候，先碰到了<code class="language-text">()</code>，然后碰到 function 关键字就会<strong>自动将<code class="language-text">()</code>里面的代码识别为函数表达式而不是函数声明</strong>。</p>
<p>因此，也可以这么写：</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">/* code */</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>此外，只要功能类似于<code class="language-text">()</code>将<strong>语句</strong>转化为<strong>表达式</strong>的方式都能用于 IIFE，例如下面的写法都会生效：</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token boolean">false</span> <span class="token operator">||</span>
  <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token boolean">true</span> <span class="token operator">&amp;&amp;</span>
  <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token string">"anything"</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">~</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">!</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span>
  <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span>
  <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">~</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 变种</span></code></pre></div>
<h4 id="第四种情况：" style="position:relative;"><a href="#%E7%AC%AC%E5%9B%9B%E7%A7%8D%E6%83%85%E5%86%B5%EF%BC%9A" aria-label="第四种情况： permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>第四种情况：</h4>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>这样的写法把<code class="language-text">fucntion</code>当做函数表达式，可以不加<code class="language-text">()</code>，但是为了增加代码可读性，建议加上。</p>
<h2 id="和闭包的配合" style="position:relative;"><a href="#%E5%92%8C%E9%97%AD%E5%8C%85%E7%9A%84%E9%85%8D%E5%90%88" aria-label="和闭包的配合 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>和闭包的配合</h2>
<h3 id="1-保存函数内部变量状态" style="position:relative;"><a href="#1-%E4%BF%9D%E5%AD%98%E5%87%BD%E6%95%B0%E5%86%85%E9%83%A8%E5%8F%98%E9%87%8F%E7%8A%B6%E6%80%81" aria-label="1 保存函数内部变量状态 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 保存函数内部变量状态</h3>
<p>下面代码并不会像你想象那样的执行，因为<code class="language-text">i</code>的值没有被锁住，当我们点击链接的时候，其实 for 循环已经执行完了，于是在点击的时候 i 的值其实已经是 elems.length 了。</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> elems <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> elems<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  elems<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>
    <span class="token string">"click"</span><span class="token punctuation">,</span>
    <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"I am link #"</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string">"false"</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>这样改写：</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> elems <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> elems<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">i</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 其实代码中的 i 和外面的 i 是在不同的作用域里完全不同，比如：</span>
    elems<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>
      <span class="token string">"click"</span><span class="token punctuation">,</span>
      <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"I am link #"</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token string">"false"</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>IIFE 代码中的<code class="language-text">i</code>和外面的<code class="language-text">i</code>是在不同的作用域里，完全不同的两个值，只是名字一样。</p>
<h3 id="2-局部变量、模块化" style="position:relative;"><a href="#2-%E5%B1%80%E9%83%A8%E5%8F%98%E9%87%8F%E3%80%81%E6%A8%A1%E5%9D%97%E5%8C%96" aria-label="2 局部变量、模块化 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 局部变量、模块化</h3>
<p>立即执行函数在模块化中也大有用处。用立即执行函数处理模块化可以减少全局变量造成的空间污染，构造更多的私有变量。</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// 创建一个立即执行的匿名函数</span>
<span class="token comment">// 该函数返回一个对象，包含你要暴露的属性</span>
<span class="token comment">// 如下代码如果不使用立即执行函数，就会多一个属性i</span>
<span class="token comment">// 如果有了属性i，我们就能调用counter.i改变i的值</span>
<span class="token comment">// 对我们来说这种不确定的因素越少越好</span>

<span class="token keyword">var</span> counter <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> i<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      i <span class="token operator">=</span> val<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">increment</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token operator">++</span>i<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// counter其实是一个对象</span>

counter<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 0</span>
counter<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
counter<span class="token punctuation">.</span><span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 4</span>
counter<span class="token punctuation">.</span><span class="token function">increment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 5</span>

counter<span class="token punctuation">.</span>i<span class="token punctuation">;</span> <span class="token comment">// undefined i并不是counter的属性</span>
i<span class="token punctuation">;</span> <span class="token comment">// ReferenceError: i is not defined (函数内部的是局部变量)</span></code></pre></div>
<h2 id="总结" style="position:relative;"><a href="#%E6%80%BB%E7%BB%93" aria-label="总结 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>总结</h2>
<ul>
<li>能转化为函数表达式的操作都能构造 IIFE</li>
<li>IIFE 和普通函数类似，可以传参，有返回值</li>
<li>IIFE 可以制造局部变量，用于模块化</li>
</ul>
<h2 id="参考" style="position:relative;"><a href="#%E5%8F%82%E8%80%83" aria-label="参考 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>参考</h2>
<ul>
<li><a href="http://web.jobbole.com/82520/" target="_target" rel="nofollow">详解 javascript 立即执行函数表达式（IIFE）</a></li>
</ul>]]></description><link>https://xiangst0816.github.io/blog/IIFE-li-ji-zhi-hang-xing-han-shu-shuo/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/IIFE-li-ji-zhi-hang-xing-han-shu-shuo/</guid><category><![CDATA[JavaScript]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Mon, 01 Jan 2018 08:40:10 GMT</pubDate></item><item><title><![CDATA[变量提升]]></title><description><![CDATA[<blockquote>
<p>这里说的变量提升指的是使用<strong>var</strong>声明的变量</p>
</blockquote>
<p>变量提升也可以说是“<strong>变量声明前置</strong>”，就是把函数里面用到的变量声明提升到前面，<strong>赋值步骤在书写的位置进行</strong>。</p>
<h2 id="是否使用-var-定义变量的区别" style="position:relative;"><a href="#%E6%98%AF%E5%90%A6%E4%BD%BF%E7%94%A8-var-%E5%AE%9A%E4%B9%89%E5%8F%98%E9%87%8F%E7%9A%84%E5%8C%BA%E5%88%AB" aria-label="是否使用 var 定义变量的区别 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>是否使用 var 定义变量的区别</h2>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token string">"var-a"</span><span class="token punctuation">;</span>
  b <span class="token operator">=</span> <span class="token string">"var-b"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 'var-b'</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ReferenceError: a is not defined</span></code></pre></div>
<ul>
<li>使用 var 定义的变量是函数级变量，只在函数内能访问到。</li>
<li>不使用 var 定义的变量是全局变量，等同于<code class="language-text">window.b = &#39;var-b&#39;</code></li>
</ul>
<h2 id="块级作用域和函数级作用域" style="position:relative;"><a href="#%E5%9D%97%E7%BA%A7%E4%BD%9C%E7%94%A8%E5%9F%9F%E5%92%8C%E5%87%BD%E6%95%B0%E7%BA%A7%E4%BD%9C%E7%94%A8%E5%9F%9F" aria-label="块级作用域和函数级作用域 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>块级作用域和函数级作用域</h2>
<ul>
<li>使用传统的<code class="language-text">var</code>定义的变量执行的是<strong>函数级作用域</strong>。</li>
</ul>
<p>描述一下就是：在函数中使用<code class="language-text">var</code>定义的变量都会将变量声明放在函数的第一行，变量赋值在书写的位置赋值。</p>
<ul>
<li>使用 let 定义变量将执行<strong>块级作用域</strong>，即<code class="language-text">{}</code>内范围</li>
</ul>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> varvars <span class="token operator">=</span> <span class="token string">"varvars"</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> letvars <span class="token operator">=</span> <span class="token string">"letvars"</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> varvars <span class="token operator">=</span> <span class="token string">"11"</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> letvars <span class="token operator">=</span> <span class="token string">"22"</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"test varvars:"</span> <span class="token operator">+</span> varvars<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"test letvars:"</span> <span class="token operator">+</span> letvars<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>等同于：</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> varvars <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> letvars <span class="token operator">=</span> <span class="token string">"letvars"</span><span class="token punctuation">;</span>

  varvars <span class="token operator">=</span> <span class="token string">"varvars"</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    varvars <span class="token operator">=</span> <span class="token string">"11"</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> letvars <span class="token operator">=</span> <span class="token string">"22"</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"test varvars:"</span> <span class="token operator">+</span> varvars<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"test letvars:"</span> <span class="token operator">+</span> letvars<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// letvars</span>
<span class="token punctuation">}</span>

<span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<h2 id="结合函数执行过程说明" style="position:relative;"><a href="#%E7%BB%93%E5%90%88%E5%87%BD%E6%95%B0%E6%89%A7%E8%A1%8C%E8%BF%87%E7%A8%8B%E8%AF%B4%E6%98%8E" aria-label="结合函数执行过程说明 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>结合函数执行过程说明</h2>
<p>当程序进入执行的上下文（代码真正执行之前），变量对象（VO）已经包含的属性是：</p>
<ul>
<li>函数的所有<strong>形参</strong></li>
</ul>
<p>创建由<strong>变量名称</strong>和<strong>对应值</strong>组成的一个变量对象，如果名称没有对应的值时，默认值为 undefined</p>
<ul>
<li>所有<strong>函数声明</strong></li>
</ul>
<p>创建由<strong>函数名</strong>和<strong>函数对象</strong>组成的一个变量对象，如果函数名已存在则完全替换</p>
<ul>
<li>所有<strong>变量声明</strong>（var 声明）</li>
</ul>
<p>创建由<strong>名称</strong>和<strong>对应值</strong>组成的一个变量对象，如果名称没有对应的值时，默认值为 undefined
，如果函数名已存在则完全替换</p>
<h2 id="示例及优先级说明" style="position:relative;"><a href="#%E7%A4%BA%E4%BE%8B%E5%8F%8A%E4%BC%98%E5%85%88%E7%BA%A7%E8%AF%B4%E6%98%8E" aria-label="示例及优先级说明 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>示例及优先级说明</h2>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span> <span class="token comment">// 这里的定义将覆盖形参name和函数name, 声明提升，默认为undefined</span>
  <span class="token keyword">function</span> <span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 这里定义的name函数将覆盖形参name</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  name <span class="token operator">=</span> <span class="token string">"inner"</span><span class="token punctuation">;</span> <span class="token comment">// 这里的定义将覆盖形参name和函数name</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出 inner</span>
<span class="token punctuation">}</span>

<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">"outer"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>或者：</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 1. 形参: {name: 'outer'}</span>
  <span class="token comment">// 2. 函数: {name: function () { // ... }} 覆盖上面的同名定义</span>
  <span class="token comment">// 3. 变量: {name: 'inner'} 覆盖上面的同名定义，多个var赋值取最后一次赋值</span>

  <span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">"inner"</span><span class="token punctuation">;</span> <span class="token comment">// 这里的定义将覆盖形参name和函数name, 声明提升，这里的定义将覆盖形参name和函数name</span>
  <span class="token keyword">function</span> <span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 这里定义的name函数将覆盖形参name</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出 inner</span>
<span class="token punctuation">}</span>

<span class="token function">test</span><span class="token punctuation">(</span><span class="token string">"outer"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>注意：</p>
<ul>
<li>不管 var 声明放在何处，结果都是一样的</li>
<li>多次 var 声明同一个变量，代码不会报错，声明前置，原地赋值</li>
<li>如果使用 let 声明，则<strong>不可定义已存在的变量名（包括 函数名和形参）</strong>， 返回错误</li>
</ul>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">SyntaxError<span class="token operator">:</span> Identifier <span class="token string">'name'</span> has already been declared</code></pre></div>
<h2 id="总结" style="position:relative;"><a href="#%E6%80%BB%E7%BB%93" aria-label="总结 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>总结</h2>
<ul>
<li><em>var 定义的变量</em>为<strong>函数级作用域</strong></li>
<li><em>var 定义的变量</em>会有<strong>变量声明提升</strong>的现象，但是在<strong>书写位置赋值</strong></li>
<li><em>let 定义的变量</em>为<strong>块级作用域</strong>，不会出现变量声明提升的现象，在书写的位置声明及赋值，变量名称不能和 [形参名称/函数名称] 重复。</li>
<li>生效优先级：<code class="language-text">变量名(var定义) &gt; 函数名 &gt; 形参名</code></li>
<li>let 不会出现同名的问题，但是<code class="language-text">函数名 &gt; 形参名</code>的情况会存在</li>
</ul>]]></description><link>https://xiangst0816.github.io/blog/bian-liang-ti-di-sheng/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/bian-liang-ti-di-sheng/</guid><category><![CDATA[JavaScript]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Mon, 01 Jan 2018 07:01:14 GMT</pubDate></item><item><title><![CDATA[关于this]]></title><description><![CDATA[<h2 id="this-是什么" style="position:relative;"><a href="#this-%E6%98%AF%E4%BB%80%E4%B9%88" aria-label="this 是什么 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>this 是什么</h2>
<p><strong>在函数运行时，基于调用位置的条件自动生成的内部对象</strong>，可以理解为动态绑定对象到 this 上。</p>
<p>需要强调的是：</p>
<ul>
<li>只针对函数，<strong>在函数内部使用</strong></li>
<li>this 由调用位置的上下文<strong>自动的</strong>决定，而不是函数声明的位置（代码书写的位置）</li>
<li>必须是运行时才确定，而不是编写时</li>
<li>this 绑定之后可理解为<strong>自动生成的内部对象</strong></li>
</ul>
<p>示例：</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> foo <span class="token operator">=</span> <span class="token string">"golbal foo"</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> myObj <span class="token operator">=</span> <span class="token punctuation">{</span> foo<span class="token operator">:</span> <span class="token string">"myObj foo"</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> <span class="token function-variable function">say</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>foo<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

myObj<span class="token punctuation">.</span>say <span class="token operator">=</span> say<span class="token punctuation">;</span>
myObj<span class="token punctuation">.</span><span class="token function">say</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//结果：myObj foo</span>
<span class="token function">say</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//结果：golbal foo  ，相当于window.say()，内部的this->window对象</span></code></pre></div>
<h2 id="this-的四个绑定规则及优先级" style="position:relative;"><a href="#this-%E7%9A%84%E5%9B%9B%E4%B8%AA%E7%BB%91%E5%AE%9A%E8%A7%84%E5%88%99%E5%8F%8A%E4%BC%98%E5%85%88%E7%BA%A7" aria-label="this 的四个绑定规则及优先级 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>this 的四个绑定规则及优先级</h2>
<p>下面四个为 this 的绑定优先级规则，第一个优先级最高。判断执行流程需要做的就是找到函数的调用位置并判断使用哪条规则。</p>
<h3 id="1-函数是否通过code-classlanguage-textnew-basecode方式绑定？如果是，code-classlanguage-textthiscode绑定新创建的对象" style="position:relative;"><a href="#1-%E5%87%BD%E6%95%B0%E6%98%AF%E5%90%A6%E9%80%9A%E8%BF%87code-classlanguage-textnew-basecode%E6%96%B9%E5%BC%8F%E7%BB%91%E5%AE%9A%EF%BC%9F%E5%A6%82%E6%9E%9C%E6%98%AF%EF%BC%8Ccode-classlanguage-textthiscode%E7%BB%91%E5%AE%9A%E6%96%B0%E5%88%9B%E5%BB%BA%E7%9A%84%E5%AF%B9%E8%B1%A1" aria-label="1 函数是否通过code classlanguage textnew basecode方式绑定？如果是，code classlanguage textthiscode绑定新创建的对象 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 函数是否通过<code class="language-text">new Base()</code>方式绑定？如果是，<code class="language-text">this</code>绑定新创建的对象</h3>
<p>在 Javascript 引擎中看到的对象模型是：</p>
<p><img src="http://coolshell.cn/wp-content/uploads/2012/02/joo_3.png"></p>
<p><code class="language-text">new</code>的调用会自动执行下面代码（示例代码），Base 函数中的<code class="language-text">this</code>指向新创建的对象(一般)：</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Base</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 1. 创建（或者说构造）一个全新的对象；</span>
<span class="token keyword">var</span> _obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 2. 我们将这个空对象的__proto__成员指向了Base函数对象prototype成员对象</span>
_obj<span class="token punctuation">.</span>__proto__ <span class="token operator">=</span> <span class="token class-name">Base</span><span class="token punctuation">.</span>prototype<span class="token punctuation">;</span>

<span class="token comment">// 3. 我们将Base函数对象的this指针替换成_obj，然后再调用Base函数</span>
<span class="token keyword">var</span> _return <span class="token operator">=</span> <span class="token function">Base</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>_obj<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 4 如果函数没有返回其他对象，那么new表达式中的函数调用会自动返回这个新对象</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> _return <span class="token operator">===</span> <span class="token string">"object"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  obj <span class="token operator">=</span> _return<span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  obj <span class="token operator">=</span> _obj<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<h3 id="2-函数是否通过code-classlanguage-textcallcode、code-classlanguage-textapplycode、code-classlanguage-textbindcode显式绑定？如果是，code-classlanguage-textthiscode绑定所指定的对象" style="position:relative;"><a href="#2-%E5%87%BD%E6%95%B0%E6%98%AF%E5%90%A6%E9%80%9A%E8%BF%87code-classlanguage-textcallcode%E3%80%81code-classlanguage-textapplycode%E3%80%81code-classlanguage-textbindcode%E6%98%BE%E5%BC%8F%E7%BB%91%E5%AE%9A%EF%BC%9F%E5%A6%82%E6%9E%9C%E6%98%AF%EF%BC%8Ccode-classlanguage-textthiscode%E7%BB%91%E5%AE%9A%E6%89%80%E6%8C%87%E5%AE%9A%E7%9A%84%E5%AF%B9%E8%B1%A1" aria-label="2 函数是否通过code classlanguage textcallcode、code classlanguage textapplycode、code classlanguage textbindcode显式绑定？如果是，code classlanguage textthiscode绑定所指定的对象 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 函数是否通过<code class="language-text">call</code>、<code class="language-text">apply</code>、<code class="language-text">bind</code>显式绑定？如果是，<code class="language-text">this</code>绑定所指定的对象</h3>
<p>强制将<code class="language-text">foo</code>方法中的<code class="language-text">this</code>绑定到<code class="language-text">obj</code>对象上，即使后面再次更新绑定也不生效。</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> <span class="token function-variable function">bar</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">foo</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//2</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span>bar<span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//2</span>
<span class="token function">bar</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//2</span></code></pre></div>
<p><strong>注意：</strong></p>
<p><code class="language-text">bind</code>绑定会返回新函数，对新函数无法更改内部的 this，原因同上。但是对原函数可以随意切换绑定。</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">base</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>hello<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token punctuation">{</span>
  hello<span class="token operator">:</span> <span class="token string">"aaa"</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token punctuation">{</span>
  hello<span class="token operator">:</span> <span class="token string">"bbb"</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function">base</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// aaa</span>
<span class="token function">base</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// bbb</span>
<span class="token keyword">var</span> bb <span class="token operator">=</span> <span class="token function">base</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 强绑定，返回的bb函数已无法更改this</span>
<span class="token function">bb</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// bbb</span>
<span class="token function">bb</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// bbb</span>
<span class="token function">base</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// aaa</span>
<span class="token function">base</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// bbb</span></code></pre></div>
<h3 id="3-函数是否在某个上下文对象中隐式调用？如果是，code-classlanguage-textthiscode绑定到那个上下文对象" style="position:relative;"><a href="#3-%E5%87%BD%E6%95%B0%E6%98%AF%E5%90%A6%E5%9C%A8%E6%9F%90%E4%B8%AA%E4%B8%8A%E4%B8%8B%E6%96%87%E5%AF%B9%E8%B1%A1%E4%B8%AD%E9%9A%90%E5%BC%8F%E8%B0%83%E7%94%A8%EF%BC%9F%E5%A6%82%E6%9E%9C%E6%98%AF%EF%BC%8Ccode-classlanguage-textthiscode%E7%BB%91%E5%AE%9A%E5%88%B0%E9%82%A3%E4%B8%AA%E4%B8%8A%E4%B8%8B%E6%96%87%E5%AF%B9%E8%B1%A1" aria-label="3 函数是否在某个上下文对象中隐式调用？如果是，code classlanguage textthiscode绑定到那个上下文对象 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. 函数是否在某个上下文对象中隐式调用？如果是，<code class="language-text">this</code>绑定到那个上下文对象</h3>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> obj1 <span class="token operator">=</span> <span class="token punctuation">{</span>
  a<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  foo<span class="token operator">:</span> foo
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> obj2 <span class="token operator">=</span> <span class="token punctuation">{</span>
  a<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  obj1<span class="token operator">:</span> obj1
<span class="token punctuation">}</span><span class="token punctuation">;</span>
obj2<span class="token punctuation">.</span>obj1<span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//结果：2</span></code></pre></div>
<p><code class="language-text">foo()</code>执行时的上下文是<code class="language-text">obj1</code>，因此函数内的<code class="language-text">this</code>-><code class="language-text">obj1</code></p>
<p><strong>注意：</strong></p>
<p>隐式绑定会出现绑定丢失的问题，不过这个很好推理。</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token string">"foo"</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">doFoo</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//var fn = obj.foo</span>
  <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  a<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  foo<span class="token operator">:</span> foo
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token function">doFoo</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>foo<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//"foo"  this->window</span>

<span class="token keyword">var</span> bar <span class="token operator">=</span> obj<span class="token punctuation">.</span>foo<span class="token punctuation">;</span>
<span class="token function">bar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// "foo" 相当于：window.bar()， this->window</span>
<span class="token function">bar</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// "2" this->obj</span>

<span class="token function">setTimeout</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>foo<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//"foo"</span></code></pre></div>
<h3 id="4-上述全部不是，则code-classlanguage-textthis-gtwindow上code，如果是严格模式，code-classlanguage-textthis-gtundefinedcode" style="position:relative;"><a href="#4-%E4%B8%8A%E8%BF%B0%E5%85%A8%E9%83%A8%E4%B8%8D%E6%98%AF%EF%BC%8C%E5%88%99code-classlanguage-textthis-gtwindow%E4%B8%8Acode%EF%BC%8C%E5%A6%82%E6%9E%9C%E6%98%AF%E4%B8%A5%E6%A0%BC%E6%A8%A1%E5%BC%8F%EF%BC%8Ccode-classlanguage-textthis-gtundefinedcode" aria-label="4 上述全部不是，则code classlanguage textthis gtwindow上code，如果是严格模式，code classlanguage textthis gtundefinedcode permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. 上述全部不是，则<code class="language-text">this-&gt;window上</code>，如果是严格模式，<code class="language-text">this-&gt;undefined</code></h3>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// 严格模式是？</span>
<span class="token keyword">var</span> <span class="token function-variable function">a</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token string">"use strict"</span><span class="token punctuation">;</span>
  <span class="token comment">//...</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<h2 id="事件中的-this" style="position:relative;"><a href="#%E4%BA%8B%E4%BB%B6%E4%B8%AD%E7%9A%84-this" aria-label="事件中的 this permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>事件中的 this</h2>
<h3 id="1-作为-dom-事件处理" style="position:relative;"><a href="#1-%E4%BD%9C%E4%B8%BA-dom-%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86" aria-label="1 作为 dom 事件处理 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 作为 DOM 事件处理</h3>
<p>在事件处理函数中的 this 指向绑定事件的对象<code class="language-text">event.currentTarget</code></p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"button"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"click"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>target <span class="token operator">===</span> event<span class="token punctuation">.</span>currentTarget<span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>target <span class="token operator">===</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<blockquote>
<p>currentTarget：绑定事件的元素，恒等于 this<br>
target：触发事件的元素，可能是绑定事件元素的子元素接收到了事件</p>
</blockquote>
<h3 id="2-作为内联事件处理" style="position:relative;"><a href="#2-%E4%BD%9C%E4%B8%BA%E5%86%85%E8%81%94%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86" aria-label="2 作为内联事件处理 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 作为内联事件处理</h3>
<p>当代码在元素上进行调用处理，this 指向的是这个 DOM 元素，<code class="language-text">this-&gt;$(button)</code></p>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>alert(this.tagName.toLowerCase());<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> Show this<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span></code></pre></div>
<p>function 函数中返回，则 this 指向 window，<code class="language-text">this-&gt;window</code></p>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>alert((function(){return this}()));<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Show inner this<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span></code></pre></div>
<h2 id="iife-中的-this" style="position:relative;"><a href="#iife-%E4%B8%AD%E7%9A%84-this" aria-label="iife 中的 this permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>IIFE 中的 this</h2>
<p><strong>不管 IIFE 写在哪，里面的 this 都指向 window。</strong>相当于是在 window 下执行 IIFE 函数。此外，自执行函数返回值为 undefined。</p>
<h2 id="注意点" style="position:relative;"><a href="#%E6%B3%A8%E6%84%8F%E7%82%B9" aria-label="注意点 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>注意点</h2>
<h3 id="1-忽略-this" style="position:relative;"><a href="#1-%E5%BF%BD%E7%95%A5-this" aria-label="1 忽略 this permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 忽略 this</h3>
<p>把<code class="language-text">null</code>或<code class="language-text">undefined</code>作为<code class="language-text">this</code>的绑定对象传入<code class="language-text">call</code>、<code class="language-text">apply</code>、<code class="language-text">bind</code>，调用时会被忽略，实际应用的是默认绑定规则<code class="language-text">this-&gt;window</code>！如果是严格模式, 这个值为<code class="language-text">undefined</code>.</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token function">foo</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1  this->window</span>
<span class="token function">foo</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">undefined</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//1  this->window</span>
<span class="token function">foo</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>window<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//1  this->window</span></code></pre></div>
<h3 id="2-间接引用" style="position:relative;"><a href="#2-%E9%97%B4%E6%8E%A5%E5%BC%95%E7%94%A8" aria-label="2 间接引用 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 间接引用</h3>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> o <span class="token operator">=</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span> foo<span class="token operator">:</span> foo <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> p <span class="token operator">=</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">4</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
o<span class="token punctuation">.</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//3</span>
<span class="token punctuation">(</span>p<span class="token punctuation">.</span>foo <span class="token operator">=</span> o<span class="token punctuation">.</span>foo<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//2 间接引用, 前面返回foo函数，相当于：(foo)(), this->window</span>
<span class="token keyword">var</span> pfoo <span class="token operator">=</span> o<span class="token punctuation">.</span>foo<span class="token punctuation">;</span>
<span class="token function">pfoo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//2 隐式丢失</span></code></pre></div>
<h3 id="3-箭头函数" style="position:relative;"><a href="#3-%E7%AE%AD%E5%A4%B4%E5%87%BD%E6%95%B0" aria-label="3 箭头函数 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. 箭头函数</h3>
<p>箭头函数中的 this 无法被修改，<strong>this 指向由外层函数决定</strong>，常用于事件处理器或定时器等<strong>异步场景</strong>。</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token function">foo</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>等价于：</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> self <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token function">foo</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<h2 id="补充" style="position:relative;"><a href="#%E8%A1%A5%E5%85%85" aria-label="补充 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>补充</h2>
<h3 id="1-code-classlanguage-textbindcode实现？" style="position:relative;"><a href="#1-code-classlanguage-textbindcode%E5%AE%9E%E7%8E%B0%EF%BC%9F" aria-label="1 code classlanguage textbindcode实现？ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. <code class="language-text">bind()</code>实现？</h3>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">bind</span><span class="token punctuation">(</span><span class="token parameter">f<span class="token punctuation">,</span> o</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>f<span class="token punctuation">.</span>bind<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">f</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token function">f</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>o<span class="token punctuation">,</span> arguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<h3 id="2-什么是严格模式？" style="position:relative;"><a href="#2-%E4%BB%80%E4%B9%88%E6%98%AF%E4%B8%A5%E6%A0%BC%E6%A8%A1%E5%BC%8F%EF%BC%9F" aria-label="2 什么是严格模式？ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 什么是严格模式？</h3>
<p>为了向新版 JS 语法过度的模式。</p>
<h4 id="放置位置" style="position:relative;"><a href="#%E6%94%BE%E7%BD%AE%E4%BD%8D%E7%BD%AE" aria-label="放置位置 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>放置位置</h4>
<blockquote>
<p>严格模式编译指示: “use strict”</p>
</blockquote>
<ul>
<li>放置在脚本第一行</li>
<li>声明在函数体中第一行</li>
</ul>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> <span class="token function-variable function">a</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token string">"use strict"</span><span class="token punctuation">;</span>
  <span class="token comment">//...</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<h4 id="与非严格模式的区别" style="position:relative;"><a href="#%E4%B8%8E%E9%9D%9E%E4%B8%A5%E6%A0%BC%E6%A8%A1%E5%BC%8F%E7%9A%84%E5%8C%BA%E5%88%AB" aria-label="与非严格模式的区别 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>与非严格模式的区别</h4>
<ul>
<li>无法创建全局变量，变量必须使用 var 声明</li>
</ul>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token string">"use strict"</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">123</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a <span class="token operator">===</span> window<span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<ul>
<li>静默失败都会抛出错误</li>
<li>禁止使用 with</li>
</ul>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
obj<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
obj<span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token keyword">with</span> <span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span>a <span class="token operator">+</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>with 的作用是将 obj 对象中的变量在{}中展开可直接访问，注意这没有影响 window 对象。类似于作用域拼接。</p>
<ul>
<li>严格模式下，eval 内部有自己的作用域</li>
<li>默认的 this 指向 undefined，而不是 window，避免 window 变量被污染</li>
<li>禁止在函数内部使用 callee、caller、arguments 这些属性</li>
<li>对象属性名唯一，函数传参名唯一</li>
<li>禁止八进制表示法</li>
<li>不允许对 arguments 赋值</li>
<li>arguments 不在追踪参数的变化</li>
<li>不能再非函数的代码块中声明函数</li>
</ul>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token operator">></span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"hi"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token comment">//报错</span></code></pre></div>
<ul>
<li>禁止使用保留关键字</li>
</ul>
<h2 id="测试题" style="position:relative;"><a href="#%E6%B5%8B%E8%AF%95%E9%A2%98" aria-label="测试题 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>测试题</h2>
<h3 id="1-为什么要使用-this，而不是传参解决问题" style="position:relative;"><a href="#1-%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E4%BD%BF%E7%94%A8-this%EF%BC%8C%E8%80%8C%E4%B8%8D%E6%98%AF%E4%BC%A0%E5%8F%82%E8%A7%A3%E5%86%B3%E9%97%AE%E9%A2%98" aria-label="1 为什么要使用 this，而不是传参解决问题 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 为什么要使用 this，而不是传参解决问题</h3>
<ul>
<li>复用</li>
</ul>
<p>在不同的对象环境下执行了它们，达到了复用的效果，而不用为了在不同的对象环境下执行而必须针对不同的对象环境写对应的函数了。</p>
<ul>
<li>模拟类</li>
</ul>
<h3 id="2-基础-call" style="position:relative;"><a href="#2-%E5%9F%BA%E7%A1%80-call" aria-label="2 基础 call permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 基础 call</h3>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">identify</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">sayHello</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> greeting <span class="token operator">=</span> <span class="token string">"Hello, I'm "</span> <span class="token operator">+</span> <span class="token function">identify</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>greeting<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> person1 <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">"Kyle"</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> person2 <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">"Reader"</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token function">identify</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>person1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// KYLE</span>
<span class="token function">identify</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>person2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// READER</span>
<span class="token function">sayHello</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>person1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Hello, I'm KYLE</span>
<span class="token function">sayHello</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>person2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Hello, I'm READER</span></code></pre></div>
<blockquote>
<p>函数在哪里调用才决定了 this 到底引用的是啥</p>
</blockquote>
<h3 id="3-this-不是指向函数本身" style="position:relative;"><a href="#3-this-%E4%B8%8D%E6%98%AF%E6%8C%87%E5%90%91%E5%87%BD%E6%95%B0%E6%9C%AC%E8%BA%AB" aria-label="3 this 不是指向函数本身 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. this 不是指向函数本身</h3>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token parameter">num</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"fn: "</span> <span class="token operator">+</span> num<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// count用于记录fn的被调用次数</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>count<span class="token operator">++</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
fn<span class="token punctuation">.</span>count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> i<span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">></span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">fn</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// fn: 6</span>
<span class="token comment">// fn: 7</span>
<span class="token comment">// fn: 8</span>
<span class="token comment">// fn: 9</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>fn<span class="token punctuation">.</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 0 -- 耶？咋不是4捏？</span></code></pre></div>
<ul>
<li>fn.count 是函数本身的属性，因为函数也是对象</li>
<li>this.count 是 fn 函数构造器中的变量， 也是全局变量，this->window</li>
</ul>
<h3 id="4-继承引用this" style="position:relative;"><a href="#4-%E7%BB%A7%E6%89%BF%E5%BC%95%E7%94%A8this" aria-label="4 继承引用this permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. 继承+引用+this</h3>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">Parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>a<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// this.a只在函数体内存在，这里相当于设置“默认值”</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>c <span class="token operator">=</span> <span class="token punctuation">{</span> demo<span class="token operator">:</span> <span class="token number">5</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">show</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>a<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>b<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>c<span class="token punctuation">.</span>demo<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">Child</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">change</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// this中变量就近引用，如果没有就从原型链继续找</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>b<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>b<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>c<span class="token punctuation">.</span>demo <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>a<span class="token operator">++</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">Child</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> parent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> child1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Child</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> child2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Child</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
child1<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">11</span><span class="token punctuation">;</span>
child2<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">;</span>
parent<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1 [1,2,1] 5</span>
child1<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 11 [1,2,1] 5</span>
child2<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 12 [1,2,1] 5</span>
child1<span class="token punctuation">.</span><span class="token function">change</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// a->5, b->[1,2,1,11], c.demo->4，this就近+继承+引用</span>
child2<span class="token punctuation">.</span><span class="token function">change</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// a->6, b->[1,2,1,11,12], c.demo->5，this就近+继承+引用</span>
parent<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1 [1,2,1] 5</span>
child1<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 5 [1,2,1,11,12] 5</span>
child2<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 6 [1,2,1,11,12] 5</span></code></pre></div>
<p>需要注意的是：</p>
<ul>
<li>继承+引用</li>
</ul>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">child2<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> child1<span class="token punctuation">.</span>__proto__<span class="token punctuation">;</span> <span class="token comment">// true</span></code></pre></div>]]></description><link>https://xiangst0816.github.io/blog/guan-yu-this/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/guan-yu-this/</guid><category><![CDATA[JavaScript]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Sat, 30 Dec 2017 14:02:09 GMT</pubDate></item><item><title><![CDATA[dva]]></title><description><![CDATA[<h3 id="路由部分" style="position:relative;"><a href="#%E8%B7%AF%E7%94%B1%E9%83%A8%E5%88%86" aria-label="路由部分 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>路由部分</h3>
<p>以下是<code class="language-text">dva/router</code>的导出项:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span>
  routerRedux<span class="token punctuation">,</span>
  Router<span class="token punctuation">,</span>
  Switch<span class="token punctuation">,</span>
  Route<span class="token punctuation">,</span>
  Redirect<span class="token punctuation">,</span>
  Link<span class="token punctuation">,</span>
  NavLink
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"dva/router"</span><span class="token punctuation">;</span></code></pre></div>
<h4 id="routerredux" style="position:relative;"><a href="#routerredux" aria-label="routerredux permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>routerRedux</h4>
<p>dva 中的源码如下:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">module<span class="token punctuation">.</span>exports<span class="token punctuation">.</span>routerRedux <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"react-router-redux"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>routerRedux 是对<code class="language-text">react-router-redux</code>的导出, 自身的初始化已在 dva 中完成, 一般用在非 RouteComponent 页面(不是函数式组件), 比如:</p>
<ul>
<li>PC 组件内</li>
<li>外部库</li>
<li>modals</li>
<li>函数式组件</li>
</ul>
<p>这样使用:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token function">dispatch</span><span class="token punctuation">(</span>routerRedux<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">"/form/step-form"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>RouteComponent 组件可以直接在<code class="language-text">this.props</code>中拿到.</p>
<h4 id="code-classlanguage-textltrouter-historyhistorygtcode" style="position:relative;"><a href="#code-classlanguage-textltrouter-historyhistorygtcode" aria-label="code classlanguage textltrouter historyhistorygtcode permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code class="language-text">&lt;Router history:History&gt;</code></h4>
<p><code class="language-text">&lt;Router&gt;</code>组件源自<code class="language-text">react-router</code>插件, 按照源码的说明:</p>
<blockquote>
<p>The public API for putting history on context.</p>
</blockquote>
<p>也就是说, 将传入的<code class="language-text">history</code>实例通过 React 组件的形式注入 context 中, 以便于子组件通过 context 拿到 router 信息, 这里的<code class="language-text">router</code>结构信息如下:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token punctuation">{</span>
	history<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>history<span class="token punctuation">,</span>
	route<span class="token operator">:</span> <span class="token punctuation">{</span>
    		location<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>history<span class="token punctuation">.</span>location<span class="token punctuation">,</span>
    		match<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>match
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>这里需要注意的是, 传入的 history 是特意化的 history 实例, 比如这三类:</p>
<ul>
<li>createBrowserHistory</li>
<li>createMemoryHistory</li>
<li>createHashHistory</li>
</ul>
<p>因此, 在 dva 中不再需要<code class="language-text">&lt;BrowserRouter&gt;</code>, <code class="language-text">&lt;HashRouter&gt;</code>, <code class="language-text">&lt;MemoryRouter&gt;</code>三个组件, 这里不再解释.</p>
<p>对于在组件树中的组件, 通过以下方式就能拿到路由信息:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">class</span> <span class="token class-name">Analysis</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> router <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>context<span class="token punctuation">.</span>router<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

Analysis<span class="token punctuation">.</span>contextTypes <span class="token operator">=</span> <span class="token punctuation">{</span>
  router<span class="token operator">:</span> PropTypes<span class="token punctuation">.</span>object
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<blockquote>
<p>ps: react-router 就是对 history 的再次封装</p>
</blockquote>
<h4 id="code-classlanguage-textltswitchgtcode" style="position:relative;"><a href="#code-classlanguage-textltswitchgtcode" aria-label="code classlanguage textltswitchgtcode permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code class="language-text">&lt;Switch&gt;</code></h4>
<p>只渲染出第一个与当前访问地址匹配的 <code class="language-text">&lt;Route&gt;</code> 或 <code class="language-text">&lt;Redirect&gt;</code>。</p>
<h4 id="code-classlanguage-textltredirect-tostringobject-fromstring-pushbooleangtcode" style="position:relative;"><a href="#code-classlanguage-textltredirect-tostringobject-fromstring-pushbooleangtcode" aria-label="code classlanguage textltredirect tostringobject fromstring pushbooleangtcode permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code class="language-text">&lt;Redirect to:string|object from:string push:boolean&gt;</code></h4>
<p>渲染时将导航到一个新地址，这个新地址覆盖在访问历史信息里面的本该访问的那个地址。</p>
<h4 id="code-classlanguage-textltroute-component--render--children-path-string-exact-bool-strict-boolgtcode" style="position:relative;"><a href="#code-classlanguage-textltroute-component--render--children-path-string-exact-bool-strict-boolgtcode" aria-label="code classlanguage textltroute component  render  children path string exact bool strict boolgtcode permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code class="language-text">&lt;Route component | render | children path: string exact: bool strict: bool&gt;</code></h4>
<p>它最基本的职责就是当页面的访问地址与 Route 上的 path 匹配时，就渲染出对应的 UI 界面。即: 页面插入点.</p>
<h4 id="code-classlanguage-textltlinkgtcode" style="position:relative;"><a href="#code-classlanguage-textltlinkgtcode" aria-label="code classlanguage textltlinkgtcode permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code class="language-text">&lt;Link&gt;</code></h4>
<p>为你的应用提供声明式，无障碍导航。</p>
<ul>
<li>to: string</li>
<li>replace: bool</li>
</ul>
<h4 id="code-classlanguage-textltnavlinkgtcode" style="position:relative;"><a href="#code-classlanguage-textltnavlinkgtcode" aria-label="code classlanguage textltnavlinkgtcode permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code class="language-text">&lt;NavLink&gt;</code></h4>
<p>这是 <Link> 的特殊版，顾名思义这就是为页面导航准备的。因为导航需要有 “激活状态”。</p>
<ul>
<li>activeClassName: string</li>
<li>exact: bool</li>
<li>strict: bool</li>
<li>isActive: func</li>
</ul>
<h2 id="参考文章" style="position:relative;"><a href="#%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0" aria-label="参考文章 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>参考文章</h2>
<ul>
<li><a href="http://blog.csdn.net/sinat_17775997/article/details/69218382" target="_target" rel="nofollow">初探 React Router 4.0</a></li>
</ul>]]></description><link>https://xiangst0816.github.io/blog/dva/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/dva/</guid><category><![CDATA[React]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Wed, 27 Dec 2017 09:38:58 GMT</pubDate></item><item><title><![CDATA[Fastclick原理浅析]]></title><description><![CDATA[<h3 id="为什么使用-fastclick" style="position:relative;"><a href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BD%BF%E7%94%A8-fastclick" aria-label="为什么使用 fastclick permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>为什么使用 FastClick</h3>
<p>在移动端 H5 开发过程中，关于点触可能会遇到如下两个问题：</p>
<ul>
<li>手动点击与真正触发<code class="language-text">click</code>事件会存在 300ms 的延迟</li>
<li>点击穿透问题（点击行为会穿透元素触发非父子关系元素的事件）</li>
</ul>
<p>延迟的存在时因为浏览器想知道你<a href="https://developers.google.com/mobile/articles/fast_buttons" target="_target" rel="nofollow">是否在进行双击操作</a>；而点击穿透是因为 300ms 延迟触发时的副作用。而使用 fastclick 能很好的解决这个问题，增加使用者的体验。</p>
<h3 id="可以不使用的场景" style="position:relative;"><a href="#%E5%8F%AF%E4%BB%A5%E4%B8%8D%E4%BD%BF%E7%94%A8%E7%9A%84%E5%9C%BA%E6%99%AF" aria-label="可以不使用的场景 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>可以不使用的场景</h3>
<p>不必使用的浏览器环境如下：</p>
<ul>
<li>Android + Chrome >32</li>
<li>Android + Chrome + <code class="language-text">meta=&quot;user-scalable=no&quot;</code></li>
<li>部分黑莓手机环境（可略过）</li>
<li>部分 WindowsPhone 环境（可略过）</li>
</ul>
<p>这部分的判断在下面的方法中有体现，如果当前环境支持快速点击，则 FastClick 会自动跳过初始化。</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">FastClick<span class="token punctuation">.</span><span class="token function-variable function">notNeeded</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">layer</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span></code></pre></div>
<h3 id="原理过程" style="position:relative;"><a href="#%E5%8E%9F%E7%90%86%E8%BF%87%E7%A8%8B" aria-label="原理过程 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>原理过程</h3>
<p>如果完整的描述 FastClick 过程需要考虑多种场景的兼容，<strong>这里就描述一个按钮点击过程的处理</strong>，下面是用来描述的代码：</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// 业务代码</span>
<span class="token keyword">var</span> $test <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"test"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
$test<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"click"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"1 click"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// FastClick简单实现</span>
<span class="token keyword">var</span> targetElement <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"touchstart"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 记录点击的元素</span>
  targetElement <span class="token operator">=</span> event<span class="token punctuation">.</span>target<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"touchend"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 阻止默认事件（屏蔽之后的click事件）</span>
  event<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> touch <span class="token operator">=</span> event<span class="token punctuation">.</span>changedTouches<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token comment">// 合成click事件，并添加可跟踪属性forwardedTouchEvent</span>
  <span class="token keyword">var</span> clickEvent <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createEvent</span><span class="token punctuation">(</span><span class="token string">"MouseEvents"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  clickEvent<span class="token punctuation">.</span><span class="token function">initMouseEvent</span><span class="token punctuation">(</span>
    <span class="token string">"click"</span><span class="token punctuation">,</span>
    <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token boolean">true</span><span class="token punctuation">,</span>
    window<span class="token punctuation">,</span>
    <span class="token number">1</span><span class="token punctuation">,</span>
    touch<span class="token punctuation">.</span>screenX<span class="token punctuation">,</span>
    touch<span class="token punctuation">.</span>screenY<span class="token punctuation">,</span>
    touch<span class="token punctuation">.</span>clientX<span class="token punctuation">,</span>
    touch<span class="token punctuation">.</span>clientY<span class="token punctuation">,</span>
    <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token keyword">null</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  clickEvent<span class="token punctuation">.</span>forwardedTouchEvent <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// 自定义的</span>
  targetElement<span class="token punctuation">.</span><span class="token function">dispatchEvent</span><span class="token punctuation">(</span>clickEvent<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<h4 id="这里进行过程说明：" style="position:relative;"><a href="#%E8%BF%99%E9%87%8C%E8%BF%9B%E8%A1%8C%E8%BF%87%E7%A8%8B%E8%AF%B4%E6%98%8E%EF%BC%9A" aria-label="这里进行过程说明： permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>这里进行过程说明：</h4>
<h5 id="1-业务正常使用-click-绑定事件" style="position:relative;"><a href="#1-%E4%B8%9A%E5%8A%A1%E6%AD%A3%E5%B8%B8%E4%BD%BF%E7%94%A8-click-%E7%BB%91%E5%AE%9A%E4%BA%8B%E4%BB%B6" aria-label="1 业务正常使用 click 绑定事件 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 业务正常使用 click 绑定事件</h5>
<h5 id="2-在-documentbody-绑定code-classlanguage-texttouchstartcode和code-classlanguage-texttouchendcode" style="position:relative;"><a href="#2-%E5%9C%A8-documentbody-%E7%BB%91%E5%AE%9Acode-classlanguage-texttouchstartcode%E5%92%8Ccode-classlanguage-texttouchendcode" aria-label="2 在 documentbody 绑定code classlanguage texttouchstartcode和code classlanguage texttouchendcode permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 在 document.body 绑定<code class="language-text">touchstart</code>和<code class="language-text">touchend</code></h5>
<p><strong><code class="language-text">touchstart</code></strong></p>
<p>用于记录当前点击的元素 targetElement；</p>
<p><strong><code class="language-text">touchend</code></strong></p>
<ul>
<li>阻止默认事件（屏蔽之后的 click 事件）</li>
<li>合成 click 事件，并添加可跟踪属性 forwardedTouchEvent</li>
<li>在 targetElement 上触发<code class="language-text">click</code>事件</li>
<li>targetElement 上绑定的事件立即执行，完成 FastClick</li>
</ul>
<h5 id="3-执行业务自己的-click-事件" style="position:relative;"><a href="#3-%E6%89%A7%E8%A1%8C%E4%B8%9A%E5%8A%A1%E8%87%AA%E5%B7%B1%E7%9A%84-click-%E4%BA%8B%E4%BB%B6" aria-label="3 执行业务自己的 click 事件 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. 执行业务自己的 click 事件</h5>
<h3 id="总结" style="position:relative;"><a href="#%E6%80%BB%E7%BB%93" aria-label="总结 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>总结</h3>
<p>以上就完成了模拟 FastClick，是不是很简单。事件的执行过程需要了解：touch 事件先于 mouse 事件先于 click 执行，因此可以在 document.body 上绑定事件用于监听点触行为，根据需要模拟 click 触发真正需要响应的元素。</p>
<p>(完)</p>]]></description><link>https://xiangst0816.github.io/blog/Fastclick-yuan-li-qian-jian-xi/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/Fastclick-yuan-li-qian-jian-xi/</guid><category><![CDATA[Mobile]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Fri, 08 Dec 2017 13:38:12 GMT</pubDate></item><item><title><![CDATA[关于组件库的主题定制]]></title><description><![CDATA[<h3 id="简述" style="position:relative;"><a href="#%E7%AE%80%E8%BF%B0" aria-label="简述 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>简述</h3>
<p>这篇博文主要讲解<strong>前端组件库主题定制</strong>相关内容，只限于<strong>Scss/Sass、Less</strong>两种样式预处理语言，这两种语言能够简化 CSS 的工作流，使得开发者维护开发样式更得心应手，便于应对复杂的样式需求。</p>
<p>对组件封装性好的库而我比较熟悉的有两个，React 和 Vue，这里我对这两个前端库封装的组件进行说明，涉及到的组件库包括：<a href="http://element-cn.eleme.io" target="_target" rel="nofollow">element-ui</a>、<a href="https://www.iviewui.com/" target="_target" rel="nofollow">iview</a>、<a href="https://ant.design" target="_target" rel="nofollow">antd</a>、<a href="https://github.com/ionic-team/ionic" target="_target" rel="nofollow">ionic</a>。</p>
<h3 id="主题定制分类" style="position:relative;"><a href="#%E4%B8%BB%E9%A2%98%E5%AE%9A%E5%88%B6%E5%88%86%E7%B1%BB" aria-label="主题定制分类 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>主题定制分类</h3>
<p>组件库的编写者一般都会为开发者设计一些主题样式更换方案，主要是这两类：</p>
<ol>
<li>复写全部主题样式，一次性引入</li>
<li>通过预处理器注入主题变量</li>
</ol>
<p>这里对这两类进行说明。</p>
<h4 id="1-复写全部主题样式" style="position:relative;"><a href="#1-%E5%A4%8D%E5%86%99%E5%85%A8%E9%83%A8%E4%B8%BB%E9%A2%98%E6%A0%B7%E5%BC%8F" aria-label="1 复写全部主题样式 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 复写全部主题样式</h4>
<h5 id="scss" style="position:relative;"><a href="#scss" aria-label="scss permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>SCSS</h5>
<p>这个在 PC 端比较常见，比如：<a href="http://element-cn.eleme.io/#/zh-CN/component/custom-theme" target="_target" rel="nofollow">element-ui</a>中的第二个方案，虽然说是改变 SCSS 变量，但还是复写了全部主题样式。项目初始时加载全部组件的样式，这个场景在 PC 端并没有太大的问题。但是从性能优化的角度，并不推荐。</p>
<div class="gatsby-highlight" data-language="scss"><pre class="language-scss"><code class="language-scss"><span class="token comment">/* 改变主题色变量 */</span>
<span class="token property"><span class="token variable">$--color-primary</span></span><span class="token punctuation">:</span> teal<span class="token punctuation">;</span>

<span class="token comment">/* 改变 icon 字体路径变量，必需 */</span>
<span class="token property"><span class="token variable">$--font-path</span></span><span class="token punctuation">:</span> <span class="token string">"../node_modules/element-ui/lib/theme-chalk/fonts"</span><span class="token punctuation">;</span>

<span class="token keyword">@import</span> <span class="token string">"../node_modules/element-ui/packages/theme-chalk/src/index"</span><span class="token punctuation">;</span></code></pre></div>
<h5 id="less" style="position:relative;"><a href="#less" aria-label="less permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Less</h5>
<p>此外，<a href="https://www.iviewui.com/docs/guide/theme" target="_target" rel="nofollow">iview</a>使用 Less 作为预编译语言，给出的推荐主题定制方案全部都是复写全部主题样式的解决办法，和 element-ui 一致。</p>
<div class="gatsby-highlight" data-language="less"><pre class="language-less"><code class="language-less"><span class="token variable">@import</span> <span class="token string">"~iview/src/styles/index.less"</span><span class="token punctuation">;</span>

<span class="token comment">// Here are the variables to cover, such as:</span>
<span class="token variable">@primary-color<span class="token punctuation">:</span></span> #8c0776<span class="token punctuation">;</span></code></pre></div>
<blockquote>
<p>因为 Less 和 Scss 变量作用域定义不一样，上面两个<code class="language-text">@import</code>写法会有些不同，但都是一个意思。</p>
</blockquote>
<p>需要注意的是，这种方式已经载入了所有组件的样式，不需要也无法和按需加载插件<a href="https://www.npmjs.com/package/babel-plugin-import" target="_target" rel="nofollow">babel-plugin-import</a>或<a href="https://www.npmjs.com/package/babel-plugin-component" target="_target" rel="nofollow">babel-plugin-component</a>的 style 属性一起使用。</p>
<h4 id="2-通过预处理器注入主题变量" style="position:relative;"><a href="#2-%E9%80%9A%E8%BF%87%E9%A2%84%E5%A4%84%E7%90%86%E5%99%A8%E6%B3%A8%E5%85%A5%E4%B8%BB%E9%A2%98%E5%8F%98%E9%87%8F" aria-label="2 通过预处理器注入主题变量 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 通过预处理器注入主题变量</h4>
<h5 id="less-1" style="position:relative;"><a href="#less-1" aria-label="less 1 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Less</h5>
<p>这里值得一提的是 Antd 组件库，这是我强烈推荐使用的组件库。它推荐使用<a href="https://ant.design/docs/react/customize-theme-cn" target="_target" rel="nofollow">修改主题变量</a>的方式定制主题，使用了 Less 的 <a href="http://lesscss.org/usage/#using-less-in-the-browser-modify-variables" target="_target" rel="nofollow"><strong>modifyVars</strong></a> 的方式来覆盖主题变量。比如将主题挂在<code class="language-text">package.json</code>上：</p>
<div class="gatsby-highlight" data-language="json"><pre class="language-json"><code class="language-json"><span class="token property">"theme"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token property">"primary-color"</span><span class="token operator">:</span> <span class="token string">"#1DA57A"</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span></code></pre></div>
<p>这个方案之前在我做的项目中有使用，自己根据实现原理写逻辑代码不是很难。</p>
<p>问题点是：每次修改变量都需要重启 dev 服务，刚开始对开发者不是很友好。当然，主题修改好后，并不是经常变动，这里可以原谅。</p>
<h5 id="scss-1" style="position:relative;"><a href="#scss-1" aria-label="scss 1 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>SCSS</h5>
<p>其实 SCSS 也能通过<strong>只修改主题变量</strong>的方式更改主题，这个是在读 IONIC 源码时发现的，<a href="https://github.com/ionic-team/ionic-app-scripts/blob/427e556460265da817a5975567ded2a00e5cb8bd/src/sass.ts#L137" target="_target" rel="nofollow">源码位置</a>。它是通过<a href="https://github.com/sass/node-sass" target="_target" rel="nofollow">node-sass</a>的<a href="https://github.com/sass/node-sass#data" target="_target" rel="nofollow"><strong>options.data</strong></a>的方式覆盖主题。比如传入如下字符串：</p>
<div class="gatsby-highlight" data-language="scss"><pre class="language-scss"><code class="language-scss"><span class="token string">'@charset "UTF-8"; @import "/xxx/xxx/project/to/theme/path/variables.scss";'</span></code></pre></div>
<p>构建时启用你定义的样式变量。我这里简单写了一个变量获取方式，<a href="https://github.com/vm-component/vimo/blob/master/examples/build/get-scss-variables.js" target="_target" rel="nofollow">代码</a>。</p>
<p>注意，这里需要你样式组件中的所有变量后都带上<code class="language-text">!default</code>修饰，将生效等级降为最低。这里没有 Less 那样需要重启 dev-server 的问题，通过 webpack 构建，修改了引入的主题文件，项目将自动重构，较为方便。</p>
<h3 id="总结" style="position:relative;"><a href="#%E6%80%BB%E7%BB%93" aria-label="总结 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>总结</h3>
<p>建议通过修改变量的方式来修改主题我认为是比较靠谱的，当主题与公司 UI 不符时，再使用样式复写的方式处理。</p>
<blockquote>
<p>个人还是比较喜欢 SCSS 的处理方式。</p>
</blockquote>]]></description><link>https://xiangst0816.github.io/blog/guan-yu-zu-jian-ku-de-di-zhu-ti-ding-zhi/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/guan-yu-zu-jian-ku-de-di-zhu-ti-ding-zhi/</guid><category><![CDATA[组件库]]></category><category><![CDATA[主题]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Tue, 05 Dec 2017 01:23:52 GMT</pubDate></item><item><title><![CDATA[关于Babel最新使用方式]]></title><description><![CDATA[<blockquote>
<p>文章总结的时间是 2017/11/20</p>
</blockquote>
<p>本文是为了梳理 Babel 配置及使用而整理，因为看过使用 Babel 配置项目和文章，存在项目插件使用混乱、文章各种照搬、插件使用听风是雨、插件升级文章内容不再适用的问题。这里就目前最新使用的配置组合进行整理，涉及的插件包括以下三个：</p>
<ul>
<li>@babel/preset-env(^7.0.0-beta.32)</li>
<li>@babel/preset-stage-x(7.0.0-beta.32), x-0,1,2,3</li>
<li>@babel/polyfill(^7.0.0-beta.32)</li>
</ul>
<h2 id="babelpreset-env" style="position:relative;"><a href="#babelpreset-env" aria-label="babelpreset env permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>@babel/preset-env</h2>
<h3 id="特性" style="position:relative;"><a href="#%E7%89%B9%E6%80%A7" aria-label="特性 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>特性</h3>
<h4 id="替换之前所有code-classlanguage-textbabel-presets-es20xxcode插件" style="position:relative;"><a href="#%E6%9B%BF%E6%8D%A2%E4%B9%8B%E5%89%8D%E6%89%80%E6%9C%89code-classlanguage-textbabel-presets-es20xxcode%E6%8F%92%E4%BB%B6" aria-label="替换之前所有code classlanguage textbabel presets es20xxcode插件 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>替换之前所有<code class="language-text">babel-presets-es20xx</code>插件</h4>
<blockquote>
<p>A Babel preset that compiles ES2015+ down to ES5 by automatically determining the Babel plugins and polyfills you need based on your targeted browser or runtime environments.</p>
</blockquote>
<p>也就是说，这是一个能根据运行环境为代码做相应的编译，<code class="language-text">@babel/preset-env</code>的推出是为了解解决个性化输出目标代码的问题，通过<code class="language-text">browserslist</code>语法解析需要支持的目标环境，根据环境将源代码转义到目标代码，可以实现代码精准适配。</p>
<p>此外，<strong><code class="language-text">@babel/preset-env</code>不包含<code class="language-text">state-x</code>一些列插件</strong>，只支持最新推出版本的 JavaScript 语法（state-4），关于<code class="language-text">state-x</code>后面会介绍。</p>
<p>更进一步说明，请参考<a href="http://2ality.com/2017/02/babel-preset-env.html" target="_target" rel="nofollow">Dr. Axel Rauschmayer</a>的介绍。这个插件对特殊平台的开发有很大帮助，比如：Electron、大屏、移动端(只考虑 webkit)等。</p>
<h4 id="替换code-classlanguage-textbabelplugin-transform-runtimecode的使用" style="position:relative;"><a href="#%E6%9B%BF%E6%8D%A2code-classlanguage-textbabelplugin-transform-runtimecode%E7%9A%84%E4%BD%BF%E7%94%A8" aria-label="替换code classlanguage textbabelplugin transform runtimecode的使用 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>替换<code class="language-text">@babel/plugin-transform-runtime</code>的使用</h4>
<p><code class="language-text">@babel/plugin-transform-runtime</code>插件是为了解决：</p>
<ul>
<li>多个文件重复引用相同 helpers（帮助函数）-> 提取运行时</li>
<li>新 API 方法全局污染 -> 局部引入</li>
</ul>
<p>这个插件推荐在编写 library/module 时使用。当然，以上问题可通过设置<code class="language-text">useBuiltIns</code>搞定。</p>
<h4 id="支持实例方法按需引入" style="position:relative;"><a href="#%E6%94%AF%E6%8C%81%E5%AE%9E%E4%BE%8B%E6%96%B9%E6%B3%95%E6%8C%89%E9%9C%80%E5%BC%95%E5%85%A5" aria-label="支持实例方法按需引入 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>支持实例方法按需引入</h4>
<p>传统方式是手动从<code class="language-text">core-js</code>引入需要的 ES6+特性，</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'core-js/fn/set'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'core-js/fn/array/from'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'core-js/fn/array/find-index'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">...</span>
<span class="token operator">...</span></code></pre></div>
<p>或者一股脑全部引入：</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token string">"@babel/polyfill"</span><span class="token punctuation">;</span>
<span class="token comment">// or</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"@babel/polyfill"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>同样，以上问题可通过设置<code class="language-text">useBuiltIns</code>搞定。</p>
<h3 id="使用说明" style="position:relative;"><a href="#%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E" aria-label="使用说明 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>使用说明</h3>
<p>默认情况下，<code class="language-text">@babel/preset-env</code>的效果和<code class="language-text">@babel/preset-latest</code>一样，虽然上面的说明有提到 polyfills，但是也需要在配置中设置<code class="language-text">useBuiltIns</code>才会生效。</p>
<h3 id="主要配置" style="position:relative;"><a href="#%E4%B8%BB%E8%A6%81%E9%85%8D%E7%BD%AE" aria-label="主要配置 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>主要配置</h3>
<h4 id="targets" style="position:relative;"><a href="#targets" aria-label="targets permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>targets</h4>
<p><strong>设置支持环境</strong>，支持的<code class="language-text">key</code>包括：chrome, opera, edge, firefox, safari, ie, ios, android, node, electron。</p>
<p>例如：</p>
<div class="gatsby-highlight" data-language="json"><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"presets"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span>
      <span class="token string">"@babel/env"</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"targets"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"node"</span><span class="token operator">:</span> <span class="token string">"current"</span><span class="token punctuation">,</span>
          <span class="token property">"chrome"</span><span class="token operator">:</span> <span class="token number">52</span><span class="token punctuation">,</span>
          <span class="token property">"browsers"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"last 2 versions"</span><span class="token punctuation">,</span> <span class="token string">"safari 7"</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span></code></pre></div>
<p>其中，<strong><code class="language-text">browserslist</code>可在<code class="language-text">package.json</code>中配置</strong>，这个和设置 CSS 的 Autoprefixer 一致，配置优先级如下：</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">targets.browsers &gt; package.json/browserslist</code></pre></div>
<p>此外，<strong><code class="language-text">browserslist</code>的配置满足最大匹配原则</strong>，比如需要同时支持在 IE 8 和 Chrome 55 下运行，则<code class="language-text">preset-env</code>提供所有 IE 8 下需要的插件，即使 Chrome 55 可能不需要。</p>
<h4 id="modules" style="position:relative;"><a href="#modules" aria-label="modules permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>modules</h4>
<p>选项用于模块转化规则设置，可选配置包括：“amd” | “umd” | “systemjs” | “commonjs” | false, 默认使用 “commonjs”。即，将代码中的 ES6 的<code class="language-text">import</code>转为<code class="language-text">require</code>。</p>
<p>如果你当前的 webpack 构建环境是 2.x/3.x，推荐将<code class="language-text">modules</code>设置为<code class="language-text">false</code>，即交由 Webpack 来处理模块化，通过其 TreeShaking 特性将有效减少打包出来的 JS 文件大小。这部分参考这里的回答：<a href="https://www.zhihu.com/question/27917401/answer/223309781" target="_target" rel="nofollow">ECMAScript 6 的模块相比 CommonJS 的 require (…)有什么优点？</a></p>
<h4 id="usebuiltins" style="position:relative;"><a href="#usebuiltins" aria-label="usebuiltins permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>useBuiltIns</h4>
<blockquote>
<p>A way to apply @babel/preset-env for polyfills (via @babel/polyfill).</p>
</blockquote>
<p>可选值包括：“usage” | “entry” | false, 默认为 false，表示不对 polyfills 处理，<strong>这个配置是引入 polyfills 的关键</strong>。</p>
<h5 id="usebuiltinsusage" style="position:relative;"><a href="#usebuiltinsusage" aria-label="usebuiltinsusage permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>“useBuiltIns”:“usage”</h5>
<p>在文件需要的位置单独按需引入，可以保证在每个 bundler 中只引入一份。例如：</p>
<p><strong>In</strong></p>
<p>a.js</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>b.js</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p><strong>Out (if environment doesn’t support it)</strong></p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token string">"core-js/modules/es6.promise"</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token string">"core-js/modules/es6.map"</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p><strong>Out (if environment supports it)</strong></p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p><strong>！！注意！！</strong></p>
<p>当前模式类似于<code class="language-text">@babel/plugin-transform-runtime</code>，polyfill 局部使用，制造一个沙盒环境，不造成全局污染，但是如上配置后，<strong><code class="language-text">@babel/preset-env</code>能按需引入新实例方法</strong>，例如：</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token string">"foobar"</span><span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">"foo"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>而<code class="language-text">@babel/plugin-transform-runtime</code>不行，需要自行从<code class="language-text">core-js</code>中按需引入。我测试的情况和下面这篇文章所说完全不一致。</p>
<blockquote>
<p>原文：<a href="https://zhuanlan.zhihu.com/p/29506685" target="_target" rel="nofollow">https://zhuanlan.zhihu.com/p/29506685</a></p>
<p>当 useBuiltIns 设置为 usage 时，Babel 会在你使用到 ES2015+ 新特性时，自动添加 babel-polyfill 的引用，并且是 partial 级别的引用。</p>
<blockquote>
<p>请注意： usage 的行为类似 babel-transform-runtime，不会造成全局污染，<strong>因此也会不会对类似 Array.prototype.includes() 进行 polyfill</strong>。</p>
</blockquote>
</blockquote>
<h5 id="usebuiltinsentry" style="position:relative;"><a href="#usebuiltinsentry" aria-label="usebuiltinsentry permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>“useBuiltIns”:“entry”</h5>
<p>在项目入口引入一次（多次引入会报错）</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token string">"@babel/polyfill"</span><span class="token punctuation">;</span>
<span class="token comment">// or</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"@babel/polyfill"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>插件<code class="language-text">@babel/preset-env</code>会将把<code class="language-text">@babel/polyfill</code>根据实际需求<strong>打散</strong>，只留下必须的，例如：</p>
<p><strong>In</strong></p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token string">"@babel/polyfill"</span><span class="token punctuation">;</span></code></pre></div>
<p><strong>Out (different based on environment)</strong></p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> <span class="token string">"core-js/modules/es6.promise"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">"core-js/modules/es7.string.pad-start"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">"core-js/modules/es7.string.pad-end"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">"core-js/modules/es7.array.includes"</span><span class="token punctuation">;</span></code></pre></div>
<blockquote>
<p>除了新 API，也可以是实例方法，不过最终包体积比使用<code class="language-text">&quot;useBuiltIns&quot;:&quot;usage&quot;</code>大 30kb 左右（因项目而异）。</p>
</blockquote>
<h5 id="usebuiltins-false" style="position:relative;"><a href="#usebuiltins-false" aria-label="usebuiltins false permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>“useBuiltIns”: false</h5>
<p>不在代码中使用 polyfills，表现形式和<code class="language-text">@babel/preset-latest</code>一样，当使用 ES6+语法及 API 时，在不支持的环境下会报错。</p>
<h2 id="babelpreset-stage-x" style="position:relative;"><a href="#babelpreset-stage-x" aria-label="babelpreset stage x permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>@babel/preset-stage-x</h2>
<p>这里需要说明下 ES 特性支持的提案，不同阶段的提案支持的内容不同，其中<code class="language-text">stage-4</code>阶段提案中的特性将会在未来发布。</p>
<p>关于各个 Stage 的说明参考<a href="http://babeljs.io/docs/plugins#stage-x-experimental-presets" target="_target" rel="nofollow">这里</a>。上面介绍的<code class="language-text">@babel/preset-env</code>或者<code class="language-text">@babel/preset-latest</code>就是下面提到的<code class="language-text">stage-4</code>。</p>
<blockquote>
<p>The TC39 categorizes proposals into the following stages:</p>
<ul>
<li>Stage 0 - Strawman: just an idea, possible Babel plugin.</li>
<li>Stage 1 - Proposal: this is worth working on.</li>
<li>Stage 2 - Draft: initial spec.</li>
<li>Stage 3 - Candidate: complete spec and initial browser implementations.</li>
<li>Stage 4 - Finished: will be added to the next yearly release.</li>
</ul>
</blockquote>
<p>Stage 的包含顺序是：<strong>左边包含右边全部特性，即 stage-0 包含右边 1 / 2 / 3 的所有插件。</strong></p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">stage-0 &gt; ~1 &gt; ~2 &gt; ~3 &gt; ~4:</code></pre></div>
<h3 id="疑问" style="position:relative;"><a href="#%E7%96%91%E9%97%AE" aria-label="疑问 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>疑问</h3>
<h4 id="1-这个和code-classlanguage-textbabelpreset-envcode的区别" style="position:relative;"><a href="#1-%E8%BF%99%E4%B8%AA%E5%92%8Ccode-classlanguage-textbabelpreset-envcode%E7%9A%84%E5%8C%BA%E5%88%AB" aria-label="1 这个和code classlanguage textbabelpreset envcode的区别 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 这个和<code class="language-text">@babel/preset-env</code>的区别</h4>
<p><code class="language-text">@babel/preset-env</code>会根据预设的浏览器兼容列表从<code class="language-text">stage-4</code>选取必须的 plugin，也就是说，不引入别的<code class="language-text">stage-x</code>，<code class="language-text">@babel/preset-env</code>将只支持到<code class="language-text">stage-4</code>。</p>
<h3 id="建议" style="position:relative;"><a href="#%E5%BB%BA%E8%AE%AE" aria-label="建议 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>建议</h3>
<h4 id="1-如果是-react-用户，建议配到code-classlanguage-textbabelpreset-stage-0code" style="position:relative;"><a href="#1-%E5%A6%82%E6%9E%9C%E6%98%AF-react-%E7%94%A8%E6%88%B7%EF%BC%8C%E5%BB%BA%E8%AE%AE%E9%85%8D%E5%88%B0code-classlanguage-textbabelpreset-stage-0code" aria-label="1 如果是 react 用户，建议配到code classlanguage textbabelpreset stage 0code permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 如果是 React 用户，建议配到<code class="language-text">@babel/preset-stage-0</code></h4>
<p>其中的两个插件对于写 JSX 很有帮助。</p>
<ul>
<li>transform-do-expressions：if/else 三目运算展开</li>
<li>transform-function-bind：this 绑定</li>
</ul>
<h4 id="2-通常使用建议配到code-classlanguage-textbabelpreset-stage-2code" style="position:relative;"><a href="#2-%E9%80%9A%E5%B8%B8%E4%BD%BF%E7%94%A8%E5%BB%BA%E8%AE%AE%E9%85%8D%E5%88%B0code-classlanguage-textbabelpreset-stage-2code" aria-label="2 通常使用建议配到code classlanguage textbabelpreset stage 2code permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 通常使用建议配到<code class="language-text">@babel/preset-stage-2</code></h4>
<p>插件包括：</p>
<ul>
<li>syntax-dynamic-import： 动态 import</li>
<li>transform-class-properties：用于 class 的属性转化</li>
<li>transform-object-rest-spread：用来处理 rest spread</li>
<li>transform-async-generator-functions：用来处理 async 和 await</li>
</ul>
<h2 id="babelpolyfill" style="position:relative;"><a href="#babelpolyfill" aria-label="babelpolyfill permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>@babel/polyfill</h2>
<p>这个插件是对<a href="https://www.npmjs.com/package/core-js" target="_target" rel="nofollow">core-js</a>和<a href="https://www.npmjs.com/package/regenerator-runtime" target="_target" rel="nofollow">regenerator-runtime</a>的再次封装，在<code class="language-text">@babel/preset-env</code>中的<code class="language-text">useBuiltIns: entry</code>用到，<a href="https://github.com/babel/babel/blob/master/packages/babel-polyfill/src/index.js" target="_target" rel="nofollow">代码不多</a>。</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">if</span> <span class="token punctuation">(</span>global<span class="token punctuation">.</span>_babelPolyfill<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">"only one instance of @babel/polyfill is allowed"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
global<span class="token punctuation">.</span>_babelPolyfill <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token string">"core-js/shim"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">"regenerator-runtime/runtime"</span><span class="token punctuation">;</span></code></pre></div>
<p><strong>core-js/shim</strong></p>
<blockquote>
<p>shim only: Only includes the standard methods.</p>
</blockquote>
<p>只包含了纳入标准的<strong>API</strong>及<strong>实例化方法</strong>，例如下列常见的。注意，这里没有 generator/async，如果需要，那就安装插件<code class="language-text">@babel/preset-stage-3</code>（或者 0 / 1 / 2）</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token operator">...</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./modules/es6.string.trim'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./modules/es6.string.includes'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./modules/es7.array.includes'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./modules/es6.promise'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">...</span></code></pre></div>
<p><strong>regenerator-runtime/runtime</strong></p>
<blockquote>
<p>Standalone runtime for Regenerator-compiled generator and async functions.</p>
</blockquote>
<p>主要是给 generator/async 做支持的插件。</p>
<h2 id="总结" style="position:relative;"><a href="#%E6%80%BB%E7%BB%93" aria-label="总结 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>总结</h2>
<p>这里需要理解下三个概念：</p>
<ul>
<li>最新 ES 语法：比如，箭头函数</li>
<li>最新 ES API：，比如，Promise</li>
<li>最新 ES 实例方法：比如，String.protorype.includes</li>
</ul>
<p><code class="language-text">@babel/preset-env</code>默认支持<strong>语法</strong>转化，需要开启<code class="language-text">useBuiltIns</code>配置才能转化<strong>API</strong>和<strong>实例方法</strong>。</p>
<p>此外，不管是写项目还是写 Library/Module，使用<code class="language-text">@babel/preset-env</code>并正确配置就行。多看英文原稿说明，中文总结看看就好，别太当真。</p>
<h2 id="参考" style="position:relative;"><a href="#%E5%8F%82%E8%80%83" aria-label="参考 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>参考</h2>
<ul>
<li><a href="https://www.npmjs.com/package/@babel/preset-env" target="_target" rel="nofollow">@babel/preset-env</a></li>
<li><a href="https://www.npmjs.com/package/@babel/preset-stage-0" target="_target" rel="nofollow">@babel/preset-stage-0</a></li>
<li><a href="https://www.npmjs.com/package/@babel/preset-stage-1" target="_target" rel="nofollow">@babel/preset-stage-1</a></li>
<li><a href="https://www.npmjs.com/package/@babel/preset-stage-2" target="_target" rel="nofollow">@babel/preset-stage-2</a></li>
<li><a href="https://www.npmjs.com/package/@babel/preset-stage-3" target="_target" rel="nofollow">@babel/preset-stage-3</a></li>
<li><a href="https://www.cnblogs.com/chris-oil/p/5717544.html" target="_target" rel="nofollow">stage 的区别</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/25961891" target="_target" rel="nofollow">弄清楚 babel 的 stage</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/29506685" target="_target" rel="nofollow">再见，babel-preset-2015</a></li>
<li><a href="https://www.zhihu.com/question/27917401/answer/223309781" target="_target" rel="nofollow">ECMAScript 6 的模块相比 CommonJS 的 require (…)有什么优点？</a></li>
</ul>]]></description><link>https://xiangst0816.github.io/blog/guan-yu-Babel-zui-xin-shi-yong-fang-shi/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/guan-yu-Babel-zui-xin-shi-yong-fang-shi/</guid><category><![CDATA[Babel]]></category><category><![CDATA[JavaScript]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Sun, 19 Nov 2017 08:06:59 GMT</pubDate></item><item><title><![CDATA[TypeScript]]></title><description><![CDATA[<blockquote>
<p>代码详解 + 备忘记录</p>
</blockquote>
<h2 id="基础类型" style="position:relative;"><a href="#%E5%9F%BA%E7%A1%80%E7%B1%BB%E5%9E%8B" aria-label="基础类型 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>基础类型</h2>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// 布尔</span>
<span class="token keyword">let</span> isDone<span class="token operator">:</span> boolean <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token comment">// 数字</span>
<span class="token keyword">let</span> decLiteral<span class="token operator">:</span> number <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> hexLiteral<span class="token operator">:</span> number <span class="token operator">=</span> <span class="token number">0xf00d</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> binaryLiteral<span class="token operator">:</span> number <span class="token operator">=</span> <span class="token number">0b1010</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> octalLiteral<span class="token operator">:</span> number <span class="token operator">=</span> <span class="token number">0o744</span><span class="token punctuation">;</span>
<span class="token comment">// 字符串</span>
<span class="token keyword">let</span> name<span class="token operator">:</span> string <span class="token operator">=</span> <span class="token string">"bob"</span><span class="token punctuation">;</span>
<span class="token comment">// 数组</span>
<span class="token keyword">let</span> list<span class="token operator">:</span> number<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> list<span class="token operator">:</span> Array<span class="token operator">&lt;</span>number<span class="token operator">></span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 数组泛型，Array&lt;元素类型></span>
<span class="token keyword">let</span> list<span class="token operator">:</span> <span class="token punctuation">(</span>string <span class="token operator">|</span> number<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span>
<span class="token keyword">let</span> list<span class="token operator">:</span> any<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span>
<span class="token comment">// 对象</span>
<span class="token keyword">let</span> obj<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token punctuation">{</span>foo<span class="token operator">:</span><span class="token string">'foo'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 元组类型, 限定了值的pattern: 两个元素, 第一个是string, 第二个是number</span>
<span class="token keyword">let</span> x<span class="token operator">:</span> <span class="token punctuation">[</span>string<span class="token punctuation">,</span> number<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">// 多类型</span>
<span class="token keyword">let</span> x<span class="token operator">:</span> string <span class="token operator">|</span> number<span class="token punctuation">;</span>
<span class="token comment">// 枚举</span>
<span class="token keyword">enum</span> Color <span class="token punctuation">{</span>Red <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> Green<span class="token punctuation">,</span> Blue<span class="token punctuation">}</span>
<span class="token keyword">let</span> cRed<span class="token operator">:</span> Color <span class="token operator">=</span> Color<span class="token punctuation">.</span>Red<span class="token punctuation">;</span> <span class="token comment">// 1</span>
<span class="token keyword">let</span> colorName<span class="token operator">:</span> string <span class="token operator">=</span> Color<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// Green</span>
<span class="token comment">// Any</span>
<span class="token keyword">let</span> notSure<span class="token operator">:</span> any <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
<span class="token comment">// Void 表示没有任何类型, 多用于函数返回</span>
<span class="token keyword">function</span> <span class="token function">warnUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">"This is my warning message"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// Null 和 Undefined, 常用在联合类型, 一般不建议使用</span>
<span class="token keyword">let</span> u<span class="token operator">:</span> <span class="token keyword">undefined</span> <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> n<span class="token operator">:</span> <span class="token keyword">null</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token comment">// Never, 表示的是那些永不存在的值的类型</span>
<span class="token keyword">function</span> <span class="token function">error</span><span class="token punctuation">(</span><span class="token parameter">message<span class="token operator">:</span> string</span><span class="token punctuation">)</span><span class="token operator">:</span> never <span class="token punctuation">{</span>
    <span class="token comment">// 返回never的函数必须存在无法达到的终点</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 类型断言</span>
<span class="token operator">-</span> “尖括号”语法
<span class="token keyword">let</span> someValue<span class="token operator">:</span> any <span class="token operator">=</span> <span class="token string">"this is a string"</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> strLength<span class="token operator">:</span> number <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">&lt;</span>string<span class="token operator">></span>someValue<span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>
<span class="token operator">-</span> <span class="token keyword">as</span>语法
<span class="token keyword">let</span> someValue<span class="token operator">:</span> any <span class="token operator">=</span> <span class="token string">"this is a string"</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> strLength<span class="token operator">:</span> number <span class="token operator">=</span> <span class="token punctuation">(</span>someValue <span class="token keyword">as</span> string<span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>

<span class="token comment">// 解构模式标记类型</span>
<span class="token keyword">let</span> <span class="token punctuation">{</span>a<span class="token punctuation">,</span> b<span class="token punctuation">}</span><span class="token operator">:</span> <span class="token punctuation">{</span>a<span class="token operator">:</span> string<span class="token punctuation">,</span> b<span class="token operator">:</span> number<span class="token punctuation">}</span> <span class="token operator">=</span> o<span class="token punctuation">;</span></code></pre></div>
<h2 id="变量声明" style="position:relative;"><a href="#%E5%8F%98%E9%87%8F%E5%A3%B0%E6%98%8E" aria-label="变量声明 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>变量声明</h2>
<ul>
<li>尽量使用<code class="language-text">let</code>, ‘const’替换<code class="language-text">var</code></li>
<li>解构和 es6 相同, 注意: <code class="language-text">默认值 + 类型 + 解构</code> 的组合写法</li>
</ul>
<h2 id="接口" style="position:relative;"><a href="#%E6%8E%A5%E5%8F%A3" aria-label="接口 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>接口</h2>
<blockquote>
<p>TypeScript 的核心原则之一是对值所具有的结构进行类型检查。</p>
</blockquote>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// 可选属性</span>
<span class="token keyword">interface</span> <span class="token class-name">SquareConfig</span> <span class="token punctuation">{</span>
  color<span class="token operator">?</span><span class="token operator">:</span> string<span class="token punctuation">;</span>
  width<span class="token operator">?</span><span class="token operator">:</span> number<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 只读属性</span>
<span class="token keyword">interface</span> <span class="token class-name">Point</span> <span class="token punctuation">{</span>
    readonly x<span class="token operator">:</span> number<span class="token punctuation">;</span>
    readonly y<span class="token operator">:</span> number<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 额外的属性</span>
<span class="token keyword">interface</span> <span class="token class-name">SquareConfig</span> <span class="token punctuation">{</span>
    color<span class="token operator">?</span><span class="token operator">:</span> string<span class="token punctuation">;</span>
    width<span class="token operator">?</span><span class="token operator">:</span> number<span class="token punctuation">;</span>
    <span class="token punctuation">[</span>propName<span class="token operator">:</span> string<span class="token punctuation">]</span><span class="token operator">:</span> any<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 函数类型, 定义调用签名, 只做类型检查(不是函数名)</span>
<span class="token keyword">interface</span> <span class="token class-name">SearchFunc</span> <span class="token punctuation">{</span>
  <span class="token punctuation">(</span>source<span class="token operator">:</span> string<span class="token punctuation">,</span> subString<span class="token operator">:</span> string<span class="token punctuation">)</span><span class="token operator">:</span> boolean<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 可索引的类型</span>
<span class="token keyword">interface</span> <span class="token class-name">StringArray</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span>index<span class="token operator">:</span> number<span class="token punctuation">]</span><span class="token operator">:</span> string<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 类类型</span>
<span class="token keyword">interface</span> <span class="token class-name">ClockInterface</span> <span class="token punctuation">{</span>
    currentTime<span class="token operator">:</span> Date<span class="token punctuation">;</span>
    <span class="token keyword">new</span> <span class="token punctuation">(</span>hour<span class="token operator">:</span> number<span class="token punctuation">,</span> minute<span class="token operator">:</span> number<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setTime</span><span class="token punctuation">(</span>d<span class="token operator">:</span> Date<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Clock</span> <span class="token keyword">implements</span> <span class="token class-name">ClockInterface</span> <span class="token punctuation">{</span>
    currentTime<span class="token operator">:</span> Date<span class="token punctuation">;</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">h<span class="token operator">:</span> number<span class="token punctuation">,</span> m<span class="token operator">:</span> number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
    <span class="token function">setTime</span><span class="token punctuation">(</span><span class="token parameter">d<span class="token operator">:</span> Date</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>currentTime <span class="token operator">=</span> d<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 继承接口</span>
<span class="token keyword">interface</span> <span class="token class-name">Shape</span> <span class="token punctuation">{</span>
    color<span class="token operator">:</span> string<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">interface</span> <span class="token class-name">Square</span> <span class="token punctuation">{</span>
    sideLength<span class="token operator">:</span> number<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">interface</span> <span class="token class-name">Foo</span> <span class="token keyword">extends</span> <span class="token class-name">Square</span><span class="token punctuation">,</span> Shape <span class="token punctuation">{</span>
    FooLength<span class="token operator">:</span> number<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 接口集成类(未写)</span></code></pre></div>
<h2 id="类" style="position:relative;"><a href="#%E7%B1%BB" aria-label="类 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>类</h2>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// 类</span>
<span class="token keyword">class</span> <span class="token class-name">Greeter</span> <span class="token punctuation">{</span>
    greeting<span class="token operator">:</span> string<span class="token punctuation">;</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">message<span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>greeting <span class="token operator">=</span> message<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">greet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">"Hello, "</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>greeting<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> greeter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Greeter</span><span class="token punctuation">(</span><span class="token string">"world"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 继承</span>
<span class="token keyword">class</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span>string<span class="token punctuation">;</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">theName<span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> theName<span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token function">move</span><span class="token punctuation">(</span><span class="token parameter">distanceInMeters<span class="token operator">:</span> number <span class="token operator">=</span> <span class="token number">0</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> moved </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>distanceInMeters<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">m.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Snake</span> <span class="token keyword">extends</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token function">move</span><span class="token punctuation">(</span><span class="token parameter">distanceInMeters <span class="token operator">=</span> <span class="token number">5</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Slithering..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">move</span><span class="token punctuation">(</span>distanceInMeters<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 公共，私有与受保护的修饰符</span>
<span class="token comment">// 默认public</span>
<span class="token comment">// private 只在'当前类'的内部访问</span>
<span class="token keyword">class</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> name<span class="token operator">:</span> string<span class="token punctuation">;</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">theName<span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> theName<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// protected 只在'当前类及其子类'的内部访问</span>
<span class="token comment">// 如果构造函数也可以被标记成protected, 意味着这个类不能实例化, 只能由子类实例化</span>
<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
    <span class="token keyword">protected</span> name<span class="token operator">:</span> string<span class="token punctuation">;</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// readonly修饰符 只读, 只能在构造函数中被初始化</span>
<span class="token keyword">class</span> <span class="token class-name">Octopus</span> <span class="token punctuation">{</span>
    readonly name<span class="token operator">:</span> string<span class="token punctuation">;</span>
    readonly numberOfLegs<span class="token operator">:</span> number <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span>
    <span class="token function">constructor</span> <span class="token punctuation">(</span><span class="token parameter">theName<span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> theName<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 存取器(拦截器)</span>
<span class="token keyword">class</span> <span class="token class-name">Employee</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> _fullName<span class="token operator">:</span> string<span class="token punctuation">;</span>

    <span class="token keyword">get</span> <span class="token function">fullName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> string <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_fullName<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">set</span> <span class="token function">fullName</span><span class="token punctuation">(</span><span class="token parameter">newName<span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>passcode <span class="token operator">&amp;&amp;</span> passcode <span class="token operator">==</span> <span class="token string">"secret passcode"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>_fullName <span class="token operator">=</span> newName<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Error: Unauthorized update of employee!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 静态属性: 这些属性存在于类本身上面而不是类的实例上, 通过Grid.访问</span>
<span class="token keyword">class</span> <span class="token class-name">Grid</span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> origin <span class="token operator">=</span> <span class="token punctuation">{</span>x<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token function">calculateDistanceFromOrigin</span><span class="token punctuation">(</span><span class="token parameter">point<span class="token operator">:</span> <span class="token punctuation">{</span>x<span class="token operator">:</span> number<span class="token punctuation">;</span> y<span class="token operator">:</span> number<span class="token punctuation">;</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> xDist <span class="token operator">=</span> <span class="token punctuation">(</span>point<span class="token punctuation">.</span>x <span class="token operator">-</span> Grid<span class="token punctuation">.</span>origin<span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> yDist <span class="token operator">=</span> <span class="token punctuation">(</span>point<span class="token punctuation">.</span>y <span class="token operator">-</span> Grid<span class="token punctuation">.</span>origin<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> Math<span class="token punctuation">.</span><span class="token function">sqrt</span><span class="token punctuation">(</span>xDist <span class="token operator">*</span> xDist <span class="token operator">+</span> yDist <span class="token operator">*</span> yDist<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token keyword">this</span><span class="token punctuation">.</span>scale<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">constructor</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token keyword">public</span> scale<span class="token operator">:</span> number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> grid1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Grid</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 1x scale</span>
<span class="token keyword">let</span> grid2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Grid</span><span class="token punctuation">(</span><span class="token number">5.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 5x scale</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>grid1<span class="token punctuation">.</span><span class="token function">calculateDistanceFromOrigin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>x<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>grid2<span class="token punctuation">.</span><span class="token function">calculateDistanceFromOrigin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>x<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 抽象类</span>
<span class="token comment">// 构造函数</span>
<span class="token comment">// 把类当做接口使用</span></code></pre></div>
<h2 id="函数" style="position:relative;"><a href="#%E5%87%BD%E6%95%B0" aria-label="函数 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>函数</h2>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// 函数类型</span>
<span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token operator">:</span> number<span class="token punctuation">,</span> y<span class="token operator">:</span> number</span><span class="token punctuation">)</span><span class="token operator">:</span> number <span class="token punctuation">{</span>
    <span class="token keyword">return</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 可选参数和默认参数</span>
<span class="token keyword">function</span> <span class="token function">buildName</span><span class="token punctuation">(</span><span class="token parameter">firstName<span class="token operator">:</span> string<span class="token punctuation">,</span> lastName<span class="token operator">?</span><span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">buildName</span><span class="token punctuation">(</span>firstName<span class="token operator">:</span> string<span class="token punctuation">,</span> lastName <span class="token operator">=</span> <span class="token string">"Smith"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
<span class="token comment">// 剩余参数</span>
<span class="token keyword">function</span> <span class="token function">buildName</span><span class="token punctuation">(</span><span class="token parameter">firstName<span class="token operator">:</span> string<span class="token punctuation">,</span> <span class="token operator">...</span>restOfName<span class="token operator">:</span> string<span class="token punctuation">[</span><span class="token punctuation">]</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> firstName <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> restOfName<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// this参数</span>
<span class="token comment">// noImplicitThis标记: 提供指定类型的this假参数</span>
<span class="token comment">// this参数在回调函数里: 将this类型设置为void避免函数内部使用this</span>

<span class="token comment">// 重载</span>
<span class="token keyword">function</span> <span class="token function">pickCard</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token operator">:</span> <span class="token punctuation">{</span>suit<span class="token operator">:</span> string<span class="token punctuation">;</span> card<span class="token operator">:</span> number<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span><span class="token punctuation">)</span><span class="token operator">:</span> number<span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">pickCard</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token operator">:</span> number</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token punctuation">{</span>suit<span class="token operator">:</span> string<span class="token punctuation">;</span> card<span class="token operator">:</span> number<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">pickCard</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span><span class="token operator">:</span> any <span class="token punctuation">{</span>
    <span class="token comment">// Check to see if we're working with an object/array</span>
    <span class="token comment">// if so, they gave us the deck and we'll pick the card</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> x <span class="token operator">==</span> <span class="token string">"object"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> pickedCard <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> x<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> pickedCard<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// Otherwise just let them pick the card</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> x <span class="token operator">==</span> <span class="token string">"number"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> pickedSuit <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>x <span class="token operator">/</span> <span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span> suit<span class="token operator">:</span> suits<span class="token punctuation">[</span>pickedSuit<span class="token punctuation">]</span><span class="token punctuation">,</span> card<span class="token operator">:</span> x <span class="token operator">%</span> <span class="token number">13</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<h2 id="泛型" style="position:relative;"><a href="#%E6%B3%9B%E5%9E%8B" aria-label="泛型 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>泛型</h2>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// 定义类型变量T</span>
<span class="token keyword">function</span> identity<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">(</span>arg<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> arg<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>]]></description><link>https://xiangst0816.github.io/blog/TypeScript/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/TypeScript/</guid><category><![CDATA[TypeScript]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Mon, 07 Aug 2017 08:37:05 GMT</pubDate></item><item><title><![CDATA[deepLinks]]></title><description><![CDATA[<p>这个词我第一次是在<a href="http://ionicframework.com/docs/native/deeplinks/" target="_target" rel="nofollow">IONIC Deeplinks</a>中看到的，它表示在 H5 中使用一个链接（URL Scheme 或者 Universal Links）就能打开我们指定的 App。这样的需求可以参考下面的流程图：</p>
<p><figure class="gatsby-resp-image-figure" style="">
    <span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 465px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 141.9047619047619%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAcCAIAAADuuAg3AAAACXBIWXMAAAsSAAALEgHS3X78AAAB/klEQVQ4y5XV2W7aUBAGYL//u4EEF4AElCrs0LCEfUv61aNajrGpOhdHx+NZ/n8WO/n6Lp+plGo+Pj6m0+mvvzIajZLL5XI8Hk+nU97h8XjQX6/XfCA2y+Xy/f19Mpms1+vFYpFEGKr9fn+/3108bjab1WrFlJFH0W+3G2t6Ztvt9nA40CfCzGYz5263O5/PEWuSytvbG2wR1yvO8/k8g+2e0AovUoF8JMlrWI7HY5kwn6WSVBUMQ5zzr0DjgMtwOATnT8EKtSXoASI8uwAcQen5IwzwIZWkkNZJK4PAaMOJOX9RlM3FmSEqwiZqLudgMOCvSBk0F6/iMdiVOIdIrpAZHG6GBOx8aUtgM2o0Gu12u9frNZtNDQdVkVAVTqmQr4RNwhpnl0AYQwKOWOWZ86IqhrQws4XmlTgHePB05eullGfWkpgH6/HfzmqmWroVE/o8SOXOYadOsTCFVf135vDXmDzn/Eciu5Q7GwaEdQX+Wyoe+/0+Lt1uF6JKZy2BudVqmZNoNeb412q1er1ufoxAJK/sc2EljSc4ojizFlQ6M8pXK7aCxKjE/JTD5hmfC5xjDePDZM/g94qmsmBe/0zFRR4QxqnEwmiE6K9gW734hmScaU6puHh81WdNDs7Pv4FX+6ykP1LRWGds/+d3qXRm3el0DANn5cmcnzP/Bu0gWRc7IOvuAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="交互说明"
        title="交互说明"
        src="/blog/static/75a6a4144213c78b2e982259bbe40f2c/44d73/deeplinks.png"
        srcset="/blog/static/75a6a4144213c78b2e982259bbe40f2c/e1650/deeplinks.png 210w,
/blog/static/75a6a4144213c78b2e982259bbe40f2c/8cae7/deeplinks.png 420w,
/blog/static/75a6a4144213c78b2e982259bbe40f2c/44d73/deeplinks.png 465w"
        sizes="(max-width: 465px) 100vw, 465px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span>
    <figcaption class="gatsby-resp-image-figcaption">交互说明</figcaption>
  </figure></p>
<p>因此，结合这个需求，我介绍下<strong>DeepLinks 的概念和交互设计</strong>。</p>
<h2 id="deeplinks-的概念" style="position:relative;"><a href="#deeplinks-%E7%9A%84%E6%A6%82%E5%BF%B5" aria-label="deeplinks 的概念 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>DeepLinks 的概念</h2>
<p>在 H5 中点击链接跳转到 App 可以使用两个方式实现：<strong>URL Scheme 或者 Universal Links</strong>，URL Scheme 较为通用，Universal Links 为 IOS9.0+系统专属。</p>
<h3 id="url-scheme" style="position:relative;"><a href="#url-scheme" aria-label="url scheme permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>URL Scheme</h3>
<p>简单地说，就是使用这样的连接<code class="language-text">mycoolapp://path?foo=bar</code>开启你的 App，例如：</p>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mycoolapp://<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Open my app<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mycoolapp://somepath<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Open my app<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mycoolapp://somepath?foo=bar<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Open my app<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mycoolapp://?foo=bar<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Open my app<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span></code></pre></div>
<p>或者来一个真实的案例：</p>
<blockquote>
<p>使用手机模式在<strong>外部浏览器</strong>中打开，且安装了<code class="language-text">知乎</code>或者<code class="language-text">网易新闻</code>，否则点击会报错或者没反应。</p>
</blockquote>
<ul>
<li>知乎: 《JS 判断 APP 是否安装?》 - <a href="zhihu://questions/34831949?utm_campaign=ge19&#x26;utm_content=m_banner" target="_target" rel="nofollow">在「知乎」中打开</a></li>
<li>网易新闻: 《刘强东力挺顺丰：我相信王卫为人，质疑菜鸟违法》 - <a href="newsapp://doc/CLU0M6DS00097U7R?s=sps_ulink&#x26;ss=sps_article" target="_target" rel="nofollow">在「网易新闻」中打开</a></li>
</ul>
<h4 id="1-给-ios-的建议" style="position:relative;"><a href="#1-%E7%BB%99-ios-%E7%9A%84%E5%BB%BA%E8%AE%AE" aria-label="1 给 ios 的建议 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 给 IOS 的建议</h4>
<p>上面的这种方式对全系的 Android 和 IOS 系统都适用，但是对于 IOS9.0+在 Safari 中会存在以下问题（以知乎为例）：</p>
<p>在 Safari 中点击链接会弹出<code class="language-text">在“知乎”中打开？</code>的提示，且 JS 脚本此时不会中断，如果设置了<code class="language-text">setTimeout</code>等操作则完全达不到预期，因为不知道用户什么时候会点击<code class="language-text">打开</code>还是<code class="language-text">取消</code>。</p>
<p>因此，建议使用<strong>Universal Links</strong>式。当用户安装了 App 则流畅的跳转到 App 中，如果没安装则进入<strong>Universal Links</strong>所指向的位置，一般是下载中转页。</p>
<h4 id="2-给-android-的建议" style="position:relative;"><a href="#2-%E7%BB%99-android-%E7%9A%84%E5%BB%BA%E8%AE%AE" aria-label="2 给 android 的建议 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 给 Android 的建议</h4>
<p>这个问题和 IOS9.0+在 Safari 中出现的问题相同，一些安卓机会有<code class="language-text">ActionSheet</code>弹出提示是否进入 App 等选项，因此也会出现<code class="language-text">setTimeout</code>失效的问题。目前「知乎」的方式是：第一次尝试使用<strong>URL Scheme</strong>，1000ms 后 H5 跳转到下载中转页而不做其他处理。</p>
<h4 id="3-微信、微博、qq、支付宝等壳子会拦截-url-scheme" style="position:relative;"><a href="#3-%E5%BE%AE%E4%BF%A1%E3%80%81%E5%BE%AE%E5%8D%9A%E3%80%81qq%E3%80%81%E6%94%AF%E4%BB%98%E5%AE%9D%E7%AD%89%E5%A3%B3%E5%AD%90%E4%BC%9A%E6%8B%A6%E6%88%AA-url-scheme" aria-label="3 微信、微博、qq、支付宝等壳子会拦截 url scheme permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. 微信、微博、QQ、支付宝等壳子会拦截 URL Scheme</h4>
<p>拦截的意思是点击了这样的链接会毫无反应，上面的示例链接可以在微信中体验下。但是 IOS9.0+使用<code class="language-text">Universal Links</code>的方式上述平台是无法拦截的。因此，对于安卓用户只能跳转到<strong>下载中转页</strong>再做后续动作。</p>
<h4 id="4-url-scheme-命名规则" style="position:relative;"><a href="#4-url-scheme-%E5%91%BD%E5%90%8D%E8%A7%84%E5%88%99" aria-label="4 url scheme 命名规则 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. URL Scheme 命名规则</h4>
<ul>
<li>不要使用已存在的 scheme，比如：zhihu、twitter、newsapp、fb 等</li>
<li>使用小写字母</li>
<li>不要使用<code class="language-text">-</code>，因为安卓下会转化为<code class="language-text">_</code></li>
<li>使用一个单词且不加空格</li>
</ul>
<h4 id="5-建议" style="position:relative;"><a href="#5-%E5%BB%BA%E8%AE%AE" aria-label="5 建议 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>5. 建议</h4>
<p>建议让 IOS 和 Android 的小伙伴提供一致规则的<strong>URL Scheme</strong>规则。</p>
<h3 id="universal-links" style="position:relative;"><a href="#universal-links" aria-label="universal links permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Universal Links</h3>
<p>这个方法是专属 IOS9.0+的，简单来说就是一种能够方便的通过传统的 HTTP/HTTPS 链接来启动 App，使用相同的网址打开网站和 App。如果英语可以的话建议阅读下面的链接：</p>
<ul>
<li><a href="https://developer.apple.com/library/content/documentation/General/Conceptual/AppSearch/UniversalLinks.html" target="_target" rel="nofollow">Universal Links on iOS</a></li>
</ul>
<p>当用户点击链接时，如果安装了 App 则跳转到 App；如果没安装则打开链接指向的网址。相比于<strong>URL Scheme</strong>方案具有以下优点：</p>
<ul>
<li><strong>Unique</strong>：因为是使用的标准 HTTP or HTTPS 链接到自己的网站，因此别的应用无法伪造</li>
<li><strong>Secure</strong>：IOS 系统会检查放在自己服务器上的<code class="language-text">apple-app-site-association</code>文件，这个文件用于关联网站和 app 之间的联动关系</li>
<li><strong>Flexible</strong>：如果没安装应用，则点击<code class="language-text">Universal Links</code>会跳转到关联的网址，可以是主页也可以是下载引导页</li>
<li><strong>Simple</strong>：一个 URL 连接可以给 App 服务，也可是一个简单的网站</li>
<li><strong>Private</strong>：别的应用无法拦截这个过程，也无法知道后续是开启 App 还是跳转到 Safari</li>
</ul>
<h4 id="1-这里给两个示例：" style="position:relative;"><a href="#1-%E8%BF%99%E9%87%8C%E7%BB%99%E4%B8%A4%E4%B8%AA%E7%A4%BA%E4%BE%8B%EF%BC%9A" aria-label="1 这里给两个示例： permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 这里给两个示例：</h4>
<blockquote>
<p>使用 IOS 手机在任何 webview 中打开，且安装了<code class="language-text">知乎</code>或者<code class="language-text">网易新闻</code>，否则点击就会进入链接指向的网站。</p>
</blockquote>
<ul>
<li>知乎: 《JS 判断 APP 是否安装?》 - <a href="https://oia.zhihu.com/questions/34831949?utm_campaign=ge19" target="_target" rel="nofollow">在「知乎」中打开</a></li>
<li>网易新闻: 《刘强东力挺顺丰：我相信王卫为人，质疑菜鸟违法》 - <a href="http://m.163.com/newsapp/applinks.html?path=%2Fdoc%2FCLU0M6DS00097U7R&#x26;s=sps_ulink&#x26;ss=sps_article" target="_target" rel="nofollow">在「网易新闻」中打开</a></li>
</ul>
<h4 id="2-如何获得-ios-版本" style="position:relative;"><a href="#2-%E5%A6%82%E4%BD%95%E8%8E%B7%E5%BE%97-ios-%E7%89%88%E6%9C%AC" aria-label="2 如何获得 ios 版本 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 如何获得 IOS 版本</h4>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">var</span> arr <span class="token operator">=</span> window<span class="token punctuation">.</span>navigator<span class="token punctuation">.</span>userAgent<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex">/OS (\d+)_(\d+)?/</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> version <span class="token operator">=</span> arr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"."</span> <span class="token operator">+</span> arr<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">// -> 9.1</span></code></pre></div>
<h3 id="使用何种方式触发跳转" style="position:relative;"><a href="#%E4%BD%BF%E7%94%A8%E4%BD%95%E7%A7%8D%E6%96%B9%E5%BC%8F%E8%A7%A6%E5%8F%91%E8%B7%B3%E8%BD%AC" aria-label="使用何种方式触发跳转 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>使用何种方式触发跳转</h3>
<p>这里有三种方式：</p>
<ul>
<li>iframe</li>
<li>a 标签 href 属性</li>
<li>window.location.href</li>
</ul>
<p>现在网上给的方案都是大概 1 年左右，都倾向于使用 iframe，但是像「网易新闻」和「知乎」都是使用的<code class="language-text">window.location.href</code>（翻看了源码），好吧，用这个方案吧。</p>
<blockquote>
<p>在 IOS 的 Safari 上使用 iframe 方案点击无反应</p>
</blockquote>
<h2 id="交互设计" style="position:relative;"><a href="#%E4%BA%A4%E4%BA%92%E8%AE%BE%E8%AE%A1" aria-label="交互设计 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>交互设计</h2>
<p>上面的关系理清，交互就很明确了，简单的流程如下图：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/2036128-0c71665a8bb5b50b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="流程图"></p>
<p>因为「网易新闻」和「知乎」两个平台都对<code class="language-text">setTimeout</code>定时跳转没有处理，因此都会进入跳转中转页然后根据设备类型及壳子类型初始化对应的<strong>操作提示</strong>及<strong>下载链接</strong>。</p>
<p>关于这这部分的代码，请参考我写的一个 Demo 示例： <a href="https://github.com/xiangsongtao/oia-page" target="_target" rel="nofollow">仿「知乎」中转页项目工程</a>，如果需要对<code class="language-text">setTimeout</code>处理的话，建议监听页面 hide 事件，对应的兼容库在这里：<a href="https://github.com/addyosmani/visibly.js" target="_target" rel="nofollow">visibly.js</a>。</p>
<h2 id="最后" style="position:relative;"><a href="#%E6%9C%80%E5%90%8E" aria-label="最后 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>最后</h2>
<ul>
<li>向 IOS 和 Android 的开发同时搞到 URL Scheme 链接</li>
<li>向 IOS 同事询问 Universal Links 的链接</li>
<li>准备 OIA 页面（下载指引页）</li>
</ul>
<p>希望以上对你有用。</p>]]></description><link>https://xiangst0816.github.io/blog/deepLinks/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/deepLinks/</guid><category><![CDATA[Mobile]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Sat, 03 Jun 2017 05:09:08 GMT</pubDate></item><item><title><![CDATA[JavaScript应用程序设计]]></title><description><![CDATA[<p>这篇文章是的对《JavaScript 应用程序设计》书中的重要概念梳理，便于日后巩固其中的有用知识点。以下章节将按照书中章节依次总结。因为我的语文一直是体育老师教的，写的不好请见谅。</p>
<h2 id="1-javascript-的革命时代" style="position:relative;"><a href="#1-javascript-%E7%9A%84%E9%9D%A9%E5%91%BD%E6%97%B6%E4%BB%A3" aria-label="1 javascript 的革命时代 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. JavaScript 的革命时代</h2>
<p>JavaScript 具有的以下特性：</p>
<ul>
<li>高性能、事件驱动、无阻塞</li>
<li>JSON 原生支持，及 NoSQL 数据库</li>
<li>RESTful 接口架构</li>
<li>Nodejs 服务端</li>
<li>NPM 包管理</li>
<li>ES2015</li>
</ul>
<p>使得 JavaScript 语言可以在各个层面承担从前端到后端的开发任务。</p>
<h2 id="2-函数" style="position:relative;"><a href="#2-%E5%87%BD%E6%95%B0" aria-label="2 函数 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 函数</h2>
<p>函数编写最佳实践：</p>
<ul>
<li>不要重复造轮子，<strong>将功能抽象成逻辑并通过组合复用</strong></li>
<li>一次只做一件事儿</li>
<li>保持简单，保持原子性</li>
<li>少即是多，保持原子性</li>
</ul>
<h3 id="减少隐式副作用" style="position:relative;"><a href="#%E5%87%8F%E5%B0%91%E9%9A%90%E5%BC%8F%E5%89%AF%E4%BD%9C%E7%94%A8" aria-label="减少隐式副作用 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>减少隐式副作用</h3>
<ul>
<li>引用参数传参的问题，需要清楚这个过程</li>
</ul>
<h3 id="函数声明" style="position:relative;"><a href="#%E5%87%BD%E6%95%B0%E5%A3%B0%E6%98%8E" aria-label="函数声明 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>函数声明</h3>
<ul>
<li>变量提升问题，这部分我建议按照 StandardJs 的规范走，将变量统一放在函数体顶部。</li>
</ul>
<h3 id="其他" style="position:relative;"><a href="#%E5%85%B6%E4%BB%96" aria-label="其他 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>其他</h3>
<ul>
<li>闭包</li>
<li>立即执行函数</li>
<li>
<p>上下文 this[需要详细介绍 this]</p>
<ul>
<li>this 的指向取决于方法在哪一个对象上执行</li>
</ul>
</li>
</ul>]]></description><link>https://xiangst0816.github.io/blog/JavaScript-ying-yong-cheng-xu-she-ji/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/JavaScript-ying-yong-cheng-xu-she-ji/</guid><category><![CDATA[读书笔记]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Thu, 25 May 2017 13:45:15 GMT</pubDate></item><item><title><![CDATA[Flex布局及在移动端的应用]]></title><description><![CDATA[<p>前端发展很快，以前在移动端使用 Flex 布局还要<strong>想三想</strong>的文章也许已经过时了，这篇文章主要介绍使用 Flex 进行常规布局及在移动端的处理。</p>
<h2 id="flex-语法" style="position:relative;"><a href="#flex-%E8%AF%AD%E6%B3%95" aria-label="flex 语法 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Flex 语法</h2>
<p>Flex 布局意为”弹性布局”，用来为盒模型提供更多灵活性。此外，Flex 定义的容器可以对块级元素(<code class="language-text">display: flex;</code>)或行内元素(<code class="language-text">display: inline-flex;</code>)生效，需要注意的是，如果父元素设置了 Flex 容器，则子元素的<code class="language-text">float</code>、<code class="language-text">clear</code>和<code class="language-text">vertical-align</code>属性将失效。</p>
<p>Flex 布局需要注意<strong>下面几个重要的概念</strong>，结合下面这张图也许能更好的理解:</p>
<ul>
<li>flex 容器(flex container)</li>
<li>flex 项目(flex item)</li>
<li>主轴(main axis)</li>
<li>交叉轴(cross axis)</li>
<li>开始位置(start)</li>
<li>结束位置(end)</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/2036128-102577302e07d171.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<blockquote>
<p>提示：定义在容器(container)上的属性和定义在项目(item)上的属性不可搞混!</p>
</blockquote>
<p>关于语法的其余部分，请参考阮一峰的教程，希望你能熟记里面的示例图:</p>
<ul>
<li>Flex 布局教程: <a href="http://www.ruanyifeng.com/blog/2015/07/flex-grammar.html" target="_target" rel="nofollow">语法篇</a></li>
<li>Flex 布局教程: <a href="http://www.ruanyifeng.com/blog/2015/07/flex-examples.html" target="_target" rel="nofollow">实例篇</a></li>
</ul>
<p>上面部分搞定，趁热打铁做一下下面的练习，做上两次基本上 Flex 就基本没问题了。</p>
<ul>
<li>Flex 训练游戏: <a href="http://flexboxfroggy.com/?utm_source=jsgroup#zh-cn" target="_target" rel="nofollow">地址</a></li>
</ul>
<h2 id="flex-常规布局" style="position:relative;"><a href="#flex-%E5%B8%B8%E8%A7%84%E5%B8%83%E5%B1%80" aria-label="flex 常规布局 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Flex 常规布局</h2>
<h3 id="1-单列布局" style="position:relative;"><a href="#1-%E5%8D%95%E5%88%97%E5%B8%83%E5%B1%80" aria-label="1 单列布局 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 单列布局</h3>
<p>单列布局使用场景非常多，用来实现文本或者 block 的居中效果。对外部容器定义就可实现内部布局效果，实现起来非常简单，尤其是使用响应式布局中。以下示例都是 Flex 的基本使用语法。</p>
<p>基本的 DOM 结构如下:</p>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>parent<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>children<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></code></pre></div>
<h4 id="--水平居中" style="position:relative;"><a href="#--%E6%B0%B4%E5%B9%B3%E5%B1%85%E4%B8%AD" aria-label="  水平居中 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>- 水平居中</h4>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">.parent{
  display:flex;
  justify-content:center;
}</code></pre></div>
<h4 id="--垂直居中" style="position:relative;"><a href="#--%E5%9E%82%E7%9B%B4%E5%B1%85%E4%B8%AD" aria-label="  垂直居中 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>- 垂直居中</h4>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">.parent{
  display:flex;
  align-items:center;
}</code></pre></div>
<h4 id="--水平垂直全部居中" style="position:relative;"><a href="#--%E6%B0%B4%E5%B9%B3%E5%9E%82%E7%9B%B4%E5%85%A8%E9%83%A8%E5%B1%85%E4%B8%AD" aria-label="  水平垂直全部居中 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>- 水平垂直全部居中</h4>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">.parent{
  display:flex;
  justify-content:center;
  align-items:center;
}</code></pre></div>
<h3 id="2-多列布局" style="position:relative;"><a href="#2-%E5%A4%9A%E5%88%97%E5%B8%83%E5%B1%80" aria-label="2 多列布局 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 多列布局</h3>
<p>多列布局使用较多，比如商品展示需要在左侧显示图片，右侧显示详情；</p>
<p>多列布局的示例 DOM 结构如下:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">    &lt;div class=&quot;container&quot;&gt;
        &lt;div class=&quot;left&quot;&gt;Left&lt;/div&gt;
        &lt;div class=&quot;right&quot;&gt;Center&lt;/div&gt;
        &lt;div class=&quot;center&quot;&gt;Right&lt;/div&gt;
    &lt;/div&gt;</code></pre></div>
<h4 id="--左列定宽，右列自适应--右列定宽，左列自适应同理" style="position:relative;"><a href="#--%E5%B7%A6%E5%88%97%E5%AE%9A%E5%AE%BD%EF%BC%8C%E5%8F%B3%E5%88%97%E8%87%AA%E9%80%82%E5%BA%94--%E5%8F%B3%E5%88%97%E5%AE%9A%E5%AE%BD%EF%BC%8C%E5%B7%A6%E5%88%97%E8%87%AA%E9%80%82%E5%BA%94%E5%90%8C%E7%90%86" aria-label="  左列定宽，右列自适应  右列定宽，左列自适应同理 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>- 左列定宽，右列自适应 | 右列定宽，左列自适应(同理)</h4>
<blockquote>
<p>该布局方式非常常见，适用于定宽的一侧常为导航，自适应的一侧为内容的布局。</p>
</blockquote>
<h5 id="示例" style="position:relative;"><a href="#%E7%A4%BA%E4%BE%8B" aria-label="示例 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>示例</h5>
<p><img src="http://upload-images.jianshu.io/upload_images/2036128-a9a8075e63c38733.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="一列定宽，一列自适应"></p>
<h5 id="样式" style="position:relative;"><a href="#%E6%A0%B7%E5%BC%8F" aria-label="样式 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>样式</h5>
<div class="gatsby-highlight" data-language="css"><pre class="language-css"><code class="language-css"><span class="token selector">.container</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.left</span> <span class="token punctuation">{</span>
  <span class="token property">flex</span><span class="token punctuation">:</span> 0 0 300px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.right</span> <span class="token punctuation">{</span>
  <span class="token property">flex</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<h4 id="--左中两列定宽，右侧列自适应" style="position:relative;"><a href="#--%E5%B7%A6%E4%B8%AD%E4%B8%A4%E5%88%97%E5%AE%9A%E5%AE%BD%EF%BC%8C%E5%8F%B3%E4%BE%A7%E5%88%97%E8%87%AA%E9%80%82%E5%BA%94" aria-label="  左中两列定宽，右侧列自适应 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>- 左中两列定宽，右侧列自适应</h4>
<h5 id="示例-1" style="position:relative;"><a href="#%E7%A4%BA%E4%BE%8B-1" aria-label="示例 1 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>示例</h5>
<p><img src="http://upload-images.jianshu.io/upload_images/2036128-58b2d7096bc3f532.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="左中两列定宽，右侧列自适应"></p>
<h5 id="样式-1" style="position:relative;"><a href="#%E6%A0%B7%E5%BC%8F-1" aria-label="样式 1 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>样式</h5>
<div class="gatsby-highlight" data-language="css"><pre class="language-css"><code class="language-css"><span class="token selector">.container</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.left，.center</span> <span class="token punctuation">{</span>
  <span class="token property">flex</span><span class="token punctuation">:</span> 0 0 100px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.right</span> <span class="token punctuation">{</span>
  <span class="token property">flex</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<h4 id="--两侧定宽，中栏自适应" style="position:relative;"><a href="#--%E4%B8%A4%E4%BE%A7%E5%AE%9A%E5%AE%BD%EF%BC%8C%E4%B8%AD%E6%A0%8F%E8%87%AA%E9%80%82%E5%BA%94" aria-label="  两侧定宽，中栏自适应 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>- 两侧定宽，中栏自适应</h4>
<h5 id="示例-2" style="position:relative;"><a href="#%E7%A4%BA%E4%BE%8B-2" aria-label="示例 2 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>示例</h5>
<p><img src="http://upload-images.jianshu.io/upload_images/2036128-6e4e139264c044c5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="两侧定宽，中栏自适应"></p>
<h4 id="样式-2" style="position:relative;"><a href="#%E6%A0%B7%E5%BC%8F-2" aria-label="样式 2 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>样式</h4>
<div class="gatsby-highlight" data-language="css"><pre class="language-css"><code class="language-css"><span class="token selector">.container</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.left</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.center</span> <span class="token punctuation">{</span>
  <span class="token property">flex</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.right</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100px<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<h4 id="--一列不定宽，一列自适应" style="position:relative;"><a href="#--%E4%B8%80%E5%88%97%E4%B8%8D%E5%AE%9A%E5%AE%BD%EF%BC%8C%E4%B8%80%E5%88%97%E8%87%AA%E9%80%82%E5%BA%94" aria-label="  一列不定宽，一列自适应 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>- 一列不定宽，一列自适应</h4>
<h5 id="示例-3" style="position:relative;"><a href="#%E7%A4%BA%E4%BE%8B-3" aria-label="示例 3 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>示例</h5>
<p><img src="http://upload-images.jianshu.io/upload_images/2036128-8ec7dd4d015f8eee.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="一列不定宽，一列自适应"></p>
<h5 id="样式-3" style="position:relative;"><a href="#%E6%A0%B7%E5%BC%8F-3" aria-label="样式 3 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>样式</h5>
<div class="gatsby-highlight" data-language="css"><pre class="language-css"><code class="language-css"><span class="token selector">.container</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.right</span> <span class="token punctuation">{</span>
  <span class="token property">flex</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<h4 id="--多列等分布局" style="position:relative;"><a href="#--%E5%A4%9A%E5%88%97%E7%AD%89%E5%88%86%E5%B8%83%E5%B1%80" aria-label="  多列等分布局 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>- 多列等分布局</h4>
<blockquote>
<p>多列等分布局常出现在内容中，多数为功能的，同等级内容的并排显示等。</p>
</blockquote>
<h5 id="示例-4" style="position:relative;"><a href="#%E7%A4%BA%E4%BE%8B-4" aria-label="示例 4 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>示例</h5>
<p><img src="http://upload-images.jianshu.io/upload_images/2036128-34ba21dc0ae5f7d1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="多列等分布局"></p>
<h5 id="样式-4" style="position:relative;"><a href="#%E6%A0%B7%E5%BC%8F-4" aria-label="样式 4 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>样式</h5>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">.container{
  display:flex;
}
.left，.center，.right {
  flex:1;
}</code></pre></div>
<h3 id="3-九宫格布局" style="position:relative;"><a href="#3-%E4%B9%9D%E5%AE%AB%E6%A0%BC%E5%B8%83%E5%B1%80" aria-label="3 九宫格布局 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. 九宫格布局</h3>
<h5 id="示例-5" style="position:relative;"><a href="#%E7%A4%BA%E4%BE%8B-5" aria-label="示例 5 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>示例</h5>
<p><img src="http://upload-images.jianshu.io/upload_images/2036128-61ecf0bfcbc0875b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="九宫格布局"></p>
<h5 id="dom-结构" style="position:relative;"><a href="#dom-%E7%BB%93%E6%9E%84" aria-label="dom 结构 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>DOM 结构</h5>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>row<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>left<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Left<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>right<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Center<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>center<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Right<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>row<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>left<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Left<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>right<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Center<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>center<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Right<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>row<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>left<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Left<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>right<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Center<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>center<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Right<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></code></pre></div>
<h5 id="样式-5" style="position:relative;"><a href="#%E6%A0%B7%E5%BC%8F-5" aria-label="样式 5 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>样式</h5>
<div class="gatsby-highlight" data-language="scss"><pre class="language-scss"><code class="language-scss"><span class="token selector">.container </span><span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">flex-direction</span><span class="token punctuation">:</span> column<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 300px<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 300px<span class="token punctuation">;</span>
  <span class="token selector">.row </span><span class="token punctuation">{</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 100px<span class="token punctuation">;</span>
    <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.left，.center，.right </span><span class="token punctuation">{</span>
    <span class="token property">flex</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 100px<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<h3 id="4-圣杯布局" style="position:relative;"><a href="#4-%E5%9C%A3%E6%9D%AF%E5%B8%83%E5%B1%80" aria-label="4 圣杯布局 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. 圣杯布局</h3>
<h5 id="示例-6" style="position:relative;"><a href="#%E7%A4%BA%E4%BE%8B-6" aria-label="示例 6 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>示例</h5>
<p><img src="http://upload-images.jianshu.io/upload_images/2036128-4eab812e11fee2e2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="圣杯布局"></p>
<h5 id="dom-结构-1" style="position:relative;"><a href="#dom-%E7%BB%93%E6%9E%84-1" aria-label="dom 结构 1 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>DOM 结构</h5>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>header</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>header<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
            Header
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>header</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>article</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>article<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>nav</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>nav<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Nav<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>nav</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>section</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>body<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Body<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>section</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>aside</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>aside<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Aside<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>aside</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>article</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>footer</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>footer<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
            Footer
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>footer</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></code></pre></div>
<h5 id="样式-6" style="position:relative;"><a href="#%E6%A0%B7%E5%BC%8F-6" aria-label="样式 6 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>样式</h5>
<div class="gatsby-highlight" data-language="scss"><pre class="language-scss"><code class="language-scss"><span class="token selector">.container </span><span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">flex-direction</span><span class="token punctuation">:</span> column<span class="token punctuation">;</span>
  <span class="token property">min-height</span><span class="token punctuation">:</span> 100vh<span class="token punctuation">;</span>
  <span class="token property">justify-content</span><span class="token punctuation">:</span> space-between<span class="token punctuation">;</span>
  <span class="token selector">.header，.footer </span><span class="token punctuation">{</span>
    <span class="token property">flex</span><span class="token punctuation">:</span> 0 0 100px<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.article </span><span class="token punctuation">{</span>
    <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
    <span class="token property">flex</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span>
    <span class="token selector">.nav </span><span class="token punctuation">{</span>
      <span class="token property">flex</span><span class="token punctuation">:</span> 0 0 100px<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector">.body </span><span class="token punctuation">{</span>
      <span class="token property">flex</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector">.aside </span><span class="token punctuation">{</span>
      <span class="token property">flex</span><span class="token punctuation">:</span> 0 0 100px<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<h3 id="5-响应式布局" style="position:relative;"><a href="#5-%E5%93%8D%E5%BA%94%E5%BC%8F%E5%B8%83%E5%B1%80" aria-label="5 响应式布局 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>5. 响应式布局</h3>
<h4 id="设置-meta" style="position:relative;"><a href="#%E8%AE%BE%E7%BD%AE-meta" aria-label="设置 meta permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>设置 meta</h4>
<p>使用前需要对设置 meta 标签，设置布局宽度等于设备宽度，布局 viewport 等于度量 viewport。</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">&lt;meta name=&#39;viewport&#39; content=&#39;width=device-width，initial-scale=1&#39;&gt;</code></pre></div>
<h4 id="媒体查询" style="position:relative;"><a href="#%E5%AA%92%E4%BD%93%E6%9F%A5%E8%AF%A2" aria-label="媒体查询 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>媒体查询</h4>
<p>HTML 4 和 CSS 2 目前支持为不同的媒体类型设定专有的样式表，比如，一个页面在屏幕上显示时使用无衬线字体，而在打印时则使用衬线字体，screen 和 print 是两种已定义的媒体类型，媒体查询让样式表有更强的针对性，扩展了媒体类型的功能; 媒体查询由媒体类型和一个或多个检测媒体特性的条件表达式组成，媒体查询中可用于检测的媒体特性有 width、height 和 color（等），使用媒体查询，可以在不改变页面内容的情况下，为特定的一些输出设备定制显示效果。</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">@media screen and (max-width:960px){....}
&lt;link rel=&#39;stylesheet&#39; media=&#39;screen and (max-width:960px)&#39; href=&#39;xxx.css&#39; /&gt;</code></pre></div>
<h2 id="兼容性问题解决方案" style="position:relative;"><a href="#%E5%85%BC%E5%AE%B9%E6%80%A7%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88" aria-label="兼容性问题解决方案 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>兼容性问题解决方案</h2>
<p>对于移动端的处理主要是解决兼容性，毕竟新出的事物普遍接受还是需要过程的，但是把握趋势对不兼容的情况需要做好补丁。这里是 Caniuse.com 上的关于 Flex 的<a href="http://caniuse.com/#search=flex" target="_target" rel="nofollow">兼容性</a>。</p>
<p>我在开发的要求是能用工具处理的不进行人为干预，因为这样会增加开发及维护成本，浪费生命。 有句话: “工欲善其事必先利其器”，因此按照 Flex 的标准去开发，剩余的事情交给自动化工具处理。</p>
<p>这里使用的工具是<a href="https://github.com/sindresorhus/gulp-autoprefixer" target="_target" rel="nofollow">gulp-autoprefixer</a>，配置的参数：</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">{
  browsers: [
    &#39;last 2 versions&#39;,
    &#39;iOS &gt;= 7&#39;,
    &#39;Android &gt;= 4&#39;],
  cascade: false
}</code></pre></div>
<p><strong>源码</strong></p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">{
  display: flex;
  flex: 1;
  align-items: center;
}</code></pre></div>
<p><strong>兼容后</strong></p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">{
    display: -webkit-box;
    display: -webkit-flex;
    display: flex;
    -webkit-box-flex: 1;
    -webkit-flex: 1;
    flex: 1;
    -webkit-box-align: center;
    -webkit-align-items: center;
    align-items: center;
}</code></pre></div>
<h2 id="最后" style="position:relative;"><a href="#%E6%9C%80%E5%90%8E" aria-label="最后 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>最后</h2>
<p>Flex 布局高效简洁且有兼容性处理方案，因此朝这个趋势走不会有错。</p>
<h2 id="参考" style="position:relative;"><a href="#%E5%8F%82%E8%80%83" aria-label="参考 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>参考</h2>
<ul>
<li><a href="https://css-tricks.com/snippets/css/a-guide-to-flexbox/" target="_target" rel="nofollow">A Complete Guide to Flexbox</a></li>
<li><a href="https://scotch.io/tutorials/a-visual-guide-to-css3-flexbox-properties" target="_target" rel="nofollow">A Visual Guide to CSS3 Flexbox Properties</a></li>
</ul>]]></description><link>https://xiangst0816.github.io/blog/Flex-bu-ju-ji-zai-yi-dong-duan-de-di/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/Flex-bu-ju-ji-zai-yi-dong-duan-de-di/</guid><category><![CDATA[CSS]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Thu, 25 May 2017 01:12:39 GMT</pubDate></item><item><title><![CDATA[CSS优先级计算及应用]]></title><description><![CDATA[<p>梳理这部分是因为在使用组件模式开发 h5 应用会出现组件样式修改未生效的问题，在解决样式修改的问题前，需要理清楚 CSS 样式生效的优先级。样式根据引入和声明需要分开介绍，分为<strong>引入样式优先级</strong>和<strong>声明样式优先级</strong>。</p>
<h2 id="引入样式优先级" style="position:relative;"><a href="#%E5%BC%95%E5%85%A5%E6%A0%B7%E5%BC%8F%E4%BC%98%E5%85%88%E7%BA%A7" aria-label="引入样式优先级 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>引入样式优先级</h2>
<p>引入样式优先级一般是在外部样式、内部样式、内联样式之间应用同一个样式的情况是使用， 优先级如下：</p>
<ul>
<li><strong>外部样式</strong> | <strong>内部样式</strong> &#x3C; <strong>内联样式</strong></li>
<li><strong>外部样式</strong>和<strong>内部样式</strong>，最后出现的优先级最高，例如：</li>
</ul>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html"><span class="token comment">&lt;!-- 内联样式 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token property">color</span><span class="token punctuation">:</span>red<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Hello<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/css<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css">
     <span class="token comment">/* 内部样式 */</span>
     <span class="token selector">h3</span><span class="token punctuation">{</span><span class="token property">color</span><span class="token punctuation">:</span>green<span class="token punctuation">;</span><span class="token punctuation">}</span>
 </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>

<span class="token comment">&lt;!-- 外部样式 style.css --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/css<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>style.css<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span></code></pre></div>
<p>因此，对于一些重置的样式集，比如<strong>normalize.css/reset.css</strong>必须写在所有样式的前面。</p>
<blockquote>
<p>PS: 没有外联样式，<a href="http://www.w3school.com.cn/html/html_css.asp" target="_target" rel="nofollow">参考</a>。</p>
</blockquote>
<h2 id="声明样式优先级" style="position:relative;"><a href="#%E5%A3%B0%E6%98%8E%E6%A0%B7%E5%BC%8F%E4%BC%98%E5%85%88%E7%BA%A7" aria-label="声明样式优先级 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>声明样式优先级</h2>
<h3 id="1-大致的优先级" style="position:relative;"><a href="#1-%E5%A4%A7%E8%87%B4%E7%9A%84%E4%BC%98%E5%85%88%E7%BA%A7" aria-label="1 大致的优先级 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 大致的优先级</h3>
<p>一般来说满这个规则：</p>
<ul>
<li>继承不如指定</li>
<li>!important > 内联 > ID > Class|属性|伪类 > 元素选择器</li>
<li>:link、:visited、:hover、:active 按照 LVHA（LoVe HAte）顺序定义</li>
</ul>
<p>上面是优先级算法反映出的大致结果，在一般的开发中熟记即可。如果需要进一步研究原理，则了解下优先级算法。</p>
<h3 id="2-优先级算法" style="position:relative;"><a href="#2-%E4%BC%98%E5%85%88%E7%BA%A7%E7%AE%97%E6%B3%95" aria-label="2 优先级算法 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 优先级算法</h3>
<p>选择器的特殊性值分为四个等级，如下：</p>
<table>
<thead>
<tr>
<th>等级</th>
<th>标签内选择符</th>
<th>ID 选择符</th>
<th>Class 选择符/属性选择符/伪类选择符</th>
<th>元素选择符</th>
</tr>
</thead>
<tbody>
<tr>
<td>示例</td>
<td><code class="language-text">&lt;span style=&quot;color:red;&quot;&gt;</code></td>
<td><code class="language-text">#text{color:red;}</code></td>
<td><code class="language-text">.text{color:red;} [type=&quot;text&quot;]{color:red}</code></td>
<td><code class="language-text">span{color:red;}</code></td>
</tr>
<tr>
<td>标记位</td>
<td>x,0,0,0</td>
<td>0,x,0,0</td>
<td>0,0,x,0</td>
<td>0,0,0,x</td>
</tr>
</tbody>
</table>
<h4 id="特点" style="position:relative;"><a href="#%E7%89%B9%E7%82%B9" aria-label="特点 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>特点:</h4>
<ul>
<li>每个等级的初始值为 0，</li>
<li>每个等级的叠加为选择器出<strong>现的次数相加</strong></li>
<li>不可进位，比如<code class="language-text">0,99,99,99</code></li>
<li>依次表示为：0,0,0,0</li>
<li>每个等级计数之间没关联</li>
<li>等级判断从左向右，如果某一位数值相同，则判断下一位数值</li>
<li>如果两个优先级相同，则最后出现的优先级高，<code class="language-text">!important</code>也适用</li>
<li>通配符选择器的特殊性值为：<code class="language-text">0,0,0,0</code></li>
<li><strong>继承样式优先级最低</strong>，通配符样式优先级高于继承样式</li>
</ul>
<h4 id="计算示例：" style="position:relative;"><a href="#%E8%AE%A1%E7%AE%97%E7%A4%BA%E4%BE%8B%EF%BC%9A" aria-label="计算示例： permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>计算示例：</h4>
<ul>
<li><code class="language-text">a{color: yellow;} /*特殊性值：0,0,0,1*/</code></li>
<li><code class="language-text">div a{color: green;} /*特殊性值：0,0,0,2*/</code></li>
<li><code class="language-text">.demo a{color: black;} /*特殊性值：0,0,1,1*/</code></li>
<li><code class="language-text">.demo input[type=&quot;text&quot;]{color: blue;} /*特殊性值：0,0,2,1*/</code></li>
<li><code class="language-text">.demo *[type=&quot;text&quot;]{color: grey;} /*特殊性值：0,0,2,0*/</code></li>
<li><code class="language-text">#demo a{color: orange;} /*特殊性值：0,1,0,1*/</code></li>
<li><code class="language-text">div#demo a{color: red;} /*特殊性值：0,1,0,2*/</code></li>
</ul>
<h4 id="生效示例：" style="position:relative;"><a href="#%E7%94%9F%E6%95%88%E7%A4%BA%E4%BE%8B%EF%BC%9A" aria-label="生效示例： permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>生效示例：</h4>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>第一条应该是黄色<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span> <span class="token comment">&lt;!--适用第1行规则--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>demo<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>第二条应该是蓝色<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token comment">&lt;!--适用第4、5行规则，第4行优先级高--></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>第三条应该是黑色<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token comment">&lt;!--适用第2、3行规则，第3行优先级高--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>demo<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>第四条应该是红色<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token comment">&lt;!--适用第6、7行规则，第7行优先级高--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></code></pre></div>
<h4 id="关于伪类-lvha-的解释" style="position:relative;"><a href="#%E5%85%B3%E4%BA%8E%E4%BC%AA%E7%B1%BB-lvha-%E7%9A%84%E8%A7%A3%E9%87%8A" aria-label="关于伪类 lvha 的解释 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>关于伪类 LVHA 的解释</h4>
<p>a 标签有四种状态：链接访问前、链接访问后、鼠标滑过、激活，分别对应四种伪类:link、:visited、:hover、:active；</p>
<ul>
<li>当鼠标滑过 a 链接时，满足<code class="language-text">:link</code>和<code class="language-text">:hover</code>两个伪类，要改变 a 标签的颜色，就必须将:hover 伪类在:link 伪类后面声明；</li>
<li>当鼠标点击激活 a 链接时，同时满足:link、:hover、:active 三种状态，要显示 a 标签激活时的样式（:active），必须将:active 声明放到:link 和:hover 之后。因此得出 LVHA 这个顺序。</li>
</ul>
<p>这个顺序能不能变？可以，但也只有:link 和:visited 可以交换位置，因为一个链接要么访问过要么没访问过，不可能同时满足，也就不存在覆盖的问题。</p>
<h2 id="在组件中的应用" style="position:relative;"><a href="#%E5%9C%A8%E7%BB%84%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8" aria-label="在组件中的应用 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>在组件中的应用</h2>
<p>目前的前端开发为了增加开发效率，会对常用组件进行封装，此外，组件还会添加一些必要的结构样式。但是业务的设计文稿中可不一定按照预先写好的默认样式，需要在开发业务时根据组件的 DOM 结构修改默认样式，此时会出现样式不生效的问题。</p>
<p>例如下面的结构，如果对 Title 直接增加样式类，则肯定不会生效，因为 Title 的 DOM 结构为两层(组件样式定义规定不能使用 ID 选择器，且类选择器满足最小标记原则)），故样式最多为<code class="language-text">0,0,2,x</code>。因此，样式多层标记就可提高自定义样式的优先级，例如下方的 SCSS 写法。</p>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Page</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>test<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Header</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>test__header<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Navbar</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Title</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>test__header--title<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Toolbar<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Title</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Navbar</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Header</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Content</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Content</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Page</span><span class="token punctuation">></span></span></code></pre></div>
<div class="gatsby-highlight" data-language="scss"><pre class="language-scss"><code class="language-scss"><span class="token selector">.test </span><span class="token punctuation">{</span>
  <span class="token selector">.test__header </span><span class="token punctuation">{</span>
    <span class="token selector">.test__header--title </span><span class="token punctuation">{</span>
      <span class="token property">height</span><span class="token punctuation">:</span> 100px<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<blockquote>
<p>此外，对于<code class="language-text">Page</code>组件的样式标记策略推荐使用<strong>金字塔形(树形)</strong>，比如上面的 SCSS 书写，这样可以保证内部自定义样式不会受到外部干扰，减少不必要的麻烦。</p>
</blockquote>
<h2 id="参考" style="position:relative;"><a href="#%E5%8F%82%E8%80%83" aria-label="参考 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>参考</h2>
<ul>
<li><a href="http://www.cnblogs.com/wangmeijian/p/4207433.html" target="_target" rel="nofollow">css 优先级计算规则</a></li>
<li><a href="http://blog.csdn.net/jie1336950707/article/details/49046371" target="_target" rel="nofollow">关于 CSS 的优先级,CSS 优先级计算,多个 class 引用</a></li>
<li><a href="http://www.w3school.com.cn/html/html_css.asp" target="_target" rel="nofollow">样式表定义</a></li>
</ul>]]></description><link>https://xiangst0816.github.io/blog/CSS-you-xian-ji-ji-suan-ji-ying-yong/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/CSS-you-xian-ji-ji-suan-ji-ying-yong/</guid><category><![CDATA[CSS]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Wed, 24 May 2017 05:52:01 GMT</pubDate></item><item><title><![CDATA[Vue组件开发]]></title><description><![CDATA[<p>软件编程界有一个<strong>面相对象</strong>的思想, 或者用另一句话就是<strong>为实例写模板</strong>, 初始化的时候调用模板(类)生成实例, 进行抽象化开发. 因此, 组件的开发和类的设计有着异曲同工之处.</p>
<p>类的设计原则有以下几种, 分别是:</p>
<ol>
<li>单一职责原则</li>
<li>接口隔离原则</li>
<li>开放封闭原则</li>
<li>依赖倒置原则</li>
</ol>
<p>关于这方面的资料网上介绍比较多, 这里我对此概念进行迁移, 用于解释 Vue 组件开发中需要考虑的原则.</p>
<h2 id="关于设计原则" style="position:relative;"><a href="#%E5%85%B3%E4%BA%8E%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99" aria-label="关于设计原则 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>关于设计原则</h2>
<h3 id="1-单一职责" style="position:relative;"><a href="#1-%E5%8D%95%E4%B8%80%E8%81%8C%E8%B4%A3" aria-label="1 单一职责 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 单一职责</h3>
<p>这个比较好理解, 比如<a href="https://github.com/DTFE/Vimo/tree/master/raw/components/alert" target="_target" rel="nofollow">Alert</a>/<a href="https://github.com/DTFE/Vimo/tree/master/raw/components/toast" target="_target" rel="nofollow">Toast</a>/<a href="https://github.com/DTFE/Vimo/tree/master/raw/components/action-sheet" target="_target" rel="nofollow">Actionsheet</a>/<a href="https://github.com/DTFE/Vimo/tree/master/raw/components/loading" target="_target" rel="nofollow">Loading</a>等组件, 通过名字就能知道他们都是与用户交互的弹出层, 用于提示用户操作结果的.</p>
<p>另外, 在 Alert/Actionsheet/Loading 中, 又有背景变黑的开关, 因此为了保证单一职责原则, 背景变黑这样的公共特性需要封装为独立的组件(<a href="https://github.com/DTFE/Vimo/tree/master/raw/components/backdrop" target="_target" rel="nofollow">Backdrop</a>).</p>
<p>同样的例子在<a href="https://github.com/DTFE/Vimo/tree/master/raw/components/input" target="_target" rel="nofollow">Input 组件</a>编写时也有体现. Input 和 Textarea 组件两者有大部分的逻辑是共用的, 所以将共用的部分进行抽离放到<a href="https://github.com/DTFE/Vimo/blob/master/raw/components/input/mixin.vue" target="_target" rel="nofollow">mixin</a>中.</p>
<blockquote>
<p>所以, 我认为<strong>区分组件的原子性是根据组件是否共用为参考的.</strong> 此外, 不建议过度的原子性. 因此, 正确的时机因该是当代码有重复可合并的情况下进行抽离.</p>
</blockquote>
<h3 id="2-接口隔离" style="position:relative;"><a href="#2-%E6%8E%A5%E5%8F%A3%E9%9A%94%E7%A6%BB" aria-label="2 接口隔离 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 接口隔离</h3>
<p>Vue 在设计组件的时候这方面就考虑的很周全. 目前(Vue2.x), <strong>Vue 组件对外只有三个 API:</strong></p>
<ul>
<li><strong>Prps:</strong> 外部传递组件数据</li>
<li><strong>Events:</strong> 组件向外发送事件(可传递数据)</li>
<li><strong>Slots:</strong> 外部逻辑整合到组件中(插槽)</li>
</ul>
<p>引入这张<strong>组件通讯</strong>图还是很必要的: <img src="http://cn.vuejs.org/images/props-events.png" alt="组件通讯"></p>
<p>这张图中并没有 Slot, 是因为 Slot 中的内容组件是无法直接感知到. 关于组件使用的详细信息参考官网的<a href="http://cn.vuejs.org/v2/guide/components.html#%E4%BB%80%E4%B9%88%E6%98%AF%E7%BB%84%E4%BB%B6%EF%BC%9F" target="_target" rel="nofollow">组件开发教程</a>.</p>
<blockquote>
<p>因此, <strong>如果你在使用组件</strong>, 在向组件内传递数据, 或者监听组件的状态使用<em>Props</em>和<em>Events</em>就可以, 不建议通过 this 找<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mi>a</mi><mi>r</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi mathvariant="normal">/</mi></mrow><annotation encoding="application/x-tex">parent/</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">e</span><span class="mord mathdefault">n</span><span class="mord mathdefault">t</span><span class="mord">/</span></span></span></span>children 等方法获取组件的直接操作. <strong>另外, 如果是在编写开发组件, 那就随意了!</strong></p>
</blockquote>
<h3 id="3-开放封闭" style="position:relative;"><a href="#3-%E5%BC%80%E6%94%BE%E5%B0%81%E9%97%AD" aria-label="3 开放封闭 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. 开放封闭</h3>
<h4 id="拓展开放" style="position:relative;"><a href="#%E6%8B%93%E5%B1%95%E5%BC%80%E6%94%BE" aria-label="拓展开放 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>拓展开放</h4>
<p>这部分也是 Vue 在设计组件的时候内置的功能: <a href="http://cn.vuejs.org/v2/api/#mixins" target="_target" rel="nofollow">Mixins</a>和<a href="http://cn.vuejs.org/v2/api/#extends" target="_target" rel="nofollow">Extends</a>.</p>
<p>两个属性的功能类似, 简单的说就是将组件初始化的对象进行合并:</p>
<ul>
<li><strong>对于属性(包括 data/props/watch/methods/computed 等):</strong> 数据会进行合并替换, 原始组件的优先级最高;</li>
<li><strong>对于钩子函数(created/mounted):</strong> Mixins/Extends 中定义的钩子不影响原始组件的钩子, 但是会优先执行 Mixins/Extends 中的定义.</li>
</ul>
<h5 id="区别" style="position:relative;"><a href="#%E5%8C%BA%E5%88%AB" aria-label="区别 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>区别</h5>
<ul>
<li>传参: - Mixins 需要传入数组 - Extends 传入对象即可</li>
<li>两者混用优先级: - 对于钩子函数: Extends > Mixins > Source - 对于属性: Source > Mixins > Extends</li>
</ul>
<blockquote>
<p>这部分也是单一原则的实现方式</p>
</blockquote>
<h4 id="修改封闭" style="position:relative;"><a href="#%E4%BF%AE%E6%94%B9%E5%B0%81%E9%97%AD" aria-label="修改封闭 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>修改封闭</h4>
<p>正常情况下, 不会涉及到使用组件内部的方法, <strong>组件对外全靠事件进行</strong>. 但是, 也有些情况在事件触发时传递组件的 this, 让业务能够执行组件内部方法改变组件状态, 比如<a href="https://github.com/DTFE/Vimo/tree/master/raw/components/refresher" target="_target" rel="nofollow">Refresher 组件</a>: 对外可调用内部两个方法:</p>
<ul>
<li><strong>complete():</strong> 异步数据请求成功后, 调用这个方法; refresher 将会关闭, 状态由<code class="language-text">refreshing</code> -> <code class="language-text">completing</code>.</li>
<li><strong>cancel():</strong> 取消 refresher, 其状态由<code class="language-text">refreshing</code> -> <code class="language-text">cancelling</code></li>
</ul>
<p>因此, 保证这部分不会在组件更迭发生变化也是很重要的!</p>
<h3 id="3-依赖倒置" style="position:relative;"><a href="#3-%E4%BE%9D%E8%B5%96%E5%80%92%E7%BD%AE" aria-label="3 依赖倒置 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. 依赖倒置</h3>
<p>这部分讲的是<strong>降低组件和业务之间的耦合度</strong>, 组件只要明确了使用调用的文档, 业务按照文档进行组件使用即可. 组件发生任何更新迭代优化等升级只要不改变定义的文档即可.</p>
<blockquote>
<p><strong>组件面相抽象开发, 不依赖具体实现.</strong> 组件开发就是为了降低耦合度而进行的.</p>
</blockquote>
<h2 id="写组件之前的建议" style="position:relative;"><a href="#%E5%86%99%E7%BB%84%E4%BB%B6%E4%B9%8B%E5%89%8D%E7%9A%84%E5%BB%BA%E8%AE%AE" aria-label="写组件之前的建议 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>写组件之前的建议</h2>
<p>到这里我想到了<strong>“为人名服务”</strong>这句话, 也就是说开发组件前需要站在使用者角度考虑如何去使用这个组件. 所以我的做法如下:</p>
<ol>
<li>先写 DEMO 实例, 将所有数据交互及操作交互等内容涵盖到里面</li>
<li>根据实例写文档, 规范 API, 这部分可以和有经验的同时交流</li>
<li>准备实现具体逻辑</li>
</ol>
<h2 id="vue-组件的几种类型" style="position:relative;"><a href="#vue-%E7%BB%84%E4%BB%B6%E7%9A%84%E5%87%A0%E7%A7%8D%E7%B1%BB%E5%9E%8B" aria-label="vue 组件的几种类型 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Vue 组件的几种类型</h2>
<p>这部分简单介绍<a href="https://github.com/DTFE/Vimo" target="_target" rel="nofollow">Vimo 框架</a>中使用到的几种组件类型的实现思路</p>
<h3 id="1-弹出层组件" style="position:relative;"><a href="#1-%E5%BC%B9%E5%87%BA%E5%B1%82%E7%BB%84%E4%BB%B6" aria-label="1 弹出层组件 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 弹出层组件</h3>
<p>关于弹出层组件之前是参考 mint-ui 来写的, 但是 vue 和 js 文件杂糅的方式导致职责不清, 比如<a href="https://github.com/ElemeFE/mint-ui/tree/master/packages/message-box/src" target="_target" rel="nofollow">message-box 组件</a>, 关键部分代码流程如下:</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// 1. 获取message-box.vue文件并extend</span>
<span class="token keyword">import</span> msgboxVue <span class="token keyword">from</span> <span class="token string">"./message-box.vue"</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> MessageBoxConstructor <span class="token operator">=</span> Vue<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span>msgboxVue<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 2. 根据MessageBoxConstructor生成实例instance, 使用div包裹</span>
<span class="token keyword">var</span> <span class="token function-variable function">initInstance</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MessageBoxConstructor</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    el<span class="token operator">:</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"div"</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  instance<span class="token punctuation">.</span>callback <span class="token operator">=</span> defaultCallback<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 3. 根据传入参数修改instance的属性, 然后挂到body上显示</span>
<span class="token keyword">var</span> <span class="token function-variable function">showNextMsg</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>instance<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">initInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>instance<span class="token punctuation">.</span>value <span class="token operator">||</span> instance<span class="token punctuation">.</span>closeTimer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>msgQueue<span class="token punctuation">.</span>length <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      currentMsg <span class="token operator">=</span> msgQueue<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">var</span> options <span class="token operator">=</span> currentMsg<span class="token punctuation">.</span>options<span class="token punctuation">;</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> prop <span class="token keyword">in</span> options<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>options<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">(</span>prop<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          instance<span class="token punctuation">[</span>prop<span class="token punctuation">]</span> <span class="token operator">=</span> options<span class="token punctuation">[</span>prop<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>options<span class="token punctuation">.</span>callback <span class="token operator">===</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        instance<span class="token punctuation">.</span>callback <span class="token operator">=</span> defaultCallback<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token punctuation">[</span><span class="token string">"modal"</span><span class="token punctuation">,</span> <span class="token string">"showClose"</span><span class="token punctuation">,</span> <span class="token string">"closeOnClickModal"</span><span class="token punctuation">,</span> <span class="token string">"closeOnPressEscape"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>
        <span class="token parameter">prop</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>instance<span class="token punctuation">[</span>prop<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            instance<span class="token punctuation">[</span>prop<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
      document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>instance<span class="token punctuation">.</span>$el<span class="token punctuation">)</span><span class="token punctuation">;</span>
      Vue<span class="token punctuation">.</span><span class="token function">nextTick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
        instance<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<p>这么做不好的地方如下:</p>
<ol>
<li>vue 并没有存在的意义, 直接写成 html 模板即可</li>
<li>组件没有初始化的生命周期过程, 即 created/mounted 等钩子都不起作用</li>
<li>js 部分包含了 vue 中的实现逻辑, vue 只是作为了模板存在</li>
<li>message-box.vue 中定义的 prop 并没有发挥功能</li>
<li>使用 setTimeout 判断组件的开闭动画是否完毕, 正常应该监听 transitionend 事件</li>
</ol>
<p>这部分也曾改写过很多次, 最终官网的一个 API<a href="http://cn.vuejs.org/v2/api/#propsData" target="_target" rel="nofollow"><code class="language-text">propsData</code></a>开启了一个新思路.</p>
<ol>
<li>先写普通组件一样先写弹出层组件,</li>
<li>之后用<code class="language-text">propsData</code>传递数据</li>
<li>给<code class="language-text">el</code>传递位置</li>
<li>组件的开闭有组件 vue 自己控制, 外部的 js 文件只是做以上步骤, 例如这样: <a href="https://github.com/DTFE/Vimo/tree/master/raw/components/alert" target="_target" rel="nofollow">Alert 组件</a></li>
<li>组件具有完整的生命周期, 且 props 能够正常工作</li>
</ol>
<p>关键代码如下:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">var Comp = Vue.extend({
  props: [&#39;msg&#39;],
  template: &#39;&lt;div&gt;{{ msg }}&lt;/div&gt;&#39;
})
var vm = new Comp({
  el: document.getElementById(position),
  propsData: {
    msg: &#39;hello&#39;
  }
})</code></pre></div>
<h4 id="另外" style="position:relative;"><a href="#%E5%8F%A6%E5%A4%96" aria-label="另外 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>另外</h4>
<p>关于监听组件动画结束返回 Promise 的解决办法:</p>
<ol>
<li>使用<code class="language-text">transition</code>的 js 钩子, <a href="http://cn.vuejs.org/v2/guide/transitions.html#JavaScript-%E9%92%A9%E5%AD%90" target="_target" rel="nofollow">这里是说明.</a></li>
<li>开启关闭的函数返回 Promise, 但是<code class="language-text">resolve</code>方法在钩子中执行</li>
</ol>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">// 1. 开启返回Promise</span>
<span class="token function">present</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token keyword">const</span> _this <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
     _this<span class="token punctuation">.</span>isActive <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
     <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>presentCallback <span class="token operator">=</span> resolve<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>

<span class="token comment">// 2. transition中定义钩子</span>
       <span class="token operator">&lt;</span>transition name<span class="token operator">=</span><span class="token string">"alert"</span>
                    v<span class="token operator">-</span>on<span class="token operator">:</span>before<span class="token operator">-</span>enter<span class="token operator">=</span><span class="token string">"_beforeEnter"</span>
                    v<span class="token operator">-</span>on<span class="token operator">:</span>after<span class="token operator">-</span>enter<span class="token operator">=</span><span class="token string">"_afterEnter"</span>
                    v<span class="token operator">-</span>on<span class="token operator">:</span>before<span class="token operator">-</span>leave<span class="token operator">=</span><span class="token string">"_beforeLeave"</span>
                    v<span class="token operator">-</span>on<span class="token operator">:</span>after<span class="token operator">-</span>leave<span class="token operator">=</span><span class="token string">"_afterLeave"</span><span class="token operator">></span>
         <span class="token operator">...</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
       <span class="token operator">&lt;</span><span class="token operator">/</span>transition<span class="token operator">></span>

<span class="token comment">//3. 在钩子中执行presentCallback</span>
<span class="token function">_afterEnter</span> <span class="token punctuation">(</span><span class="token parameter">el</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token keyword">this</span><span class="token punctuation">.</span>enabled <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
     <span class="token comment">// 执行开启的promise</span>
     <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">presentCallback</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span></code></pre></div>
<h3 id="2-父子组合组件" style="position:relative;"><a href="#2-%E7%88%B6%E5%AD%90%E7%BB%84%E5%90%88%E7%BB%84%E4%BB%B6" aria-label="2 父子组合组件 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 父子组合组件</h3>
<p>这种组件组合方式类似于 HTML 中常用的<code class="language-text">&lt;select&gt;</code>和<code class="language-text">&lt;option&gt;</code>. 在 Vimo 中类似的组件有:<a href="https://github.com/DTFE/Vimo/tree/master/raw/components/radio" target="_target" rel="nofollow">Radio</a>/<a href="https://github.com/DTFE/Vimo/tree/master/raw/components/segment" target="_target" rel="nofollow">Segment</a>等, 大致的结构如下:</p>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ParentComponent</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>value<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ChildrenComponent</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>value1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> value1 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ChildrenComponent</span><span class="token punctuation">></span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ChildrenComponent</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>value2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> value2 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ChildrenComponent</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ParentComponent</span><span class="token punctuation">></span></span></code></pre></div>
<p>前面说到, 组件使用需要遵循 Vue 定制的规范, 但是组件开发就没那么多限制, <code class="language-text">ParentComponent</code>和<code class="language-text">ChildrenComponent</code>是联动的关系, 因此需要定下他们之间的<strong>数据交互规则</strong>:</p>
<ol>
<li>初始化时, <code class="language-text">ChildrenComponent</code>组件将自己的 this 传递给<code class="language-text">ParentComponent</code>, 父组件记录下来</li>
<li><code class="language-text">ChildrenComponent</code>点击操作时, 调用<code class="language-text">ParentComponent</code>组件的 onChildrenChange 函数, 传递自己的 value</li>
<li><code class="language-text">ParentComponent</code>组件得到 value 触发 input 更新 v-modal 值, 之后遍历子组件, 触发子组件的 refresh 方法, 传递 value</li>
<li>子组件根据最新 value 更新自己的状态</li>
<li>以上过程设置相应的对外事件</li>
<li>父子组件组合需要设置 assert, 如果 assert 失败需要给出使用提示, 比如”两个组件需要组合使用…”</li>
<li>子组件需要支持异步<code class="language-text">v-for</code>填入,</li>
<li><code class="language-text">v-model</code>默认值能正确反映到子组件</li>
</ol>
<p>基本上按照以上的步骤就能搞定类似的组件啦, 不太明白的可以参考<a href="https://github.com/DTFE/Vimo/tree/master/raw/components/radio" target="_target" rel="nofollow">Radio 组件</a>的写法.</p>
<h3 id="3-其余" style="position:relative;"><a href="#3-%E5%85%B6%E4%BD%99" aria-label="3 其余 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. 其余</h3>
<p>剩余的组件都比较好写了, 定好 props 和 event 就好, 比如:</p>
<ul>
<li>需要 Slot 部分</li>
</ul>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Header</span><span class="token punctuation">></span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Navbar</span><span class="token punctuation">></span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Title</span><span class="token punctuation">></span></span>Alert<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Title</span><span class="token punctuation">></span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Navbar</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Header</span><span class="token punctuation">></span></span></code></pre></div>
<ul>
<li>不需要 Slot 部分</li>
</ul>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Toggle</span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dark<span class="token punctuation">"</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>displayData.dark<span class="token punctuation">"</span></span> <span class="token attr-name">@onChange</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>onChangeHandler<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Toggle</span><span class="token punctuation">></span></span></code></pre></div>
<h2 id="总结" style="position:relative;"><a href="#%E6%80%BB%E7%BB%93" aria-label="总结 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>总结</h2>
<p>写组件需要对 Vue 的 API 语法有深入的了解, 写起来才会的心入手. 此外, 对于组件我持有的态度是, 能从 Github 中找到且不难的组件都不自己写, 快速看看源码没致命错误就好. 如果是业务定制性的组件, 先写在业务中, 如果共用, 则提取出来(比较懒, 😑)</p>]]></description><link>https://xiangst0816.github.io/blog/Vue-zu-jian-kai-fa/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/Vue-zu-jian-kai-fa/</guid><category><![CDATA[Vue]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Tue, 18 Apr 2017 01:50:54 GMT</pubDate></item><item><title><![CDATA[如何设计组件的API]]></title><description><![CDATA[<p>出现这个问题是因为我在排查 Toast 组的代码中, 发现现在的 API 调用感觉不够清晰, 有点像老奶奶的裹脚布一样长, 想修改但是不知道如何改.</p>
<p>这里参看了很多相同组件的 API 设计, 百花齐放, 我也不知道该怎么办了.</p>
<p>这里找了一篇文章说的挺好: <a href="http://www.woshipm.com/operate/32612.html" target="_target" rel="nofollow">如何设计一个优秀的 API</a> , 可以参考下!</p>
<h2 id="原则" style="position:relative;"><a href="#%E5%8E%9F%E5%88%99" aria-label="原则 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>原则</h2>
<h3 id="对于用户" style="position:relative;"><a href="#%E5%AF%B9%E4%BA%8E%E7%94%A8%E6%88%B7" aria-label="对于用户 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>对于用户:</h3>
<ol>
<li>易学习：有完善的文档及提供尽可能多的示例和可 copy－paste 的代码，像其他设计工作一样，你应该应用最小惊讶原则。</li>
<li>易使用：没有复杂的程序、复杂的细节，易于学习；灵活的 API 允许按字段排序、可自定义分页、 排序和筛选等。一个完整的 API 意味着被期望的功能都包含在内。</li>
<li>难误用：对详细的错误提示，有些经验的用户可以直接使用 API 而不需要阅读文档。</li>
</ol>
<h3 id="对于开发者" style="position:relative;"><a href="#%E5%AF%B9%E4%BA%8E%E5%BC%80%E5%8F%91%E8%80%85" aria-label="对于开发者 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>对于开发者:</h3>
<ol>
<li>易阅读：代码的编写只需要一次一次，但是当调试或者修改的时候都需要对代码进行阅读。</li>
<li>易开发：个最小化的接口是使用尽可能少的类以及尽可能少的类成员。这样使得理解、记忆、调试以及改变 API 更容易。</li>
</ol>
<h2 id="开发" style="position:relative;"><a href="#%E5%BC%80%E5%8F%91" aria-label="开发 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>开发</h2>
<ol>
<li>站在用户的角度</li>
<li>后续的需求能拓展</li>
<li>尽量少的做事儿是抑制 API 设计错误的有效方案</li>
<li>对外文档清晰和规范,</li>
<li>方法优于属性</li>
<li>工厂方法优于构造函数</li>
<li>避免过多继承</li>
<li>避免由于优化或者复用代码影响 API</li>
<li>面向接口编程</li>
<li>扩展参数应当是便利的</li>
<li>对组件进行合理定位，确定暴露多少接口</li>
<li>提供扩展点</li>
</ol>]]></description><link>https://xiangst0816.github.io/blog/ru-he-she-ji-zu-jian-de-di-API/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/ru-he-she-ji-zu-jian-de-di-API/</guid><category><![CDATA[思考]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Sun, 19 Mar 2017 02:15:03 GMT</pubDate></item><item><title><![CDATA[前端代码异常监控模块设计]]></title><description><![CDATA[<p>最近在做 VImo 前端 Hybrid 框架编写，基础组件完成的差不多了，在组件模块之外还需要一个日志模块，关于日志模块的设计先从需求开始(自己给自己找需求)，大概是这样：在手机模式下，希望能有一个将代码中以 console 打印出来的信息显示在这个界面上的模块，包括 log、error、warn 等信息， 这样方便在手机上调试能看到错误信息，或者是 log 信息。</p>
<p>因此，第一版的做法估计大家都会，拦截 console 方法， 将 arguments 信息转存到一个数组，然后将数组中的数据显示在这个界面上。界面用 js 动态生成，然后内容 append 到 body 里面就好，难度不大。</p>
<p>但是，仔细一想，这个是有问题的：既然我都拦截了 console，如果我想统计 error 信息，并将错误信息发送到异常监控平台，也许又是一顿改；或者 PM 给了另一个需求：将监控用户行为的代码埋点发送到处理埋点的平台，也许又要加班了。</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">try{
	helloWord()
}catch(err){
	sendReport(err)
}

var res = {
	// ...
	fail:function(){
		console.error(&#39;Can not find data! getUser.js::&lt;Function&gt;findMethod&#39;)
	}
}</code></pre></div>
<p>这里需要解释下埋点，乍一看，这个好像和拦截 console 没关系，我们需要换个角度来看下：一般定制化的统计都是需要定向埋点的，这就需要监听目标位置触发的事件，然后执行埋点程序，像下面这样：</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">$here.click(function(){
	userEvent.send(&#39;hereClick-1&#39;)
})</code></pre></div>
<p>发送使用的是 ajax 还是图片这个由业务自己选择，本质上也是一个单向的数据传递，这个和发送页面异常信息是一样，可以理解成“我埋了一个错误”，呵呵。</p>
<p>将共性提取出来，就是下面这个的图：</p>
<p><img src=""></p>
<p>我们可以将网页看做一个分布式不连续的类 App 应用，当然，SPA 单页应用会更纯粹一些。应用对外信息操作分为两类：</p>
<ol>
<li>双向通信：比如 Ajax 数据请求，或者发送数据</li>
<li>单向传递状态信息：错误异常监控、埋点等</li>
</ol>
<p>因此，这里涉及的日志模块就是为第二类准备的，功能清单如下：</p>
<ol>
<li>拦截 console 方法，如果是 error、warn、assert 方法则提取错误信息，一般为 string</li>
<li>$log 服务添加自定义的 error、warn、assert 方法，可以传递更为复杂的错误对象</li>
<li>对传入的错误信息进行归一化，try/catch 和 onerror 的错误属性是不一样的，这里需要统一</li>
<li>埋点的实现方法和$log 完全相同</li>
</ol>
<p>将前端的代码当做一个分布式的类 App</p>
<h2 id="app-对外通信方式" style="position:relative;"><a href="#app-%E5%AF%B9%E5%A4%96%E9%80%9A%E4%BF%A1%E6%96%B9%E5%BC%8F" aria-label="app 对外通信方式 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>App 对外通信方式</h2>
<h3 id="http-请求" style="position:relative;"><a href="#http-%E8%AF%B7%E6%B1%82" aria-label="http 请求 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>http 请求</h3>
<h3 id="app-日志" style="position:relative;"><a href="#app-%E6%97%A5%E5%BF%97" aria-label="app 日志 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>App 日志</h3>
<p>普通日志(log/debug/info)+异常日志(error/assert/warn)+埋点信息(analystics)</p>
<p>移动端需要将日志搜集显示在手机屏幕上的需求</p>
<p>普通的日志使用方式(显示级别不一样):</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">$log.log(&#39;message&#39;);
$log.info(&#39;message&#39;);
$log.debug(&#39;message&#39;);</code></pre></div>
<p>异常的日志使用方式:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">$log.warn(&#39;message&#39;, &#39;position&#39;);
$log.error(&#39;message&#39;, &#39;position&#39;);
$log.assert(isFalse, &#39;message&#39;, &#39;position&#39;);
$log.assert(isFalse, &#39;message&#39;, &#39;./src/test.js::&lt;Function&gt;testMethod&#39;);</code></pre></div>
<h2 id="异常搜集方式" style="position:relative;"><a href="#%E5%BC%82%E5%B8%B8%E6%90%9C%E9%9B%86%E6%96%B9%E5%BC%8F" aria-label="异常搜集方式 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>异常搜集方式</h2>
<h3 id="主动发送" style="position:relative;"><a href="#%E4%B8%BB%E5%8A%A8%E5%8F%91%E9%80%81" aria-label="主动发送 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>主动发送</h3>
<p>用于逻辑错误或状态错误.</p>
<p>在代码中的异常位置手写记录代码:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">{
	fail:function(){
		$log.error(&#39;无法得到服务器数据&#39;, &#39;./src/test.js &lt;Function&gt;testMethod&#39;)
	}
}</code></pre></div>
<h3 id="trycatch" style="position:relative;"><a href="#trycatch" aria-label="trycatch permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>try/catch</h3>
<p>能不捕获的异常有 7 类,:</p>
<ol>
<li>SyntaxError: 语法错误</li>
<li>ReferenceError: 引用错误 要用的东西没找到</li>
<li>RangeError: 范围错误 专指参数超范围</li>
<li>TypeError: 类型错误 错误的调用了对象的方法</li>
<li>EvalError: eval()方法错误的使用与 url 相关函数参数不正确，主要是 encodeURI()、decodeURI()、
encodeURIComponent()、decodeURIComponent()、escape()和 unescape()这六个函数。
eg: decodeURI(‘%2’)
Uncaught URIError: URI malformed</li>
<li>URIError: url 地址错误
eval 函数没有被正确执行</li>
<li>执行 ifream 中的方法</li>
<li>json.parse()</li>
<li>外部定义的变量, 比如 hrbyid 中定义的全局属性及方法</li>
</ol>
<p>1-4 在开发过程中避免,
5-8 需要代码运行时判断(try/catch)</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">try{
	// ....code
}catch(err){
	$log.error(&#39;无法执行代码&#39;, &#39;./src/test.js::&lt;Function&gt;testMethod&#39;, err)
}</code></pre></div>
<h3 id="windowonerror" style="position:relative;"><a href="#windowonerror" aria-label="windowonerror permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>window.onerror</h3>
<h2 id="异常搜集问题点" style="position:relative;"><a href="#%E5%BC%82%E5%B8%B8%E6%90%9C%E9%9B%86%E9%97%AE%E9%A2%98%E7%82%B9" aria-label="异常搜集问题点 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>异常搜集问题点</h2>
<ol>
<li>Script error 跨域问题. -> “Script error.“,</li>
<li>try/catch, window.onerror -> 压缩代码无法定位(由本地$log 接管封装)</li>
<li>window.onerror 只能有一个</li>
<li>采样率(大 PV 的情况下)</li>
<li>try/catch, window.onerror 返回的参数需要归一化</li>
<li>error 不同途径的参数丢失</li>
<li>message 在 console 中的展示形式</li>
</ol>
<h2 id="支持单页-spa-也支持多页" style="position:relative;"><a href="#%E6%94%AF%E6%8C%81%E5%8D%95%E9%A1%B5-spa-%E4%B9%9F%E6%94%AF%E6%8C%81%E5%A4%9A%E9%A1%B5" aria-label="支持单页 spa 也支持多页 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>支持单页 SPA 也支持多页</h2>
<p>localstroage 中备份, 初始化时先检查是否有备份. 注意 3Mb 的限制</p>
<h2 id="关于埋点" style="position:relative;"><a href="#%E5%85%B3%E4%BA%8E%E5%9F%8B%E7%82%B9" aria-label="关于埋点 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>关于埋点</h2>
<p>这里使用的是定向侵入式埋点.</p>
<p>这类的埋点都是由事件触发: performance/pointer(click/touch)/scroll/setTimeout/自定义(swiper/goBack/appLoad/appExit/), 触发之后发送 log 信息:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">$analytics(&#39;type&#39;, id)</code></pre></div>
<p>如果是 pointer 类事件, 则在 dom 中添加属性: data-analytics-id=”_id”, _id 这部分可以通过 Vuex 全局维护(类似于 i18n)</p>]]></description><link>https://xiangst0816.github.io/blog/qian-duan-dai-ma-yi-chang-jian-kong/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/qian-duan-dai-ma-yi-chang-jian-kong/</guid><category><![CDATA[前端监控]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Thu, 09 Mar 2017 05:08:25 GMT</pubDate></item><item><title><![CDATA[Vimo介绍]]></title><description><![CDATA[<p>Vimo 是一个移动端混合框架的解决方案，包含了移动设备平台信息的初始化置、基础 H5 组件及 HyBrid 组件的注册安装、公共方法包装等。决定要写这个框架也是因为自己去年一年的工作需要做个总结，故以此为载体，将我对 H5 移动端的理解及认识总结在里面。</p>
<p>Vimo 是 VueMobile 的昵称，也是名字的由来，代表他是基于 Vue.js 为基础实现的。对于框架的开发，我自认为我对框架前瞻性思维和经验还是不足，借鉴与学习也许就是我现在最该着手去做的。因为开发过 IONIC 应用，认为 IONIC 在处理组件传参指纹、平台特性初始化等方面做得很好，所以就以此为蓝图进行模仿。因此，在阅读 Vimo 源码的时候应该能看到很多 IONIC 的身影。</p>
<p>我相信每个致力于技术方向的开发人员心里面都会有一个金字塔，金字塔的底部就是自己领域的知识积累，中间是经验与技巧，最上面应该就要实现自己的知识体系与框架思想。VImo 就是一个我的一个 Top，在开发完“杭州公交 H5”项目后，认识到这个过程是必须要走的。</p>
<blockquote>
<p>也是为了在框架的基础上快开发，避免不必要的设计麻烦，节省时间多陪陪家人。</p>
</blockquote>
<p>关于 Vimo 接下来的介绍，我将以问题的形式进行：</p>
<h2 id="1-什么是混合框架-设计的目的是什么" style="position:relative;"><a href="#1-%E4%BB%80%E4%B9%88%E6%98%AF%E6%B7%B7%E5%90%88%E6%A1%86%E6%9E%B6-%E8%AE%BE%E8%AE%A1%E7%9A%84%E7%9B%AE%E7%9A%84%E6%98%AF%E4%BB%80%E4%B9%88" aria-label="1 什么是混合框架 设计的目的是什么 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 什么是混合框架, 设计的目的是什么?</h2>
<p>设计的目的：便于在各个系统(网页/平台/壳子)中都能步调一致的工作，将不同的部分抽离出页面，也便于调试！</p>
<h2 id="问题搜集" style="position:relative;"><a href="#%E9%97%AE%E9%A2%98%E6%90%9C%E9%9B%86" aria-label="问题搜集 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题搜集</h2>
<p><strong>什么是混合框架, 设计的目的是什么?</strong></p>
<table>
<thead>
<tr>
<th align="center">纯 H5 实现</th>
<th align="center">纯 App 方案</th>
<th align="center">HyBrid 方案</th>
<th align="center">类 ReactNative 方案</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">效率高, 性能低</td>
<td align="center">效率低, 性能高, 灵活性低</td>
<td align="center">折中, 需要 bridge</td>
<td align="center">特殊业务需要定制化开发插件</td>
</tr>
</tbody>
</table>
<p>设计的目的：便于在各个系统(网页/平台/壳子)中都能步调一致的工作，将不同的部分抽离出页面，也便于调试！</p>
<p>现在的一种这种方案:</p>
<ul>
<li>Vimo 设计思路来源于 IONIC, 为何选用 Vue 重构?</li>
<li>IONIC 的设计可以借鉴学习, 我对 vue 比较熟, 简单+快</li>
<li>IONIC Angular2.x + Typescript 陡峭+维护复杂</li>
<li>react 不熟, 但是从测试角度来看, vue 稍强</li>
<li>组件间嵌套规则是怎样的, 公共服务是如何注册到 this 上的? 为何要这样做?</li>
</ul>
<p>App -> Nav -> | Page | -> Header/Content/Footer</p>
<p>覆盖大多数场景的布局结构</p>
<ul>
<li>各个模块的作用介绍, 和简单的实现思路?</li>
</ul>
<p>App: 主体
Nav: 路由切换的 wrap, 动画部分
Page: 业务页面</p>
<ul>
<li>从我的角度来看你 Vimo 的不足和需要改进的地方</li>
<li>计划: IONIC 的皮肤+ vue 的核心, 展示 IOS/md/wp/wechat/ali/cus</li>
<li>只需要一个主题</li>
<li>IONIC 实现有些复杂, 有些代码没看懂</li>
<li>组件主要依据功能清单写的.</li>
<li>对 test 支持</li>
<li>hybrid 如何进行安装的由 hybrid 自己安装</li>
</ul>
<p>改进的地方：</p>
<ol>
<li>没实际的项目测试及运用，</li>
<li>关于样式的处理，计划简单点, 例如只支持 IOS 的</li>
<li>设计大多数是向类杭州公交【富 APP】方向靠，如果对单个页面的业务支持需要再改版.</li>
<li>列表组件及附属组件有些事不必要的. 需要剔除</li>
</ol>]]></description><link>https://xiangst0816.github.io/blog/Vimo-jie-shao/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/Vimo-jie-shao/</guid><category><![CDATA[Vue]]></category><category><![CDATA[Vimo]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Thu, 23 Feb 2017 02:03:38 GMT</pubDate></item><item><title><![CDATA[烈风裘的前端技能]]></title><description><![CDATA[<ul>
<li>切图 - Photosho - 切图插件 Cutterman - 标注插件 Parker - 图片压缩 ImageOptim/HummingBird</li>
<li>HTML - HTML 基础 - 基础标签技术性 - 语义化及 SEO - meta 属性 - 移动端 viewport 设置 - 块级元素/行内元素 - HTML 媒体 - HTML API - SSE/Web Works/拖放(了解) - 存储/定位/全屏/页面状态(是否当前浏览) - 全局属性 - contenteditable（是否允许编辑） - draggable（是否允许拖动） - drapzone（被拖动的目标被拖放到元素中会发生什么） - hidden - spellcheck（拼写检查） - id/class/title/dir/tabindex/lang - HTML 图形 - SVG/Canvas(了解) - 快速编辑 Emmet</li>
<li>
<p>CSS - CSS 选择器(了解写法对浏览器性能的开销) - CSS 核心点 - 浮动与清除浮动 - 居中 - 透明滤镜 - 布局 - display/position - float - flex - overflow - 基础样式 - 背景/边框/文本/字体/连接/表格/轮廓/3D - 用户界面 - 盒模型 - transform 变换 - transform（二维变换，平移、缩放、扭曲） - transforn-origin - transition 过度 - transition-property：检索或设置对象中的参与过渡的属性[all] - transition-duration - transition-timing-function - transition-delay - animation 动画 - CSS 引用方式 - 外部样式表 - 内部样式表 - 内联样式表 - 常用布局 (了解 HTML 书写顺序对网页渲染性能的影响) - CSS hack (常用的有总结)</p>
<p>  	- CSS前处理器
- Scss
- CSS后处理器
- PostCss/Autoprefix
- BEM命名法(面向对象的CSS)</p>
</li>
<li>JavaScript - Js 引用方式 - 外部/内联 - Script 异步加载方式 - async - 异步下载, 下载完毕后立即执行 - defer - 异步下载, 等待 DOM 解析完毕触发 DOMContentLoaded 事件之前 - 数据类型 - 数值类型 - 引用类型 - Object - Array 基础属性/方法 - Date 基础属性/方法 - RegExp 常用实例 - String 基础属性/方法 - 类型检测 - typeof/instance of/Object 类型拆分 - 深浅拷贝 (总结过) - 函数 - 理解 this - 作用于及作用域链 - 类 (原生写法/ES6) - call/apply - 绑定 this 的 - 闭包 - 模块化 - ES6 - Math - 常用方法 - DOM - DOM 基础操作(需要不定时查看文档) - 事件绑定/代理/队列 - BOM - 获取浏览器参数 - JSON - 对象的深拷贝 - 其他 - setTimeout 异步 - setInternal/requestAnimationFrame - try/catch - ES6 (掌握及使用了 70%) - 加密库 - md5/base64/sha1</li>
<li>综合 - 页面性能优化及调试(雅虎军规) - 缓存处理 - 调试 - PC: Chrome - Mobile: 微信开发者工具/二维码/ - 线上抓包: Charles - API 测试: Postman - 跨域处理</li>
<li>前端自动化 - Gulp(很熟悉, 能直接写任务) - Webpack(知道原理, 正在使用) - 依赖管理: npm/cnpm/yarn</li>
<li>IDE: WebStorm/Brackets</li>
<li>版本管理 - SVN(CornerStone) - Git(SourceTree/GitHub Desktop)</li>
<li>框架 - jQuery/zepto - Angular1.x/Vue2.x - Leaflet - IONIC1.x - Lodash/Moment/…</li>
<li>软技能 - 写作能力(正在锻炼) - 协作(能一个人做完的不交给两个人做) - 沟通(需要磨合)</li>
<li>想学的 - Weex - IONIC 2.x - Nodejs - 达到熟练的程度</li>
<li>今年计划 - Vimo: 基于 Vue2.x 的移动端 Hybrid 框架(完成 40%) - Vida: 基于 Vue2.x 的桌面框架(未开进行) - 深入了解 Nodejs 的中途岛模式(未开进行) - 发布 50 篇技术文章(不是硬性的)</li>
</ul>]]></description><link>https://xiangst0816.github.io/blog/lie-feng-qiu-de-di-qian-duan-ji-neng-nai/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/lie-feng-qiu-de-di-qian-duan-ji-neng-nai/</guid><category><![CDATA[随笔]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Sun, 19 Feb 2017 01:18:59 GMT</pubDate></item><item><title><![CDATA[浏览器兼容性问题及解决方案(CSS部分)]]></title><description><![CDATA[<p><img src="https://drscdn.500px.org/photo/72944089/m%3D2048/bee828b2bca1bca21d335bccae466489" alt="可畏的前端"></p>
<p>浏览器兼容性问题是指因为不同的浏览器对同一段 CSS 代码或者 JS 代码解析不同导致页面显示效果不统一或者脚本执行错误的情况。一般情况下，我们希望用户无论使用什么浏览器来查看网页效果都应该是一样的。浏览器的兼容性问题是 Web 前端开发人员经常会碰到的和必须要解决的问题。</p>
<p>浏览器兼容的部分一般分为 CSS 部分和 JS 部分，JS 部分请参考<a href="http://www.jianshu.com/p/8cd605d14e19" target="_target" rel="nofollow">这里</a>。</p>
<p>相关的问题已近在前端界整理的很充分了，大致的问题可总结如下：</p>
<ul>
<li>浏览器的初始化样式不同导致兼容性的问题</li>
<li>局部样式解析不同导致的 bug</li>
</ul>
<blockquote>
<p>有些文章把样式使用技巧也放到兼容性的问题里面，这有失偏颇，关于常用样式使用技巧在<a href="http://www.jianshu.com/p/25eaac282b0d" target="_target" rel="nofollow">另一边文章</a>叙述，这里不重复。</p>
</blockquote>
<h2 id="1-浏览器的初始化样式不同导致兼容性的问题" style="position:relative;"><a href="#1-%E6%B5%8F%E8%A7%88%E5%99%A8%E7%9A%84%E5%88%9D%E5%A7%8B%E5%8C%96%E6%A0%B7%E5%BC%8F%E4%B8%8D%E5%90%8C%E5%AF%BC%E8%87%B4%E5%85%BC%E5%AE%B9%E6%80%A7%E7%9A%84%E9%97%AE%E9%A2%98" aria-label="1 浏览器的初始化样式不同导致兼容性的问题 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 浏览器的初始化样式不同导致兼容性的问题</h2>
<p>对于这个问题可以一上来就是用<code class="language-text">*{margin:0;padding:0;}</code>，不过这个代码的杀伤力有些大，如果用户自定义样式未加载进来，则整个页面的布局毫无结构可言。</p>
<p>所以这里出现两个浏览器默认样式重置库：<a href="http://necolas.github.io/normalize.css/" target="_target" rel="nofollow">Normalize.css</a>和<a href="http://meyerweb.com/eric/tools/css/reset/" target="_target" rel="nofollow">reset.css</a>，上面的链接是项目的介绍。</p>
<p>关于这两个库的对比介绍也<a href="https://segmentfault.com/q/1010000000117189" target="_target" rel="nofollow">比较详细</a>，简单的说：<strong>Normalize</strong> 的理念则是尽量保留浏览器的默认样式，不进行太多的重置；而<strong>Reset</strong>的目的，是将所有的浏览器的自带样式重置掉，这样更易于保持各浏览器渲染的一致性。</p>
<p>浏览器默认样式重置就像是贴墙纸前先上一遍腻子将墙抹之后再贴。Normalize.css 或者 Reset.css 需要在所有样式引用前引用。就我个人而言，使用 Normalize.css 比较多一些。</p>
<h2 id="2-局部样式解析不同导致的-bug" style="position:relative;"><a href="#2-%E5%B1%80%E9%83%A8%E6%A0%B7%E5%BC%8F%E8%A7%A3%E6%9E%90%E4%B8%8D%E5%90%8C%E5%AF%BC%E8%87%B4%E7%9A%84-bug" aria-label="2 局部样式解析不同导致的 bug permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 局部样式解析不同导致的 bug</h2>
<p>其实，这里主要是<strong>IE 浏览器</strong>和<strong>非 IE 浏览器</strong>之间的解析区别。如果使用了 normalize 或者 reset 后能处理大部分的问题，下面是剩余的部分：</p>
<h4 id="21-透明度的兼容-css-设置" style="position:relative;"><a href="#21-%E9%80%8F%E6%98%8E%E5%BA%A6%E7%9A%84%E5%85%BC%E5%AE%B9-css-%E8%AE%BE%E7%BD%AE" aria-label="21 透明度的兼容 css 设置 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2.1 透明度的兼容 CSS 设置</h4>
<p><strong>解决方式：</strong></p>
<ul>
<li>IE：filter:progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=60)。</li>
<li>非 IE：opacity:0.6。</li>
</ul>
<h4 id="22-默认的盒子解析模型" style="position:relative;"><a href="#22-%E9%BB%98%E8%AE%A4%E7%9A%84%E7%9B%92%E5%AD%90%E8%A7%A3%E6%9E%90%E6%A8%A1%E5%9E%8B" aria-label="22 默认的盒子解析模型 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2.2 默认的盒子解析模型</h4>
<p>标准 w3c 盒子模型的范围包括 margin、border、padding、content，并且 content 部分不包含其他部分； IE 盒子模型的范围也包括 margin、border、padding、content。</p>
<p>和标准 w3c 盒子模型不同的是：ie 盒子模型的 content 部分包含了 border 和 pading。</p>
<p>因此，问题主要表现在 css 中的 width 是否计算 border 和 padding 的问题，这个是默认的盒子解析模型不同导致的。</p>
<p><strong>IE6：</strong>中包括 border 和 padding<code class="language-text">(box-sizing: border-box;)</code><br>
<strong>IE7 和非 IE：</strong>width 宽度不包括 border 和 padding<code class="language-text">(box-sizing: content-box;)</code></p>
<p><strong>解决方式：</strong> 根据使用方式，写好 box-sizing 属性。</p>
<h4 id="23-浮动问题" style="position:relative;"><a href="#23-%E6%B5%AE%E5%8A%A8%E9%97%AE%E9%A2%98" aria-label="23 浮动问题 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2.3 浮动问题</h4>
<p>主要表现是子元素使用了浮动，而父元素没有撑开盒子，下面是解决的代码，加载父元素上就好。</p>
<p><strong>解决技巧：</strong></p>
<div class="gatsby-highlight" data-language="css"><pre class="language-css"><code class="language-css"><span class="token selector">.clearfix:before, .clearfix:after</span> <span class="token punctuation">{</span>   <span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">" "</span><span class="token punctuation">;</span> <span class="token comment">/* 1 */</span>   <span class="token property">display</span><span class="token punctuation">:</span> table<span class="token punctuation">;</span> <span class="token comment">/* 2 */</span> <span class="token punctuation">}</span>
 <span class="token selector">.clearfix:after</span> <span class="token punctuation">{</span>   <span class="token property">clear</span><span class="token punctuation">:</span> both<span class="token punctuation">;</span> <span class="token punctuation">}</span></code></pre></div>
<h4 id="24-高度不适应" style="position:relative;"><a href="#24-%E9%AB%98%E5%BA%A6%E4%B8%8D%E9%80%82%E5%BA%94" aria-label="24 高度不适应 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2.4 高度不适应</h4>
<p>高度不适应是当内层对象的高度发生变化时外层高度不能自动进行调节，特别是当内层对象使用 margin 或 padding 时。</p>
<p><strong>例如：</strong></p>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html">#box {background-color:#eee; }
#box p {margin-top: 20px;margin-bottom: 20px; text-align:center; }
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>box<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>p对象中的内容＜/p>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></code></pre></div>
<p><strong>解决技巧：</strong></p>
<ol>
<li>在 P 对象上下各加 2 个空的 div 对象 CSS 代码{height:0px;overflow:hidden;}</li>
<li>或者为 DIV 加上 border 属性</li>
</ol>
<h4 id="25-滚动条颜色设置" style="position:relative;"><a href="#25-%E6%BB%9A%E5%8A%A8%E6%9D%A1%E9%A2%9C%E8%89%B2%E8%AE%BE%E7%BD%AE" aria-label="25 滚动条颜色设置 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2.5 滚动条颜色设置</h4>
<p>IE 无法设置滚动条颜色了, 解决办法是将 body 换成 html</p>
<p><strong>解决技巧：</strong></p>
<div class="gatsby-highlight" data-language="css"><pre class="language-css"><code class="language-css"><span class="token selector">html</span> <span class="token punctuation">{</span>
  <span class="token property">scrollbar-face-color</span><span class="token punctuation">:</span> #f6f6f6<span class="token punctuation">;</span>
  <span class="token property">scrollbar-highlight-color</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
  <span class="token property">scrollbar-shadow-color</span><span class="token punctuation">:</span> #eeeeee<span class="token punctuation">;</span>
  <span class="token property">scrollbar-3dlight-color</span><span class="token punctuation">:</span> #eeeeee<span class="token punctuation">;</span>
  <span class="token property">scrollbar-arrow-color</span><span class="token punctuation">:</span> #000<span class="token punctuation">;</span>
  <span class="token property">scrollbar-track-color</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
  <span class="token property">scrollbar-darkshadow-color</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<h4 id="26-超链接访问过后-hover-样式就不出现的问题" style="position:relative;"><a href="#26-%E8%B6%85%E9%93%BE%E6%8E%A5%E8%AE%BF%E9%97%AE%E8%BF%87%E5%90%8E-hover-%E6%A0%B7%E5%BC%8F%E5%B0%B1%E4%B8%8D%E5%87%BA%E7%8E%B0%E7%9A%84%E9%97%AE%E9%A2%98" aria-label="26 超链接访问过后 hover 样式就不出现的问题 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2.6 超链接访问过后 hover 样式就不出现的问题</h4>
<p>被点击访问过的超链接样式不在具有 hover 和 active 了,很多人应该都遇到过这个问题,解决技巧是改变 CSS 属性的排列顺序: L-V-H-A</p>
<p><strong>解决技巧：</strong></p>
<div class="gatsby-highlight" data-language="css"><pre class="language-css"><code class="language-css"><span class="token selector">a:link</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
<span class="token selector">a:visited</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
<span class="token selector">a:hover</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
<span class="token selector">a:active</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span></code></pre></div>
<h4 id="27-条件注释" style="position:relative;"><a href="#27-%E6%9D%A1%E4%BB%B6%E6%B3%A8%E9%87%8A" aria-label="27 条件注释 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2.7 条件注释</h4>
<p>在 html 中加入条件判断，选择激活哪些部分</p>
<p><strong>解决技巧：</strong></p>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/css<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>css.css<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>

<span class="token comment">&lt;!--[if IE 7]>
&lt;link rel="stylesheet" type="text/css" href="ie7.css" />
&lt;![endif]--></span>

<span class="token comment">&lt;!--[if lte IE 6]>
&lt;link rel="stylesheet" type="text/css" href="ie.css" />
&lt;![endif]--></span>

lte -- 小于等于
lt  -- 小于
gte --  大于等于
gt  --  大于
！ --  不等于</code></pre></div>
<h4 id="28-background-attachmentfixed-在-ios-下失效的-hack" style="position:relative;"><a href="#28-background-attachmentfixed-%E5%9C%A8-ios-%E4%B8%8B%E5%A4%B1%E6%95%88%E7%9A%84-hack" aria-label="28 background attachmentfixed 在 ios 下失效的 hack permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2.8 background-attachment:fixed 在 ios 下失效的 hack</h4>
<p>ios 系统和某些移动端 background-attachment:fixed 不兼容性，没有任何效果，但可以 hack 一下就可以了，代码如下:</p>
<p>ps：想在哪个标签加背景，可以在它 class 后:before.</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">body:before {
  content: &#39; &#39;;
  position: fixed;
  z-index: -1;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  background: url(path/to/image) center 0 no-repeat;
  background-size: cover;
}</code></pre></div>
<h4 id="29-calc-使用" style="position:relative;"><a href="#29-calc-%E4%BD%BF%E7%94%A8" aria-label="29 calc 使用 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2.9 Calc 使用</h4>
<p>浏览器支持的不是很好，而且在使用的时候要加上厂商前缀，达到兼容性。另外，注意减号之间的空格。</p>
<div class="gatsby-highlight" data-language="css"><pre class="language-css"><code class="language-css"><span class="token property">width</span><span class="token punctuation">:</span> <span class="token function">calc</span><span class="token punctuation">(</span>100% - 80px<span class="token punctuation">)</span><span class="token selector">;

#formbox</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 130px<span class="token punctuation">;</span>
  <span class="token comment">/*加厂商前缀，操作符（+，-，*，/）两边要有空格）*/</span>
  <span class="token property">width</span><span class="token punctuation">:</span> <span class="token function">-moz-calc</span><span class="token punctuation">(</span>100% / 6<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> <span class="token function">-webkit-calc</span><span class="token punctuation">(</span>100% / 6<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> <span class="token function">calc</span><span class="token punctuation">(</span>100% / 6<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">border</span><span class="token punctuation">:</span> 1px solid black<span class="token punctuation">;</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> 4px<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<h2 id="最后" style="position:relative;"><a href="#%E6%9C%80%E5%90%8E" aria-label="最后 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>最后</h2>
<p>除去以上的总结，还有很多是关于在 IE6 下的 Hack，但是这个“老古董”在市面上的占有率已近相当低了，另外，按照由上到下的开发模式(优先兼容高级浏览器)，IE8 及以下的浏览器都可不用重点考虑。因此，关于样式兼容性的问题重点放到<strong>浏览器样式重置</strong>、<strong>flex 布局</strong>、<strong>CSS 预处理器(SCSS/Less)</strong>、<strong>CSS 后处理器(Autoprefixer/Postcss/Cssnano)</strong>上就可以解决大部分问题。</p>
<p>此外，关于 Hack 的问题不需要全部记住，只需要记住大概的问题点，在做布局的时候尽量避免，遇到问题查问题。我认为这部分问题会随着技术或者浏览器的更迭而全部解决，因此不需要放太多精力。</p>
<h2 id="参考连接" style="position:relative;"><a href="#%E5%8F%82%E8%80%83%E8%BF%9E%E6%8E%A5" aria-label="参考连接 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>参考连接</h2>
<ul>
<li><a href="https://www.zhihu.com/question/20094066" target="_target" rel="nofollow">Normalize.css 与传统的 CSS Reset 有哪些区别</a></li>
<li><a href="https://segmentfault.com/a/1190000003021766" target="_target" rel="nofollow">关于 CSS Reset 那些事（一）之 历史演变与 Normalize.css</a></li>
<li><a href="https://segmentfault.com/a/1190000003025718" target="_target" rel="nofollow">关于 CSS Reset 那些事（二）之 Normalize.css 源码解读</a></li>
<li><a href="https://segmentfault.com/a/1190000003028985" target="_target" rel="nofollow">关于 CSS Reset 那些事（三）之 Normalize-zh.css 出炉</a></li>
</ul>]]></description><link>https://xiangst0816.github.io/blog/liu-lan-qi-jian-rong-xing-wen-ti-ji-jie/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/liu-lan-qi-jian-rong-xing-wen-ti-ji-jie/</guid><category><![CDATA[兼容问题]]></category><category><![CDATA[CSS]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Wed, 08 Feb 2017 03:18:49 GMT</pubDate></item><item><title><![CDATA[vueMobile组件(组件间通讯)]]></title><description><![CDATA[<p>移动端组件的编写和 PC 端组件的编写是不同的，PC 端组件见的通讯及状态共享很简单，基本上井水不犯河水，但是移动端组件的却不是这样：ion-title 组件希望共享自己的控制权，便于业务动态修改、menu 组件弹开的手，希望页面也能向右移动下、页面切换的时候，自动关闭 ActionSheet 组件等。下面是我在组件编写时踩得坑，如果感兴趣或者有同样的思考可以和我联系。</p>
<h2 id="组件间通讯" style="position:relative;"><a href="#%E7%BB%84%E4%BB%B6%E9%97%B4%E9%80%9A%E8%AE%AF" aria-label="组件间通讯 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>组件间通讯</h2>
<p>基础组件的组件见通讯使用的比较多，比如 menu 组件打开需要通知 nav 组件是否移动等，如果直接上 Vuex，基础组件间的通讯与业务逻辑的通讯将混为一起，不方便开发调试。另外，项目是否上 Vuex 也是未知数，所以这里确定：vueMobile 组件间通讯走 EventBus，业务间状态同步是否上 Vuex 根据规模选择使用。这也算是自己编写组件前一致坚持的：</p>
<blockquote>
<p>我想在编写业务页面的时候，能清爽一点。</p>
</blockquote>
<p>下图是简单的机构说明：</p>
<p><img src=""></p>
<h2 id="公共组件方法提取" style="position:relative;"><a href="#%E5%85%AC%E5%85%B1%E7%BB%84%E4%BB%B6%E6%96%B9%E6%B3%95%E6%8F%90%E5%8F%96" aria-label="公共组件方法提取 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>公共组件方法提取</h2>
<p>基础组件通过 Vue.install 安装到全局，但是组件中的某些方法是需要在业务代码中直接调用的，比如控制页面是否能滚动、是否能点击、设置标题、返回顶部等方法。另一方面，组件在注册返回的始终是构造器，而不是<code class="language-text">鲜活的</code>组件实例：</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">// 获取注册的组件（始终返回构造器）
var MyComponent = Vue.component(&#39;my-component&#39;)</code></pre></div>
<p>也就是说：<strong>组件只有被页面初始化的时候才会存在生命，才存在这个组件内部的 this</strong>。</p>
<h3 id="子组件希望共享对自己的控制权，这个怎么做？" style="position:relative;"><a href="#%E5%AD%90%E7%BB%84%E4%BB%B6%E5%B8%8C%E6%9C%9B%E5%85%B1%E4%BA%AB%E5%AF%B9%E8%87%AA%E5%B7%B1%E7%9A%84%E6%8E%A7%E5%88%B6%E6%9D%83%EF%BC%8C%E8%BF%99%E4%B8%AA%E6%80%8E%E4%B9%88%E5%81%9A%EF%BC%9F" aria-label="子组件希望共享对自己的控制权，这个怎么做？ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>子组件希望共享对自己的控制权，这个怎么做？</h3>
<p>比如业务页面中的<code class="language-text">ion-title</code>组件自身实现了<code class="language-text">setTitle</code>方法来控制 Title 的显示，但是这个方法希望在业务页面中能调用，方便用户自定义 Title(包括修改 document.title 的 Hack 方法)。例如如下的结构：</p>
<div class="gatsby-highlight" data-language="jsx"><pre class="language-jsx"><code class="language-jsx"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ion-page</span><span class="token punctuation">></span></span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ion-header</span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ion-navbar</span><span class="token punctuation">></span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ion-title</span> <span class="token attr-name">slot</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>content<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token plain-text">Demo</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ion-title</span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ion-navbar</span><span class="token punctuation">></span></span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ion-header</span><span class="token punctuation">></span></span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ion-content</span><span class="token punctuation">></span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">content</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ion-content</span><span class="token punctuation">></span></span><span class="token plain-text">
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ion-page</span><span class="token punctuation">></span></span></code></pre></div>
<p>这样的需求实现有两个方法：</p>
<ol>
<li><strong>在业务 this 中找到子组件的 this</strong>：在业务页面的 this 通过逐层查找$children 中 ion-title 组件，然后执行找到的组件的 child.setTitle(val)方法。</li>
<li><strong>子组件将自己放到全局</strong>：ion-title 组件初始化时，向全局挂载，比如挂载到 Vue 的 prototype 上：<code class="language-text">Vue.prototype.setTitle=ins.setTitle</code>；或者挂载到 window 上。当页面切换后，需要重复此操作。挂载到 Vue 上，业务页面可以通过 this 访问到，并且页面模板也能直接使用，较为方便。</li>
</ol>
<p>另外，路由开启<code class="language-text">keep-alive</code>时，组件也能正常工作的情况别忘记考虑，此时页面切换只有<code class="language-text">activated/deactivated</code>钩子工作，业务内的组件不会因为外面是<code class="language-text">keep-alive</code>而自我更新的，相当于变成了<strong>墓碑</strong>。</p>
<p>此外，<code class="language-text">ion-page</code>外层的<code class="language-text">ion-app/ion-nav</code>是所有业务页面公用的，每次业务页面切换再提取父组件的内容可能不太合适。</p>
<p>因此，vueMobile 组件是这样做的：</p>
<ol>
<li>业务页面的子组件使用 mixins 遍历 this 提取公共方法，提取方法在 created 和 activated 钩子上都注册方法，挂载前判断是否已挂载；</li>
<li>业务页面的父组件使用 Vue.prototype 将自己挂载到全局上。</li>
</ol>
<p>下面是对这个过程的说明：</p>
<p><img src=""></p>
<h2 id="backdrop-组件" style="position:relative;"><a href="#backdrop-%E7%BB%84%E4%BB%B6" aria-label="backdrop 组件 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Backdrop 组件</h2>
<p>同时打开两个带有 Backdrop 的 Loading 组件，这个该怎么显示呢？答案是只显示一次 Backdrop！因此 Backdrop 组件的设计需要脱离 Loading、Toast、ChooseSheet 等组件。</p>
<h2 id="choosesheet-组件" style="position:relative;"><a href="#choosesheet-%E7%BB%84%E4%BB%B6" aria-label="choosesheet 组件 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ChooseSheet 组件</h2>
<p>其实这个组件是 ActionSheet 的变种，因为此组件的展现样式被发现在多处被使用到，比如：Timepicker、购物车、选择商品尺码、选择地址等。</p>]]></description><link>https://xiangst0816.github.io/blog/vueMobile-zu-jian/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/vueMobile-zu-jian/</guid><category><![CDATA[Vue]]></category><category><![CDATA[Mobile]]></category><category><![CDATA[组件通信]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Mon, 06 Feb 2017 05:22:14 GMT</pubDate></item><item><title><![CDATA[关于埋点浅谈]]></title><description><![CDATA[<p>埋点适用于分析用户的使用行为，通过搜集分析数据推进用户体验，进而优化产品或者挖掘用户习惯推出新产品等。</p>
<p>埋点方式分为前端和后端，这里主要谈谈前端的实现。埋点方案现在业界已经比较成熟了，可分为：有码埋点、可视化埋点、无码埋点三种，<a href="http://www.jianshu.com/p/afd601e07bf0" target="_target" rel="nofollow">这里是介绍</a>。简单的说就是这样：</p>
<ul>
<li>有码埋点: 埋点锚点植入业务代码中描述 优点 缺点埋点锚点植入业务代码中(JS 或者 HTML 中) 高耦合，精确控制 技术人员手工添加修改因为无代码，不移维护修改，易出错，埋点前的方案都清楚</li>
<li>可视化埋点 通过元素的页面结构定位埋点位置，业务代码与埋点代码分离 可对线上代码修改，</li>
</ul>
<h4 id="有码埋点" style="position:relative;"><a href="#%E6%9C%89%E7%A0%81%E5%9F%8B%E7%82%B9" aria-label="有码埋点 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>有码埋点</h4>
<p>熟悉 Google Analytics 的同学都知道这个，除了 PV 统计外，GA 还提供了追踪访客和网站的互动的功能，尤其是追踪那些不产生新页面的访问行为（例如下载文件），很多类似的产品都叫自定义事件功能，说的就是它。有码埋点是目前业内最为熟悉且被广泛采用的一种数据接入手段。</p>
<p>拿 Google Analytics 为例，可以利用_trackEvent()方法来进行事件追踪。它的详细参数如下：_trackEvent(category, action, opt<em>label, opt</em>value, opt_noninteraction)</p>
<ul>
<li>category（必需）：类别</li>
<li>action（必需）：和用户的行为对应，例如“下载”</li>
<li>label：标签，其他有关信息</li>
<li>value：提供数值型数据</li>
<li>non-interaction：布尔值。</li>
</ul>
<p>如果你想在追踪链接的，给需要追踪的链接调用_trackEvent()方法并设置参数，加上调用的方法 onclick 即可。优点是可以对发送的内容做到精准控制，对于上线后影响因素较小数据埋点它无疑是最适用的。缺点也很明显，对页面元素的埋点都需要手工添加代码，工作量无疑是巨大的，必须是技术人员参与才能完成，埋点地方过多也容易出错。代码埋点的理想化在于事先把数据收集方案都想明白，而在实际情况下很难做到。</p>
<h4 id="可视化埋点" style="position:relative;"><a href="#%E5%8F%AF%E8%A7%86%E5%8C%96%E5%9F%8B%E7%82%B9" aria-label="可视化埋点 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>可视化埋点</h4>
<p>有码埋点无疑是苦逼的，成本高而且容易出错，如果想修改的话还得重新上线，尤其对 APP 开发者来说更是苦难，漫长的审核期客户端的更新成本都是不容忽略的。</p>
<p>所以为了解决这些问题，有些专业做数据分析的厂商提出来更加敏捷和聪明的方案，以 Kissmetrics 和 Mixpanel 为代表的数据分析服务商提供了可视化埋点的方案，以 Click to Track 的方式代替了手工埋点，<strong>实现了埋点的配置与应用本身的分离</strong>，每次用户打开应用时，只需要把新的埋点配置重新下载到客户端即可，而无须频繁更新客户端版本。拿 Kissmetrics 为例，</p>]]></description><link>https://xiangst0816.github.io/blog/guan-yu-mai-man-dian-qian-jian-tan/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/guan-yu-mai-man-dian-qian-jian-tan/</guid><category><![CDATA[埋点]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Sun, 22 Jan 2017 02:15:17 GMT</pubDate></item><item><title><![CDATA[JavaScript 核心技能点]]></title><description><![CDATA[<blockquote>
<p>下面列出来的是 JavaScript 总结大纲，详细内容会继续展开，待续。。</p>
</blockquote>
<h2 id="基础" style="position:relative;"><a href="#%E5%9F%BA%E7%A1%80" aria-label="基础 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>基础</h2>
<ul>
<li>
<p>数据类型相关</p>
<ul>
<li>基础类型(Number/String/Boolean/Null/undefined)</li>
<li>引用类型(object/function/array/date)</li>
<li>深浅拷贝</li>
<li>类型对应的操作方法</li>
</ul>
</li>
<li>
<p>函数相关</p>
<ul>
<li>内部属性(this)</li>
<li>外部属性(arguments/length/name/protorype)</li>
<li>call/apply</li>
<li>bind</li>
<li>作用域及作用域链</li>
<li>类/闭包/原型继承</li>
<li>模块化</li>
<li>错误及调试</li>
</ul>
</li>
<li>
<p>Ajax</p>
<ul>
<li>创建过程</li>
<li>响应码 readystate</li>
<li>跨域请求</li>
<li>请求方式</li>
<li>jsonp</li>
</ul>
</li>
<li>
<p>jQuery</p>
<ul>
<li>流式 API</li>
<li>DOM 操作</li>
<li>通用工具及方法</li>
<li>选择器及事件队列</li>
<li>ajax 方法</li>
</ul>
</li>
</ul>
<h2 id="进阶" style="position:relative;"><a href="#%E8%BF%9B%E9%98%B6" aria-label="进阶 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>进阶</h2>
<ul>
<li>雅虎军规熟记</li>
<li>代码优化</li>
<li>HTML/CSS/JavaScript 书写结构优化</li>
<li>请求优化</li>
<li>合理分流</li>
<li>
<p>移动端性能优化</p>
<ul>
<li>网络传输优化</li>
<li>DOM 操作优化</li>
<li>内存资源优化</li>
<li>体验优化</li>
</ul>
</li>
<li>
<p>常见算法</p>
<ul>
<li>冒泡排序</li>
<li>插入排序</li>
<li>希尔排序</li>
<li>快速排序</li>
</ul>
</li>
<li>
<p>数据结构</p>
<ul>
<li>数组</li>
<li>列表</li>
<li>栈</li>
<li>队列</li>
<li>链表</li>
<li>字典</li>
<li>散列</li>
<li>集合</li>
<li>二叉树</li>
<li>图</li>
<li>排序算法</li>
<li>检索算法</li>
</ul>
</li>
<li>
<p>高性能 JavaScript</p>
<ul>
<li>脚本加载和执行</li>
<li>数据存储</li>
<li>DOM 操作</li>
<li>算法和流程控制</li>
<li>字符串及正则</li>
<li>控制 js 处理时长</li>
<li>ajax 异步数据的运用</li>
<li>语言使用习惯(eval/with/new/原生方法)</li>
<li>js 压缩/Gzip/md5 命名/CDN</li>
</ul>
</li>
<li>
<p>常用 JS 框架</p>
<ul>
<li>reactjs</li>
<li>vuejs</li>
<li>angularjs 1.x</li>
<li>jquery</li>
<li>zepto</li>
<li>lodash</li>
<li>nodejs</li>
<li>express</li>
</ul>
</li>
<li>
<p>构建工具</p>
<ul>
<li>gulp</li>
<li>webpack</li>
<li>fis</li>
<li>yeoman</li>
</ul>
</li>
<li>
<p>MVC/MVVM 概念</p>
<ul>
<li>区别</li>
<li>框架代表</li>
<li>使用范围</li>
</ul>
</li>
<li>
<p>ECMAScript5</p>
<ul>
<li>语法</li>
<li>babel</li>
<li>promise</li>
</ul>
</li>
</ul>]]></description><link>https://xiangst0816.github.io/blog/JavaScript-he-hu-xin-ji-neng-nai-dian/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/JavaScript-he-hu-xin-ji-neng-nai-dian/</guid><category><![CDATA[随笔]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Tue, 27 Dec 2016 14:03:09 GMT</pubDate></item><item><title><![CDATA[Vue2之去掉组件的click事件的native修饰]]></title><description><![CDATA[<p>这个是在组件开发中遇到的问题，当时我在编写 button 的组件，模板是这样的：</p>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>disable-hover button ion-button<span class="token punctuation">"</span></span>
          <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>[modeClass,typeClass,shapeClass,sizeClass,colorClass,roleClass,strongClass]<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button-inner<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button-effect<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span></code></pre></div>
<p>使用是这样子的：</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">&lt;ion-button @click.native=&quot;primary()&quot; color=&quot;primary&quot;&gt;primary&lt;/ion-button&gt;</code></pre></div>
<p>根据 Vue2.0 官方文档关于父子组件通讯的原则，父组件通过 prop 传递数据给子组件，子组件触发事件给父组件。但父组件想在子组件上监听自己的 click 的话，需要加上<code class="language-text">native</code>修饰符，故写法就像上面这样。</p>
<p>好吧，处女座的毛病又来了。像 button 这样常用的组件如果加上 native 的话是感觉很突兀的。虽然组件设计有自身的考虑，因此我想将 click 的 native 去掉，思路如下：</p>
<ol>
<li>子组件监听父组件给的 click 事件，</li>
<li>子组件内部处理 click 事件然后向外发送 click 事件：<code class="language-text">$emit(&quot;click&quot;.fn)</code></li>
</ol>
<p>改造后的代码如下(亲测可用)：</p>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>disable-hover button ion-button<span class="token punctuation">"</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>_click<span class="token punctuation">"</span></span>
          <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>[modeClass,typeClass,shapeClass,sizeClass,colorClass,roleClass,strongClass]<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button-inner<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>button-effect<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/babel<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span><span class="token punctuation">{</span>
    <span class="token operator">...</span><span class="token punctuation">.</span>
    <span class="token operator">...</span><span class="token punctuation">.</span>
    methods<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token function-variable function">_click</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'inner'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></code></pre></div>
<p>父组件中这样使用：</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">&lt;ion-button @click=&quot;primary()&quot; color=&quot;primary&quot;&gt;primary&lt;/ion-button&gt;</code></pre></div>
<p>也许读者能看出来，我正在参照 IONIC2.X 的组件 API 写 Vue2.0 的功能组件，目前只完成了：ActionSheet、Button、Icon、Alert、Toast 这几个，一边看 IONIC 源码，一边将思路总结写成 Vue 代码，也就是花点时间。积累自己的组件库希望以后能开发快点。</p>
<p>现在项目地址在<a href="https://github.com/xiangsongtao/VueMobile" target="_target" rel="nofollow">这里</a>，前期以实现功能为主，不建议用在生产环境，读读代码实现思路就好，中文备注都做好了。</p>
<p>(完)</p>]]></description><link>https://xiangst0816.github.io/blog/Vue2-zhi-qu-diao-zu-jian-de-di/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/Vue2-zhi-qu-diao-zu-jian-de-di/</guid><category><![CDATA[Vue]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Sun, 25 Dec 2016 13:51:20 GMT</pubDate></item><item><title><![CDATA[路由开启keep-alive时的注意点]]></title><description><![CDATA[<p>这个不是业务的要求，但是看到每次进入页面就重新渲染 DOM 然后再获取数据更新 DOM，觉得作为一个前端工程师有必要优化下的加载逻辑，正好 vue 提供了<code class="language-text">keep-alive</code>的功能，所以就试用了下。当然，干任何事儿都不会一帆风顺的，在路上的磕磕碰碰在所难免，故在此记录下遇到的问题，希望看到这篇文章的人能有所帮助。ps：这个也没多难。</p>
<p>HTML 部分：</p>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>keep-alive</span><span class="token punctuation">></span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-view</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-view</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>keep-alive</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span></code></pre></div>
<p>JavaScript 部分：</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token operator">...</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

    <span class="token function-variable function">created</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">mounted</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">activated</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">deactivated</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

<span class="token operator">...</span><span class="token punctuation">.</span><span class="token punctuation">.</span></code></pre></div>
<h2 id="1-什么阶段获取数据" style="position:relative;"><a href="#1-%E4%BB%80%E4%B9%88%E9%98%B6%E6%AE%B5%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE" aria-label="1 什么阶段获取数据 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 什么阶段获取数据</h2>
<p>页面生命周期钩子如上面的代码所示，这四个是最常用到的部分。这部分需要注意下，当引入<code class="language-text">keep-alive</code>的时候，页面第一次进入，钩子的触发顺序 created-> mounted-> activated，退出时触发 deactivated。当再次进入（前进或者后退）时，只触发 activated。</p>
<p>我们知道<code class="language-text">keep-alive</code>之后页面模板第一次初始化解析变成 HTML 片段后，再次进入就不在重新解析而是读取内存中的数据，即，只有当数据变化时，才使用 VirtualDOM 进行 diff 更新。故，页面进入的数据获取应该在 activated 中也放一份。数据下载完毕手动操作 DOM 的部分也应该在 activated 中执行才会生效。</p>
<p>所以，应该 activated 中留一份数据获取的代码，或者不要 created 部分，直接将 created 中的代码转移到 activated 中。</p>
<h2 id="2-code-classlanguage-textroutecode中的数据读不到" style="position:relative;"><a href="#2-code-classlanguage-textroutecode%E4%B8%AD%E7%9A%84%E6%95%B0%E6%8D%AE%E8%AF%BB%E4%B8%8D%E5%88%B0" aria-label="2 code classlanguage textroutecode中的数据读不到 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. <code class="language-text">$route</code>中的数据读不到</h2>
<p>以前的写法是在 data 中将需要的<code class="language-text">$route</code>数据进行赋值，便于其余方法使用，但是使用了<code class="language-text">keep-alive</code>后数据需要进入页面在 activated 中再次获取，才能达到更新的目的。定义一个 initData 方法，然后在 activated 中启动。</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token function-variable function">initData</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> _this <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
        _this<span class="token punctuation">.</span>fromLocation <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$route<span class="token punctuation">.</span>query<span class="token punctuation">.</span>fromLocation<span class="token punctuation">)</span><span class="token punctuation">;</span>
        _this<span class="token punctuation">.</span>toLocation <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$route<span class="token punctuation">.</span>query<span class="token punctuation">.</span>toLocation<span class="token punctuation">)</span><span class="token punctuation">;</span>
        _this<span class="token punctuation">.</span>activeIndex <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$route<span class="token punctuation">.</span>params<span class="token punctuation">.</span>activeIndex<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token number">0</span><span class="token punctuation">;</span>
        _this<span class="token punctuation">.</span>policyType <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$route<span class="token punctuation">.</span>params<span class="token punctuation">.</span>policyType<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span></code></pre></div>
<h2 id="3-当页动态修改-url" style="position:relative;"><a href="#3-%E5%BD%93%E9%A1%B5%E5%8A%A8%E6%80%81%E4%BF%AE%E6%94%B9-url" aria-label="3 当页动态修改 url permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. 当页动态修改 url</h2>
<p>需求描述：当页面在进行轮播操作的时候希望能记录当前显示的轮播 ID(activeIndex)。当进入下一个页面再返回的时候能记住之前的选择，将轮播打到之前的 ID 位置。所以我想将这部分信息固化在 url 中，轮播发生变化时，修改 URL。这样实现比较符最小修改原则，其余页面不用变动。</p>
<p>之前的写法是将 activeIndex 放在<code class="language-text">$route</code>的 query 中，当轮播后，将
activeIndex 的值存入<code class="language-text">$route.query.activeIndex</code>中，然后<code class="language-text">$router.replace</code>当前路由，理论上应该能发生变化，但实际没有。</p>
<p>查看文档后说，<code class="language-text">$route</code>是只读模式。当然，对象部分是他监管不到的，我修改了并不是正统的做法。</p>
<p><strong>神奇的地方来了</strong>：当我将 activeIndex 记在 params 中，轮播变动修改 params 中的参数，然后<code class="language-text">$router.replace</code>当前路由，却能发生对应的变化。代码如下：</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">let</span> swiperInstance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Swiper</span><span class="token punctuation">(</span><span class="token string">"#swiper"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  pagination<span class="token operator">:</span> <span class="token string">".swiper-pagination"</span><span class="token punctuation">,</span>
  paginationClickable<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  initialSlide<span class="token operator">:</span> activeIndex<span class="token punctuation">,</span>
  <span class="token function-variable function">onSlideChangeEnd</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">swiper</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> _activeIndex <span class="token operator">=</span> swiper<span class="token punctuation">.</span>activeIndex<span class="token punctuation">;</span>
    _this<span class="token punctuation">.</span>$route<span class="token punctuation">.</span>params<span class="token punctuation">.</span>activeIndex <span class="token operator">=</span> _activeIndex<span class="token punctuation">;</span>
    <span class="token comment">// $router我放到了window上方便调用</span>
    window<span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      name<span class="token operator">:</span> _this<span class="token punctuation">.</span>$route<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
      params<span class="token operator">:</span> _this<span class="token punctuation">.</span>$route<span class="token punctuation">.</span>params<span class="token punctuation">,</span>
      query<span class="token operator">:</span> _this<span class="token punctuation">.</span>$route<span class="token punctuation">.</span>query
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 根据activeIndex，在这里初始化下面显示的数据</span>
    _this<span class="token punctuation">.</span>transferDetail <span class="token operator">=</span> _this<span class="token punctuation">.</span>allData<span class="token punctuation">.</span>plans<span class="token punctuation">[</span>_activeIndex<span class="token punctuation">]</span><span class="token punctuation">.</span>segments<span class="token punctuation">;</span>
    _this<span class="token punctuation">.</span><span class="token function">clearBusDetailFoldState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<h2 id="4-事件如何处理" style="position:relative;"><a href="#4-%E4%BA%8B%E4%BB%B6%E5%A6%82%E4%BD%95%E5%A4%84%E7%90%86" aria-label="4 事件如何处理 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. 事件如何处理</h2>
<p>估计你也能猜到，发生的问题是事件绑定了很多次，比如上传点击 input 监听 change 事件，突然显示了多张相同图片的问题。</p>
<p>也就是说，DOM 在编译后就缓存在内容中了，如果再次进入还再进行事件绑定初始化则就会发生这个问题。</p>
<p>解决办法：在 mounted 中绑定事件，因为这个只执行一次，并且 DOM 已准备好。如果插件绑定后还要再执行一下事件的 handler 函数的话，那就提取出来，放在 activated 中执行。比如：根据输入内容自动增长 textarea 的高度，这部分需要监听 textarea 的 input 和 change 事件，并且页面进入后还要再次执行一次 handler 函数，更新 textarea 高度（避免上次输入的影响）。</p>
<h2 id="5-地图组件处理" style="position:relative;"><a href="#5-%E5%9C%B0%E5%9B%BE%E7%BB%84%E4%BB%B6%E5%A4%84%E7%90%86" aria-label="5 地图组件处理 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>5. 地图组件处理</h2>
<p>想必这是使用<code class="language-text">keep-alive</code>最直接的性能表现。之前是进入地图页面后进行地图渲染+线路标记；现在是清除以前的线路标记绘制新的线路，性能优化可想而知！</p>
<p>我这里使用的是高德地图，在 mounted 中初始化 map，代码示例如下：</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">"transferMap"</span><span class="token punctuation">,</span>
  <span class="token function-variable function">data</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      map<span class="token operator">:</span> <span class="token keyword">null</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">initData</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">searchTransfer</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">type</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 地图渲染 这个在transfer-map.html中使用</span>
    <span class="token function-variable function">renderTransferMap</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">transferMap</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">mounted</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AMap<span class="token punctuation">.</span>Map</span><span class="token punctuation">(</span><span class="token string">"container"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      showBuildingBlock<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      animateEnable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      resizeEnable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      zoom<span class="token operator">:</span> <span class="token number">12</span> <span class="token comment">//地图显示的缩放级别</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">activated</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> _this <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    _this<span class="token punctuation">.</span><span class="token function">initData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 设置title</span>
    <span class="token function">setDocumentTitle</span><span class="token punctuation">(</span><span class="token string">"换乘地图"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    _this<span class="token punctuation">.</span><span class="token function">searchTransfer</span><span class="token punctuation">(</span>_this<span class="token punctuation">.</span>policyType<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 数据加载完成</span>
      <span class="token comment">// 换乘地图页面</span>
      <span class="token keyword">let</span> transferMap <span class="token operator">=</span> result<span class="token punctuation">.</span>plans<span class="token punctuation">[</span>_this<span class="token punctuation">.</span>activeIndex<span class="token punctuation">]</span><span class="token punctuation">;</span>
      transferMap<span class="token punctuation">.</span>origin <span class="token operator">=</span> result<span class="token punctuation">.</span>origin<span class="token punctuation">;</span>
      transferMap<span class="token punctuation">.</span>destination <span class="token operator">=</span> result<span class="token punctuation">.</span>destination<span class="token punctuation">;</span>
      <span class="token comment">// 填数据</span>
      _this<span class="token punctuation">.</span>transferMap <span class="token operator">=</span> transferMap<span class="token punctuation">;</span>
      <span class="token comment">// 地图渲染</span>
      _this<span class="token punctuation">.</span><span class="token function">renderTransferMap</span><span class="token punctuation">(</span>transferMap<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">deactivated</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 清理地图之前的标记</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>map<span class="token punctuation">.</span><span class="token function">clearMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre></div>
<h2 id="6-documenttitle-修改" style="position:relative;"><a href="#6-documenttitle-%E4%BF%AE%E6%94%B9" aria-label="6 documenttitle 修改 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>6. document.title 修改</h2>
<p>这个不是<code class="language-text">keep-alive</code>的问题，不过我也在这里分享下。</p>
<p>问题是，使用下面这段方法，可以修改 Title，但是页面来回切换多次后就不生效了，我也不知道为啥，放到 setTimeout 中就直接不执行。</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">document.title = &#39;页面名称&#39;;</code></pre></div>
<p>下面是使用 2 种环境的修复方法：</p>
<p>纯 js 实现</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">setDocumentTitle</span><span class="token punctuation">(</span><span class="token parameter">title</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token string">"use strict"</span><span class="token punctuation">;</span>
  <span class="token comment">//以下代码可以解决以上问题，不依赖jq</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//利用iframe的onload事件刷新页面</span>
    document<span class="token punctuation">.</span>title <span class="token operator">=</span> title<span class="token punctuation">;</span>
    <span class="token keyword">var</span> iframe <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"iframe"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    iframe<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">"/favicon.ico"</span><span class="token punctuation">;</span> <span class="token comment">// 必须</span>
    iframe<span class="token punctuation">.</span>style<span class="token punctuation">.</span>visibility <span class="token operator">=</span> <span class="token string">"hidden"</span><span class="token punctuation">;</span>
    iframe<span class="token punctuation">.</span>style<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token string">"1px"</span><span class="token punctuation">;</span>
    iframe<span class="token punctuation">.</span>style<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token string">"1px"</span><span class="token punctuation">;</span>
    iframe<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>iframe<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>iframe<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>jQuery/Zepto 实现</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">setDocumentTitle</span><span class="token punctuation">(</span><span class="token parameter">title</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//需要jQuery</span>
  <span class="token keyword">var</span> $body <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"body"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  document<span class="token punctuation">.</span>title <span class="token operator">=</span> title<span class="token punctuation">;</span>
  <span class="token comment">// hack在微信等webview中无法修改document.title的情况</span>
  <span class="token keyword">var</span> $iframe <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'&lt;iframe src="/favicon.ico">&lt;/iframe>'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  $iframe
    <span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">"load"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        $iframe<span class="token punctuation">.</span><span class="token function">off</span><span class="token punctuation">(</span><span class="token string">"load"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">appendTo</span><span class="token punctuation">(</span>$body<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<p>以上内容的更新请查看我的博客，<a href="http://xiangsongtao.com/article/5853b2c0044bf1353af82fbf" target="_target" rel="nofollow">点这里</a>。</p>
<p>(完)</p>]]></description><link>https://xiangst0816.github.io/blog/lu-you-kai-qi-keep-alive-shi-de/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/lu-you-kai-qi-keep-alive-shi-de/</guid><category><![CDATA[Vue]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Fri, 16 Dec 2016 08:14:38 GMT</pubDate></item><item><title><![CDATA[Vue Introduce]]></title><description><![CDATA[<p>这篇 PPT 是关于最近在做 H5 版杭州公交的经验分享，里面部分细节也包括工作一年的总结。</p>
<h2 id="简介" style="position:relative;"><a href="#%E7%AE%80%E4%BB%8B" aria-label="简介 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>简介</h2>
<p><img src="http://xiangsongtao.com/uploads/1481464550000.jpeg" alt="简介"></p>
<p>Vue 是我在 8 月份第一次接触，用周末两天时间熟悉了下 API 及 Vue 全家桶，框架学完练练手可以熟悉思路，在之后的项目中能马上使用到。所以我将我的博客从 Angualr1.3 改写到 Vue1.0，花了不少下班时间。项目是由 vue-cli 基础上开发，现已在 GitHub 上开源，另外还包括对博客支持的后台代码，使用的是 Node+Express+Mongodb。</p>
<p>之后 Vue2.0 发布后，趁着项目测试的空隙，又将博客升级到 2.0，改动的部分及总结在博客中已写出，可以作为升级的参考，<a href="http://xiangsongtao.com/article/5846277f089b4c33d4ec79a9" target="_target" rel="nofollow">链接</a>。到目前为止，已经使用 Vue 直接开发了 3 个项目，加上今天的分享，应该是第四个了。因为 Vue 对浏览器的唯一的限制是 IE9+，故移动端应该是没问题的。</p>
<h2 id="目录" style="position:relative;"><a href="#%E7%9B%AE%E5%BD%95" aria-label="目录 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>目录</h2>
<p><img src="http://xiangsongtao.com/uploads/1481464684000.jpeg" alt="目录"></p>
<p>这个是 ppt 的顺序，有些思路可能某些同学没接触过，我也是用比较形象的方式给大家讲解。我希望以后大家在学到新的东西都能通过这种方式分享出来共同进步，回顾总结，加深自己的印象。</p>
<h2 id="如何选择框架" style="position:relative;"><a href="#%E5%A6%82%E4%BD%95%E9%80%89%E6%8B%A9%E6%A1%86%E6%9E%B6" aria-label="如何选择框架 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>如何选择框架</h2>
<p><img src="http://xiangsongtao.com/uploads/1481464705000.jpeg" alt="如何选择框架"></p>
<p>这里主要是我对我已有的经验来分析如何根据项目来选择框架。可能由我的局限性，希望能和大家碰撞下思想。</p>
<h3 id="1-对于后台管理系统" style="position:relative;"><a href="#1-%E5%AF%B9%E4%BA%8E%E5%90%8E%E5%8F%B0%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F" aria-label="1 对于后台管理系统 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 对于后台管理系统</h3>
<p>我曾经使用过两次 jQuery+ifream 框架（二次维护，历史遗留问题），通过接口获取数据后拼接 HTML 字符串然后 append 到 DOM 中，因为需求没有设计成 UI，当时拿到的是功能清单，UI 只能靠我们前端自己设计。因此在写 render 函数之前，我将画好的 UI 给 leader 看，然后讨论交互，连问多遍有没问题后才敢开始写 render 函数，因为需求改动后，render 函数就会废弃再写！不过最后结果还好，返工的不多。另一个是给后台写 jsp 模板，分不清前后端界线，js 交互也不敢多写（后端同学理解 JS 也是头疼）。</p>
<p>以上，也许也能看出问题点了，代码无法复用，需求改动后代码改动多；前后端界线不清，工作内容会有重叠，口头确认不是很好的规范。所以我倾向于基于 MVVM 模式的 SPA 系统。前后端由 API 文档划分界线，因为不涉及到首次加载速度、浏览器适配范围和 SEO 等问题，我认为 SPA 的方式是可行的，也是大多数公司在用的方式，例如阿里云控制台、收钱吧控制台、盈联智能商户管理系统等。</p>
<h3 id="2-对于面对消费者的-pc-页面" style="position:relative;"><a href="#2-%E5%AF%B9%E4%BA%8E%E9%9D%A2%E5%AF%B9%E6%B6%88%E8%B4%B9%E8%80%85%E7%9A%84-pc-%E9%A1%B5%E9%9D%A2" aria-label="2 对于面对消费者的 pc 页面 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 对于面对消费者的 PC 页面</h3>
<p>这种场景，使用后端渲染的方式无可厚非，加载快，利于 SEO，页面可缓存等优点。</p>
<h3 id="3-移动端展示类型的页面" style="position:relative;"><a href="#3-%E7%A7%BB%E5%8A%A8%E7%AB%AF%E5%B1%95%E7%A4%BA%E7%B1%BB%E5%9E%8B%E7%9A%84%E9%A1%B5%E9%9D%A2" aria-label="3 移动端展示类型的页面 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. 移动端展示类型的页面</h3>
<p>这种情况大多数不会超过 5 个页面（类似于抽奖、活动展示、答题、留言板等），且页面间衔接的紧密度不高，使用 zepto 框架即可。开发快速，a 标签跳转，如果不喜欢 300ms 点击延迟，那就上 fastclick 就好，一般开发人员就能胜任。</p>
<h3 id="4-移动微应用" style="position:relative;"><a href="#4-%E7%A7%BB%E5%8A%A8%E5%BE%AE%E5%BA%94%E7%94%A8" aria-label="4 移动微应用 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. 移动微应用</h3>
<p>最后一个场景就是较为复杂的移动微应用，<strong>古老的方法</strong>是使用后端渲染的方式进行，例如 jsp、hbs 等，如果不同页面间数据需要传递也只能放到 url 中或者 sessionStorage 或者 localStorage 中，开发逻辑不好维护，需要加大量的注释。页面跳转还需要再次加载公共的脚本，如果服务器开了缓存还好，否则用户体验不好。我这里倾向于使用 SPA 模式开发，由路由控制增量加载的内容（懒加载），webpack 进行代码分割，确保首屏之外的资源按需加载。前端控制范围增多，API 划分界限。</p>
<h2 id="mvc-和-mvvm-对比" style="position:relative;"><a href="#mvc-%E5%92%8C-mvvm-%E5%AF%B9%E6%AF%94" aria-label="mvc 和 mvvm 对比 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>MVC 和 MVVM 对比</h2>
<p><img src="http://xiangsongtao.com/uploads/1481464740000.jpeg" alt="MVC和MVVM对比"></p>
<p>Vue 是基于 MVVM 开发模式的框架。在 MVVM 之前还有很多开发模式，不过都被踩在时代的脚下，比如 MVC。就我经验所及的范围，我认为 MVVM 在处理 UI 交互方面应该是抽象的最全面的模式。</p>
<p>上张图是 MVVM 的结构，在 SilverLight 或者 WPF 开发中常用的模式，同理，前端也是和 UI 交互的部分，模式借鉴很有意义。View 层只依赖数据，降低 View-Model 与 View 之间的耦合；只要数据相同，View-Model 可复用，UI 测试转化为对 Data 的测试。</p>
<p>jQuery 是 MVC 开发模式的一个代表。在 jQuery 代码中，controller 中存在大量的和 view 耦合的逻辑，例如 jq 中的 html 片段拼接，无法复用和维护困难。另外，controller 基本没有测试的可能。</p>
<h2 id="mvc-和-mvvm-业务实现区别" style="position:relative;"><a href="#mvc-%E5%92%8C-mvvm-%E4%B8%9A%E5%8A%A1%E5%AE%9E%E7%8E%B0%E5%8C%BA%E5%88%AB" aria-label="mvc 和 mvvm 业务实现区别 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>MVC 和 MVVM 业务实现区别</h2>
<h3 id="1-mvc-方式" style="position:relative;"><a href="#1-mvc-%E6%96%B9%E5%BC%8F" aria-label="1 mvc 方式 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. MVC 方式</h3>
<p><img src="http://xiangsongtao.com/uploads/1481464793000.jpeg" alt="MVC方式"></p>
<p>以我现在在做的页面对 MVC 和 MVVM 做个对比。</p>
<p>页面 1 是第一次的需求，我按照页面将 HTML 片段和数据拼接写好 render 函数，之后 append 到页面中，数据通过 ajax 获取。当 UED 改图时（页面 2），可以看出页面的结构发生了变化：由之前的上下结构变成了左右结构，对用的 HTML 片段也要发生变化，故 render 函数需要修改以适应新需求，我醉了。。。这种需求以前遇到很多回了！view 和 controlelr 高度耦合，并且 HTML 片段不易再次维护，不可测试也无法复用。</p>
<h3 id="2-mvvm-方式" style="position:relative;"><a href="#2-mvvm-%E6%96%B9%E5%BC%8F" aria-label="2 mvvm 方式 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. MVVM 方式</h3>
<p><img src="http://xiangsongtao.com/uploads/1481464827000.jpeg" alt="MVVM方式"></p>
<p>如果页面是使用 MVVM 模式做的话，从上面可看出，页面的数据是没变动的，只是 HTML 变动，故使用 Vue 双向绑定的基础功能，我这里只需要修改 HTML 即可，View-Model 中的代码无需修改。另外，只要数据格式没问题，页面的渲染效果也固定，可测试。之后讲解下代码复用部分。</p>
<h3 id="3-view-model-代码复用" style="position:relative;"><a href="#3-view-model-%E4%BB%A3%E7%A0%81%E5%A4%8D%E7%94%A8" aria-label="3 view model 代码复用 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. View-Model 代码复用</h3>
<p><img src="http://xiangsongtao.com/uploads/1481464853000.jpeg" alt="View-Model代码复用"></p>
<p>换乘摘要[1]、换乘详情[2]、换乘地图[3]三部分的页面有公共个数据部分：URL 参数（起始终止位置信息+换乘策略信息）、当前策略下换乘信息（allData -> 包含起止经纬度、摘要和详情），换乘地图独用 transferMap。因此，此部分的 View-Model 可复用，只需要判断 path 后开启必要的部分即可。</p>
<p><strong>以上就是 MVVM 的三个优点：</strong>低耦合、可复用、可测试、易维护。</p>
<h2 id="vue-性能" style="position:relative;"><a href="#vue-%E6%80%A7%E8%83%BD" aria-label="vue 性能 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Vue 性能</h2>
<p><img src="http://xiangsongtao.com/uploads/1481464887000.jpeg" alt="Vue性能"></p>
<p>我一般在使用 Vue 都是在做移动端开发，既然选用是看中他的两个特性：<strong>运行快+加载快</strong>；上图是 Vue2.0 的综合性能对比图，右边是 Benchmark 跑分（不服跑跑分），绿色越深代表越好。红框圈出的部分从左到右依次是 react、Vue2.0、原生 JS。想必大家能看出来差异了。值得一说的是，Vue2.0 是基于更快的 Virtual-DOM。</p>
<h2 id="vue-构建大型项目及生态" style="position:relative;"><a href="#vue-%E6%9E%84%E5%BB%BA%E5%A4%A7%E5%9E%8B%E9%A1%B9%E7%9B%AE%E5%8F%8A%E7%94%9F%E6%80%81" aria-label="vue 构建大型项目及生态 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Vue 构建大型项目及生态</h2>
<p><img src="http://xiangsongtao.com/uploads/1481464916000.jpeg" alt="Vue构建大型项目及生态"></p>
<p>Vue 在构建大型项目也不逊色，因为 Vue.js 自身只是处理 View 层的框架，做大型项目需要协同插件的协助，这个与 react 很像。可以说 Vue 构建大型项目的插件都已完备。参见上图。</p>
<h2 id="我为什么使用-vue" style="position:relative;"><a href="#%E6%88%91%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BD%BF%E7%94%A8-vue" aria-label="我为什么使用 vue permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>我为什么使用 Vue</h2>
<p><img src="http://xiangsongtao.com/uploads/1481464940000.jpeg" alt="我为什么使用Vue"></p>
<p>最后说下我为什么倾向于使用 Vue。我认为，工具的价值在于为人服务。Vue 及其附属的 Vue-cli 工具很好的在开发者体验和最终生成代码之间做好了桥梁，即：说明文档详细，代码编写简单，API 抽象到位方便别人阅读，最终代码运行高效。</p>
<p>另外，框架的选择取决于团队的水平，Vue 还是很简单的，而且还是中文文档哦。</p>
<h2 id="最后" style="position:relative;"><a href="#%E6%9C%80%E5%90%8E" aria-label="最后 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>最后</h2>
<blockquote>
<p><strong>用了 Vue，我可以正常下班了</strong></p>
</blockquote>
<p>(完)</p>]]></description><link>https://xiangst0816.github.io/blog/VueIntroduce/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/VueIntroduce/</guid><category><![CDATA[Vue]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Sun, 11 Dec 2016 13:54:46 GMT</pubDate></item><item><title><![CDATA[WebStorm中对Vue的支持]]></title><description><![CDATA[<p>这篇文章主要介绍了如何在 WebStorm 中进行配置达到对 Vue 的完美支持，包括代码检查、自动排版等。</p>
<h2 id="plugins-安装" style="position:relative;"><a href="#plugins-%E5%AE%89%E8%A3%85" aria-label="plugins 安装 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Plugins 安装</h2>
<p>首先两个插件是必不可缺少的，这个需要在 WebStorm->Preferences->Plugins 中搜索’vue-for-idea’插件。另外’Vue.js’这个插件不好用，别安装！！</p>
<h2 id="默认模板修改" style="position:relative;"><a href="#%E9%BB%98%E8%AE%A4%E6%A8%A1%E6%9D%BF%E4%BF%AE%E6%94%B9" aria-label="默认模板修改 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>默认模板修改</h2>
<p>依次进入顺序：</p>
<blockquote>
<p>WebStorm->Preferences->Editor->Code Stype->File andCode Templates</p>
</blockquote>
<p>之后选择 Vue File，下面是我的模板，制定 style 和 script 的类型是为了能够自动格式化。</p>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>main<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>header-component</span><span class="token punctuation">/></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>this is template body<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>other-component</span><span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>scss<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css">
    <span class="token selector">body</span><span class="token punctuation">{</span>
        <span class="token property">background-color</span><span class="token punctuation">:</span>#ff0000<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/ecmascript-6<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">import</span> HeaderComponent <span class="token keyword">from</span> <span class="token string">'./components/header.vue'</span>
    <span class="token keyword">import</span> OtherComponent <span class="token keyword">from</span> <span class="token string">'./components/other.vue'</span>
    <span class="token keyword">export</span> <span class="token keyword">default</span><span class="token punctuation">{</span>
        <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span><span class="token punctuation">{</span>
                msg<span class="token operator">:</span><span class="token string">'hello vue'</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        components<span class="token operator">:</span><span class="token punctuation">{</span>
            <span class="token string">'other-component'</span><span class="token operator">:</span>OtherComponent<span class="token punctuation">,</span>
            HeaderComponent<span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></code></pre></div>
<h2 id="注册文件模板" style="position:relative;"><a href="#%E6%B3%A8%E5%86%8C%E6%96%87%E4%BB%B6%E6%A8%A1%E6%9D%BF" aria-label="注册文件模板 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>注册文件模板</h2>
<p>依次进入顺序：</p>
<blockquote>
<p>WebStorm->Preferences->Editor->Code Stype->File Types</p>
</blockquote>
<p>之后选择 Vue，在下面添加对 vue 的支持，输入：<code class="language-text">*.vue</code>。如果已经默认改好了，那就不修改了。</p>
<h2 id="script-代码片段绿色背景" style="position:relative;"><a href="#script-%E4%BB%A3%E7%A0%81%E7%89%87%E6%AE%B5%E7%BB%BF%E8%89%B2%E8%83%8C%E6%99%AF" aria-label="script 代码片段绿色背景 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Script 代码片段绿色背景</h2>
<p>完成以上的设置后，会在 Script 代码片段处出现绿色的背景提示，虽然不影响排版和代码错误检查，但是影响编程心情，问题如下：</p>
<p><img src="http://xiangsongtao.com/uploads/1481340380000.png"></p>
<p>这个问题也一直困扰了我很久，在网上也没找到答案，偶然一次在查看代码片段配色的时候找到了这个设置，这里分享下，依次点击进入：</p>
<blockquote>
<p>WebStorm->Preferences->Editor->Color&#x26;Fonts->General->Code->inject language fragment->Background</p>
</blockquote>
<p>Background 不设置颜色，之后 Apply 就好了。</p>
<p><img src="http://xiangsongtao.com/uploads/1481340545000.png"></p>
<p>（完）</p>]]></description><link>https://xiangst0816.github.io/blog/WebStorm-zhong-dui-Vue-de-d/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/WebStorm-zhong-dui-Vue-de-d/</guid><category><![CDATA[WebStorm]]></category><category><![CDATA[Vue]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Sat, 10 Dec 2016 03:05:18 GMT</pubDate></item><item><title><![CDATA[Vue学习小结]]></title><description><![CDATA[<blockquote>
<p>相同的内容经过实战的熏陶再次看看会有不同的体验，这里对 Vue 官方文档再次学习，总结下使用过的与未使用的部分，以期在未来能写出更好的 Vue 代码。</p>
</blockquote>
<h2 id="vue-构造器内部的事儿" style="position:relative;"><a href="#vue-%E6%9E%84%E9%80%A0%E5%99%A8%E5%86%85%E9%83%A8%E7%9A%84%E4%BA%8B%E5%84%BF" aria-label="vue 构造器内部的事儿 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Vue 构造器内部的事儿</h2>
<p>为了方便函数调用及数据调用，在书写 Vue 的时候都是在 new Vue({})进行，我这里主要在函数内这个角度进行总结，希望能开拓你的角度。先上一个大概框架，这也是我在进行项目的时候多次复制粘贴的部分，之后我对下面的部分我逐一讲解：</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">var</span> vm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">//1. 挂载位置</span>
  el<span class="token operator">:</span> <span class="token string">"#app"</span><span class="token punctuation">,</span>
  <span class="token comment">//2. 数据</span>
  data<span class="token operator">:</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">"songtao"</span><span class="token punctuation">,</span>
    data<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment">//数据</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  filters<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 第1个参数是传入过滤的值，第2、3是参数</span>
    <span class="token function-variable function">capitalize</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">value<span class="token punctuation">,</span> arg1<span class="token punctuation">,</span> arg2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>value<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span>
      value <span class="token operator">=</span> value<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> value<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> value<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">//3. 数据watch</span>
  watch<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 如果 question 发生改变，这个函数就会运行</span>
    <span class="token function-variable function">question</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">newQuestion</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>answer <span class="token operator">=</span> <span class="token string">"Waiting for you to stop typing..."</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getAnswer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">//4. 计算属性-</span>
  computed<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// a computed getter</span>
    <span class="token function-variable function">reversedMessage</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// `this` points to the vm instance</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>message
        <span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    fullName<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// getter</span>
      <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>firstName <span class="token operator">+</span> <span class="token string">" "</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>lastName<span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token comment">// setter</span>
      <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">newValue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> names <span class="token operator">=</span> newValue<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>firstName <span class="token operator">=</span> names<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>lastName <span class="token operator">=</span> names<span class="token punctuation">[</span>names<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">//5. 方法及事件处理</span>
  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">say</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">message</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">alert</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// &lt;button v-on:click="warn('Form cannot be submitted yet.', $event)">Submit&lt;/button></span>
    <span class="token function-variable function">warn</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">message<span class="token punctuation">,</span> event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 现在我们可以访问原生事件对象</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">)</span> event<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">alert</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">//6. 生命周期钩子</span>
  <span class="token function-variable function">beforeCreate</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">created</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"获取数据"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">beforeMount</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">mounted</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"操作DOM"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">beforeUpdate</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">updated</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">beforeDestroy</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">destroyed</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">//7. 组件</span>
  components<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// &lt;my-component> 将只在父模板可用</span>
    <span class="token string">"my-component"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      template<span class="token operator">:</span> <span class="token string">"&lt;div>A custom component!&lt;/div>"</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<h3 id="1-挂载位置" style="position:relative;"><a href="#1-%E6%8C%82%E8%BD%BD%E4%BD%8D%E7%BD%AE" aria-label="1 挂载位置 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 挂载位置</h3>
<p>显式的在 HTML 中定义 Vue 的作用范围，使用 id 标明，当然也可以使用 class，不过就要写成<code class="language-text">el: &#39;.app&#39;</code>，建议写成 id，因为使用 id 在 DOM 中查找会更快。可以在 HTML 中定义多个 Vue 事例，但是别嵌套定义。</p>
<h3 id="2-数据" style="position:relative;"><a href="#2-%E6%95%B0%E6%8D%AE" aria-label="2 数据 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 数据</h3>
<p>在 HTML 中使用双大括号<code class="language-text">{{name}}</code>绑定 data 中的数据即可。可能在这里你会有这样的需求：Ajax 返回的数据需要 forEach 处理后显示在页面上，但是数据修改的结果并没实时更新 DOM，这里有两个解决办法：</p>
<ol>
<li>Ajax 返回的数据先进行 forEach 处理后在赋值给<code class="language-text">this.data</code>，检查下代码。</li>
<li>使用 computed 处理，return 需要返回<code class="language-text">this.data</code>处理后的结果。</li>
</ol>
<h3 id="3-模板" style="position:relative;"><a href="#3-%E6%A8%A1%E6%9D%BF" aria-label="3 模板 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. 模板</h3>
<p>按照我的习惯，我都是使用 HTML 模板而不是类似于 JSX 的 render 函数完成数据填充。我认为，好的工具或者框架应该兼顾开发者体验和程序运行效率。与此同时，对框架面对的业务范围应该都能抽象到位，API 的设计或者协同组件都能完美互补。他的反例我想就是 JSX 语法，html 和 css 柔和到 js 中我认为不是很好的开发体验。</p>
<h3 id="4-方法及事件处理" style="position:relative;"><a href="#4-%E6%96%B9%E6%B3%95%E5%8F%8A%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86" aria-label="4 方法及事件处理 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. 方法及事件处理</h3>
<p>methods 中定义的方法可在 vm 中也可以在 HTML 中使用（所谓的“事件”）。按照我的编写习惯，我一般都将方法在 methods 中定义，而不是 created 或者 mounted 中。</p>
<h3 id="5-计算属性" style="position:relative;"><a href="#5-%E8%AE%A1%E7%AE%97%E5%B1%9E%E6%80%A7" aria-label="5 计算属性 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>5. 计算属性</h3>
<p>计算属性主要是为了简化 HTML 中绑定数据的逻辑复杂度与阅读难易度而设定的。正如上面所讲，对于需要处理的后再显示的数据使用此方法：</p>
<ol>
<li>各种格式化(金额/日期)</li>
<li>从 data 中提取嵌套较深的数据</li>
<li>根据 data 中某字段判断返回 true/false 等。</li>
</ol>
<blockquote>
<p>以上，请注意<code class="language-text">return</code>的写法，其直接返回修改数据的 this.data 的修改值。</p>
</blockquote>
<p>在{{}}中使用函数返回修改的值也是可以的。区别在于：计算属性能缓存结果，而函数则每次都进行计算。</p>
<p>故，下面的代码只会执行一次</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript">computed<span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">now</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<p>可以对计算属性赋值：</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript">computed<span class="token operator">:</span> <span class="token punctuation">{</span>
  fullName<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 取值时 getter</span>
    <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>firstName <span class="token operator">+</span> <span class="token string">' '</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>lastName
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 赋值时，会修改firstName和lastName值 setter</span>
    <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">newValue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">var</span> names <span class="token operator">=</span> newValue<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>firstName <span class="token operator">=</span> names<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>lastName <span class="token operator">=</span> names<span class="token punctuation">[</span>names<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div>
<h3 id="6-生命周期钩子" style="position:relative;"><a href="#6-%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E9%92%A9%E5%AD%90" aria-label="6 生命周期钩子 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>6. 生命周期钩子</h3>
<p>官方的图我认为已经说的很详细了，这里有图：</p>
<div style="width:100%;text-align:center;">
<img src="http://xiangsongtao.com/uploads/1480993223000.png" width="400" alt="&#x751F;&#x547D;&#x5468;&#x671F;&#x94A9;&#x5B50;" align="center">
</div>
<p>这个是中文说明：</p>
<p><img src="http://xiangsongtao.com/uploads/1480993292000.png"></p>
<p>以上，使用的比较多的是 created 和 mounted。created 用于获取初始化数据的地方；mounted 用户操作 DOM，比如轮播 swiper 插件初始化的位置。</p>
<h3 id="7-组件" style="position:relative;"><a href="#7-%E7%BB%84%E4%BB%B6" aria-label="7 组件 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>7. 组件</h3>
<p>见下面单独的说明。</p>
<h2 id="html-函数模板中发生的事儿" style="position:relative;"><a href="#html-%E5%87%BD%E6%95%B0%E6%A8%A1%E6%9D%BF%E4%B8%AD%E5%8F%91%E7%94%9F%E7%9A%84%E4%BA%8B%E5%84%BF" aria-label="html 函数模板中发生的事儿 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>HTML 函数模板中发生的事儿</h2>
<h3 id="1-数据绑定" style="position:relative;"><a href="#1-%E6%95%B0%E6%8D%AE%E7%BB%91%E5%AE%9A" aria-label="1 数据绑定 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 数据绑定</h3>
<blockquote>
<p>注意：过滤器 只能在{{}}中使用</p>
</blockquote>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html">// 双向绑定
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>Message: {{ msg }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>
// 单项绑定 v-once
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">v-once</span><span class="token punctuation">></span></span>This will never change: {{ msg }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>
// 绑定HTML
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-html</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>rawHtml<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>{{{rawHtml}}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>

// 绑定属性
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name"><span class="token namespace">v-bind:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dynamicId<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">:data-id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>index<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>用于在HTML中绑定自定义属性
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name"><span class="token namespace">v-bind:</span>href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>url<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name"><span class="token namespace">v-bind:</span>disabled</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>someDynamicCondition<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Button<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>

// 在{{}}中使用js表达式，但是建议使用computed计算完后在回填HTML中，
// 保持逻辑清晰，方便别人阅读代码。
{{ ok ? 'YES' : 'NO' }}
{{ message.split('').reverse().join('') }}

// 过滤器 只能在此使用
{{ message | filterA | filterB }}串联
{{ message | filterA('arg1', arg2) }}带参数，分别是过滤器中的第2、3号参数

// 指令中使用
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>seen<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Now you see me<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></code></pre></div>
<p>如果第一次使用的话，在数据回填之前，会在 HTML 中出现双大括号{{}}的文本，有失美观，使用下面的代码在全局 css 中定义，可解决问题：</p>
<div class="gatsby-highlight" data-language="css"><pre class="language-css"><code class="language-css"><span class="token selector">// 数据渲染完毕后显示内容
[v-cloak]</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<h3 id="2-方法及事件绑定" style="position:relative;"><a href="#2-%E6%96%B9%E6%B3%95%E5%8F%8A%E4%BA%8B%E4%BB%B6%E7%BB%91%E5%AE%9A" aria-label="2 方法及事件绑定 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 方法及事件绑定</h3>
<p><code class="language-text">v-on: click</code>或者简写<code class="language-text">@ click</code></p>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name"><span class="token namespace">v-on:</span>click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>counter += 1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>增加 1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
<span class="token comment">&lt;!--简写--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>counter += 1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>增加 1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
<span class="token comment">&lt;!--methods中定义的函数--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>counter()<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>增加 1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
<span class="token comment">&lt;!--传入事件回调 $event--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>counter($event)<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>增加 1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span></code></pre></div>
<h4 id="3-事件修饰符和按键修饰符" style="position:relative;"><a href="#3-%E4%BA%8B%E4%BB%B6%E4%BF%AE%E9%A5%B0%E7%AC%A6%E5%92%8C%E6%8C%89%E9%94%AE%E4%BF%AE%E9%A5%B0%E7%AC%A6" aria-label="3 事件修饰符和按键修饰符 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. 事件修饰符和按键修饰符</h4>
<blockquote>
<p>修饰符的存在意义：将函数与 DOM 事件解耦，即函数只处理数据逻辑，事件修饰符解决与 DOM 相关操作。当 ViewModel 被销毁时，所有的事件处理器都会自动被删除。</p>
</blockquote>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript">#事件修饰符

<span class="token punctuation">.</span>stop       event<span class="token punctuation">.</span><span class="token function">stopPropagation</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span>prevent    event<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span>capture    添加事件侦听器时使用事件捕获模式
<span class="token punctuation">.</span>self       只当事件在该元素本身（而不是子元素）触发时触发回调

<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 示例 <span class="token operator">--</span><span class="token operator">></span>
<span class="token operator">&lt;</span>a v<span class="token operator">-</span>on<span class="token operator">:</span>click<span class="token punctuation">.</span>stop<span class="token operator">=</span><span class="token string">"doThis"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">></span>

#按键修饰符

<span class="token punctuation">.</span>enter
<span class="token punctuation">.</span>tab
<span class="token punctuation">.</span><span class="token function">delete</span> <span class="token punctuation">(</span>捕获 “删除” 和 “退格” 键<span class="token punctuation">)</span>
<span class="token punctuation">.</span>esc
<span class="token punctuation">.</span>space
<span class="token punctuation">.</span>up
<span class="token punctuation">.</span>down
<span class="token punctuation">.</span>left
<span class="token punctuation">.</span>right

<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 示例 <span class="token operator">--</span><span class="token operator">></span>
<span class="token operator">&lt;</span>input v<span class="token operator">-</span>on<span class="token operator">:</span>keyup<span class="token punctuation">.</span><span class="token number">13</span><span class="token operator">=</span><span class="token string">"submit"</span><span class="token operator">></span>
<span class="token operator">&lt;</span>input v<span class="token operator">-</span>on<span class="token operator">:</span>keyup<span class="token punctuation">.</span>enter<span class="token operator">=</span><span class="token string">"submit"</span><span class="token operator">></span></code></pre></div>
<h3 id="4-class-和-style-中绑定" style="position:relative;"><a href="#4-class-%E5%92%8C-style-%E4%B8%AD%E7%BB%91%E5%AE%9A" aria-label="4 class 和 style 中绑定 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. Class 和 Style 中绑定</h3>
<p>总体来说，就是由 data 中的属性值修改 HTML 中的 class 或者 style，共有 3 中方式。</p>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html"><span class="token comment">&lt;!--1. 样式class 传入对象 classObject = { active: isActive }--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name"><span class="token namespace">v-bind:</span>class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>classObject<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>

<span class="token comment">&lt;!--2. 样式class--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name"><span class="token namespace">v-bind:</span>class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{ active: isActive }<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>static<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">v-bind:</span>class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{ active: isActive, <span class="token punctuation">'</span>text-danger<span class="token punctuation">'</span>: hasError }<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>

<span class="token comment">&lt;!--3. 样式class 使用array语法--></span>
<span class="token comment">&lt;!--activeClass，errorClass是data中的属性值，动态设置class名称--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name"><span class="token namespace">v-bind:</span>class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>[activeClass, errorClass]<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name"><span class="token namespace">v-bind:</span>class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>[isActive ? activeClass : <span class="token punctuation">'</span><span class="token punctuation">'</span>, errorClass]<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name"><span class="token namespace">v-bind:</span>class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>[{ active: isActive }, errorClass]<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></code></pre></div>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html"><span class="token comment">&lt;!--1. 样式style 传入对象 --></span>
<span class="token comment">&lt;!--styleObject = { color: activeColor, fontSize: fontSize + 'px' }--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name"><span class="token namespace">v-bind:</span>class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>styleObject<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>

<span class="token comment">&lt;!--2. 样式style--></span>
<span class="token comment">&lt;!--activeColor，fontSize是data中的属性值，动态设置class名称--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name"><span class="token namespace">v-bind:</span></span><span class="token style-attr language-css"><span class="token attr-name"><span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token punctuation">{</span> <span class="token property">color</span><span class="token punctuation">:</span> activeColor<span class="token punctuation">,</span> <span class="token property">fontSize</span><span class="token punctuation">:</span> fontSize + <span class="token string">'px'</span> <span class="token punctuation">}</span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>

<span class="token comment">&lt;!--3. 样式style 使用array语法--></span>
<span class="token comment">&lt;!--baseStyles，overridingStyles是data中的定义的样式对象--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name"><span class="token namespace">v-bind:</span></span><span class="token style-attr language-css"><span class="token attr-name"><span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value">[baseStyles<span class="token punctuation">,</span> overridingStyles]</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token comment">&lt;!--自动加前缀，例如transform--></span></code></pre></div>
<h3 id="5-条件渲染" style="position:relative;"><a href="#5-%E6%9D%A1%E4%BB%B6%E6%B8%B2%E6%9F%93" aria-label="5 条件渲染 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>5. 条件渲染</h3>
<p>和 angular 很相似，v-if, v-else/v-show，v-show 会在页面初始化的时候渲染内部内容，而 v-if 不会。故 v-if 适用在外部数据渲染前隐藏模板内容，这样不会因为 data 未准备好而报错。</p>
<blockquote>
<p>在开发中还遇到一个问题，这个问题只在 IOS 中发现：使用 v-show 隐藏的页面，其中的 methods 定义的方法，在使用 fastclick 处理 click 事件的时候，点击两次才会触发一次的问题。这个没找到原因，改成了使用<code class="language-text">:class</code>隐藏的手法可以避免。</p>
</blockquote>
<h3 id="6-列表渲染" style="position:relative;"><a href="#6-%E5%88%97%E8%A1%A8%E6%B8%B2%E6%9F%93" aria-label="6 列表渲染 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>6. 列表渲染</h3>
<p>可以渲染三种类型的数据：array、object、number。</p>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html"><span class="token comment">&lt;!--数组列表--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item in items<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>(item,index)in items<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>

<span class="token comment">&lt;!--对象--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>value in object<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>(value, key, index) in object<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>

<span class="token comment">&lt;!--数字--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>n in 10<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>{{ n }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span>

<span class="token comment">&lt;!--绑定顺序 key为通用机制--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item in items<span class="token punctuation">"</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>item.id<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token comment">&lt;!-- 内容 --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></code></pre></div>
<p>数组有些特殊，因为有些数组的方法是在原值上修改，有些是返回新的数组，这里需要注意：如果是返回新的数组，请在将其复制给原数组，保持响应特性。</p>
<p>Array 原值修改的方法：</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">unshift</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">splice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>返回新 Array 的方法：</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">concat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">slice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>以下设置需要注意：</p>
<table>
<thead>
<tr>
<th align="center">使用场景</th>
<th align="center">避免</th>
<th align="center">推荐</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">直接设置一项的索引时</td>
<td align="center"><code class="language-text">vm.items[indexOfItem] = newValue</code></td>
<td align="center"><code class="language-text">Vue.set(example1.items, indexOfItem, newValue)</code> <code class="language-text">example1.items.splice(indexOfItem, 1, newValue)</code></td>
</tr>
<tr>
<td align="center">修改数组的长度时</td>
<td align="center"><code class="language-text">vm.items.length = newLength</code></td>
<td align="center"><code class="language-text">example1.items.splice(newLength)</code></td>
</tr>
</tbody>
</table>
<h3 id="7-表单控件绑定" style="position:relative;"><a href="#7-%E8%A1%A8%E5%8D%95%E6%8E%A7%E4%BB%B6%E7%BB%91%E5%AE%9A" aria-label="7 表单控件绑定 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>7. 表单控件绑定</h3>
<p>选择列表中的 value 不只能绑定 String 结果，也能绑定对象。</p>
<blockquote>
<p>注意：在预选定的需求中，需要将列表中的某值给 selected 才能预选中，而不是创造一个值（列表中的 item 为对象的形式-object） 。</p>
</blockquote>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>selected<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token comment">&lt;!-- 内联对象字面量 --></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name"><span class="token namespace">v-bind:</span>value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>{ number: 123 }<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>123<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>selected<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>option in options<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">v-bind:</span>value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>option.value<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    {{ option.text }}
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span></code></pre></div>
<p>修饰符</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">.lazy        在 change 事件中双向同步数据（区别debounce）使用在,比如输入的值会进行复杂计算或者异步请求
.number      返回number值
.trim        去除首尾空格

&lt;input v-model.number =&quot;age&quot; type=&quot;number&quot;&gt;
&lt;input v-model.trim=&quot;msg&quot;&gt;</code></pre></div>
<h2 id="关于组件" style="position:relative;"><a href="#%E5%85%B3%E4%BA%8E%E7%BB%84%E4%BB%B6" aria-label="关于组件 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>关于组件</h2>
<p>这一节需要单独说明，因为这个是文档中说的最强大的部分。</p>
<p>关于父子组件交互的部分这张图已经说明了一切。即，父组件传给子组件数据，子组件给父组件自定义事件响应。保证了每个组件可以在相对隔离的环境中书写和理解，也大幅提高了组件的可维护性和可重用性。</p>
<blockquote>
<p>类似于这样的一个场景：老子给小子钱买“海天牌”食用盐，买到后放到厨房，小子买到后说一声“全部办完”，此过程老子不管小子是怎么买的。</p>
</blockquote>
<div style="width:100%;text-align:center;">
 <img src="http://xiangsongtao.com/uploads/1480992921000.png" width="400" alt="&#x56FE;&#x7247;&#x540D;&#x79F0;" align="center">
</div>
<p>Vue 组件的核心思想就三部分：数据(props)、事件(event)、内容分发(slot)。</p>
<ol>
<li>prop：允许外部环境传递数据给组件；</li>
<li>event：允许组件触发外部环境的 action；</li>
<li>slot：允许外部环境插入内容到组件的视图结构内。</li>
</ol>
<p>其内容在下面是整体代码中会集中体现，再之后是注意点及解读。</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript">Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">"child"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token comment">// data必须是函数，因为对象是引用类型，会在不同组件间共用</span>
  <span class="token function-variable function">data</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      counter<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      reversedMyMessage1<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>myMessage
        <span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  template<span class="token operator">:</span> <span class="token string">"&lt;span>{{ myMessage }}&lt;/span>"</span><span class="token punctuation">,</span>
  <span class="token comment">// 简单模式</span>
  props<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"myMessage"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token comment">// 完成模式</span>
  props<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 基础类型检测 （`null` 意思是任何类型都可以）</span>
    propA<span class="token operator">:</span> Number<span class="token punctuation">,</span>
    <span class="token comment">// 多种类型 (1.0.21+)</span>
    propM<span class="token operator">:</span> <span class="token punctuation">[</span>String<span class="token punctuation">,</span> Number<span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token comment">// 必需且是字符串</span>
    propB<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> String<span class="token punctuation">,</span>
      required<span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 数字，有默认值</span>
    propC<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> Number<span class="token punctuation">,</span>
      <span class="token keyword">default</span><span class="token operator">:</span> <span class="token number">100</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 对象/数组的默认值应当由一个函数返回</span>
    propD<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> Object<span class="token punctuation">,</span>
      <span class="token function-variable function">default</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
          msg<span class="token operator">:</span> <span class="token string">"hello"</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 自定义验证函数</span>
    propF<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token function-variable function">validator</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> value <span class="token operator">></span> <span class="token number">10</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 全家福</span>
    propG<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> Number<span class="token punctuation">,</span>
      <span class="token keyword">default</span><span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span>
      required<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      <span class="token function-variable function">validator</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> value <span class="token operator">></span> <span class="token number">10</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  computed<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">reversedMyMessage2</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>myMessage
        <span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">increment</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>counter <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">"increment"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<h3 id="1-使用方法" style="position:relative;"><a href="#1-%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95" aria-label="1 使用方法 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 使用方法</h3>
<h4 id="全局组件" style="position:relative;"><a href="#%E5%85%A8%E5%B1%80%E7%BB%84%E4%BB%B6" aria-label="全局组件 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>全局组件</h4>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>example<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-component</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>my-component</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></code></pre></div>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token comment">// 注册</span>
Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">"my-component"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  template<span class="token operator">:</span> <span class="token string">"&lt;div>A custom component!&lt;/div>"</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 创建根实例</span>
<span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  el<span class="token operator">:</span> <span class="token string">"#example"</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<h4 id="局部组件" style="position:relative;"><a href="#%E5%B1%80%E9%83%A8%E7%BB%84%E4%BB%B6" aria-label="局部组件 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>局部组件</h4>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">var</span> Child <span class="token operator">=</span> <span class="token punctuation">{</span>
  template<span class="token operator">:</span> <span class="token string">"&lt;div>A custom component!&lt;/div>"</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  components<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// &lt;my-component> 将只在父模板可用</span>
    <span class="token string">"my-component"</span><span class="token operator">:</span> Child
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<h3 id="2-内部数据data" style="position:relative;"><a href="#2-%E5%86%85%E9%83%A8%E6%95%B0%E6%8D%AEdata" aria-label="2 内部数据data permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 内部数据(data)</h3>
<p>这里的数据必须是 function，且返回 data 数据</p>
<h3 id="3-模板template" style="position:relative;"><a href="#3-%E6%A8%A1%E6%9D%BFtemplate" aria-label="3 模板template permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. 模板(template)</h3>
<p>例子已能说明一切了：在组件定义的数据都可以在里面使用，类似于在 HTML 中绑定数据一样。data 和 props 唯一的区别就是：一个来源内部、一个来源外部。</p>
<h3 id="4-父组件数据props" style="position:relative;"><a href="#4-%E7%88%B6%E7%BB%84%E4%BB%B6%E6%95%B0%E6%8D%AEprops" aria-label="4 父组件数据props permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. 父组件数据(props)</h3>
<blockquote>
<p>组件实例的作用于是孤立的，这点很明确。每个组件都是一个独立王国。</p>
</blockquote>
<ol>
<li>props 中定义的外部变量使用驼峰形式(myMessage)，而在 HTML 中则转化为短横线形式(my-message)</li>
<li>动态的 props 使用<code class="language-text">v-bind:my-message</code>或者<code class="language-text">:my-message</code>形式</li>
<li>props 默认传递 string 类型，即使像 number 这样的传入。如果想传递 number，则使用动态绑定语法<code class="language-text">v-bind:some-prop=&quot;1&quot;</code></li>
<li>prop 为单向数据流，传入的值建议作为<strong>只读模式</strong>使用，如果要对传入值进行处理，请使用<code class="language-text">data</code>或者<code class="language-text">computed</code>处理</li>
<li>对于应用类型：object、array，请 deepCopy 后再处理，或者这样：<code class="language-text">JSON.parse(JSON.stringify(object))</code>，只限于数据拷贝</li>
</ol>
<h3 id="5-事件event" style="position:relative;"><a href="#5-%E4%BA%8B%E4%BB%B6event" aria-label="5 事件event permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>5. 事件(event)</h3>
<ol>
<li><code class="language-text">this.$emit(&#39;increment&#39;)</code>: 子组件的发出的事件在函数内部定义</li>
<li><code class="language-text">v-on:incrementTotal</code>: 父组件监听子组件发出的事件</li>
<li>监听原生事件使用 native 修饰符<code class="language-text">&lt;my-component v-on:click.native=&quot;doTheThing&quot;&gt;&lt;/my-component&gt;</code></li>
<li>非父子通信可使用 eventBus 手段，或者 vuex</li>
</ol>
<p>完整父子组件通信过程：</p>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>counter-event-example<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>{{ total }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button-counter</span> <span class="token attr-name"><span class="token namespace">v-on:</span>increment</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>incrementTotal<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button-counter</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button-counter</span> <span class="token attr-name"><span class="token namespace">v-on:</span>increment</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>incrementTotal<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button-counter</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></code></pre></div>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript">Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">"button-counter"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  template<span class="token operator">:</span> <span class="token string">'&lt;button v-on:click="increment">{{ counter }}&lt;/button>'</span><span class="token punctuation">,</span>
  <span class="token function-variable function">data</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      counter<span class="token operator">:</span> <span class="token number">0</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">increment</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>counter <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">"increment"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  el<span class="token operator">:</span> <span class="token string">"#counter-event-example"</span><span class="token punctuation">,</span>
  data<span class="token operator">:</span> <span class="token punctuation">{</span>
    total<span class="token operator">:</span> <span class="token number">0</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">incrementTotal</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>total <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>对于 v-model 这样的自定义表单输入事件怎么写：</p>
<ol>
<li>props->value</li>
<li>有输入时触发 input 事件</li>
<li>template 做好接收</li>
</ol>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>currency-input</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>price<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>currency-input</span><span class="token punctuation">></span></span></code></pre></div>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript">Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token string">"currency-input"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  template<span class="token operator">:</span> <span class="token string">'\
    &lt;span>\
      $\
      &lt;input\
        ref="input"\
        v-bind:value="value"\
        v-on:input="updateValue($event.target.value)"\
      >\
    &lt;/span>\
  '</span><span class="token punctuation">,</span>
  props<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"value"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// Instead of updating the value directly, this</span>
    <span class="token comment">// method is used to format and place constraints</span>
    <span class="token comment">// on the input's value</span>
    <span class="token function-variable function">updateValue</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">var</span> formattedValue <span class="token operator">=</span> value
        <span class="token comment">// Remove whitespace on either side</span>
        <span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment">// Shorten to 2 decimal places</span>
        <span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> value<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// If the value was not already normalized,</span>
      <span class="token comment">// manually override it to conform</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>formattedValue <span class="token operator">!==</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>input<span class="token punctuation">.</span>value <span class="token operator">=</span> formattedValue<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token comment">// Emit the number value through the input event</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">"input"</span><span class="token punctuation">,</span> <span class="token function">Number</span><span class="token punctuation">(</span>formattedValue<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<h3 id="6-分发内容slot" style="position:relative;"><a href="#6-%E5%88%86%E5%8F%91%E5%86%85%E5%AE%B9slot" aria-label="6 分发内容slot permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>6. 分发内容(slot)</h3>
<p>slot 的动作都是在 html 中下功夫，具体做法：在父组件中，子组件范围内的 html 内容插入 具有 slot 标识位置的子组件中。解读有点晦涩，看完代码变化就懂了。</p>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html"><span class="token comment">&lt;!--子组件(app-layout)--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>header</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>header<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>header</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>main</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>main</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>footer</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>footer<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>footer</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></code></pre></div>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html"><span class="token comment">&lt;!--父组件--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>app-layout</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">slot</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>header<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Here might be a page title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>A paragraph for the main content.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>And another one.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">slot</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>footer<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Here's some contact info<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>app-layout</span><span class="token punctuation">></span></span></code></pre></div>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html"><span class="token comment">&lt;!--组合结果--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>header</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>Here might be a page title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>header</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>main</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>A paragraph for the main content.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>And another one.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>main</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>footer</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>Here's some contact info<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>footer</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></code></pre></div>
<h3 id="7-其他" style="position:relative;"><a href="#7-%E5%85%B6%E4%BB%96" aria-label="7 其他 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>7. 其他</h3>
<ol>
<li>使用 is 特性在组件挂载点动态切换组件</li>
<li>子组件索引<code class="language-text">$refs</code></li>
<li>组件可异步加载</li>
<li>js 中组件命名随意，但是在 html 中只能使用短横线形式</li>
</ol>
<h2 id="高级部分" style="position:relative;"><a href="#%E9%AB%98%E7%BA%A7%E9%83%A8%E5%88%86" aria-label="高级部分 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>高级部分</h2>
<h3 id="1-异步队列更新" style="position:relative;"><a href="#1-%E5%BC%82%E6%AD%A5%E9%98%9F%E5%88%97%E6%9B%B4%E6%96%B0" aria-label="1 异步队列更新 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 异步队列更新</h3>
<p>为了在数据变化之后等待 Vue 完成更新 DOM ，可以在数据变化之后立即使用<code class="language-text">Vue.nextTick(callback)</code> 。这样回调在 DOM 更新完成后就会调用。如果是组件内的话，使用<code class="language-text">this.nextTick(callback)</code>即可。</p>
<blockquote>
<p>而以前的做法是使用 setTimeout 给一个很短的定时，是不是有点尴尬。</p>
</blockquote>
<p>(完)</p>]]></description><link>https://xiangst0816.github.io/blog/Vue-xue-xi-xiao-jie/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/Vue-xue-xi-xiao-jie/</guid><category><![CDATA[Vue]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Sun, 04 Dec 2016 02:20:31 GMT</pubDate></item><item><title><![CDATA[Yarn命令]]></title><description><![CDATA[<h2 id="安装" style="position:relative;"><a href="#%E5%AE%89%E8%A3%85" aria-label="安装 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>安装</h2>
<p><code class="language-text">npm install -g yarn</code></p>
<h2 id="常用命令" style="position:relative;"><a href="#%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4" aria-label="常用命令 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>常用命令</h2>
<table>
<thead>
<tr>
<th align="center">npm 命令</th>
<th align="center">yarn 命令</th>
<th align="center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><code class="language-text">npm install</code></td>
<td align="center"><code class="language-text">yarn</code></td>
<td align="center">install 安装是默认行为</td>
</tr>
<tr>
<td align="center"><code class="language-text">npm install taco --save</code></td>
<td align="center"><code class="language-text">yarn add taco</code></td>
<td align="center">taco 包立即被保存到 package.json 中</td>
</tr>
<tr>
<td align="center"><code class="language-text">npm uninstall taco --save</code></td>
<td align="center"><code class="language-text">yarn remove taco</code></td>
<td align="center">在 yarn 中，在 package.json 中添加（add）和移除（remove）等行为是默认的</td>
</tr>
<tr>
<td align="center"><code class="language-text">npm install taco --save-dev</code></td>
<td align="center"><code class="language-text">yarn add taco --dev</code></td>
<td align="center"></td>
</tr>
<tr>
<td align="center"><code class="language-text">npm update --save</code></td>
<td align="center"><code class="language-text">yarn upgrade</code></td>
<td align="center"></td>
</tr>
<tr>
<td align="center"><code class="language-text">npm install taco --global</code></td>
<td align="center"><code class="language-text">yarn global add taco</code></td>
<td align="center">请谨慎使用 global 标记</td>
</tr>
<tr>
<td align="center"><code class="language-text">npm init</code></td>
<td align="center"><code class="language-text">yarn init</code></td>
<td align="center"></td>
</tr>
<tr>
<td align="center"><code class="language-text">npm link</code></td>
<td align="center"><code class="language-text">yarn link</code></td>
<td align="center"></td>
</tr>
<tr>
<td align="center"><code class="language-text">npm outdated</code></td>
<td align="center"><code class="language-text">yarn outdated</code></td>
<td align="center"></td>
</tr>
<tr>
<td align="center"><code class="language-text">npm publish</code></td>
<td align="center"><code class="language-text">yarn publish</code></td>
<td align="center"></td>
</tr>
<tr>
<td align="center"><code class="language-text">npm run</code></td>
<td align="center"><code class="language-text">yarn run</code></td>
<td align="center"></td>
</tr>
<tr>
<td align="center"><code class="language-text">npm cache clean</code></td>
<td align="center"><code class="language-text">yarn cache clean</code></td>
<td align="center"></td>
</tr>
<tr>
<td align="center"><code class="language-text">npm login</code></td>
<td align="center"><code class="language-text">yarn login</code></td>
<td align="center">运行命令</td>
</tr>
<tr>
<td align="center"><code class="language-text">npm test</code></td>
<td align="center"><code class="language-text">yarn test</code></td>
<td align="center"></td>
</tr>
</tbody>
</table>
<h2 id="yarn-独有命令" style="position:relative;"><a href="#yarn-%E7%8B%AC%E6%9C%89%E5%91%BD%E4%BB%A4" aria-label="yarn 独有命令 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Yarn 独有命令</h2>
<table>
<thead>
<tr>
<th align="center">yarn 命令</th>
<th align="center">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><code class="language-text">yarn licenses ls</code></td>
<td align="center">允许你检查依赖的许可信息</td>
</tr>
<tr>
<td align="center"><code class="language-text">yarn licenses generate</code></td>
<td align="center">自动创建依赖免责声明 license</td>
</tr>
<tr>
<td align="center"><code class="language-text">yarn why taco</code></td>
<td align="center">检查为什么会安装 taco，详细列出依赖它的其他包</td>
</tr>
</tbody>
</table>]]></description><link>https://xiangst0816.github.io/blog/Yarn-ming-ling/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/Yarn-ming-ling/</guid><category><![CDATA[Yarn]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Sat, 03 Dec 2016 08:26:23 GMT</pubDate></item><item><title><![CDATA[事件模型]]></title><description><![CDATA[<h2 id="dom-事件流" style="position:relative;"><a href="#dom-%E4%BA%8B%E4%BB%B6%E6%B5%81" aria-label="dom 事件流 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>DOM 事件流</h2>
<p>分为三个阶段：事件捕获阶段、目标阶段、事件冒泡阶段。</p>
<p>事件捕获老版本浏览器（IE&#x3C;=8）不支持，但是事件冒泡可以放心使用。</p>
<p><img src="http://xiangsongtao.com/uploads/1477529052000.jpeg" alt="12"></p>
<h2 id="事件处理程序" style="position:relative;"><a href="#%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%E7%A8%8B%E5%BA%8F" aria-label="事件处理程序 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>事件处理程序</h2>
<blockquote>
<p>一共四类写法，基本都见过，看下写法就知道怎么回事儿了。</p>
</blockquote>
<h3 id="1-html-事件处理程序" style="position:relative;"><a href="#1-html-%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%E7%A8%8B%E5%BA%8F" aria-label="1 html 事件处理程序 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. HTML 事件处理程序</h3>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">&lt;input type=&quot;button&quot; value=&quot;Click me&quot; onclick=&quot;ShowMessage()&quot;/&gt;</code></pre></div>
<h3 id="2-dom0-级事件处理程序" style="position:relative;"><a href="#2-dom0-%E7%BA%A7%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%E7%A8%8B%E5%BA%8F" aria-label="2 dom0 级事件处理程序 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. DOM0 级事件处理程序</h3>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">var btn = document.getElementById(&quot;myBtn&quot;);
btn.onclick = function(){
	alert(&quot;click!&quot;);
	alert(this.id);//this指向myBtn，可继续获取myBtn的其余属性
}</code></pre></div>
<h3 id="3-dom2-级事件处理程序" style="position:relative;"><a href="#3-dom2-%E7%BA%A7%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%E7%A8%8B%E5%BA%8F" aria-label="3 dom2 级事件处理程序 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. DOM2 级事件处理程序</h3>
<p>定义事件及删除事件的两个方法：addEventListener、removeEventListener。</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">var btn = document.getElementById(&quot;myBtn&quot;);
btn.addEventListener(&quot;click&quot;,function(){
	alert(this.id);
},false);</code></pre></div>
<p>第三个参数：true，表示在捕获阶段触发；false，表示程序在冒泡阶段触发；</p>
<p>removeEventListener()的第二个参数必须传入与 addEventListener()中相同的处理函数(传入相同的函数引用，而不是形同函数！)，否则不会生效。</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">var handler = function handler(){
	alert(this.id);
}
btn.addEventListener(&quot;click&quot;, handler, false);
btn.removeEventListener(&quot;click&quot;, handler, false);</code></pre></div>
<h3 id="4-ie-事件处理函数" style="position:relative;"><a href="#4-ie-%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%E5%87%BD%E6%95%B0" aria-label="4 ie 事件处理函数 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. IE 事件处理函数</h3>
<blockquote>
<p>IE 就是这么另类（IE8 及更早版本）</p>
</blockquote>
<p>定义事件及删除事件的两个方法：attachEvent、detachEvent。因为只支持冒泡，故第三个参数没有；且第一个参数需要带上<strong>“on”</strong>！</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">var handler = function handler(){
	alert(this.id);
}
btn.attachEvent(&quot;onclick&quot;, handler);
btn.detachEvent(&quot;onclick&quot;, handler);</code></pre></div>
<h2 id="事件对象" style="position:relative;"><a href="#%E4%BA%8B%E4%BB%B6%E5%AF%B9%E8%B1%A1" aria-label="事件对象 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>事件对象</h2>
<p>事件触发会在 handler 中传入事件对象 event。</p>
<h3 id="1-dom-中的事件对象" style="position:relative;"><a href="#1-dom-%E4%B8%AD%E7%9A%84%E4%BA%8B%E4%BB%B6%E5%AF%B9%E8%B1%A1" aria-label="1 dom 中的事件对象 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. DOM 中的事件对象</h3>
<p>event 的成员属性及说明如下，以下属性皆为只读：</p>
<table>
<thead>
<tr>
<th align="center">属性/方法</th>
<th align="center">说明</th>
<th align="center">示例</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">bubble</td>
<td align="center">表示事件是否冒泡</td>
<td align="center">event.bubble -> true/false</td>
</tr>
<tr>
<td align="center">cancelable</td>
<td align="center">是否可以取消事件的默认行为</td>
<td align="center">event.cancelable -> true/false</td>
</tr>
<tr>
<td align="center">currentTarget</td>
<td align="center">事件函数正在处理事件的那个元素，比如委托 document 处理</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">defaultPrevented</td>
<td align="center">为 true 则表示已经调用了 preventDefault()</td>
<td align="center"></td>
</tr>
<tr>
<td align="center">eventPhase</td>
<td align="center">事件处理阶段，1 捕获阶段，2 目标，3 冒泡阶段</td>
<td align="center">event.eventPhase === 1</td>
</tr>
<tr>
<td align="center">preventDefault()</td>
<td align="center">取消默认行为</td>
<td align="center">event. preventDefault();</td>
</tr>
<tr>
<td align="center">stopPropagation()</td>
<td align="center">取消进一步冒泡捕获行为</td>
<td align="center">event.stopPropagation();</td>
</tr>
<tr>
<td align="center">stopImmediatePropagation()</td>
<td align="center">取消进一步冒泡捕获行为,并阻止任何事件处理程序被调用</td>
<td align="center">event.stopImmediatePropagation();</td>
</tr>
<tr>
<td align="center">target</td>
<td align="center">设计目标</td>
<td align="center">event.target === getElementById(id)</td>
</tr>
<tr>
<td align="center">type</td>
<td align="center">触发事件的类型</td>
<td align="center">event.type === ‘click’</td>
</tr>
</tbody>
</table>
<h3 id="2-ie-中事件对象" style="position:relative;"><a href="#2-ie-%E4%B8%AD%E4%BA%8B%E4%BB%B6%E5%AF%B9%E8%B1%A1" aria-label="2 ie 中事件对象 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. IE 中事件对象</h3>
<p>因为 IE 中没有捕获，故简单了些。<strong>注意对比两个表的区别！</strong></p>
<table>
<thead>
<tr>
<th align="center">属性/方法</th>
<th align="center">说明</th>
<th align="center">示例</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">returnValue</td>
<td align="center">取消默认行为</td>
<td align="center">event. returnValue = false; //取消默认行为</td>
</tr>
<tr>
<td align="center">cancelBubble</td>
<td align="center">取消进一步冒泡捕获行为</td>
<td align="center">event.cancelBubble = true;//取消冒泡</td>
</tr>
<tr>
<td align="center">srcElement</td>
<td align="center">设计目标</td>
<td align="center">event.srcElement === getElementById(id)</td>
</tr>
<tr>
<td align="center">type</td>
<td align="center">触发事件的类型</td>
<td align="center">event.type === ‘click’</td>
</tr>
</tbody>
</table>
<h3 id="3-跨浏览器兼容方案" style="position:relative;"><a href="#3-%E8%B7%A8%E6%B5%8F%E8%A7%88%E5%99%A8%E5%85%BC%E5%AE%B9%E6%96%B9%E6%A1%88" aria-label="3 跨浏览器兼容方案 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. 跨浏览器兼容方案</h3>
<p>为了保证大多数浏览器的兼容，故只需要考虑冒泡阶段的实现。上面说的很清楚了，这里直接上代码。</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">var EventUtil = {
    // 绑定事件
    addHandler: function addHandler(element, type, handler) {
        if (element.addEventListener) {
            element.addEventListener(type, handler, false);
        } else if (element.attachEvent) {
            element.attachEvent(&#39;on&#39; + type, handler);
        } else {
            element[&#39;on&#39; + type] = handler;
        }
    },
    // 解绑事件
    removeHandler: function removeHandler(element, type, handler) {
        if (element.removeEventListener) {
            element.removeEventListener(type, handler, false);
        } else if (element.detachEvent) {
            element.detachEvent(&#39;on&#39; + type, handler);
        } else {
            element[&#39;on&#39; + type] = null;
        }
    },
    // 获取事件对象event
    getEvent: function getEvent(event) {
        return event || window.event;
    },
    // 获取触发目标
    getTarget: function getTarget(event) {
        return event.target || event.srcElement;
    },
    // 阻止默认行为
    preventDefault: function preventDefault(event) {
        if (event.preventDefault) {
            event.preventDefault()
        } else {
            event.returnValue = false;
        }
    },
    // 取消冒泡
    stopPropagation: function stopPropagation(event) {
        if (event.stopPropagation) {
            event.stopPropagation()
        } else {
            event.cancelBubble = true;
        }
    }
}</code></pre></div>
<h2 id="事件的代理委托的原理以及优缺点" style="position:relative;"><a href="#%E4%BA%8B%E4%BB%B6%E7%9A%84%E4%BB%A3%E7%90%86%E5%A7%94%E6%89%98%E7%9A%84%E5%8E%9F%E7%90%86%E4%BB%A5%E5%8F%8A%E4%BC%98%E7%BC%BA%E7%82%B9" aria-label="事件的代理委托的原理以及优缺点 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>事件的代理/委托的原理以及优缺点</h2>
<p>这是靠事件的冒泡机制来实现的，优点是</p>
<blockquote>
<p>1、可以大量节省内存占用，减少事件注册，比如在 table 上代理所有 td 的 click 事件就非常棒
2、可以实现当新增子对象时无需再次对其绑定事件，对于动态内容部分尤为合适</p>
</blockquote>
<h2 id="手写原生-js【实现事件代理】，并要求兼容浏览器" style="position:relative;"><a href="#%E6%89%8B%E5%86%99%E5%8E%9F%E7%94%9F-js%E3%80%90%E5%AE%9E%E7%8E%B0%E4%BA%8B%E4%BB%B6%E4%BB%A3%E7%90%86%E3%80%91%EF%BC%8C%E5%B9%B6%E8%A6%81%E6%B1%82%E5%85%BC%E5%AE%B9%E6%B5%8F%E8%A7%88%E5%99%A8" aria-label="手写原生 js【实现事件代理】，并要求兼容浏览器 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>手写原生 js【实现事件代理】，并要求兼容浏览器</h2>
<p>考核对事件对象 event 的了解程度，以及在 IE 下对应的属性名。其实此时如果你说就是用<code class="language-text">target/currentTarget</code>，以及 IE 下的<code class="language-text">srcElement/this</code>，基本就可以略过了</p>
<p>绑到按钮上：</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">var btn = document.getElementById(&quot;myBtn&quot;);
btn.addEventListener(&quot;click&quot;,function(){
	console.log(event.currentTarget === this);//true
	console.log(event.target === this);//true
},false);</code></pre></div>
<p>绑到 document 上：</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">var btn = document.getElementById(&quot;myBtn&quot;);
document.body.onclick = function(){
	console.log(event.currentTarget === this );//true
	console.log(document.body === this );//true
	console.log(event.target === btn);//true
}</code></pre></div>
<h2 id="实现事件模型" style="position:relative;"><a href="#%E5%AE%9E%E7%8E%B0%E4%BA%8B%E4%BB%B6%E6%A8%A1%E5%9E%8B" aria-label="实现事件模型 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>实现事件模型</h2>
<p>一个 bind 一个 trigger，分别实现绑定事件和触发事件，核心需求就是可以对某一个事件名称绑定多个事件响应函数，然后触发这个事件名称时，依次按绑定顺序触发相应的响应函数。</p>
<p>大致实现思路就是创建一个类或是匿名函数，在 bind 和 trigger 函数外层作用域创建一个字典对象，用于存储注册的事件及响应函数列表，bind 时，如果字典没有则创建一个，key 是事件名称，value 是数组，里面放着当前注册的响应函数，如果字段中有，那么就直接 push 到数组即可。trigger 时调出来依次触发事件响应函数即可。</p>
<h2 id="事件如何派发也就是事件广播（dispatchevent）" style="position:relative;"><a href="#%E4%BA%8B%E4%BB%B6%E5%A6%82%E4%BD%95%E6%B4%BE%E5%8F%91%E4%B9%9F%E5%B0%B1%E6%98%AF%E4%BA%8B%E4%BB%B6%E5%B9%BF%E6%92%AD%EF%BC%88dispatchevent%EF%BC%89" aria-label="事件如何派发也就是事件广播（dispatchevent） permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>事件如何派发也就是事件广播（dispatchEvent）</h2>
<p>这个是自定义事件及事件触发的应用（createEvent/dispatchEvent, createEventObject/fireEvent）</p>
<p>一般我们在元素上绑定事件后，是靠用户在这些元素上的鼠标行为来捕获或者触发事件的，或者自带的浏览器行为事件，比如 click，mouseover，load 等等，有些时候我们需要自定义事件或者在特定的情况下需要触发这些事件。这个时候我们可以使用 IE 下 fireEvent 方法，高级浏览器（chrome,firefox 等）有 dispatchEvent 方法。</p>
<h2 id="小结" style="position:relative;"><a href="#%E5%B0%8F%E7%BB%93" aria-label="小结 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>小结</h2>
<ol>
<li>有必要限制一个页面中事件处理程序的数量，因为太多会占用大量内存，导致卡顿</li>
<li>建立在事件冒泡机制上的事件委托技术，可以有效减少事件的处理程序的数量</li>
<li>建议再浏览器写在页面之前移除页面的所有事件处理程序</li>
</ol>
<h2 id="参考" style="position:relative;"><a href="#%E5%8F%82%E8%80%83" aria-label="参考 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>参考</h2>
<ul>
<li><a href="http://www.w3cmark.com/2016/439.html" target="_target" rel="nofollow">事件模型及事件代理/委托</a></li>
</ul>]]></description><link>https://xiangst0816.github.io/blog/shi-jian-mo-mu-xing/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/shi-jian-mo-mu-xing/</guid><category><![CDATA[DOM]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Sun, 23 Oct 2016 11:06:06 GMT</pubDate></item><item><title><![CDATA[JavaScript arguments 对象全面介绍]]></title><description><![CDATA[<h2 id="什么是-arguments" style="position:relative;"><a href="#%E4%BB%80%E4%B9%88%E6%98%AF-arguments" aria-label="什么是 arguments permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>什么是 arguments</h2>
<p>arguments 是一个类数组的对象，代表传给一个 function 的参数列表。</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">function printArgs() {
    console.log(arguments);
}

printArgs(&quot;A&quot;, &quot;a&quot;, 0, { foo: &quot;Hello, arguments&quot; })；
执行结果是：
[&quot;A&quot;, &quot;a&quot;, 0, Object]</code></pre></div>
<h2 id="arguments-操作" style="position:relative;"><a href="#arguments-%E6%93%8D%E4%BD%9C" aria-label="arguments 操作 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>arguments 操作</h2>
<h3 id="arguments-length" style="position:relative;"><a href="#arguments-length" aria-label="arguments length permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>arguments length</h3>
<p>arguments 是个类数组对象，其包含一个 length 属性，可以用 arguments.length 来获得传入函数的参数个数。</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">function func() {
    console.log(&quot;The number of parameters is &quot; + arguments.length);
}</code></pre></div>
<h3 id="arguments-转数组" style="position:relative;"><a href="#arguments-%E8%BD%AC%E6%95%B0%E7%BB%84" aria-label="arguments 转数组 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>arguments 转数组</h3>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">Array.prototype.slice.call(arguments);
[].slice.call(arguments);</code></pre></div>
<h3 id="arguments-传递出去" style="position:relative;"><a href="#arguments-%E4%BC%A0%E9%80%92%E5%87%BA%E5%8E%BB" aria-label="arguments 传递出去 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>arguments 传递出去</h3>
<p>将函数的 arguments 对象泄露出去了，最终的结果就是 V8 引擎将会跳过优化，导致相当大的性能损失。</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">// Leaking arguments example1:
function getArgs() {
    return arguments;
}
// good arguments example1:
function getArgs() {
    const args = [].slice.call(arguments);//slice返回新数组
    return args;
}</code></pre></div>
<h3 id="修改-arguments-值" style="position:relative;"><a href="#%E4%BF%AE%E6%94%B9-arguments-%E5%80%BC" aria-label="修改 arguments 值 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>修改 arguments 值</h3>
<p>在严格模式与非严格模式下，修改函数参数值表现的结果不一样。在严格模式下，函数中的参数与 arguments 对象没有联系，修改一个值不会改变另一个值。而在非严格模式下，两个会同步影响。</p>
<h3 id="将参数从一个函数传递到另一个函数" style="position:relative;"><a href="#%E5%B0%86%E5%8F%82%E6%95%B0%E4%BB%8E%E4%B8%80%E4%B8%AA%E5%87%BD%E6%95%B0%E4%BC%A0%E9%80%92%E5%88%B0%E5%8F%A6%E4%B8%80%E4%B8%AA%E5%87%BD%E6%95%B0" aria-label="将参数从一个函数传递到另一个函数 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>将参数从一个函数传递到另一个函数</h3>
<p>下面是将参数从一个函数传递到另一个函数的推荐做法。</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">function foo() {
    bar.apply(this, arguments);
}
function bar(a, b, c) {
    // logic
}</code></pre></div>
<h3 id="arguments-与重载" style="position:relative;"><a href="#arguments-%E4%B8%8E%E9%87%8D%E8%BD%BD" aria-label="arguments 与重载 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>arguments 与重载</h3>
<p>利用 arguments 模拟重载。</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">function add(num1, num2, num3) {
    if (arguments.length === 2) {
        console.log(&quot;Result is &quot; + (num1 + num2));
    }
    else if (arguments.length === 3) {
        console.log(&quot;Result is &quot; + (num1 + num2 + num3));
    }
}</code></pre></div>
<h2 id="es6-中的-arguments" style="position:relative;"><a href="#es6-%E4%B8%AD%E7%9A%84-arguments" aria-label="es6 中的 arguments permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ES6 中的 arguments</h2>
<h3 id="扩展操作符" style="position:relative;"><a href="#%E6%89%A9%E5%B1%95%E6%93%8D%E4%BD%9C%E7%AC%A6" aria-label="扩展操作符 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>扩展操作符</h3>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">function func() {
    console.log(...arguments);
}

func(1, 2, 3);
执行结果是：
1 2 3</code></pre></div>
<h3 id="rest-参数" style="position:relative;"><a href="#rest-%E5%8F%82%E6%95%B0" aria-label="rest 参数 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Rest 参数</h3>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">function func(firstArg, ...restArgs) {
    console.log(Array.isArray(restArgs));
    console.log(firstArg, restArgs);
}

func(1, 2, 3);
执行结果是：
true
1 [2, 3]</code></pre></div>
<p>从上面的结果可以看出，Rest 参数表示除了明确指定剩下的参数集合，类型是 Array。</p>
<h3 id="默认参数" style="position:relative;"><a href="#%E9%BB%98%E8%AE%A4%E5%8F%82%E6%95%B0" aria-label="默认参数 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>默认参数</h3>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">function func(firstArg = 0, secondArg = 1) {
    console.log(arguments[0], arguments[1]);
    console.log(firstArg, secondArg);
}

func(99);
执行结果是：
99 undefined
99 1</code></pre></div>
<p>可见，默认参数对 arguments 没有影响，arguments 还是仅仅表示调用函数时所传入的所有参数。</p>
<h3 id="arguments-转数组-1" style="position:relative;"><a href="#arguments-%E8%BD%AC%E6%95%B0%E7%BB%84-1" aria-label="arguments 转数组 1 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>arguments 转数组</h3>
<p>Array.from() 是个非常推荐的方法，其可以将所有类数组对象转换成数组。</p>
<h2 id="参考" style="position:relative;"><a href="#%E5%8F%82%E8%80%83" aria-label="参考 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>参考</h2>
<ul>
<li><a href="https://segmentfault.com/a/1190000007091243" target="_target" rel="nofollow">JavaScript arguments 对象全面介绍</a></li>
</ul>]]></description><link>https://xiangst0816.github.io/blog/JavaScriptarguments-dui-xiang-quan/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/JavaScriptarguments-dui-xiang-quan/</guid><category><![CDATA[JavaScript]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Sat, 22 Oct 2016 13:43:07 GMT</pubDate></item><item><title><![CDATA[页面缓存设置]]></title><description><![CDATA[<p>浏览器缓存机制一般分为两种：HTML Meta 标签控制缓存和 <strong>HTTP 头信息</strong>。</p>
<h2 id="html-meta-标签控制缓存" style="position:relative;"><a href="#html-meta-%E6%A0%87%E7%AD%BE%E6%8E%A7%E5%88%B6%E7%BC%93%E5%AD%98" aria-label="html meta 标签控制缓存 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>HTML Meta 标签控制缓存</h2>
<p>非 HTTP 协议定义的缓存机制，如使用 HTML Meta 标签，Web 开发者可以在 HTML 页面的<head>节点中加入<meta>标签，代码如下：</p>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html">＜meta http-equiv="参数" content="参数变量值"＞</code></pre></div>
<p><strong>参数可以是以下值：</strong></p>
<p>expires(期限) 、Pragma(cache 模式)、Refresh(刷新) 、
Set-Cookie(cookie 设定) 、Window-target(显示窗口的设定) 、
content-Type(显示字符集的设定) 、Pics-label(网页等级评定) 、
cache-control 等。</p>
<p><a href="http://kinglyhum.iteye.com/blog/827807" target="_target" rel="nofollow">设置请参考这里</a></p>
<p>但是，所有缓存代理服务器都不支持上述方法，因为代理不解析 HTML 内容本身。而广泛应用的还是 <strong>HTTP 头信息</strong> 来控制缓存，下面主要介绍 HTTP 协议定义的缓存机制，这个是比较通用的做法。记住相应的参数、作用及设置方法，就差不多了。</p>
<h2 id="http-头信息控制缓存" style="position:relative;"><a href="#http-%E5%A4%B4%E4%BF%A1%E6%81%AF%E6%8E%A7%E5%88%B6%E7%BC%93%E5%AD%98" aria-label="http 头信息控制缓存 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>HTTP 头信息控制缓存</h2>
<h3 id="资源新鲜度检测（freshness）" style="position:relative;"><a href="#%E8%B5%84%E6%BA%90%E6%96%B0%E9%B2%9C%E5%BA%A6%E6%A3%80%E6%B5%8B%EF%BC%88freshness%EF%BC%89" aria-label="资源新鲜度检测（freshness） permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>资源新鲜度检测（Freshness）</h3>
<p><code class="language-text">Cache Control</code>与<code class="language-text">Expires</code>是一组，他们是用来进行 Freshness 验证，也就是提供客户端检测文件是否足够新鲜，可以无需向服务端发起 Validation 请求(见下)就能保证并未过期可以直接使用。</p>
<p>所有的<code class="language-text">(from cache)</code>的请求实际上都是由于浏览器认为本地的缓存资源足够新鲜，所以无需额外请求而直接使用。实际上就是根据本地的时间和服务器返回头的约定信息进行对比验证。</p>
<h4 id="expires" style="position:relative;"><a href="#expires" aria-label="expires permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Expires</h4>
<p>在 HTTP1.0 版本中定义的是<code class="language-text">Expires</code>，<code class="language-text">Expires</code>的值是一个明确的<strong>GMT 格式</strong>的过期时间，指浏览器或缓存服务器在该时间点后必须从真正的服务器中获取新的页面信息；<mark>当用户的时间和服务器时间不一致的手，会引发缓存判断的问题</mark>（例如客户端的本地时间错误）。如果不设置缓存，需要将<code class="language-text">Expires</code>设为 0；</p>
<h4 id="cache-control" style="position:relative;"><a href="#cache-control" aria-label="cache control permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Cache Control</h4>
<p>因此，在 HTTP1.1 版本中再追加判断字段：<code class="language-text">Cache-Control</code>。<strong>其中<code class="language-text">max-age</code>参数告知客户端这个文件多长时间不会过期</strong>而不是直接告知过期时间。常用的参数如下：</p>
<ul>
<li>no-cache：浏览器和缓存服务器都不应该缓存页面信息；</li>
<li>private：只在内存中缓存, 默认；</li>
<li>no-store：请求和响应的信息都不应该被存储在对方的磁盘系统中；</li>
<li>must-revalidate：对于客户机的每次请求，代理服务器必须向服务器验证缓存是否过时；</li>
<li>public, max-age=[number]：在硬盘中缓存, 浏览器和缓存服务器都可以缓存页面信息，并设定具体的过期秒数</li>
</ul>
<blockquote>
<p>以上两个如果同时存在，则<code class="language-text">Cache Control</code>的<code class="language-text">max-age</code>将覆盖<code class="language-text">Expires</code>.</p>
</blockquote>
<h3 id="资源验证（validation）" style="position:relative;"><a href="#%E8%B5%84%E6%BA%90%E9%AA%8C%E8%AF%81%EF%BC%88validation%EF%BC%89" aria-label="资源验证（validation） permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>资源验证（Validation）</h3>
<p><code class="language-text">Last-Modified</code>和<code class="language-text">ETag</code>则是另一组控制信息，他们用来实现 Validation。他们的职责是在本地缓存被浏览器判断可能不够新鲜的时候，会用这两组信息向服务器请求数据，如果服务器内容没有改变，那么约定服务器会返回 <strong>304(Not Modify)</strong> HTTP Code 表明这个缓存可以直接使用，无需重新拉取，而一旦服务器内容改变了就会返回 <strong>200(from cache)</strong>，同时返回新的文件内容。</p>
<h4 id="last-modified" style="position:relative;"><a href="#last-modified" aria-label="last modified permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Last-Modified</h4>
<p>在 HTTP 1.0 中约定的<code class="language-text">Last-Modified</code>代表的含义是文件最后一次修改的<strong>GMT 格式</strong>的时间，但是当访问的静态资源师动态生成的，<strong>比如动态 gzip 压缩 js/css 代码，那么返回的<code class="language-text">Last-Modified</code>每次都会不一样</strong>；另外<code class="language-text">Last-Modified</code>只能精确到秒，如果文件变动在秒以内，则客户端无法感知。</p>
<p>如果用户第二次打开，在请求头上会添加<code class="language-text">If-Modified-Since</code>关键字，传递本地缓存的资源最后修改时间<code class="language-text">Last-Modified</code>，之后由服务器判断是返回 304 NotModified 还是 200 OK(新资源)</p>
<h4 id="etag" style="position:relative;"><a href="#etag" aria-label="etag permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>ETag</h4>
<p>因此，在 HTTP1.1 版本中再追加判断字段：<code class="language-text">ETag</code>。他的实现不尽相同，对于<strong>动态内容</strong>，常规做法是对动态内容做 HASH 计算，作为 ETAG 返回，对于静态资源，一般是使用 inode+mtime 进行计算。</p>
<p>同样，如果之前设置了此值，当用户第二次打开时，请求头会携带<code class="language-text">If-None-Match</code>关键字，判断资源的<code class="language-text">ETag</code>是否过期。</p>
<p>ETag 也有他自己的问题，所以经常在使用中会关闭<code class="language-text">ETag</code>。举例来说，同一个文件在不同物理机上的 inode 是不同的，这就导致了在分布式的 Web 系统中，当访问落在不同的物理机上时会返回不同的<code class="language-text">ETag</code>，进而导致 304 失效，降级为 200 请求。解决办法也有从<code class="language-text">ETag</code>算法中剥离 inode，只是使用 mtime，但是这样实际上和<code class="language-text">Last-Modified</code>就一样了。当然你也可以额外的做一些改进，使<code class="language-text">ETag</code>对静态资源的算法也是通过 hash 计算的。不过由于一般我们会使用 CDN 技术，因此集群部署中的<code class="language-text">ETag</code>问题并不会造成太大的影响，所以折腾的人也不太是很多。</p>
<h3 id="nodejs--express-处理方式" style="position:relative;"><a href="#nodejs--express-%E5%A4%84%E7%90%86%E6%96%B9%E5%BC%8F" aria-label="nodejs  express 处理方式 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Nodejs + Express 处理方式</h3>
<h4 id="静态资源处理" style="position:relative;"><a href="#%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E5%A4%84%E7%90%86" aria-label="静态资源处理 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>静态资源处理</h4>
<ul>
<li>设置 30 天后过期</li>
</ul>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>
  express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">"public"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    etag<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">//资源标记</span>
    maxAge<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">//除去下面格式的其余文件不缓存，比如html</span>
    <span class="token function-variable function">setHeaders</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">res<span class="token punctuation">,</span> path<span class="token punctuation">,</span> state</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token regex">/\.(js|css|png|gif|jpg|jpeg)$/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 未来的一个过期时间</span>
        res<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"Expires"</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">2592000</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toGMTString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        res<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">"Cache-Control"</span><span class="token punctuation">,</span> <span class="token string">"public, max-age=2592000"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<ul>
<li>不缓存</li>
</ul>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token function">static</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'public'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    etag<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">//资源标记</span>
    maxAge<span class="token operator">:</span> <span class="token number">0</span>，
    <span class="token function-variable function">setHeaders</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">res<span class="token punctuation">,</span> path<span class="token punctuation">,</span> state</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token regex">/\.(js|css|png|gif|jpg|jpeg)$/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            res<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'Expires'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            res<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'Cache-Control'</span><span class="token punctuation">,</span> <span class="token string">'no-cache'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<h3 id="缓存策略根据不同的重新浏览方式分为以下几种情况" style="position:relative;"><a href="#%E7%BC%93%E5%AD%98%E7%AD%96%E7%95%A5%E6%A0%B9%E6%8D%AE%E4%B8%8D%E5%90%8C%E7%9A%84%E9%87%8D%E6%96%B0%E6%B5%8F%E8%A7%88%E6%96%B9%E5%BC%8F%E5%88%86%E4%B8%BA%E4%BB%A5%E4%B8%8B%E5%87%A0%E7%A7%8D%E6%83%85%E5%86%B5" aria-label="缓存策略根据不同的重新浏览方式分为以下几种情况 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>缓存策略根据不同的重新浏览方式分为以下几种情况</h3>
<ul>
<li>
<p>打开新窗口</p>
<p>如果指定 cache-control 的值为 private、no-cache、must-revalidate，那么打开新窗口访问时都会重新访问服务器。而如果指定了 max-age 值，那么在此值内的时间里就不会重新访问服务器，例如：</p>
<p>Cache-control: max-age=5
表示当访问此网页后的 5 秒内再次访问不会去服务器获取资源</p>
</li>
<li>
<p>在地址栏回车</p>
<p>如果值为 private 或 must-revalidate（和网上说的不一样），则只有第一次访问时会访问服务器，以后就不再访问。如果值为 no-cache，那么每次都会访问。如果值为 max-age，则在过期之前不会重复访问。</p>
</li>
<li>
<p>按后退按扭</p>
<p>如果值为 private、must-revalidate、max-age，则不会重新访问，而如果为 no-cache，则每次都重复访问</p>
</li>
<li>
<p>按刷新按扭</p>
<p>无论为何值，都会重复访问</p>
</li>
</ul>
<h3 id="总结一下" style="position:relative;"><a href="#%E6%80%BB%E7%BB%93%E4%B8%80%E4%B8%8B" aria-label="总结一下 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>总结一下</h3>
<p><code class="language-text">ETag</code>的设置并不会影响 Freshness 验证，Freshness 验证只会和浏览器策略、<code class="language-text">Cache Control</code>、<code class="language-text">Expires</code>有关。</p>
<p>也就是说，如果访问的静态资源并不会存在小于 1s 的求改情况，<code class="language-text">ETag</code>可以关闭。</p>
<p>下面是上述文字的整个流程图：</p>
<p><figure class="gatsby-resp-image-figure" style="">
    <span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 472px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 109.52380952380953%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAWCAYAAADAQbwGAAAACXBIWXMAAAsSAAALEgHS3X78AAAD4ElEQVQ4y42UW0hcVxSGz5lMICmhD32SUtMWkjSJJKJGaaQ3ShvoY9K3ICUPfShSYsDSBxMkfRQ1rTZtodAHcR7qeEcU8X7HGypateL9ftcZdcYZz5zZ/dZhZhBJmWxY7H32Xus/61/r31sbHBzUZGRlZdnW19e/3t3dzVhaWkpfW1tL39vbe7KwsJAk56Zp6g0NDVrUQbBN5oqKirc3NjZ8igGw2t/fl6Wam5tzyjlLO+BWjNfr1V5rZGdnxzqdzsS8vLyUwsLCpKKiooS4uLg3TvtEBTs+Pr5MZp+3tLR83NbWltzf33+ruLj4s/r6+tSxsbHb0LyLfQLQR263+5LETE5O6jMzMzYytmxxcdE2Oztra29v1zTDMH4SakLx6OhIHRwcKPZUIBBQ/MzaB8ii7/P54qPS9Hg8WeJMsI91gDlweHhomXxjBmYCfOz3+1Nx1WFyaX5+PmV1dTV1ZWXlLjVP5fvDrq6uiwL4lA4qDv0jIyMm6Zs4BAEOQs2cmpoyAVIEujY3Nxeg2kRZsoXB1taWxSrMAN90AXwmHzs7OyYyUcjGcoKekm+hHKJuEHgf4Jjy8vL3Ghsbv29qaspobW19TP0zmpubHzscjliNv/8ogBTdhXkA8hK8QvC2rBlH/NQLqJvaXotaQ5fL9RaBNwH+gKAbYL9P1/+CTgbrWPZuAnSd+SplucCeRjZ6T0/PObG+vj7Lent77VVVVforf0Idny8vL9971RkN0QYGBnTqa5uYmLDm8fFxm+xHBlJ5hwySyDKeWt5C4In5+fkJZHYbyvHUNIHavim+6FP/P7bha6ydnJz8KnWkcz5pDhkqrmRQpMO2ETr7NBxIhjGcX8PvCk26QuevlpSUXIggk8lLCSJDY3t7W0FDoXyr42Qo5mddRRmm6ep3PBwoaNO689TVUgRnztOAVoZk6sfRFCPIBMTkLCA6pevfABBfVlZ2GZn80NnZ+RJ70dHR8aK7u/v3mpqar04D/hbOEJoKMEX3rWsYyjCAJh1k8ycPRjLnf7OeZB4SI4F/UcUfEUAyKwzdVS9ABrVxIx0PWRnsGZz72P8FWs8QddzQ0JADG+Vm9Q0PD/eOjo7+w/rnCCBdjEW8Kcx3CEykjt/y1wcAJgCWRIbJ2usOEerZQedKsLSz+9A7X11drcsDIXFnTLfb7RFQneKe48WQDL+g2A+h9AAJfTk9Pf2u+NAgS3/UTisoKNBKS0s1pKLxIFtzTk5ORFOWY2VlZQw0T4LBoJLGyAMhA4DS0E9ttbW10Snn5uaGlzoFv0fQo7q6ujRuRBrzI16QG3KINLTMzMyoeP8B6PjYxiD3rI0AAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="流程图"
        title="流程图"
        src="/blog/static/b65e46de39a67256740c7fd77f31e2a2/49211/1476065346000.png"
        srcset="/blog/static/b65e46de39a67256740c7fd77f31e2a2/e1650/1476065346000.png 210w,
/blog/static/b65e46de39a67256740c7fd77f31e2a2/8cae7/1476065346000.png 420w,
/blog/static/b65e46de39a67256740c7fd77f31e2a2/49211/1476065346000.png 472w"
        sizes="(max-width: 472px) 100vw, 472px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span>
    <figcaption class="gatsby-resp-image-figcaption">流程图</figcaption>
  </figure></p>
<p><strong>说明点:</strong></p>
<ul>
<li>当 freshness 检查失败，则发送资源请求并携带 ETage 和 Last-Modified 信息</li>
<li>ETag 和 Last-Modified 都会发送给服务器不分前后</li>
<li>Etag 用于动态内容会比 Last-Modified 好</li>
</ul>
<h3 id="参考文章" style="position:relative;"><a href="#%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0" aria-label="参考文章 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>参考文章</h3>
<ul>
<li><a href="http://www.cnblogs.com/liuling/archive/2013/07/25/2013-7-25-01.html" target="_target" rel="nofollow">页面的缓存与不缓存设置</a></li>
<li><a href="http://div.io/topic/854#4091" target="_target" rel="nofollow">配置错误产生的差距：200 OK (FROM CACHE) 与 304 NOT MODIFIED</a></li>
<li><a href="http://www.cnblogs.com/cuixiping/archive/2008/05/04/1181056.html" target="_target" rel="nofollow">“Cache-control”常见的取值</a></li>
<li><a href="http://kinglyhum.iteye.com/blog/827807" target="_target" rel="nofollow">Meta http-equiv 属性详解</a></li>
<li><a href="https://my.oschina.net/leejun2005/blog/369148" target="_target" rel="nofollow">浏览器 HTTP 协议缓存机制详解</a></li>
</ul>]]></description><link>https://xiangst0816.github.io/blog/ye-mian-huan-cun-she-zhi/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/ye-mian-huan-cun-she-zhi/</guid><category><![CDATA[缓存]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Sat, 22 Oct 2016 10:08:49 GMT</pubDate></item><item><title><![CDATA[图片压缩及方向修正]]></title><description><![CDATA[<h3 id="先描述下问题" style="position:relative;"><a href="#%E5%85%88%E6%8F%8F%E8%BF%B0%E4%B8%8B%E9%97%AE%E9%A2%98" aria-label="先描述下问题 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>先描述下问题</h3>
<p>Webapp 在上传图片的时候，会出现旋转 90° 的问题，但是在上传前预览图片是没问题的。这是因为什么呢？</p>
<p>原因在这边博客中说的很清楚了，<a href="https://github.com/xiangpaopao/blog/issues/7" target="_target" rel="nofollow">查看这里：移动端 Web 上传图片实践</a>。也就是说，对于 IOS 或者上传数码相机拍摄的图片时，为了保证快读读写所以就没对图片进行方向矫正，而是使用一个字段 Orientation 保存方向。故对这种情况需要进行图片方向的纠正。</p>
<p>这种问题的修复有两种：</p>
<ul>
<li>第一种方法是<strong>后台修正</strong>，<a href="http://www.graphicsmagick.org/" target="_target" rel="nofollow">插件 GraphicsMagick</a>提供的 API 比较友好，在控制台输入<code class="language-text">npm install gm</code>进行安装，简单实用如下：</li>
</ul>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">gm(&#39;/path/to/img.jpg&#39;)
.autoOrient()
.resize(240, 240)
.write(&#39;/path/to/new.jpg&#39;, function (err) {
  if (err) ...
})</code></pre></div>
<ul>
<li>第二种方法是<strong>前台修正</strong>，可是使用<a href="https://github.com/gokercebeci/canvasResize" target="_target" rel="nofollow">canvasResize 插件</a>，我比较倾向于实用第二种，因为将计算量分布到各个终端，减轻服务器压力。</li>
</ul>
<p>主要代码如下：</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">var file = input.files[0];
canvasResize(file, {
        width: 300,//如果宽度没到300px则不会进行方法处理
        height: 0,//自适应
        crop: false,
        quality: 100,//图片质量，default 80.
        rotate   : 90,      // Image rotation default 0,如果自动处理则不设置
        callback: function(data, width, height) {
            var blob = canvasResize(&#39;dataURLtoBlob&#39;, data);
            var form = new FormData();
            form.append(&#39;file&#39;,blob);
            $.ajax({
                type: &#39;POST&#39;,
                url: server,
                data: form,
                contentType: false,
                processData: false,
            }).done(function (res) {
                ......
            }).fail(function () {
                ......
            }).always(function () {
                ......
            });
        }
});</code></pre></div>
<p>你现在看到的这个博客的所有图片就是采用前台处理的方式进行图片方向矫正及尺寸压缩。<strong>因为使用的 ES6 语法及 VUE 框架，具体代码书写请参我的博客项目</strong>：</p>
<ul>
<li>文件<a href="https://github.com/xiangsongtao/X-SONGTAO-VUE/blob/master/src/api/api_upload.js" target="_target" rel="nofollow">api_upload.js</a> 处理上传的公共服务，其中 EXIF.js 和 canvasResize.js 我做了些模块化修改，请移步具体文件。</li>
<li><a href="https://github.com/xiangsongtao/X-SONGTAO-VUE/blob/master/src/views/admin.article.vue" target="_target" rel="nofollow">HTML 及*.vue 中的使用方法</a>，摘抄如下：</li>
</ul>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">&lt;form action=&quot;&quot; class=&quot;imgUploadForm&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;
        &lt;input id=&quot;imgUpload&quot; type=&quot;file&quot;&gt;
&lt;/form&gt;</code></pre></div>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">/**
 * 1. 选择图片,获得filer信息
 * */
$(&quot;#imgUpload&quot;).change(function (e) {
    // 文件句柄
    var file = e.target.files[0];
    // 只处理图片
    if (!file.type.match(&#39;image.*&#39;)) {
        return null;
    }
    scope.isImgLoading = true;
    ImageUpload(file).then(function (imageName) {
        scope.uploadImgUrl = addImgPrefix(imageName);
    }, function () {
        alert(&quot;upload error&quot;);
    }).then(function () {
        scope.isImgLoading = false;
    })
})</code></pre></div>
<h3 id="介绍下方法二的思路" style="position:relative;"><a href="#%E4%BB%8B%E7%BB%8D%E4%B8%8B%E6%96%B9%E6%B3%95%E4%BA%8C%E7%9A%84%E6%80%9D%E8%B7%AF" aria-label="介绍下方法二的思路 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>介绍下方法二的思路</h3>
<ol>
<li>监听 input 的 onChange 事件，获取文件句柄（file）</li>
<li>传入 file，使用 canvasResize 进行图片尺寸及方向校准，回调得到 base64 编码的图片信息（data）</li>
<li>将图片改为二进制文件 blob, 准备上传（form）</li>
<li>将得到的 form 进行上传</li>
</ol>
<p>注：上传到后台的文件需要重命名，因为在转成 blob 时，已不是原来文件了。后台相关处理文件<a href="https://github.com/xiangsongtao/X-SONGTAO/blob/master/app/routes/api.routes.js" target="_target" rel="nofollow">请转到这里</a>，Line:84。</p>
<h3 id="最终效果展示" style="position:relative;"><a href="#%E6%9C%80%E7%BB%88%E6%95%88%E6%9E%9C%E5%B1%95%E7%A4%BA" aria-label="最终效果展示 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>最终效果展示</h3>
<blockquote>
<p>效果还是很明显的，上传速度和未处理基本一样，没感觉。</p>
</blockquote>
<h4 id="从-iphone-拍摄后未处理的图片手机上看竖着的，pc-上看是横着的" style="position:relative;"><a href="#%E4%BB%8E-iphone-%E6%8B%8D%E6%91%84%E5%90%8E%E6%9C%AA%E5%A4%84%E7%90%86%E7%9A%84%E5%9B%BE%E7%89%87%E6%89%8B%E6%9C%BA%E4%B8%8A%E7%9C%8B%E7%AB%96%E7%9D%80%E7%9A%84%EF%BC%8Cpc-%E4%B8%8A%E7%9C%8B%E6%98%AF%E6%A8%AA%E7%9D%80%E7%9A%84" aria-label="从 iphone 拍摄后未处理的图片手机上看竖着的，pc 上看是横着的 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>从 iphone 拍摄后未处理的图片(手机上看竖着的，pc 上看是横着的)</h4>
<ul>
<li>尺寸：3264*2448</li>
<li>大小 ：1.2MB</li>
</ul>
<p><img src="http://xiangsongtao.com/uploads/1471425020000.jpg" alt="demo" title="未处理"></p>
<hr>
<h4 id="上传前处理后的图片" style="position:relative;"><a href="#%E4%B8%8A%E4%BC%A0%E5%89%8D%E5%A4%84%E7%90%86%E5%90%8E%E7%9A%84%E5%9B%BE%E7%89%87" aria-label="上传前处理后的图片 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>上传前处理后的图片</h4>
<ul>
<li>尺寸：710*946</li>
<li>大小 ：68KB</li>
</ul>
<p><img src="http://xiangsongtao.com/uploads/1471528805000.jpeg" title="已处理"></p>
<h3 id="最后" style="position:relative;"><a href="#%E6%9C%80%E5%90%8E" aria-label="最后 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>最后</h3>
<blockquote>
<p>希望如果有不明白的，请在下方评论或者在 github 提 issue，<a href="https://github.com/xiangsongtao/X-SONGTAO-VUE" target="_target" rel="nofollow">我的博客项目</a>因为还有些小功能未实现，将会一直维护下去，技术问题希望能共同探讨。</p>
</blockquote>
<h4 id="参考" style="position:relative;"><a href="#%E5%8F%82%E8%80%83" aria-label="参考 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>参考</h4>
<ul>
<li><a href="https://github.com/xiangpaopao/blog/issues/7" target="_target" rel="nofollow">移动端 Web 上传图片实践 </a></li>
<li><a href="http://www.graphicsmagick.org/" target="_target" rel="nofollow">GraphicsMagick</a></li>
<li><a href="https://github.com/gokercebeci/canvasResize" target="_target" rel="nofollow">canvasResize</a></li>
</ul>]]></description><link>https://xiangst0816.github.io/blog/tu-pian-ya-suo-su-ji-fang-xiang-xiu-zheng/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/tu-pian-ya-suo-su-ji-fang-xiang-xiu-zheng/</guid><category><![CDATA[图片压缩]]></category><category><![CDATA[图片修正]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Thu, 20 Oct 2016 14:12:12 GMT</pubDate></item><item><title><![CDATA[正则简单总结]]></title><description><![CDATA[<p>记得很早之前就对正则进行了简单的学习，我自己在下面也总结了很多次，但是一到用的时候就懵逼了。看来还是实践较少的结果。今天特此花时间在总结下，并且附上常用的正则示例。</p>
<h2 id="思维导图：" style="position:relative;"><a href="#%E6%80%9D%E7%BB%B4%E5%AF%BC%E5%9B%BE%EF%BC%9A" aria-label="思维导图： permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>思维导图：</h2>
<p><img src="http://xiangsongtao.com/uploads/1474687442000.png" alt="正则" title="正则"></p>
<h2 id="常用示例：" style="position:relative;"><a href="#%E5%B8%B8%E7%94%A8%E7%A4%BA%E4%BE%8B%EF%BC%9A" aria-label="常用示例： permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>常用示例：</h2>
<h3 id="去除首位空格（单独去除左右空格类似）：" style="position:relative;"><a href="#%E5%8E%BB%E9%99%A4%E9%A6%96%E4%BD%8D%E7%A9%BA%E6%A0%BC%EF%BC%88%E5%8D%95%E7%8B%AC%E5%8E%BB%E9%99%A4%E5%B7%A6%E5%8F%B3%E7%A9%BA%E6%A0%BC%E7%B1%BB%E4%BC%BC%EF%BC%89%EF%BC%9A" aria-label="去除首位空格（单独去除左右空格类似）： permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>去除首位空格（单独去除左右空格类似）：</h3>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">&quot;   ac f    &quot;.replace(/(^\s*)|(\s*$)/g,&#39;&#39;)</code></pre></div>
<h3 id="v-err-src转化为驼峰名字verrsrc：" style="position:relative;"><a href="#v-err-src%E8%BD%AC%E5%8C%96%E4%B8%BA%E9%A9%BC%E5%B3%B0%E5%90%8D%E5%AD%97verrsrc%EF%BC%9A" aria-label="v err src转化为驼峰名字verrsrc： permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>“v-err-src”转化为驼峰名字”vErrSrc”：</h3>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">&#39;v-err-src&#39;.replace(/-(\w)/ig,function(x){
   return x.slice(1).toUpperCase()
})</code></pre></div>
<h3 id="xxx-xxxx-xxxxx-前三位数字开头，中间四位字母开头数字结尾，后-5-位随意：" style="position:relative;"><a href="#xxx-xxxx-xxxxx-%E5%89%8D%E4%B8%89%E4%BD%8D%E6%95%B0%E5%AD%97%E5%BC%80%E5%A4%B4%EF%BC%8C%E4%B8%AD%E9%97%B4%E5%9B%9B%E4%BD%8D%E5%AD%97%E6%AF%8D%E5%BC%80%E5%A4%B4%E6%95%B0%E5%AD%97%E7%BB%93%E5%B0%BE%EF%BC%8C%E5%90%8E-5-%E4%BD%8D%E9%9A%8F%E6%84%8F%EF%BC%9A" aria-label="xxx xxxx xxxxx 前三位数字开头，中间四位字母开头数字结尾，后 5 位随意： permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>xxx-xxxx-xxxxx, 前三位数字开头，中间四位字母开头数字结尾，后 5 位随意：</h3>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">/^\d\w{2}-[a-zA-Z]\d{3}-.{5}$/.test(&#39;1as-a234-wwwww&#39;)</code></pre></div>
<h3 id="邮箱验证：" style="position:relative;"><a href="#%E9%82%AE%E7%AE%B1%E9%AA%8C%E8%AF%81%EF%BC%9A" aria-label="邮箱验证： permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>邮箱验证：</h3>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">/^\w+@[1-9a-z]+(\.[a-z]+){1,3}$/.test(&quot;xxxx@16.cn.net&quot;)</code></pre></div>
<h3 id="中文范围：" style="position:relative;"><a href="#%E4%B8%AD%E6%96%87%E8%8C%83%E5%9B%B4%EF%BC%9A" aria-label="中文范围： permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>中文范围：</h3>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">匹配中文：[\u4e00-\u9fa5] //中文ACALL码的范围</code></pre></div>
<p>以上就差不多这些了！</p>]]></description><link>https://xiangst0816.github.io/blog/zheng-ze-jian-dan-shan-chan-zong-jie/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/zheng-ze-jian-dan-shan-chan-zong-jie/</guid><category><![CDATA[正则]]></category><category><![CDATA[JavaScript]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Thu, 20 Oct 2016 14:11:42 GMT</pubDate></item><item><title><![CDATA[JS深浅拷贝相关]]></title><description><![CDATA[<h2 id="先说下基础类型和引用类型" style="position:relative;"><a href="#%E5%85%88%E8%AF%B4%E4%B8%8B%E5%9F%BA%E7%A1%80%E7%B1%BB%E5%9E%8B%E5%92%8C%E5%BC%95%E7%94%A8%E7%B1%BB%E5%9E%8B" aria-label="先说下基础类型和引用类型 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>先说下基础类型和引用类型</h2>
<p>在写代码的时候翻看源码无意中看到了对象的深浅复制的代码，估计以后也会用的上，虽然徒手从零开始写有些困难，但是使用的时候能快速拿出来也是好的。下面是对深浅复制的总结笔记！</p>
<p><img src="http://xiangsongtao.com/uploads/1474693606000.png" alt="分类"></p>
<p>在 JS 中有一些基本类型像是<code class="language-text">Number</code>、<code class="language-text">String</code>、<code class="language-text">Boolean</code>，而对象就是像这样的东西<code class="language-text">{ name: &#39;Larry&#39;, skill: &#39;Node.js&#39; }</code>，对象跟基本类型最大的不同就在于他们的传值方式。</p>
<p>基本类型是传 value，像是这样：</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> a<span class="token punctuation">;</span>
b <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//10</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//20</span></code></pre></div>
<p>在修改<code class="language-text">a</code>时并不会改到<code class="language-text">b</code></p>
<p>但对象就不同，对象传的是 reference：</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> obj1 <span class="token operator">=</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">30</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> obj2 <span class="token operator">=</span> obj1<span class="token punctuation">;</span>
obj2<span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// { a: 10, b: 100, c: 30 } &lt;-- b 被改到了</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// { a: 10, b: 100, c: 30 }</span></code></pre></div>
<p>复制一份<code class="language-text">obj1</code>叫做<code class="language-text">obj2</code>，然后把<code class="language-text">obj2.b</code>改成 100，但却不小心改到<code class="language-text">obj1.b</code>，因为他们根本是同一个对象，这就是所谓的<strong>浅拷贝</strong>。</p>
<p>要避免这样的错误发生就要写成这样：</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> obj1 <span class="token operator">=</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">30</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> obj2 <span class="token operator">=</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> obj1<span class="token punctuation">.</span>a<span class="token punctuation">,</span> b<span class="token operator">:</span> obj1<span class="token punctuation">.</span>b<span class="token punctuation">,</span> c<span class="token operator">:</span> obj1<span class="token punctuation">.</span>c <span class="token punctuation">}</span><span class="token punctuation">;</span>
obj2<span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// { a: 10, b: 20, c: 30 } &lt;-- b 沒被改到</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// { a: 10, b: 100, c: 30 }</span></code></pre></div>
<h2 id="浅拷贝shallow-copy-vs-深拷贝deep-copy" style="position:relative;"><a href="#%E6%B5%85%E6%8B%B7%E8%B4%9Dshallow-copy-vs-%E6%B7%B1%E6%8B%B7%E8%B4%9Ddeep-copy" aria-label="浅拷贝shallow copy vs 深拷贝deep copy permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>浅拷贝(Shallow Copy) VS 深拷贝(Deep Copy)</h2>
<p>浅拷贝只复制指向某个对象的<strong>指针</strong>，而不复制对象本身，新旧对象还是共享同一块内存。但深拷贝会另外创造<strong>一个一模一样的对象</strong>，新对象跟原对象不共享内存，修改新对象不会改到原对象。</p>
<h2 id="objectassign-es6-的新函数" style="position:relative;"><a href="#objectassign-es6-%E7%9A%84%E6%96%B0%E5%87%BD%E6%95%B0" aria-label="objectassign es6 的新函数 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Object.assign ES6 的新函数</h2>
<p>用法如下：</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> obj1 <span class="token operator">=</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span> b<span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span> c<span class="token operator">:</span> <span class="token number">30</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> obj2 <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> obj1<span class="token punctuation">)</span><span class="token punctuation">;</span>
obj2<span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// { a: 10, b: 20, c: 30 } &lt;-- 沒被改到</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// { a: 10, b: 100, c: 30 }</span></code></pre></div>
<p>但是，只能处理深度只有一层的对象，没办法做到真正的 Deep Copy。不过如果要复制的对象只有一层的话可以考虑使用它。</p>
<h2 id="处理单纯的数据对象时不能处理有函数的情况" style="position:relative;"><a href="#%E5%A4%84%E7%90%86%E5%8D%95%E7%BA%AF%E7%9A%84%E6%95%B0%E6%8D%AE%E5%AF%B9%E8%B1%A1%E6%97%B6%E4%B8%8D%E8%83%BD%E5%A4%84%E7%90%86%E6%9C%89%E5%87%BD%E6%95%B0%E7%9A%84%E6%83%85%E5%86%B5" aria-label="处理单纯的数据对象时不能处理有函数的情况 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>处理单纯的数据对象时(不能处理有函数的情况)</h2>
<p>用<code class="language-text">JSON.stringify</code>把对象转成字符串，再用<code class="language-text">JSON.parse</code>把字符串转成新的对象。</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> obj1 <span class="token operator">=</span> <span class="token punctuation">{</span> body<span class="token operator">:</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> obj2 <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>obj1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
obj2<span class="token punctuation">.</span>body<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// { body: { a: 10 } } &lt;-- 沒被改到</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// { body: { a: 20 } }</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj1 <span class="token operator">===</span> obj2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// false</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj1<span class="token punctuation">.</span>body <span class="token operator">===</span> obj2<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// false</span></code></pre></div>
<h2 id="库函数实现-deep-copy" style="position:relative;"><a href="#%E5%BA%93%E5%87%BD%E6%95%B0%E5%AE%9E%E7%8E%B0-deep-copy" aria-label="库函数实现 deep copy permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>库函数实现 Deep Copy</h2>
<h3 id="jquery" style="position:relative;"><a href="#jquery" aria-label="jquery permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>jquery</h3>
<p>jquery 中提供的一个函数<code class="language-text">$.extend</code>可以用来做 Deep Copy。</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> $ <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"jquery"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> obj1 <span class="token operator">=</span> <span class="token punctuation">{</span>
  a<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  b<span class="token operator">:</span> <span class="token punctuation">{</span> f<span class="token operator">:</span> <span class="token punctuation">{</span> g<span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  c<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> obj2 <span class="token operator">=</span> $<span class="token punctuation">.</span><span class="token function">extend</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> obj1<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj1<span class="token punctuation">.</span>b<span class="token punctuation">.</span>f <span class="token operator">===</span> obj2<span class="token punctuation">.</span>b<span class="token punctuation">.</span>f<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// false</span></code></pre></div>
<h3 id="lodash" style="position:relative;"><a href="#lodash" aria-label="lodash permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>lodash</h3>
<p>lodash 提供<code class="language-text">_.cloneDeep</code>用来做 Deep Copy。</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> _ <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"lodash"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> obj1 <span class="token operator">=</span> <span class="token punctuation">{</span>
  a<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  b<span class="token operator">:</span> <span class="token punctuation">{</span> f<span class="token operator">:</span> <span class="token punctuation">{</span> g<span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  c<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> obj2 <span class="token operator">=</span> _<span class="token punctuation">.</span><span class="token function">cloneDeep</span><span class="token punctuation">(</span>obj1<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj1<span class="token punctuation">.</span>b<span class="token punctuation">.</span>f <span class="token operator">===</span> obj2<span class="token punctuation">.</span>b<span class="token punctuation">.</span>f<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// false</span></code></pre></div>
<h2 id="哥哥给你手写一个" style="position:relative;"><a href="#%E5%93%A5%E5%93%A5%E7%BB%99%E4%BD%A0%E6%89%8B%E5%86%99%E4%B8%80%E4%B8%AA" aria-label="哥哥给你手写一个 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>哥哥给你手写一个</h2>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">var</span> obj1 <span class="token operator">=</span> <span class="token punctuation">{</span>
  a<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  b<span class="token operator">:</span> <span class="token punctuation">{</span> f<span class="token operator">:</span> <span class="token punctuation">{</span> g<span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  c<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> obj2 <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token function">_merge</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">,</span> obj2<span class="token punctuation">,</span> obj1<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj2<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">_merge</span><span class="token punctuation">(</span><span class="token parameter">deep<span class="token punctuation">,</span> target<span class="token punctuation">,</span> source</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> key <span class="token keyword">in</span> source<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>deep <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token function">isPlainObject</span><span class="token punctuation">(</span>source<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token function">isArray</span><span class="token punctuation">(</span>source<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isPlainObject</span><span class="token punctuation">(</span>source<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token function">isPlainObject</span><span class="token punctuation">(</span>target<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        target<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isArray</span><span class="token punctuation">(</span>source<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token function">isArray</span><span class="token punctuation">(</span>target<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        target<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token function">_merge</span><span class="token punctuation">(</span>deep<span class="token punctuation">,</span> target<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span> source<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>source<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      target<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> source<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">isPlainObject</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">isObject</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> Object<span class="token punctuation">.</span><span class="token function">getPrototypeOf</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">isObject</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> obj <span class="token operator">!==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> obj <span class="token operator">===</span> <span class="token string">"object"</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">isArray</span><span class="token punctuation">(</span><span class="token parameter">arr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<blockquote>
<p>以上就是全部了，也不算难，多注意多留心就好。</p>
</blockquote>]]></description><link>https://xiangst0816.github.io/blog/JS-shen-qian-jian-kao-bei-xiang-guan/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/JS-shen-qian-jian-kao-bei-xiang-guan/</guid><category><![CDATA[JavaScript]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Thu, 20 Oct 2016 14:11:22 GMT</pubDate></item><item><title><![CDATA[JS类型判断]]></title><description><![CDATA[<h2 id="常用的类型判断-typeof" style="position:relative;"><a href="#%E5%B8%B8%E7%94%A8%E7%9A%84%E7%B1%BB%E5%9E%8B%E5%88%A4%E6%96%AD-typeof" aria-label="常用的类型判断 typeof permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>常用的类型判断 typeof</h2>
<p>在进行类型判断时，第一反应是使用 typeof 来做，写法：</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">function type(value){
    return typeof value
}

console.log(type (&#39;str&#39;))
output  &#39;string&#39;</code></pre></div>
<p>但是这个方法可返回的类型只有以下几种（注意都是小写）：</p>
<p><code class="language-text">object</code>(对象,数组,日期和 null)、 <code class="language-text">string</code>、<code class="language-text">number</code>、<code class="language-text">function</code>、<code class="language-text">undefined</code>、<code class="language-text">boolean</code></p>
<blockquote>
<p>需要特别注意的是，使用 typeof 判断未定义的变量不会抛出异常<code class="language-text">Uncaught ReferenceError: xxx is not defined</code>，但是其余方法都会！</p>
</blockquote>
<h2 id="instanceof-判断" style="position:relative;"><a href="#instanceof-%E5%88%A4%E6%96%AD" aria-label="instanceof 判断 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>instanceof 判断</h2>
<p>instanceof 用于判断一个变量是否某个对象的实例，是一个三目运算式</p>
<p>这里的 instanceof 测试的 object 是指 js 语法中的 object，不是指 dom 模型对象</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">//之后就是对array、object、Date进行区分了
({}) instanceof Object
-&gt; true

([]) instanceof Array
-&gt; true

(new Date()) instanceof Date
-&gt; true

(function(){}) instanceof Function
-&gt; true

//Null String Number Boolean 判断都是不行的。</code></pre></div>
<h2 id="constructor-判断" style="position:relative;"><a href="#constructor-%E5%88%A4%E6%96%AD" aria-label="constructor 判断 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>constructor 判断</h2>
<p>constructor 属性返回对象相对应的构造函数，基础类型会临时包裹为对象！</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">({}).constructor === Object
-&gt; true

([]).constructor === Array
-&gt; true

(new Date()).constructor === Date
-&gt; true

(&#39;str&#39;).constructor === String
-&gt; true

(123).constructor === Number
-&gt; true

(true).constructor === Boolean
-&gt; true

(function(){}).constructor === Function
-&gt; true

//undefined、 Null 判断都是不行的。</code></pre></div>
<h2 id="类型判断全家福" style="position:relative;"><a href="#%E7%B1%BB%E5%9E%8B%E5%88%A4%E6%96%AD%E5%85%A8%E5%AE%B6%E7%A6%8F" aria-label="类型判断全家福 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>类型判断全家福</h2>
<p>这部分摘自<code class="language-text">vue-resource</code>源码</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">function isDefined(value) {
    return value !== undefined &amp;&amp; value !== null;
}
var isArray = Array.isArray;

function isString(val) {
    return typeof val === &#39;string&#39;;
}

function isBoolean(val) {
    return val === true || val === false;
}

function isFunction(val) {
    return typeof val === &#39;function&#39;;
}

// data、object、array
function isObject(obj) {
    return obj !== null &amp;&amp; typeof obj === &#39;object&#39;;
}

// 纯对象 object
function isPlainObject(obj) {
    return isObject(obj) &amp;&amp; Object.getPrototypeOf(obj) == Object.prototype;
}

function isFormData(obj) {
    return typeof FormData !== &#39;undefined&#39; &amp;&amp; obj instanceof FormData;
}</code></pre></div>
<h2 id="终极写法" style="position:relative;"><a href="#%E7%BB%88%E6%9E%81%E5%86%99%E6%B3%95" aria-label="终极写法 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>终极写法</h2>
<p>自己实现了 getType 函数支持各种类型的判断，包括：<code class="language-text">string</code>、 <code class="language-text">date</code>、 <code class="language-text">number</code>、 <code class="language-text">array</code>、 <code class="language-text">object</code>、 <code class="language-text">boolean</code>、 <code class="language-text">null</code>、 <code class="language-text">undefined</code>，判断后返回以上字符串。</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">function getType(value) {
    return Object.prototype.toString.call(value).match(/^(\[object )(\w+)\]$/i)[2].toLowerCase()
}

getType(&#39;str&#39;) === &#39;string&#39;;
getType(new Date()) === &#39;date&#39;;
getType(123) === &#39;number&#39;;
getType([]) === &#39;array&#39;;
getType({}) === &#39;object&#39;;
getType(true) === &#39;boolean&#39;;
getType(!!&quot;str&quot;) === &#39;boolean&#39;;
getType(null) === &#39;null&#39;;
getType(undefined) === &#39;undefined&#39;;
var str;
getType(str) === &#39;undefined&#39;;

//Output true</code></pre></div>
<p>（完）</p>]]></description><link>https://xiangst0816.github.io/blog/JS-lei-xing-pan-duan/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/JS-lei-xing-pan-duan/</guid><category><![CDATA[JavaScript]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Thu, 20 Oct 2016 14:10:43 GMT</pubDate></item><item><title><![CDATA[25个面试题，值得再看一遍]]></title><description><![CDATA[<p>无意在网上看到的，特此记录。<a href="http://www.jb51.net/article/77140.htm" target="_target" rel="nofollow">原文在此</a></p>
<h4 id="1、使用-typeof-bar--object-判断-bar-是不是一个对象有神马潜在的弊端？如何避免这种弊端？" style="position:relative;"><a href="#1%E3%80%81%E4%BD%BF%E7%94%A8-typeof-bar--object-%E5%88%A4%E6%96%AD-bar-%E6%98%AF%E4%B8%8D%E6%98%AF%E4%B8%80%E4%B8%AA%E5%AF%B9%E8%B1%A1%E6%9C%89%E7%A5%9E%E9%A9%AC%E6%BD%9C%E5%9C%A8%E7%9A%84%E5%BC%8A%E7%AB%AF%EF%BC%9F%E5%A6%82%E4%BD%95%E9%81%BF%E5%85%8D%E8%BF%99%E7%A7%8D%E5%BC%8A%E7%AB%AF%EF%BC%9F" aria-label="1、使用 typeof bar  object 判断 bar 是不是一个对象有神马潜在的弊端？如何避免这种弊端？ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1、使用 typeof bar === “object” 判断 bar 是不是一个对象有神马潜在的弊端？如何避免这种弊端？</h4>
<p>使用 typeof 的弊端是显而易见的(这种弊端同使用 instanceof)：</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">let obj = {};
let arr = [];

console.log(typeof obj === &#39;object&#39;); //true
console.log(typeof arr === &#39;object&#39;); //true
console.log(typeof null === &#39;object&#39;); //true</code></pre></div>
<p>从上面的输出结果可知，typeof bar === “object” 并不能准确判断 bar 就是一个 Object。可以通过 Object.prototype.toString.call(bar) === ”[object Object]” 来避免这种弊端：</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">let obj = {};
let arr = [];

console.log(Object.prototype.toString.call(obj)); //[object Object]
console.log(Object.prototype.toString.call(arr)); //[object Array]
console.log(Object.prototype.toString.call(null)); //[object Null]</code></pre></div>
<h4 id="2、变量作用域相关，下面的代码会在-console-输出神马？为什么？" style="position:relative;"><a href="#2%E3%80%81%E5%8F%98%E9%87%8F%E4%BD%9C%E7%94%A8%E5%9F%9F%E7%9B%B8%E5%85%B3%EF%BC%8C%E4%B8%8B%E9%9D%A2%E7%9A%84%E4%BB%A3%E7%A0%81%E4%BC%9A%E5%9C%A8-console-%E8%BE%93%E5%87%BA%E7%A5%9E%E9%A9%AC%EF%BC%9F%E4%B8%BA%E4%BB%80%E4%B9%88%EF%BC%9F" aria-label="2、变量作用域相关，下面的代码会在 console 输出神马？为什么？ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2、变量作用域相关，下面的代码会在 console 输出神马？为什么？</h4>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">(function(){
 var a = b = 3;
})();

console.log(&quot;a defined? &quot; + (typeof a !== &#39;undefined&#39;));
console.log(&quot;b defined? &quot; + (typeof b !== &#39;undefined&#39;));</code></pre></div>
<p>这跟变量作用域有关，输出换成下面的：</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">console.log(b); //3
console.log(typeof a); //undefined</code></pre></div>
<p>拆解一下自执行函数中的变量赋值：</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">b = 3;
var a = b;</code></pre></div>
<p>所以 b 成了全局变量，而 a 是自执行函数的一个局部变量。</p>
<h4 id="3、this-相关，下面的代码会在-console-输出神马？为什么？" style="position:relative;"><a href="#3%E3%80%81this-%E7%9B%B8%E5%85%B3%EF%BC%8C%E4%B8%8B%E9%9D%A2%E7%9A%84%E4%BB%A3%E7%A0%81%E4%BC%9A%E5%9C%A8-console-%E8%BE%93%E5%87%BA%E7%A5%9E%E9%A9%AC%EF%BC%9F%E4%B8%BA%E4%BB%80%E4%B9%88%EF%BC%9F" aria-label="3、this 相关，下面的代码会在 console 输出神马？为什么？ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3、this 相关，下面的代码会在 console 输出神马？为什么？</h4>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">var myObject = {
 foo: &quot;bar&quot;,
 func: function() {
 var self = this;
 console.log(&quot;outer func: this.foo = &quot; + this.foo);
 console.log(&quot;outer func: self.foo = &quot; + self.foo);
 (function() {
 console.log(&quot;inner func: this.foo = &quot; + this.foo);
 console.log(&quot;inner func: self.foo = &quot; + self.foo);
 }());
 }
};
myObject.func();</code></pre></div>
<p>第一个和第二个的输出不难判断，在 ES6 之前，JavaScript 只有函数作用域，所以 func 中的 IIFE 有自己的独立作用域，并且它能访问到外部作用域中的 self，所以第三个输出会报错，因为 this 在可访问到的作用域内是 undefined，第四个输出是 bar。如果你知道闭包，也很容易解决的：</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">(function(test) {
 console.log(&quot;inner func: this.foo = &quot; + test.foo); //&#39;bar&#39;
 console.log(&quot;inner func: self.foo = &quot; + self.foo);
}(self));</code></pre></div>
<h4 id="4、为什么要用立即执行函数表达式（immediately-invoked-function-expression）" style="position:relative;"><a href="#4%E3%80%81%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E7%94%A8%E7%AB%8B%E5%8D%B3%E6%89%A7%E8%A1%8C%E5%87%BD%E6%95%B0%E8%A1%A8%E8%BE%BE%E5%BC%8F%EF%BC%88immediately-invoked-function-expression%EF%BC%89" aria-label="4、为什么要用立即执行函数表达式（immediately invoked function expression） permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4、为什么要用立即执行函数表达式（Immediately-Invoked Function Expression）</h4>
<p>IIFE 有两个比较经典的使用场景，一是类似于在循环中定时输出数据项，二是类似于 JQuery/Node 的插件和模块开发。</p>
<p><strong>主要是为了隔离上下文环境！</strong></p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">for(var i = 0; i &lt; 5; i++) {
 setTimeout(function() {
 console.log(i);
 }, 1000);
}</code></pre></div>
<p>上面的输出并不是你以为的 0，1，2，3，4，而输出的全部是 5，这时 IIFE 就能有用了：</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">for(var i = 0; i &lt; 5; i++) {
 (function(i) {
 setTimeout(function() {
 console.log(i);
 }, 1000);
 })(i)
}</code></pre></div>
<p>而在 JQuery/Node 的插件和模块开发中，为避免变量污染，也是一个大大的 IIFE：</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">(function($) {
 //代码
 })(jQuery);</code></pre></div>
<h4 id="5、在严格模式use-strict下进行-javascript-开发有神马好处？" style="position:relative;"><a href="#5%E3%80%81%E5%9C%A8%E4%B8%A5%E6%A0%BC%E6%A8%A1%E5%BC%8Fuse-strict%E4%B8%8B%E8%BF%9B%E8%A1%8C-javascript-%E5%BC%80%E5%8F%91%E6%9C%89%E7%A5%9E%E9%A9%AC%E5%A5%BD%E5%A4%84%EF%BC%9F" aria-label="5、在严格模式use strict下进行 javascript 开发有神马好处？ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>5、在严格模式(‘use strict’)下进行 JavaScript 开发有神马好处？</h4>
<p>消除 Javascript 语法的一些不合理、不严谨之处，减少一些怪异行为;</p>
<p>消除代码运行的一些不安全之处，保证代码运行的安全；</p>
<p>提高编译器效率，增加运行速度；</p>
<p>为未来新版本的 Javascript 做好铺垫。</p>
<h4 id="6、下面两个函数的返回值是一样的吗？为什么？" style="position:relative;"><a href="#6%E3%80%81%E4%B8%8B%E9%9D%A2%E4%B8%A4%E4%B8%AA%E5%87%BD%E6%95%B0%E7%9A%84%E8%BF%94%E5%9B%9E%E5%80%BC%E6%98%AF%E4%B8%80%E6%A0%B7%E7%9A%84%E5%90%97%EF%BC%9F%E4%B8%BA%E4%BB%80%E4%B9%88%EF%BC%9F" aria-label="6、下面两个函数的返回值是一样的吗？为什么？ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>6、下面两个函数的返回值是一样的吗？为什么？</h4>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">function foo1()
{
 return {
 bar: &quot;hello&quot;
 };
}

function foo2()
{
 return
 {
 bar: &quot;hello&quot;
 };
}</code></pre></div>
<p>在编程语言中，基本都是使用分号（;）将语句分隔开，这可以增加代码的可读性和整洁性。而在 JS 中，如若语句各占独立一行，通常可以省略语句间的分号（;），JS 解析器会根据能否正常编译来决定是否自动填充分号：</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">var test = 1 +
2
console.log(test); //3</code></pre></div>
<p>在上述情况下，为了正确解析代码，就不会自动填充分号了，但是对于<code class="language-text">return</code> 、<code class="language-text">break</code>、<code class="language-text">continue</code>等语句，如果后面紧跟换行，解析器一定会自动在后面填充分号(;)，所以上面的第二个函数就变成了这样：</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">function foo2()
{
 return;
 {
 bar: &quot;hello&quot;
 };
}</code></pre></div>
<p>所以第二个函数是返回 undefined。</p>
<h4 id="7、神马是-nan，它的类型是神马？怎么测试一个值是否等于-nan" style="position:relative;"><a href="#7%E3%80%81%E7%A5%9E%E9%A9%AC%E6%98%AF-nan%EF%BC%8C%E5%AE%83%E7%9A%84%E7%B1%BB%E5%9E%8B%E6%98%AF%E7%A5%9E%E9%A9%AC%EF%BC%9F%E6%80%8E%E4%B9%88%E6%B5%8B%E8%AF%95%E4%B8%80%E4%B8%AA%E5%80%BC%E6%98%AF%E5%90%A6%E7%AD%89%E4%BA%8E-nan" aria-label="7、神马是 nan，它的类型是神马？怎么测试一个值是否等于 nan permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>7、神马是 NaN，它的类型是神马？怎么测试一个值是否等于 NaN?</h4>
<p>NaN 是 Not a Number 的缩写，JavaScript 的一种特殊数值，其类型是<code class="language-text">Number</code>，可以通过 <code class="language-text">isNaN(param)</code>来判断一个值是否是 NaN：</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">console.log(isNaN(NaN)); //true
console.log(isNaN(23)); //false
console.log(isNaN(&#39;ds&#39;)); //true
console.log(isNaN(&#39;32131sdasd&#39;)); //true
console.log(NaN === NaN); //false
console.log(NaN === undefined); //false
console.log(undefined === undefined); //false
console.log(typeof NaN); //number
console.log(Object.prototype.toString.call(NaN)); //[object Number]
// NaN是Number类型下的</code></pre></div>
<p>ES6 中，isNaN() 成为了 Number 的静态方法：Number.isNaN().</p>
<h4 id="8、关于小数的精确计算" style="position:relative;"><a href="#8%E3%80%81%E5%85%B3%E4%BA%8E%E5%B0%8F%E6%95%B0%E7%9A%84%E7%B2%BE%E7%A1%AE%E8%AE%A1%E7%AE%97" aria-label="8、关于小数的精确计算 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>8、关于小数的精确计算</h4>
<p>解释一下下面代码的输出</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">console.log(0.1 + 0.2); //0.30000000000000004
console.log(0.1 + 0.2 == 0.3); //false</code></pre></div>
<p>JavaScript 中的 number 类型就是浮点型，JavaScript 中的浮点数采用 IEEE-754 格式的规定，这是一种二进制表示法，可以精确地表示分数，比如 1/2，1/8，1/1024，每个浮点数占 64 位。但是，二进制浮点数表示法并不能精确的表示类似 0.1 这样 的简单的数字，会有舍入误差。</p>
<p>由于采用二进制，JavaScript 也不能有限表示 1/10、1/2 等这样的分数。在二进制中，1/10(0.1)被表示为 0.00110011001100110011…… 注意 0011 是无限重复的，这是舍入误差造成的，所以对于 0.1 + 0.2 这样的运算，操作数会先被转成二进制，然后再计算：</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">0.1 =&gt; 0.0001 1001 1001 1001…（无限循环）
0.2 =&gt; 0.0011 0011 0011 0011…（无限循环）</code></pre></div>
<p>双精度浮点数的小数部分最多支持 52 位，所以两者相加之后得到这么一串 0.0100110011001100110011001100110011001100…因浮点数小数位的限制而截断的二进制数字，这时候，再把它转换为十进制，就成了 0.30000000000000004。</p>
<p>对于保证浮点数计算的正确性，有两种常见方式。</p>
<p><strong>一是先升幂再降幂(转化为整数再计算)：</strong></p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">function add(num1, num2){
 let r1, r2, m;
 r1 = (&#39;&#39;+num1).split(&#39;.&#39;)[1].length;
 r2 = (&#39;&#39;+num2).split(&#39;.&#39;)[1].length;//计算小数位数

 m = Math.pow(10,Math.max(r1,r2));
 return (num1 * m + num2 * m) / m;
}
console.log(add(0.1,0.2)); //0.3
console.log(add(0.15,0.2256)); //0.3756</code></pre></div>
<p><strong>二是是使用内置的 toPrecision() 和 toFixed() 方法，注意，方法的返回值字符串。（然并卵）</strong></p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">function add(x, y) {
 return x.toPrecision() + y.toPrecision()
}
console.log(add(0.1,0.2)); //&quot;0.10.2&quot;</code></pre></div>
<h4 id="9、实现函数-isintegerx-来判断-x-是否是整数" style="position:relative;"><a href="#9%E3%80%81%E5%AE%9E%E7%8E%B0%E5%87%BD%E6%95%B0-isintegerx-%E6%9D%A5%E5%88%A4%E6%96%AD-x-%E6%98%AF%E5%90%A6%E6%98%AF%E6%95%B4%E6%95%B0" aria-label="9、实现函数 isintegerx 来判断 x 是否是整数 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>9、实现函数 isInteger(x) 来判断 x 是否是整数</h4>
<p>可以将 x 转换成 10 进制，判断和本身是不是相等即可：</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">function isInteger(x) {
 return parseInt(x, 10) === x; // 默认是10
}</code></pre></div>
<p>ES6 对数值进行了扩展，提供了静态方法 isInteger() 来判断参数是否是整数：</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">Number.isInteger(25) // true
Number.isInteger(25.0) // true
Number.isInteger(25.1) // false
Number.isInteger(&quot;15&quot;) // false
Number.isInteger(true) // false</code></pre></div>
<p>JavaScript 能够准确表示的整数范围在 -2^53 到 2^53 之间（不含两个端点），超过这个范围，无法精确表示这个值。ES6 引入了<code class="language-text">Number.MAX_SAFE_INTEGER</code> 和 <code class="language-text">Number.MIN_SAFE_INTEGER</code>这两个常量，用来表示这个范围的上下限，并提供了 <code class="language-text">Number.isSafeInteger()</code>来判断整数是否是安全型整数。</p>
<h4 id="10、在下面的代码中，数字-1-4-会以什么顺序输出？为什么会这样输出？" style="position:relative;"><a href="#10%E3%80%81%E5%9C%A8%E4%B8%8B%E9%9D%A2%E7%9A%84%E4%BB%A3%E7%A0%81%E4%B8%AD%EF%BC%8C%E6%95%B0%E5%AD%97-1-4-%E4%BC%9A%E4%BB%A5%E4%BB%80%E4%B9%88%E9%A1%BA%E5%BA%8F%E8%BE%93%E5%87%BA%EF%BC%9F%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BC%9A%E8%BF%99%E6%A0%B7%E8%BE%93%E5%87%BA%EF%BC%9F" aria-label="10、在下面的代码中，数字 1 4 会以什么顺序输出？为什么会这样输出？ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>10、在下面的代码中，数字 1-4 会以什么顺序输出？为什么会这样输出？</h4>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">(function() {
 console.log(1);
 setTimeout(function(){console.log(2)}, 1000);
 setTimeout(function(){console.log(3)}, 0);
 console.log(4);
})();
// 1,4,3,2</code></pre></div>
<p>这个就不多解释了，主要是 JavaScript 的定时机制和时间循环，不要忘了，JavaScript 是单线程的。详解可以参考 从 setTimeout 谈 JavaScript 运行机制。</p>
<h4 id="11、写一个少于-80-字符的函数，判断一个字符串是不是回文字符串" style="position:relative;"><a href="#11%E3%80%81%E5%86%99%E4%B8%80%E4%B8%AA%E5%B0%91%E4%BA%8E-80-%E5%AD%97%E7%AC%A6%E7%9A%84%E5%87%BD%E6%95%B0%EF%BC%8C%E5%88%A4%E6%96%AD%E4%B8%80%E4%B8%AA%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%98%AF%E4%B8%8D%E6%98%AF%E5%9B%9E%E6%96%87%E5%AD%97%E7%AC%A6%E4%B8%B2" aria-label="11、写一个少于 80 字符的函数，判断一个字符串是不是回文字符串 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>11、写一个少于 80 字符的函数，判断一个字符串是不是回文字符串</h4>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">function isPalindrome(str) {
 str = str.replace(/\W/g, &#39;&#39;).toLowerCase();//？
 return (str == str.split(&#39;&#39;).reverse().join(&#39;&#39;));
}</code></pre></div>
<h4 id="12、写一个按照下面方式调用都能正常工作的-sum-方法" style="position:relative;"><a href="#12%E3%80%81%E5%86%99%E4%B8%80%E4%B8%AA%E6%8C%89%E7%85%A7%E4%B8%8B%E9%9D%A2%E6%96%B9%E5%BC%8F%E8%B0%83%E7%94%A8%E9%83%BD%E8%83%BD%E6%AD%A3%E5%B8%B8%E5%B7%A5%E4%BD%9C%E7%9A%84-sum-%E6%96%B9%E6%B3%95" aria-label="12、写一个按照下面方式调用都能正常工作的 sum 方法 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>12、写一个按照下面方式调用都能正常工作的 sum 方法</h4>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">console.log(sum(2,3)); // Outputs 5
console.log(sum(2)(3)); // Outputs 5</code></pre></div>
<p>针对这个题，可以判断参数个数来实现：</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">//应该是做 curry化处理

function sum() {
    var fir = arguments[0];
    if (arguments.length === 2) {
        return arguments[0] + arguments[1]
    } else {
        return function (sec) {
            return fir + sec;
        }
    }
}</code></pre></div>
<h4 id="13、根据下面的代码片段回答后面的问题" style="position:relative;"><a href="#13%E3%80%81%E6%A0%B9%E6%8D%AE%E4%B8%8B%E9%9D%A2%E7%9A%84%E4%BB%A3%E7%A0%81%E7%89%87%E6%AE%B5%E5%9B%9E%E7%AD%94%E5%90%8E%E9%9D%A2%E7%9A%84%E9%97%AE%E9%A2%98" aria-label="13、根据下面的代码片段回答后面的问题 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>13、根据下面的代码片段回答后面的问题</h4>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">for (var i = 0; i &lt; 5; i++) {
    var btn = document.createElement(&#39;button&#39;);
    btn.appendChild(document.createTextNode(&#39;Button &#39; + i));
    btn.addEventListener(&#39;click&#39;, function () {
        console.log(i);
    });
    document.body.appendChild(btn);
}</code></pre></div>
<ol>
<li>
<p>点击 Button 4，会在控制台输出什么？</p>
<ul>
<li>点击 5 个按钮中的任意一个，都是输出 5</li>
</ul>
</li>
<li>
<p>给出一种符合预期的实现方式</p>
<ul>
<li>参考 IIFE。</li>
</ul>
</li>
</ol>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">for (var i = 0; i &lt; 5; i++) {
    var btn = document.createElement(&#39;button&#39;);
    btn.appendChild(document.createTextNode(&#39;Button &#39; + i));
    btn.addEventListener(&#39;click&#39;, (function (num) {
        console.log(num);
    })(i));
    document.body.appendChild(btn);
}</code></pre></div>
<h4 id="14、下面的代码会输出什么？为什么？" style="position:relative;"><a href="#14%E3%80%81%E4%B8%8B%E9%9D%A2%E7%9A%84%E4%BB%A3%E7%A0%81%E4%BC%9A%E8%BE%93%E5%87%BA%E4%BB%80%E4%B9%88%EF%BC%9F%E4%B8%BA%E4%BB%80%E4%B9%88%EF%BC%9F" aria-label="14、下面的代码会输出什么？为什么？ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>14、下面的代码会输出什么？为什么？</h4>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">var arr1 = &quot;john&quot;.split(&#39;&#39;); j o h n
var arr2 = arr1.reverse(); n h o j
var arr3 = &quot;jones&quot;.split(&#39;&#39;); j o n e s
arr2.push(arr3);
console.log(&quot;array 1: length=&quot; + arr1.length + &quot; last=&quot; + arr1.slice(-1));
console.log(&quot;array 2: length=&quot; + arr2.length + &quot; last=&quot; + arr2.slice(-1));</code></pre></div>
<p><code class="language-text">reverse()</code>会改变数组本身，并返回原数组的引用。故 arr1 和 arr2 是指向同一个数组的。</p>
<p><strong>这里总结下哪些方法会对数组本身修改，哪些会返回新数组：</strong></p>
<ul>
<li>原来 arr 上处理(会改变原来的数组，而不会创建新的数组)：</li>
</ul>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">forEach：循环每个元素、

every：全为true时返回true、

some：只要一个true时返回true、

reduce: 累加、

splice：数组增删操作，返回删除的元素、

sort: 对数组的元素进行排序、

reverse(): 颠倒数组中元素的顺序。

arr.forEach(function(val){})
arr.reduce(function(sum,ele){})</code></pre></div>
<ul>
<li>返回新数组：</li>
</ul>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">map：遍历后返回新数组（和forEach对立）、

filter：返回判断结果为true的结果、

slice：方法可从已有的数组中返回选定的元素，arrayObject.slice(start,end)、var arr1=arr.slice(0)

concat(): 连接两个或更多的数组，并返回结果。arr.concat(arr2,arr3)</code></pre></div>
<h4 id="15、关于-number-转化的问题" style="position:relative;"><a href="#15%E3%80%81%E5%85%B3%E4%BA%8E-number-%E8%BD%AC%E5%8C%96%E7%9A%84%E9%97%AE%E9%A2%98" aria-label="15、关于 number 转化的问题 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>15、关于 number 转化的问题</h4>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">console.log(1 + &quot;2&quot; + &quot;2&quot;);
console.log(1 + +&quot;2&quot; + &quot;2&quot;);
console.log(1 + -&quot;1&quot; + &quot;2&quot;);
console.log(+&quot;1&quot; + &quot;1&quot; + &quot;2&quot;);
console.log( &quot;A&quot; - &quot;B&quot; + &quot;2&quot;);
console.log( &quot;A&quot; - &quot;B&quot; + 2);</code></pre></div>
<p>输出什么，自己去运行吧，需要注意三个点：</p>
<p>多个数字和数字字符串混合运算时，跟操作数的位置有关</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">console.log(2 + 1 + &#39;3&#39;); / /‘33&#39;
console.log(&#39;3&#39; + 2 + 1); //&#39;321&#39;</code></pre></div>
<p>数字字符串之前存在数字中的正负号(+/-)时，会被转换成数字</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">console.log(typeof &#39;3&#39;); // string
console.log(typeof +&#39;3&#39;); //number</code></pre></div>
<p>同样，可以在数字前添加 ”，将数字转为字符串</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">console.log(typeof 3); // number
console.log(typeof (&#39;&#39;+3)); //string</code></pre></div>
<p>对于运算结果不能转换成数字的，将返回 NaN</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">console.log(&#39;a&#39; * &#39;sd&#39;); //NaN
console.log(&#39;A&#39; - &#39;B&#39;); // NaN</code></pre></div>
<h4 id="16、如果-list-很大，下面的这段递归代码会造成堆栈溢出。如果在不改变递归模式的前提下修善这段代码？" style="position:relative;"><a href="#16%E3%80%81%E5%A6%82%E6%9E%9C-list-%E5%BE%88%E5%A4%A7%EF%BC%8C%E4%B8%8B%E9%9D%A2%E7%9A%84%E8%BF%99%E6%AE%B5%E9%80%92%E5%BD%92%E4%BB%A3%E7%A0%81%E4%BC%9A%E9%80%A0%E6%88%90%E5%A0%86%E6%A0%88%E6%BA%A2%E5%87%BA%E3%80%82%E5%A6%82%E6%9E%9C%E5%9C%A8%E4%B8%8D%E6%94%B9%E5%8F%98%E9%80%92%E5%BD%92%E6%A8%A1%E5%BC%8F%E7%9A%84%E5%89%8D%E6%8F%90%E4%B8%8B%E4%BF%AE%E5%96%84%E8%BF%99%E6%AE%B5%E4%BB%A3%E7%A0%81%EF%BC%9F" aria-label="16、如果 list 很大，下面的这段递归代码会造成堆栈溢出。如果在不改变递归模式的前提下修善这段代码？ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>16、如果 list 很大，下面的这段递归代码会造成堆栈溢出。如果在不改变递归模式的前提下修善这段代码？</h4>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">var list = readHugeList();

var nextListItem = function() {
 var item = list.pop();

 if (item) {
 // process the list item...
 nextListItem();
 }
};</code></pre></div>
<p>原文上的解决方式是加个定时器：</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">var list = readHugeList();

var nextListItem = function() {
 var item = list.pop();

 if (item) {
 // process the list item...
 setTimeout( nextListItem, 0);
 }
};</code></pre></div>
<p>将其放入异步队列中处理，解决方式的原理请参考第 10 题。</p>
<h4 id="17、什么是闭包？举例说明" style="position:relative;"><a href="#17%E3%80%81%E4%BB%80%E4%B9%88%E6%98%AF%E9%97%AD%E5%8C%85%EF%BC%9F%E4%B8%BE%E4%BE%8B%E8%AF%B4%E6%98%8E" aria-label="17、什么是闭包？举例说明 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>17、什么是闭包？举例说明</h4>
<p>可以参考此篇：从作用域链谈闭包</p>
<h4 id="18、下面的代码会输出什么？为啥？" style="position:relative;"><a href="#18%E3%80%81%E4%B8%8B%E9%9D%A2%E7%9A%84%E4%BB%A3%E7%A0%81%E4%BC%9A%E8%BE%93%E5%87%BA%E4%BB%80%E4%B9%88%EF%BC%9F%E4%B8%BA%E5%95%A5%EF%BC%9F" aria-label="18、下面的代码会输出什么？为啥？ permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>18、下面的代码会输出什么？为啥？</h4>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">for (var i = 0; i &lt; 5; i++) {
 setTimeout(function() { console.log(i); }, i * 1000 );
}

out: 5 5 5 5 5</code></pre></div>
<h4 id="19、解释下列代码的输出" style="position:relative;"><a href="#19%E3%80%81%E8%A7%A3%E9%87%8A%E4%B8%8B%E5%88%97%E4%BB%A3%E7%A0%81%E7%9A%84%E8%BE%93%E5%87%BA" aria-label="19、解释下列代码的输出 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>19、解释下列代码的输出</h4>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">console.log(&quot;0 || 1 = &quot;+(0 || 1)); 1
console.log(&quot;1 || 2 = &quot;+(1 || 2)); 2
console.log(&quot;0 &amp;&amp; 1 = &quot;+(0 &amp;&amp; 1)); 0
console.log(&quot;1 &amp;&amp; 2 = &quot;+(1 &amp;&amp; 2)); 2</code></pre></div>
<p>逻辑与和逻辑或运算符会返回一个值，并且二者都是短路运算符：</p>
<p>逻辑与返回第一个是 false 的操作数 或者 最后一个是 true 的操作数</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">console.log(1 &amp;&amp; 2 &amp;&amp; 0); //0
console.log(1 &amp;&amp; 0 &amp;&amp; 1); //0
console.log(1 &amp;&amp; 2 &amp;&amp; 3); //3</code></pre></div>
<p>如果某个操作数为 false，则该操作数之后的操作数都不会被计算</p>
<p>逻辑或返回第一个是 true 的操作数 或者 最后一个是 false 的操作数</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">console.log(1 || 2 || 0); //1
console.log(0 || 2 || 1); //2
console.log(0 || 0 || false); //false</code></pre></div>
<p>如果某个操作数为 true，则该操作数之后的操作数都不会被计算</p>
<p>如果逻辑与和逻辑或作混合运算，则逻辑与的优先级高：</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">console.log(1 &amp;&amp; 2 || 0); //2
console.log(0 || 2 &amp;&amp; 1); //1
console.log(0 &amp;&amp; 2 || 1); //1</code></pre></div>
<p>在 JavaScript，常见的 false 值：</p>
<p>0, ‘0’, +0, -0, false, ”,null,undefined,null,NaN</p>
<p>要注意空数组([])和空对象({}):</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">console.log([] == false) //true
console.log({} == false) //false
console.log(Boolean([])) //true
console.log(Boolean({})) //true</code></pre></div>
<p>所以在 if 中，[] 和 {} 都表现为 true，注意两者都是引用类型，只要定义就存在。</p>
<h4 id="20、解释下面代码的输出" style="position:relative;"><a href="#20%E3%80%81%E8%A7%A3%E9%87%8A%E4%B8%8B%E9%9D%A2%E4%BB%A3%E7%A0%81%E7%9A%84%E8%BE%93%E5%87%BA" aria-label="20、解释下面代码的输出 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>20、解释下面代码的输出</h4>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">console.log(false == &#39;0&#39;)//-&gt;console.log(toNumber(false) == &#39;0&#39;) -&gt;true
console.log(false === &#39;0&#39;)//-&gt;console.log(0 === &#39;0&#39;)-&gt;false</code></pre></div>
<p>参考此图的解释：</p>
<p><img src="http://xiangsongtao.com/uploads/1474859620000.png" alt="参考此图的解释"></p>
<h4 id="21、解释下面代码的输出" style="position:relative;"><a href="#21%E3%80%81%E8%A7%A3%E9%87%8A%E4%B8%8B%E9%9D%A2%E4%BB%A3%E7%A0%81%E7%9A%84%E8%BE%93%E5%87%BA" aria-label="21、解释下面代码的输出 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>21、解释下面代码的输出</h4>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">var a={},
 b={key:&#39;b&#39;},
 c={key:&#39;c&#39;};

a[b]=123;
a[c]=456;

console.log(a[b]);//456</code></pre></div>
<h4 id="22、解释下面代码的输出" style="position:relative;"><a href="#22%E3%80%81%E8%A7%A3%E9%87%8A%E4%B8%8B%E9%9D%A2%E4%BB%A3%E7%A0%81%E7%9A%84%E8%BE%93%E5%87%BA" aria-label="22、解释下面代码的输出 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>22、解释下面代码的输出</h4>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">console.log((function f(n){return ((n &gt; 1) ? n * f(n-1) : n)})(10));</code></pre></div>
<p>结果是 10 的阶乘。这是一个递归调用，为了简化，我初始化 n=5，则调用链和返回链如下：</p>
<p><img src="http://files.jb51.net/file_images/article/201512/2015122992756570.png?201511299284"></p>
<h4 id="23、解释下面代码的输出" style="position:relative;"><a href="#23%E3%80%81%E8%A7%A3%E9%87%8A%E4%B8%8B%E9%9D%A2%E4%BB%A3%E7%A0%81%E7%9A%84%E8%BE%93%E5%87%BA" aria-label="23、解释下面代码的输出 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>23、解释下面代码的输出</h4>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">(function(x) {
 return (function(y) {
 console.log(x);
 })(2)
})(1);</code></pre></div>
<p>输出 1，闭包能够访问外部作用域的变量或参数。</p>
<h4 id="24、解释下面代码的输出，并修复存在的问题" style="position:relative;"><a href="#24%E3%80%81%E8%A7%A3%E9%87%8A%E4%B8%8B%E9%9D%A2%E4%BB%A3%E7%A0%81%E7%9A%84%E8%BE%93%E5%87%BA%EF%BC%8C%E5%B9%B6%E4%BF%AE%E5%A4%8D%E5%AD%98%E5%9C%A8%E7%9A%84%E9%97%AE%E9%A2%98" aria-label="24、解释下面代码的输出，并修复存在的问题 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>24、解释下面代码的输出，并修复存在的问题</h4>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">var hero = {
 _name: &#39;John Doe&#39;,
 getSecretIdentity: function (){
 return this._name;
 }
};

var stoleSecretIdentity = hero.getSecretIdentity;

console.log(stoleSecretIdentity());
console.log(hero.getSecretIdentity());</code></pre></div>
<p>将 getSecretIdentity 赋给 stoleSecretIdentity，等价于定义了 stoleSecretIdentity 函数：</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">var stoleSecretIdentity = function (){
 return this._name;
}
stoleSecretIdentity</code></pre></div>
<p>的上下文是全局环境，所以第一个输出 undefined。若要输出 John Doe，则要通过 call 、apply 和 bind 等方式改变 stoleSecretIdentity 的 this 指向(hero)。</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">var stoleSecretIdentity = hero.getSecretIdentity.call(hero)</code></pre></div>
<p>第二个是调用对象的方法，输出 John Doe。</p>
<h4 id="25、给你一个-dom-元素，创建一个能访问该元素所有子元素的函数，并且要将每个子元素传递给指定的回调函数。" style="position:relative;"><a href="#25%E3%80%81%E7%BB%99%E4%BD%A0%E4%B8%80%E4%B8%AA-dom-%E5%85%83%E7%B4%A0%EF%BC%8C%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E8%83%BD%E8%AE%BF%E9%97%AE%E8%AF%A5%E5%85%83%E7%B4%A0%E6%89%80%E6%9C%89%E5%AD%90%E5%85%83%E7%B4%A0%E7%9A%84%E5%87%BD%E6%95%B0%EF%BC%8C%E5%B9%B6%E4%B8%94%E8%A6%81%E5%B0%86%E6%AF%8F%E4%B8%AA%E5%AD%90%E5%85%83%E7%B4%A0%E4%BC%A0%E9%80%92%E7%BB%99%E6%8C%87%E5%AE%9A%E7%9A%84%E5%9B%9E%E8%B0%83%E5%87%BD%E6%95%B0%E3%80%82" aria-label="25、给你一个 dom 元素，创建一个能访问该元素所有子元素的函数，并且要将每个子元素传递给指定的回调函数。 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>25、给你一个 DOM 元素，创建一个能访问该元素所有子元素的函数，并且要将每个子元素传递给指定的回调函数。</h4>
<p>函数接受两个参数：</p>
<ul>
<li>DOM</li>
<li>指定的回调函数</li>
</ul>
<p>原文利用 深度优先搜索(Depth-First-Search) 给了一个实现：</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">function Traverse(p_element, p_callback) {
    p_callback(p_element);
    var list = p_element.children;
    for (var i = 0; i &lt; list.length; i++) {
        Traverse(list[i], p_callback); // recursive call
    }
}</code></pre></div>
<p>以上就是为大家分享的 25 个 JavaScript 面试题，希望对大家参加面试有所帮助。</p>
<p>（完）</p>]]></description><link>https://xiangst0816.github.io/blog/25-ge-mian-shi-ti/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/25-ge-mian-shi-ti/</guid><category><![CDATA[面试]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Thu, 20 Oct 2016 14:10:16 GMT</pubDate></item><item><title><![CDATA[setTimeout延时0毫秒的作用]]></title><description><![CDATA[<p>相信这样的代码<code class="language-text">setTimeout(function () {},0)</code>我们都是遇到过的, 但是思考为什么这么用而不用其他的办法的人估计就很少了，今天遇到，在此记录。</p>
<h2 id="先解释下-javascript-单线程模型" style="position:relative;"><a href="#%E5%85%88%E8%A7%A3%E9%87%8A%E4%B8%8B-javascript-%E5%8D%95%E7%BA%BF%E7%A8%8B%E6%A8%A1%E5%9E%8B" aria-label="先解释下 javascript 单线程模型 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>先解释下 JavaScript 单线程模型</h2>
<p><a href="http://www.cnblogs.com/silin6/p/4333999.html" target="_target" rel="nofollow">原文由此进入</a></p>
<p>首先我们来看浏览器下的 JavaScript：</p>
<p>浏览器的内核是多线程的，它们在内核制控下相互配合以保持同步，一个浏览器至少实现三个常驻线程：<strong>JavaScript 引擎线程</strong>，<strong>GUI 渲染线程</strong>，<strong>浏览器事件触发线程</strong>。</p>
<ul>
<li>JavaScript 引擎是基于事件驱动单线程执行的，JS 引擎一直等待着任务队列中任务的到来，然后加以处理，浏览器无论什么时候都只有一个 JS 线程在运行 JS 程序。</li>
<li>GUI 渲染线程负责渲染浏览器界面，当界面需要重绘（Repaint）或由于某种操作引发回流(reflow)时,该线程就会执行。但需要注意 GUI 渲染线程与 JS 引擎是互斥的，当 JS 引擎执行时 GUI 线程会被挂起，GUI 更新会被保存在一个队列中等到 JS 引擎空闲时立即被执行。<a href="">如何触发重绘操作</a></li>
<li>事件触发线程，当一个事件被触发时该线程会把事件添加到待处理队列的队尾，等待 JS 引擎的处理。这些事件可来自 JavaScript 引擎当前执行的代码块如<code class="language-text">setTimeOut</code>、也可来自浏览器内核的其他线程如<code class="language-text">鼠标点击事件</code>、<code class="language-text">AJAX异步请求</code>等，但由于 JS 的单线程关系所有这些事件都得排队等待 JS 引擎处理。（当线程中没有执行任何同步代码的前提下才会执行异步代码）。<a href="">事件</a></li>
</ul>
<p>js 的单线程在这一段面试代码中尤为明显（理解即可，请不要尝试…浏览器会假死的）：</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">var isEnd = true;
window.setTimeout(function () {
    isEnd = false; //1s后，改变isEnd的值
}, 1000);
//这个while永远的占用了js线程，所以setTimeout里面的函数永远不会执行
while (isEnd);
//alert也永远不会弹出
alert(&#39;end&#39;);</code></pre></div>
<p>在我工作中对 js 的认识，个人认为 js 的任务单位是<strong>函数</strong>。即，一个函数表示着一个任务，这个函数没有执行结束，则在浏览器中当前的任务即没有结束。</p>
<p>上面的代码中，当前任务因为 while 的执行而造成永远无法执行，所以后面的 setTimeout 也永远不会被执行。它在浏览器的任务队列中如图所示：</p>
<p><img src="http://xiangsongtao.com/uploads/1474859133000.png"></p>
<blockquote>
<p>另外值得一提的是，setTimeout 会将内部 Fn 所需的执行环境保存挂载任务的末尾，因此如果 setTimeout 过多，在 node 端会造成内存泄露，因此在 node 端慎用。</p>
</blockquote>
<h2 id="实现-javascript-的异步；" style="position:relative;"><a href="#%E5%AE%9E%E7%8E%B0-javascript-%E7%9A%84%E5%BC%82%E6%AD%A5%EF%BC%9B" aria-label="实现 javascript 的异步； permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>实现 javascript 的异步；</h2>
<blockquote>
<p>javascript 异步表示 async，指：代码执行不按顺序，‘跳过’执行，待其他某些代码执行完后，再来执行，称为“异步”。
javascript 同步表示 sync，指：代码依次执行。</p>
</blockquote>
<p>当然，这个‘异步’是模拟的形式出现的。正常情况下 javascript 都是按照顺序执行的。但是我们可能让该语句后面的语句执行完再执行本身，这时就可以用到 setTimeout 延时 0ms 来实现了，将 setTimeout 内部函数放到同步函数的外面执行（<strong>setTimeout 内部函数放到了当前执行函数的外面</strong>）。如：</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">alert(1);
setTimeout(&quot;alert(2)&quot;, 0);
alert(3);</code></pre></div>
<p>虽然延时了 0ms,但是执行顺序为：1，3，2
这样就保证 setTimeout 里面的语句在某一代码段中最后执行。</p>
<p>因此：<strong>我们应该认识到，利用 setTimeout(fn,0)的特性，可以帮助我们在某些极端场景下，修正浏览器的下一个任务。</strong></p>
<p>（完）</p>]]></description><link>https://xiangst0816.github.io/blog/setTimeout-yan-shi-0-hao-miao-de/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/setTimeout-yan-shi-0-hao-miao-de/</guid><category><![CDATA[JavaScript]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Thu, 20 Oct 2016 14:09:45 GMT</pubDate></item><item><title><![CDATA[Manifest的使用]]></title><description><![CDATA[<p>为了加快网页的访问速度，对请求资源进行缓存是一个常用的策略。当客户端发送资源请求后，如果资源未过期，则服务器返回 304 代表资源未修改使用浏览器本地缓存，但是这个过程还是会发生 TCP 连接，如果不发送请求就能知道本地的缓存副本就是最新的按就好了。</p>
<p>其中的一个解决方案就是使用 HTML5 的最新特性离线存储(manifest)来解决。通过离线存储，我们可以通过把需要离线存储在本地的文件列在一个 manifest 配置文件中，这样即使在离线的情况下，用户也可以正常使用 App。同时，由之前返回的 304(not modified)全部变成 200(from cache)，也即是说不用再请求服务器资源了。</p>
<blockquote>
<p>PS：应该是在单页面 SPA 应用中多使用此技术，除了 IE9 及其以下版本不兼容，其余浏览器都兼容。</p>
</blockquote>
<h3 id="怎么使用" style="position:relative;"><a href="#%E6%80%8E%E4%B9%88%E4%BD%BF%E7%94%A8" aria-label="怎么使用 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>怎么使用</h3>
<p>在 html 中加入 manifest 的属性就可以了。</p>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">HTML</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">manifest</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">"</span>cache.manifest<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
...
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></code></pre></div>
<p>之后编写<code class="language-text">cache.manifest</code>文件(此文件一般是通过自动化工具来做生成，手动维护很痛苦)</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">CACHE MANIFEST

CACHE:
http://cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css
http://cdn.bootcss.com/font-awesome/4.6.3/fonts/fontawesome-webfont.woff2?v=4.6.3
http://xiangsongtao.com/static/css/app.40ca310ea17e37e2c7d1be290f097782.css
http://xiangsongtao.com/static/js/0.cc35128bd8494c03daa0.js
http://xiangsongtao.com/static/js/1.9f1833ed33a94fe44f61.js
http://xiangsongtao.com/static/js/2.6fd53cc0491419739c75.js
http://xiangsongtao.com/static/js/3.7d2782ebd4a9ccfc73c3.js
http://xiangsongtao.com/static/js/4.3ffed0ad00e3cbf19311.js
http://xiangsongtao.com/static/js/5.0864b0b318aed8c5e5c3.js
http://xiangsongtao.com/static/js/6.8cf1f468ef4e49b1fb0d.js
http://xiangsongtao.com/static/js/7.da83992afd496d4889e3.js
http://xiangsongtao.com/static/js/8.a75be465a534de6bc590.js
http://xiangsongtao.com/static/js/app.88635de0da664917c9bc.js
http://xiangsongtao.com/static/js/manifest.c3d7bc712610ce511e9b.js
http://xiangsongtao.com/static/js/vendor.dd1992f099a201029616.js

NETWORK:
*

SETTINGS:
prefer-online

# hash: f98a3b3dac77c6644dc0795a6fb7e44ca03f41b33ff6d738d3da57b783abf5f1

FALLBACK:
/ /offline.html</code></pre></div>
<p>SETTINGS 可以设置成两种模式，默认是 fast。但是在我的测试中没感觉到这两种模式有什么区别，这个就暂时不说了。</p>
<p>这些就是 manifest 缓存最基本的东西，还有一个很大的问题就是火狐的警告。当使用 manifest 时，火狐下会出现警告。</p>
<p>生成上述 manifest 文件的 gulp 配置如下：</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">&#39;use strict&#39;;
var  gulp  = require(&#39;gulp&#39;);
var  gulpLoadPlugins  = require(&#39;gulp-load-plugins&#39;);
var $ = gulpLoadPlugins();

gulp.task(&#39;manifest&#39;, function(){
  gulp.src([&#39;dist/static/**/*.{js,css}&#39;], { base: &#39;./dist&#39; })
    .pipe($.manifest({
      hash: true,
      preferOnline: true,
      prefix:&#39;http://xiangsongtao.com/&#39;,
      network: [&#39;*&#39;],
      cache:[
        &#39;http://cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css&#39;,
        &#39;http://cdn.bootcss.com/font-awesome/4.6.3/fonts/fontawesome-webfont.woff2?v=4.6.3&#39;,
      ],
      filename: &#39;app.manifest&#39;,
      exclude: [&#39;app.manifest&#39;]
    }))
    .pipe(gulp.dest(&#39;dist&#39;));
});</code></pre></div>
<h3 id="manifest-解析过程" style="position:relative;"><a href="#manifest-%E8%A7%A3%E6%9E%90%E8%BF%87%E7%A8%8B" aria-label="manifest 解析过程 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>manifest 解析过程</h3>
<p>在线情况第一次访问，则查找 html 中的 manifest 文件，如果有则下载里面需要缓存的资源。第二次访问的时候，浏览器使用本地缓存副本渲染网页，之后判断 manifest 中的文件是否更新，如果未更新则不操作；如果已更新，则下载最新副本缓存（也就是说，更新 manifest 后并不会立即生效，需要再刷新下）,这个问题我们可以用代码进行手动缓存的刷新解决，调用<code class="language-text">window.applicationCache.update()</code>进行缓存刷新，<code class="language-text">window.applicationCache.swapCache()</code>进行重新请求更新的资源进行渲染。</p>
<h3 id="manifest-过程对应的事件" style="position:relative;"><a href="#manifest-%E8%BF%87%E7%A8%8B%E5%AF%B9%E5%BA%94%E7%9A%84%E4%BA%8B%E4%BB%B6" aria-label="manifest 过程对应的事件 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>manifest 过程对应的事件</h3>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text"> window.applicationCache.onnoupdate = function(){
            console.debug(&#39;onnoupdate!!!!&#39;)
}</code></pre></div>
<ol>
<li>oncached:当离线资源存储完成之后触发这个事件，这个是文档的说法，我在 Chrome 上面测试的时候并没有触发这个事件（onobsolete 也是）。</li>
<li>onchecking:当浏览器对离线存储资源进行更新检查的时候会触发这个事件</li>
<li>ondownloading:当浏览器开始下载离线资源的时候会触发这个事件</li>
<li>onprogress:当浏览器在下载每一个资源的时候会触发这个事件，每下载一个资源就会触发一次。</li>
<li>onupdateready:当浏览器对离线资源更新完成之后会触发这个事件</li>
<li>on 中 noupdate:当浏览器检查更新之后发现没有资源更新的时候触发这个事件</li>
<li>onerror: 当 manifest 中缓存的资源下载错误是触发</li>
</ol>
<h3 id="manifest-使用场景" style="position:relative;"><a href="#manifest-%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF" aria-label="manifest 使用场景 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>manifest 使用场景</h3>
<p>manifest 的名字叫 Application Cache 就已经很好的定性了，它是用来构造离线应用程序的。比方说你写了个秒表，它离线也能用，这是 manifest 的应用场景。它会讲当前访问的 HTML 也缓存起来，故实时的 web 还是别用了。</p>
<p>如果要缓存资源，设置<code class="language-text">Cache Control</code>和<code class="language-text">Expires</code>来做吧，这个见我的另外一篇文章。</p>
<h3 id="参考资源" style="position:relative;"><a href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%BA%90" aria-label="参考资源 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>参考资源</h3>
<ul>
<li><a href="https://www.npmjs.com/package/gulp-manifest" target="_target" rel="nofollow">Gulp-manifest</a></li>
<li><a href="https://segmentfault.com/a/1190000000732617" target="_target" rel="nofollow">原文参考 1</a></li>
<li><a href="http://bin-playground.top" target="_target" rel="nofollow">原文参考 2</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Using_the_application_cache" target="_target" rel="nofollow">Using<em>the</em>application_cache</a></li>
<li><a href="http://diveintohtml5.info/offline.html" target="_target" rel="nofollow">LET’S TAKE THIS OFFLINE</a></li>
</ul>]]></description><link>https://xiangst0816.github.io/blog/Manifest-de-di-shi-yong/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/Manifest-de-di-shi-yong/</guid><category><![CDATA[缓存]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Thu, 20 Oct 2016 14:09:22 GMT</pubDate></item><item><title><![CDATA[登录流程加密的思考]]></title><description><![CDATA[<p>思考这个问题主要是有人问到过我：用户登录的密码是如何保护的，又是如何在网络传输下让黑客看到也拿破解不了用户密码，也无法再次模拟登录？</p>
<p>好吧，一个是将密码使用 MD5 加密传输，另一个是使用 HTTPs 协议。</p>
<p>对于我这个小网站，用 HTTPs 有些大题小做，那如果不用 HTTPs 呢？</p>
<h3 id="登录设计" style="position:relative;"><a href="#%E7%99%BB%E5%BD%95%E8%AE%BE%E8%AE%A1" aria-label="登录设计 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>登录设计</h3>
<p>对此我想了下设计了下面登录方式（时序图）：</p>
<p><img src="http://xiangsongtao.com/uploads/1476276752000.png" alt="登录时序图"></p>
<h3 id="过程分析" style="position:relative;"><a href="#%E8%BF%87%E7%A8%8B%E5%88%86%E6%9E%90" aria-label="过程分析 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>过程分析</h3>
<ol>
<li>用户发起登录请求</li>
<li>服务器根据用户 IP 及服务器时间，返回上图所写的格式数据。将当前请求信息用 MD5 包裹</li>
<li>客户端用服务器返回的数据发送用户名<code class="language-text">u</code>和密码<code class="language-text">p</code>，其中密码用 MD5 包裹</li>
<li>最后由服务器判断当前请求的结果：服务器分析用户的 IP、判断发起登录的时间（允许登录的时间窗口为 5s，超时就失败）、判断密码的 MD5 值。</li>
</ol>
<h3 id="hack-分析" style="position:relative;"><a href="#hack-%E5%88%86%E6%9E%90" aria-label="hack 分析 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Hack 分析</h3>
<ol>
<li>除非 Hack 就在在用户输入的时候就知道密码，否则他在中间任何一步拦截，都无法获取用户密码</li>
<li>因为每次发送的密码盐<code class="language-text">b</code>都不一样，即使 Hack 伪造，也无法再次<strong>同时同地</strong>的使用。</li>
</ol>
<h3 id="博客改造" style="position:relative;"><a href="#%E5%8D%9A%E5%AE%A2%E6%94%B9%E9%80%A0" aria-label="博客改造 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>博客改造</h3>
<p>按照上面设计的方法进行登录改造,避免登录传输明文 password 的问题, 并且对登录后的 token 重点关键信息进行了 md5 修改. 整个前后台修改不到 2h, 很快哈.</p>
<p>这里使用的 md5 工具是<code class="language-text">js-md5</code>, <a href="https://www.npmjs.com/package/js-md5" target="_target" rel="nofollow">详细链接在这里</a>.</p>
<p>修改后的信息见我的博客登录处, 你可以尝试不用的输入,观察发送的结果及后台返回的结果.</p>
<p>（完）</p>]]></description><link>https://xiangst0816.github.io/blog/deng-lu-liu-cheng-jia-mi-de-di-si-sai-kao/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/deng-lu-liu-cheng-jia-mi-de-di-si-sai-kao/</guid><category><![CDATA[随笔]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Thu, 20 Oct 2016 14:07:23 GMT</pubDate></item><item><title><![CDATA[(转载)前端，我为什么不要你]]></title><description><![CDATA[<p>转载这篇文章,文章里面内容就不再展开，感兴趣的可以看下，<a href="http://www.cnblogs.com/vans/p/4550356.html" target="_target" rel="nofollow">地址点击这里</a>。</p>
<p>下面是我的评价：</p>
<p>文章里说的都是基础，有些实际应用中的问题如果基础比较好的话能够深挖问题背后的原因，方便解决问题。我觉得基础是一个内化的过程，而不是背诵的过程。遇到问题深挖一下，然后在琢磨下背后的原理，这样比背诵的效果会好很多。比如，这样问应聘者：</p>
<blockquote>
<p>问：每天早上一打开网页就出现电信在右下角的小广告，需求说要避免这种情况，你该如何处理？</p>
</blockquote>
<blockquote>
<p>答： 1. 如果特征相同的话，插入到 html 中的代码应该都是 ifream 结构的，页面加载的同时用 js 检查页面中是否有不属于页面的东西，如果有则<code class="language-text">history.go(0)</code>处理；2. 另外一种更保险的方式是用 https 加密传输 html 内容，但是会 ssl 加解密通信会增加页面打开时间，建议再使用 http2.0 的方式请求，这样只建立一次 TCP 就能 Down 下所有所需资源，与此同时做好 cache-controll 中的缓存策略处理，保证下次连接返回 200(from cache)，弥补下首次加载的速度。</p>
</blockquote>
<p>我想，这样比问“HTTP 协议”，“三次握手”、“网络协议”、“W3C 标准协议”、“性能优化”、“安全性”等问题更具有挑战吧？</p>
<p>另外，我知道 TCP 有三次握手，但是每次握手改变什么标记字段对我前端又有啥帮助呢？</p>
<p>(完)</p>]]></description><link>https://xiangst0816.github.io/blog/zhuan-zai-qian-duan-wo/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/zhuan-zai-qian-duan-wo/</guid><category><![CDATA[随笔]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Thu, 20 Oct 2016 14:06:49 GMT</pubDate></item><item><title><![CDATA[H5移动开发总结]]></title><description><![CDATA[<h2 id="透明度" style="position:relative;"><a href="#%E9%80%8F%E6%98%8E%E5%BA%A6" aria-label="透明度 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>透明度</h2>
<p>主要是兼容 IE6+的写法，当我们在兼容低版本浏览器的时候可能下面的写法可以满足我们的需求（两个属性都写上，浏览器识别的属性直接覆盖前者的属性）：</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">.item1{
    opacity:0.1;
    //IE8以上浏览器识别
    filter: progid:DXImageTransform.Microsoft.Alpha(opacity=70);
    //滤镜低版本IE7-8支持
}</code></pre></div>
<h2 id="html5-标签唤起发短信功能" style="position:relative;"><a href="#html5-%E6%A0%87%E7%AD%BE%E5%94%A4%E8%B5%B7%E5%8F%91%E7%9F%AD%E4%BF%A1%E5%8A%9F%E8%83%BD" aria-label="html5 标签唤起发短信功能 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>html5 标签唤起发短信功能</h2>
<p>做 html5 开发的过程中，我们可能会有这样的需求：</p>
<p>点击按钮，呼起系统的发送短信的窗口，并且自动填充发送到的号码和内容。网络上可以很容易的找到这方面的 demo ，并且也可以找到在安卓上和 iOS 上是有却别的（body 之前的标示）：</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">&lt;!-- ios UC浏览器--&gt;
&lt;a href=&quot;sms:10086?body=发送的内容&quot;&gt;点击我发送短信&lt;/a&gt;
&lt;!-- ios &lt;=ios7--&gt;
&lt;a href=&quot;sms:10086;body=发送的内容&quot;&gt;点击我发送短信&lt;/a&gt;
&lt;!-- ios &gt;=ios8--&gt;
&lt;a href=&quot;sms:10086&amp;body=发送的内容&quot;&gt;点击我发送短信&lt;/a&gt;
&lt;!-- android--&gt;
&lt;a href=&quot;sms:10086?body=发送的内容&quot;&gt;点击我发送短信&lt;/a&gt;</code></pre></div>
<p>这里有图片</p>
<h2 id="input-标签选择系统文件的问题" style="position:relative;"><a href="#input-%E6%A0%87%E7%AD%BE%E9%80%89%E6%8B%A9%E7%B3%BB%E7%BB%9F%E6%96%87%E4%BB%B6%E7%9A%84%E9%97%AE%E9%A2%98" aria-label="input 标签选择系统文件的问题 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>input 标签选择系统文件的问题</h2>
<p>在 html5 中 input 标签提供给了开发者访问系统文件的能力。在移动端的系统浏览器中使用 input 控件没有什么问题。但是在 app 的<strong>webview</strong>中需要注意，webview 读取系统文件是需要有权限的，如果权限未设置会出现 bug，IOS 和 Android 同理。</p>
<h2 id="多页面-html-如何传递数据" style="position:relative;"><a href="#%E5%A4%9A%E9%A1%B5%E9%9D%A2-html-%E5%A6%82%E4%BD%95%E4%BC%A0%E9%80%92%E6%95%B0%E6%8D%AE" aria-label="多页面 html 如何传递数据 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>多页面 html 如何传递数据</h2>
<p>传统的方法是在页面 url 的 query 中添加参数，但是需要处处携带。但是使用本地存储就可以解决。这个是淘宝的一个面试题，不过熟悉 sessionStroage 及 localStorage 的同学应该知道怎么办了。</p>
<p>另外，在 app 的<strong>webview</strong>中需要注意，IOS 和 Android 的同学开启 localStorage 向磁盘写文件的权限。</p>
<h2 id="js-在客户端生成二维码或者一维码" style="position:relative;"><a href="#js-%E5%9C%A8%E5%AE%A2%E6%88%B7%E7%AB%AF%E7%94%9F%E6%88%90%E4%BA%8C%E7%BB%B4%E7%A0%81%E6%88%96%E8%80%85%E4%B8%80%E7%BB%B4%E7%A0%81" aria-label="js 在客户端生成二维码或者一维码 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>JS 在客户端生成二维码或者一维码</h2>
<p>这个能实现，使用 qrcodejs 或者 jQuery.qrcide 插件。前辈总结的图用下：</p>
<p>这里有图！！</p>
<h2 id="本地存储-js-字符串并解析" style="position:relative;"><a href="#%E6%9C%AC%E5%9C%B0%E5%AD%98%E5%82%A8-js-%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%B9%B6%E8%A7%A3%E6%9E%90" aria-label="本地存储 js 字符串并解析 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>本地存储 JS 字符串并解析</h2>
<p>最终的书写代码如下：</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">var fnStr = &#39;return function (){console.log(&quot;you are here!&quot;)}&#39;
var fn = new Function(fnStr);
fn()
-&gt; function (){console.log(&quot;you are here!&quot;)}
fn()()
-&gt; you are here!</code></pre></div>
<h2 id="键盘被呼起模拟滚动" style="position:relative;"><a href="#%E9%94%AE%E7%9B%98%E8%A2%AB%E5%91%BC%E8%B5%B7%E6%A8%A1%E6%8B%9F%E6%BB%9A%E5%8A%A8" aria-label="键盘被呼起模拟滚动 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>键盘被呼起模拟滚动</h2>
<p>在移动端浏览器中，正常情况下点击 Input 是能自动滚动页面让 input 和键盘显示在一起。但是在某些 webview 中需要 js 模拟唤起，下面是实现代码：</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">function inputScroll(dom){
var tplList=[&#39;ss&#39;,&#39;bb&#39;] ;

var tpl = $.fn.getQueryString(tpl);
  if(tplList.indexOf(tpl)){
    dom.focus(function(){
      var clientHeight = $(window).height();
      var contentHeight = clientHeight + clientHeight/2;
      var smsInputTop= $(this).offset().top;

      content.height(contentHeight);
      window.scrollTo(0,smsInputTop-76);
    });
  }
}</code></pre></div>
<h2 id="参考" style="position:relative;"><a href="#%E5%8F%82%E8%80%83" aria-label="参考 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>参考</h2>
<ul>
<li><a href="https://github.com/zhiqiang21/blog/issues/27" target="_target" rel="nofollow">移动端 h5 开发相关内容总结（四）</a></li>
</ul>]]></description><link>https://xiangst0816.github.io/blog/H5-yi-dong-kai-fa-zong-jie/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/H5-yi-dong-kai-fa-zong-jie/</guid><category><![CDATA[Mobile]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Thu, 20 Oct 2016 01:08:45 GMT</pubDate></item><item><title><![CDATA[从零开始MEVN环境部署]]></title><description><![CDATA[<blockquote>
<p>前言介绍，因为在给网站升级 https，其中涉及到修改文件内容等操作，于是阴差阳错的将/etc 文件全部<code class="language-text">chmod 777</code>了，结果导致阿里云服务器远程 SSH 无法登录及 FTP 也无法使用。</p>
<p>更悲催的是，我之前都没做过数据库镜像备份及数据库备份，想着应该不会发生，结果还是发生了。从客服了解到，只能重置服务器，让我将‘受伤’的系统盘做一个镜像。等新系统初始化完毕之后挂载镜像再做修复。</p>
<p>于是，就有了这边文章的起源。从零开始部署+修复数据。不过，没想象的难。</p>
</blockquote>
<h2 id="mevn" style="position:relative;"><a href="#mevn" aria-label="mevn permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>MEVN</h2>
<p>这个单词是 Mongodb、Express、Vue、Nodejs 全栈技术的缩写，和 MEAN 很像，其中 Vue 也是 MVVM 框架，因此改动不算大。</p>
<h2 id="阿里云服务器" style="position:relative;"><a href="#%E9%98%BF%E9%87%8C%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8" aria-label="阿里云服务器 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>阿里云服务器</h2>
<p>购买了阿里云的包年的服务器，选择 CentOS+Nginx+Nodejs 的环境配置之后拿到手的就是原始的服务器环境。</p>
<h2 id="ssh-登录" style="position:relative;"><a href="#ssh-%E7%99%BB%E5%BD%95" aria-label="ssh 登录 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>SSH 登录</h2>
<p>Mac 使用起来还是挺方便的，在终端中输入命令及密码：</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">$ ssh -p 22 root@xxx.xxx.xxx.xxx
$ password</code></pre></div>
<h2 id="nodejs-升级" style="position:relative;"><a href="#nodejs-%E5%8D%87%E7%BA%A7" aria-label="nodejs 升级 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Nodejs 升级</h2>
<p>升级 Nodejs 是为了使用 ES6 的语法写后台应用，首次尝试了使用 YUM 安装：</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">$ yum insalll -y nodejs</code></pre></div>
<p>这个命令安装的是 0.10 版本，但是现在 Node 最新版本已经是 6.8.1 了，故需要换一个方法。先下载最新版本，之后再安装。<a href="http://jingyan.baidu.com/article/dca1fa6f48f478f1a5405272.html" target="_target" rel="nofollow">参考这里</a>。</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">$ curl --silent --location https://rpm.nodesource.com/setup_6.x | bash -
$ yum install -y nodejs</code></pre></div>
<p>之后是安装 npm 包管理器、n 命令（nodejs 版本管理工具）、cnpm、pm2</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">$  yun install -y npm
$ npm install n -g
$ npm install cnpm -g
$ cnpm install pm2 -g</code></pre></div>
<h2 id="挂载原来的镜像文件" style="position:relative;"><a href="#%E6%8C%82%E8%BD%BD%E5%8E%9F%E6%9D%A5%E7%9A%84%E9%95%9C%E5%83%8F%E6%96%87%E4%BB%B6" aria-label="挂载原来的镜像文件 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>挂载原来的镜像文件</h2>
<p>邀请了阿里云的客服帮我把以前的服务器镜像挂载到了<code class="language-text">/dev/vdb1</code>下，通过下面的的命令打开镜像，很是很简单。镜像在<code class="language-text">/alidata/disk_bk</code>下显示。之后就可以 cd 进去了。</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">$ mount -o loop /dev/vdb1 /alidata/disk_bk</code></pre></div>
<p>解挂命令(当前在/alidata 下)：</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">$ umount disk_bk/

$ lsof | grpe disk_bk //如果解挂不行，查询当前那个进程在使用，然后
$ kill -9 pid</code></pre></div>
<p>使用<code class="language-text">mv</code>命令将以前的资料导出到新环境中，包括部署前端文件及数据库。</p>
<h2 id="nginx" style="position:relative;"><a href="#nginx" aria-label="nginx permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Nginx</h2>
<p>我只是修改了转发端口，之前是代理 8088，我改成了我的 8080.</p>
<p>配置文件：</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">/alidata/server/nginx/conf/vhosts</code></pre></div>
<p>进入目录后重启服务：</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">$ cd /alidata/server/nginx/sbin
$ ./nginx -s reload</code></pre></div>
<h2 id="mongodb" style="position:relative;"><a href="#mongodb" aria-label="mongodb permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Mongodb</h2>
<h3 id="关闭以前的-mongod-服务" style="position:relative;"><a href="#%E5%85%B3%E9%97%AD%E4%BB%A5%E5%89%8D%E7%9A%84-mongod-%E6%9C%8D%E5%8A%A1" aria-label="关闭以前的 mongod 服务 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>关闭以前的 mongod 服务</h3>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">$ mongod --shutdown //不行使用下面的

$  lsof | grep 27017  //找占用27017端口的进程，然后kill，一般都这么搞
$  kill pid</code></pre></div>
<h3 id="启动-mongod-服务，指向最新数据库" style="position:relative;"><a href="#%E5%90%AF%E5%8A%A8-mongod-%E6%9C%8D%E5%8A%A1%EF%BC%8C%E6%8C%87%E5%90%91%E6%9C%80%E6%96%B0%E6%95%B0%E6%8D%AE%E5%BA%93" aria-label="启动 mongod 服务，指向最新数据库 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>启动 mongod 服务，指向最新数据库</h3>
<h4 id="mongod-以守护进程的方式启动" style="position:relative;"><a href="#mongod-%E4%BB%A5%E5%AE%88%E6%8A%A4%E8%BF%9B%E7%A8%8B%E7%9A%84%E6%96%B9%E5%BC%8F%E5%90%AF%E5%8A%A8" aria-label="mongod 以守护进程的方式启动 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>mongod 以守护进程的方式启动</h4>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">mongod --dbpath=/data/db --port=27017 --fork --logpath=/alidata/log/mongod/mongod.log</code></pre></div>
<h4 id="查看日志是否错误" style="position:relative;"><a href="#%E6%9F%A5%E7%9C%8B%E6%97%A5%E5%BF%97%E6%98%AF%E5%90%A6%E9%94%99%E8%AF%AF" aria-label="查看日志是否错误 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>查看日志是否错误</h4>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">tail -f /var/log/mongd.log //查看日志文件（cat也行）</code></pre></div>
<h2 id="启动应用" style="position:relative;"><a href="#%E5%90%AF%E5%8A%A8%E5%BA%94%E7%94%A8" aria-label="启动应用 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>启动应用</h2>
<p>安装各种依赖</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">$ cnpn install</code></pre></div>
<p>然后就能启动了，然后查看输出是否有问题。</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">$ cd /home/x-songtao
$ pm2 start ./bin/www -n x-songtao -i max;pm2 logs</code></pre></div>
<p>最后，<a href="xiangsongtao.com">访问试试看</a>，噢耶！</p>
<p>(完)</p>]]></description><link>https://xiangst0816.github.io/blog/cong-zong-ling-kai-shi-MEVN-huan-jing/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/cong-zong-ling-kai-shi-MEVN-huan-jing/</guid><category><![CDATA[MEVN]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Tue, 18 Oct 2016 13:12:32 GMT</pubDate></item><item><title><![CDATA[RESTful设计]]></title><description><![CDATA[<h2 id="restful-架构" style="position:relative;"><a href="#restful-%E6%9E%B6%E6%9E%84" aria-label="restful 架构 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>RESTful 架构</h2>
<p>REST 是 Representational State Transfer 的缩写，表示“表现层状态转移”。这个其实是在讲一个过程。</p>
<p>很久之前，用户访问服务器的时候，服务器是主角。他根据用户的请求决定发送设么东西给客户端，而客户端只有接收的“命”；</p>
<p>现在 REST 来了，主角现在是用户，用户通过 HTTP 协议中的多种请求状态（GET、POST、PUT、DELETE 等），要求服务器按照 URL 中的参数将资源返回。这时服务器就像一个静态的资源服务器一样，每一个 URI 代表一种资源。</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">RESRful：
资源 = URI + Method

Method：
GET用来获取资源
POST用来新建资源（也可以用于更新资源）
PUT用来更新资源
DELETE用来删除资源</code></pre></div>
<p>因此，操作资源的动作只能由 GET、POST、PUT、DELETE 等进行，URI 代表资源的名称，故设计 URI 时尽量使用名词！</p>
<h2 id="参考" style="position:relative;"><a href="#%E5%8F%82%E8%80%83" aria-label="参考 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>参考</h2>
<ul>
<li><a href="http://www.ruanyifeng.com/blog/2014/05/restful_api.html" target="_target" rel="nofollow">RESTful API 设计指南</a></li>
</ul>]]></description><link>https://xiangst0816.github.io/blog/RESTful-she-ji/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/RESTful-she-ji/</guid><category><![CDATA[RESTful]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Mon, 17 Oct 2016 13:00:26 GMT</pubDate></item><item><title><![CDATA[webp]]></title><description><![CDATA[<p>WebP 是一种图片压缩格式，主要应用在网络中传输图片，减小带宽及存储空间。在相同的精细度的情况下，WebP 拥有更小的文件尺寸，其在 Google 的产品中广为应用。</p>
<h3 id="使用场景" style="position:relative;"><a href="#%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF" aria-label="使用场景 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>使用场景</h3>
<ol>
<li>桌面浏览器： 谷歌浏览器能完全展示，但是 Firefox 不行</li>
<li>手机浏览器：完全不行，例如 IOS 的 Safari 及微信浏览器</li>
<li>APP：Android 和 IOS 图片展示需要专门的解析库</li>
</ol>
<h3 id="app-中使用特性" style="position:relative;"><a href="#app-%E4%B8%AD%E4%BD%BF%E7%94%A8%E7%89%B9%E6%80%A7" aria-label="app 中使用特性 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>APP 中使用特性</h3>
<h4 id="解析性能" style="position:relative;"><a href="#%E8%A7%A3%E6%9E%90%E6%80%A7%E8%83%BD" aria-label="解析性能 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>解析性能</h4>
<p>其中解码时间，WebP 的解码时间是 PNG 格式的 4.4 ~ 5 倍，流畅度、CPU 使用时间、内存占用无明显差异</p>
<h4 id="最优方案" style="position:relative;"><a href="#%E6%9C%80%E4%BC%98%E6%96%B9%E6%A1%88" aria-label="最优方案 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>最优方案</h4>
<ul>
<li>图片规格</li>
</ul>
<p>可以考虑使用 16n*16n 的规格，例如 256*256 或者 192*192 能获得更高的 WebP 压缩效率。</p>
<ul>
<li>色彩数</li>
</ul>
<p>建议原创表情尽量控制颜色数在 256 色以内，采用无损压缩性价比最高。</p>
<ul>
<li>色温、渐变与杂色、直线与直线、描边</li>
</ul>
<p>用色少，颜色渐变合理，装饰元素少，画面简单的</p>
<h3 id="总结" style="position:relative;"><a href="#%E6%80%BB%E7%BB%93" aria-label="总结 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>总结</h3>
<p>谨慎使用！！</p>
<h3 id="参考" style="position:relative;"><a href="#%E5%8F%82%E8%80%83" aria-label="参考 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>参考</h3>
<ul>
<li><a href="http://isux.tencent.com/introduction-of-webp.html" target="_target" rel="nofollow">WebP 探寻之路</a></li>
</ul>]]></description><link>https://xiangst0816.github.io/blog/webp/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/webp/</guid><category><![CDATA[WebP]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Mon, 17 Oct 2016 12:20:31 GMT</pubDate></item><item><title><![CDATA[高性能JavaScript实践总结]]></title><description><![CDATA[<p>本总结是对《高性能 JavaScript》这本书的总结也是记录笔记,加深我对 JavaScript 的认识及实践技巧。</p>
<h2 id="一、脚本的加载和执行" style="position:relative;"><a href="#%E4%B8%80%E3%80%81%E8%84%9A%E6%9C%AC%E7%9A%84%E5%8A%A0%E8%BD%BD%E5%92%8C%E6%89%A7%E8%A1%8C" aria-label="一、脚本的加载和执行 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>一、脚本的加载和执行</h2>
<p>一般来说，JavaScript 代码的执行会阻塞浏览器进行的其他程序，比如用户界面绘制。每次遇到<code class="language-text">&lt;script&gt;</code>后，,页面都必须停下来等待代码下载并执行，然后再继续解析和渲染页面。在这期间，页面渲染和用户交互是完全被阻塞的，例如页面出现长时间的白屏。解决方案如下：</p>
<ol>
<li>将<code class="language-text">&lt;script&gt;</code>放在<code class="language-text">&lt;/body&gt;</code>之前，确保脚被执行前页面已完成渲染。</li>
<li><code class="language-text">&lt;script&gt;</code>标签越少越好，可以考虑用 gulp 任务合并。因为 HTTP 请求会带来额外的性能开销。</li>
<li>内嵌脚本如果在<code class="language-text">&lt;link&gt;</code>之后会导致页面阻塞去等待样式表的下载。这样能获得最精准的样式信息，但是会阻塞其他任务。（不建议，但 hack 除外）</li>
<li>
<p>使用无阻塞下载的方式</p>
<ul>
<li><strong>延迟脚本：</strong><br>
在<code class="language-text">&lt;script&gt;</code>标签中使用 defer 属性，该属性指明此脚本不会修改 DOM，因此可以安全的延迟执行。（async 属性也用于异步加载脚本，区别在于其加载完成后自动执行，而 defer 需要页面完成后才执行）</li>
<li><strong>使用 XHR 对象下载 JavaScript 代码并注入到页面中</strong><br>
主要的局限是只能在同域中请求 js 文件，也不能从 CDN 获取 js 文件。</li>
<li><strong>动态脚本（推荐）：</strong><br>
动态创建<code class="language-text">&lt;script&gt;</code>元素并下载执行。即在 window 对象的 load 事件出发后再下载脚本。<br>
可自己实现(如下)，也可使用类库:<a href="http://github.com/rgrove/lazyload/" target="_target" rel="nofollow">lazyload</a>、<a href="http://labjs.com" target="_target" rel="nofollow">LABjs</a>。</li>
</ul>
</li>
</ol>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">/**
 * @title: addTags动态加载js标签
 * @params:
 * tagUrl: js资源的数组
 * eachLoadedCB: 每个资源加载完毕的回调
 * allLoadedCB: 所有资源加载完毕的回调
 * */
function addTags(tagUrl, eachLoadedCB, allLoadedCB) {

    if (!(tagUrl instanceof Array)) {
        alert(&quot;first arguments must be array of urls&quot;);
        return false;
    }
    var totalResource = tagUrl.length;
    var restResource = totalResource;
    var downLoadPercent;
    for (var i = 0, len = tagUrl.length; len &gt; i; i++) {
        //标签对象
        var _TagObjs;
        if (/.js$/.test(tagUrl[i])) {
            _TagObjs = document.createElement(&quot;script&quot;);
            _TagObjs.setAttribute(&#39;type&#39;, &#39;text/javascript&#39;);
            _TagObjs.setAttribute(&#39;src&#39;, tagUrl[i]);
            head.appendChild(_TagObjs);
        }
        if(_TagObjs.readyState){
            //IE
            _TagObjs.onreadystatechange = function () {
                if(_TagObjs.readyState == &quot;loaded&quot; || _TagObjs.readyState == &quot;complete&quot;){
                    _TagObjs.onreadystatechange = null;
                    restResource--;
                    downLoadPercent = Math.round((totalResource - restResource) / totalResource * 100);
                    !!eachLoadedCB &amp;&amp; eachLoadedCB(totalResource, restResource, downLoadPercent);
                    !!!restResource &amp;&amp; allLoadedCB &amp;&amp; allLoadedCB();
                }
            }
        }else{
            _TagObjs.onload = function () {
                restResource--;
                downLoadPercent = Math.round((totalResource - restResource) / totalResource * 100);
                !!eachLoadedCB &amp;&amp; eachLoadedCB(totalResource, restResource, downLoadPercent);
                !!!restResource &amp;&amp; allLoadedCB &amp;&amp; allLoadedCB();
            };
        }

    }
}


/**
 * 使用
 * */
addTags([&quot;core.js&quot;,&quot;lib.js&quot;],function (t,r,d) {
    alert(&quot;total:&quot;+t+&quot;,rest:&quot;+r+&quot;,percent:&quot;+d);
},function () {
    alert(&quot;all loaded&quot;)
})</code></pre></div>
<h2 id="二、数据存储" style="position:relative;"><a href="#%E4%BA%8C%E3%80%81%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8" aria-label="二、数据存储 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>二、数据存储</h2>
<p>JavaScript 的四种基本的数据存取位置，比较简单，这里只是简单列举：</p>
<ul>
<li>字面量 （最快）</li>
<li>本地变量 （var 创建）（最快）</li>
<li>数组元素 （最慢）</li>
<li>对象成员（最慢）</li>
</ul>
<h3 id="作用域链" style="position:relative;"><a href="#%E4%BD%9C%E7%94%A8%E5%9F%9F%E9%93%BE" aria-label="作用域链 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>作用域链</h3>
<p>找了一张图：
<img src="http://img.my.csdn.net/uploads/201304/04/1365082234_1223.png" alt="作用域链"></p>
<ul>
<li>函数执行都会创建自己的执行环境，且执行环境都有自己的作用域链，用于解析标识符。函数运行时的变量对象会放在作用域链的顶端。当执行环境被销毁，此对象也随之销毁。故，在函数执行过程中，每遇到变量，都会经历一次标识符解析过程以决定从哪儿获取存储数据。---> <strong>藏的越深，找的越慢！</strong></li>
<li>作用域链的末尾是全局变量对象，故<strong>搜索该变量的过程必须遍历整个作用域链！</strong>一般是讲此全局变量缓存的到局部变量中。</li>
</ul>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">function init(){
	var a = document;
	var b = a.body;
	b.getElementByTagName(&quot;a&quot;);
}</code></pre></div>
<ul>
<li>改变作用域链的方式有： - with(不建议使用，可使用局部变量替换) - try catch (可用)<br>
try 内函数的作用域对象放在首位，catch 内函数的作用域对象放在第二位。catch 执行完毕，作用域链就返回到之前的状态。<strong>建议将 catch 内的处理逻辑由专门的函数处理，由于只有一条执行语句，且没有局部变量的访问，作用域链的临时改变不会影响代码性能。</strong></li>
</ul>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">try{
	method();
} catch(e){
	handleErr(e);
}</code></pre></div>
<h3 id="闭包、作用域和内存" style="position:relative;"><a href="#%E9%97%AD%E5%8C%85%E3%80%81%E4%BD%9C%E7%94%A8%E5%9F%9F%E5%92%8C%E5%86%85%E5%AD%98" aria-label="闭包、作用域和内存 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>闭包、作用域和内存</h3>
<ul>
<li>闭包会造成更多的内存开销</li>
<li>闭包会放在作用域链的顶端，第二层是活动对象的作用域，也就是说，闭包的存在会频繁的出现跨作用域访问标识符的情况，每次访问都会带来性能损失，解救方案：将常用的跨作用域的变量存储到局部变量中，然后直接访问局部变量。</li>
</ul>
<h3 id="原型链" style="position:relative;"><a href="#%E5%8E%9F%E5%9E%8B%E9%93%BE" aria-label="原型链 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>原型链</h3>
<ul>
<li>Javascript 中的对象是基于原型的。</li>
<li>所有的对象都是 Object 的实例。</li>
<li>实例继承了原型链中的所有成员，故原型决定了实例的类型！</li>
</ul>
<p>浏览器中的原型链结构:
<img src="http://images.cnitblog.com/blog/543993/201401/211448230160.jpg" alt="浏览器中的原型链结构"></p>
<ul>
<li>嵌套的对象成员会显著的影响性能，访问的速度也越慢,例如：<br>
window.location.href.toString() > window.location.href > location.href</li>
<li>缓存对象的成员，如果多次访问的话。</li>
</ul>
<div class="gatsby-highlight" data-language="vara = location;"><pre class="language-vara = location;"><code class="language-vara = location;">	a.href;
	....</code></pre></div>
<ul>
<li>属性和方法越深，访问的速度也越慢</li>
</ul>
<h2 id="三、dom-编程" style="position:relative;"><a href="#%E4%B8%89%E3%80%81dom-%E7%BC%96%E7%A8%8B" aria-label="三、dom 编程 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>三、DOM 编程</h2>
<ul>
<li>减少 DOM 的访问次数，把运算留在 JS 端处理。</li>
<li>遍历数组的速度快于遍历集合是速度，故将 HTML 集合转化为数组在进行处理会更高效。</li>
</ul>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">function toArray(coll){
	for(var i = 0,a = [],len = coll.length;i&lt;len;i++){
		a[i] = coll[i];
	}
	return a;
}

var coll = document.getElementsByTagName(&quot;div&quot;);
var ar = toArray(coll);</code></pre></div>
<ul>
<li>建议使用 querySlectorAll()方法</li>
</ul>
<h3 id="重绘和重排" style="position:relative;"><a href="#%E9%87%8D%E7%BB%98%E5%92%8C%E9%87%8D%E6%8E%92" aria-label="重绘和重排 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>重绘和重排</h3>
<ul>
<li>重排：reflow，重新计算元素几何属性，重新构造渲染树，代价很高；</li>
<li>重绘： repaint，代价相对较小。</li>
</ul>
<p>故：</p>
<ul>
<li>批量修改 DOM</li>
<li>批量改变样式（ele.style.cssText = ""）</li>
<li>使元素脱离文档流，避免大部分文档重排： - 动画元素绝对定位，脱离文档流</li>
</ul>
<h3 id="事件委托" style="position:relative;"><a href="#%E4%BA%8B%E4%BB%B6%E5%A7%94%E6%89%98" aria-label="事件委托 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>事件委托</h3>
<p>大量元素绑定相同处理事件的时候，将事件绑定到 document 上，通过冒泡事件捕获并处理</p>
<h2 id="四、算法和流程控制" style="position:relative;"><a href="#%E5%9B%9B%E3%80%81%E7%AE%97%E6%B3%95%E5%92%8C%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6" aria-label="四、算法和流程控制 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>四、算法和流程控制</h2>
<ul>
<li>for, while, do- while，性能相当，灵活使用</li>
<li>避免使用 for-in，除非遍历对象的数量不确定。</li>
<li>switch 和 if-else 灵活使用</li>
<li>出现栈溢出，可能是因为使用了递归，将递归改为迭代可以避免。因为运行一个循环比反复调用一个函数的开销要少的多。</li>
</ul>
<h2 id="五、字符串和正则表达式" style="position:relative;"><a href="#%E4%BA%94%E3%80%81%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%92%8C%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F" aria-label="五、字符串和正则表达式 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>五、字符串和正则表达式</h2>
<ul>
<li>使用+和+=操作字符串，避免不必要的中间字符串</li>
<li>正则，待续</li>
</ul>
<h2 id="六、快速响应用户界面" style="position:relative;"><a href="#%E5%85%AD%E3%80%81%E5%BF%AB%E9%80%9F%E5%93%8D%E5%BA%94%E7%94%A8%E6%88%B7%E7%95%8C%E9%9D%A2" aria-label="六、快速响应用户界面 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>六、快速响应用户界面</h2>
<ul>
<li>js 任务不可超过 100ms</li>
<li>使用 settimeout 将长时间的 js 放入队列中异步执行，不阻碍 ui 进程。</li>
<li>可以使用 web works</li>
</ul>
<h2 id="七、ajax" style="position:relative;"><a href="#%E4%B8%83%E3%80%81ajax" aria-label="七、ajax permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>七、AJAX</h2>
<ul>
<li>减少请求次数</li>
</ul>
<h2 id="八、编程实践" style="position:relative;"><a href="#%E5%85%AB%E3%80%81%E7%BC%96%E7%A8%8B%E5%AE%9E%E8%B7%B5" aria-label="八、编程实践 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>八、编程实践</h2>
<ul>
<li>避免双重求值（使用 eval()和 Function()运行字符串代码）</li>
<li>Object 和 Array 使用直接量，而不是 new</li>
<li>环境判断的函数应该使用延迟加载技术（Lazy Loading）或者条件预加载技术（Conditional Advance Loading），即，环境确定后，用该环境下的函数替换主函数</li>
</ul>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">//延迟加载技术（Lazy Loading）
//第一次执行判断环境，之后修改addHandler函数并执行
functin addHandler(x){
	if(isThisEnvironment){
		addHandler = function(x){}
	}else{
		addHandler = function(x){}
	}
	addHandler(x);
}</code></pre></div>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">//条件预加载技术（Conditional Advance Loading）
//脚本加载期间检测，并修改addHandler函数；
var addHandler = isThisEnvironment?function(x){}:function(x){};</code></pre></div>
<ul>
<li>使用 js 原生提供的方法（Math）</li>
<li>使用位操作</li>
</ul>
<h2 id="九、构建高性能-js-应用" style="position:relative;"><a href="#%E4%B9%9D%E3%80%81%E6%9E%84%E5%BB%BA%E9%AB%98%E6%80%A7%E8%83%BD-js-%E5%BA%94%E7%94%A8" aria-label="九、构建高性能 js 应用 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>九、构建高性能 js 应用</h2>
<ul>
<li>合并多个 JavaScript 文件，减少 HTTP 请求数</li>
<li><strong>非必须的脚本延迟加载</strong></li>
<li>JavaScript 压缩，方法：ugify、js 重构（GCC）</li>
<li>启用 gzip</li>
<li>manifest 缓存技术，包含 manifest 的 html 也会被缓存</li>
<li>CDN</li>
<li>文件名增加 MD5 值防止缓存更新问题</li>
</ul>
<h2 id="10、工具" style="position:relative;"><a href="#10%E3%80%81%E5%B7%A5%E5%85%B7" aria-label="10、工具 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>10、工具</h2>
<ul>
<li>分类：性能分析+网络分析</li>
<li>浏览器的开发工具</li>
<li>Fidder/postman/Charles Proxy</li>
</ul>]]></description><link>https://xiangst0816.github.io/blog/gao-xing-neng-nai-JavaScript-shi-jian/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/gao-xing-neng-nai-JavaScript-shi-jian/</guid><category><![CDATA[JavaScript]]></category><category><![CDATA[读书笔记]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Sat, 21 May 2016 02:34:58 GMT</pubDate></item><item><title><![CDATA[imgLazyloadJS]]></title><description><![CDATA[<blockquote>
<p>我这是用的是这个插件<strong>jquery.lazyload.js</strong>,<a href="http://blog.csdn.net/zzqw199012/article/details/18707473" target="_target" rel="nofollow">关于介绍也很多了</a>,我这里就只见上干货，就说怎么用开始，不过还是先介绍下他是干什么的，怎么干的。</p>
</blockquote>
<h2 id="1-做什么的" style="position:relative;"><a href="#1-%E5%81%9A%E4%BB%80%E4%B9%88%E7%9A%84" aria-label="1 做什么的 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 做什么的</h2>
<p><strong>图片延迟加载</strong>，等<strong>滚到图片的位置时才加载</strong>，后面的图片先不加载，故能<strong>避免卡顿</strong>，需要加载图片的时候，图片进行下载，等加载完毕后才出现，<strong>消除出现半幅图</strong>的情况（改善用户体验）</p>
<h2 id="2-怎么干的" style="position:relative;"><a href="#2-%E6%80%8E%E4%B9%88%E5%B9%B2%E7%9A%84" aria-label="2 怎么干的 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 怎么干的</h2>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>lazy<span class="token punctuation">"</span></span> <span class="token attr-name">data-original</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>img/example.jpg<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>640<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>480<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></code></pre></div>
<ul>
<li><strong>data-original</strong>:这个是真正要交加载的图片；</li>
<li><strong>src</strong>：这个是占位图片，默认是 grey.gif，高度只有 1px；自动添加的。你不管。</li>
<li><strong>height</strong>：<strong>这个并不是必须设定</strong>，如果没设定导致图片都堆到一起被看到，则启动加载（我测试过，没设定尺寸），so，你知道该怎么做，把图片包起来隔开。</li>
</ul>
<p>引入 jquery：</p>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>jquery.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>jquery.lazyload.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span></code></pre></div>
<p>在 main.js 中写上：</p>
<div class="gatsby-highlight" data-language="html"><pre class="language-html"><code class="language-html">$("img.lazy").lazyload();</code></pre></div>
<p>这个例子我在<a href="https://github.com/xiangsongtao/HTML5-WebAPP-template" target="_target" rel="nofollow">HTML5-WebAPP-template</a>这里用到过了，你可以尝试下。</p>
<p><strong>如果使用的 requirejs 的话，这样做：</strong></p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">/*如果将包通过bower引入的话,会自动在paths中添加的 */</span>
require<span class="token punctuation">.</span><span class="token function">config</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  paths<span class="token operator">:</span> <span class="token punctuation">{</span>
    bootstrap<span class="token operator">:</span> <span class="token string">"../../bower_components/bootstrap/dist/js/bootstrap"</span><span class="token punctuation">,</span>
    domReady<span class="token operator">:</span> <span class="token string">"vendor/domReady.min"</span><span class="token punctuation">,</span>
    jquery<span class="token operator">:</span> <span class="token string">"../../bower_components/jquery/dist/jquery"</span><span class="token punctuation">,</span>
    <span class="token string">"jquery.scrollstop"</span><span class="token operator">:</span>
      <span class="token string">"../../bower_components/jquery_lazyload/jquery.scrollstop"</span><span class="token punctuation">,</span>
    <span class="token string">"jquery.lazyload"</span><span class="token operator">:</span> <span class="token string">"../../bower_components/jquery_lazyload/jquery.lazyload"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  shim<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">"jquery.lazyload"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"jquery"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string">"jquery.scrollstop"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"jquery"</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token comment">//先加载jquery插件及require和domReady模块</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token string">"require"</span><span class="token punctuation">,</span>
  <span class="token string">"jquery"</span><span class="token punctuation">,</span>
  <span class="token string">"domReady"</span><span class="token punctuation">,</span>
  <span class="token string">"jquery.lazyload"</span><span class="token punctuation">,</span>
  <span class="token string">"jquery.scrollstop"</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">require<span class="token punctuation">,</span> $<span class="token punctuation">,</span> domReady</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//之后通过require模块加载其余部分,当然这也是懒加载的方法</span>
  <span class="token function">require</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"app"</span><span class="token punctuation">,</span> <span class="token string">"test"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">app<span class="token punctuation">,</span> test</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">domReady</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"img.lazy"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">lazyload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<h2 id="3-说下其他功能" style="position:relative;"><a href="#3-%E8%AF%B4%E4%B8%8B%E5%85%B6%E4%BB%96%E5%8A%9F%E8%83%BD" aria-label="3 说下其他功能 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. 说下其他功能</h2>
<h3 id="31-设置加载阈值" style="position:relative;"><a href="#31-%E8%AE%BE%E7%BD%AE%E5%8A%A0%E8%BD%BD%E9%98%88%E5%80%BC" aria-label="31 设置加载阈值 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3.1 设置加载阈值</h3>
<blockquote>
<p>之前是“看到图片就加载”，现在是快到图片多少“<strong>阈值</strong>”的时候加载-提前一个距离加载。懂了不？</p>
</blockquote>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"img.lazy"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">lazyload</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">//还有200px就出现在屏幕上了，现在加载</span>
  threshold<span class="token operator">:</span> <span class="token number">200</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<h3 id="32-使用-jquery-的事件触发-img-加载" style="position:relative;"><a href="#32-%E4%BD%BF%E7%94%A8-jquery-%E7%9A%84%E4%BA%8B%E4%BB%B6%E8%A7%A6%E5%8F%91-img-%E5%8A%A0%E8%BD%BD" aria-label="32 使用 jquery 的事件触发 img 加载 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3.2 使用 jquery 的事件触发 img 加载</h3>
<blockquote>
<p>之前是自动，现在<strong>根据事件触发加载</strong>，例如 click，mouseover。。。。。自定义事件也行。</p>
</blockquote>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"img.lazy"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">lazyload</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  event<span class="token operator">:</span> <span class="token string">"click"</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p>自定义事件触发：sport 时间 5s 后触发 img 加载</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"img.lazy"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">lazyload</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    event<span class="token operator">:</span> <span class="token string">"sporty"</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">$</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token string">"load"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> timeout <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"img.lazy"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trigger</span><span class="token punctuation">(</span><span class="token string">"sporty"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<h3 id="33-使用-img-显现效果" style="position:relative;"><a href="#33-%E4%BD%BF%E7%94%A8-img-%E6%98%BE%E7%8E%B0%E6%95%88%E6%9E%9C" aria-label="33 使用 img 显现效果 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3.3 使用 img 显现效果</h3>
<blockquote>
<p>img 下载好了后，用什么方式显现的问题，简单。应该使用的是 jquery 的动画，默认是用 show(),估估计能替换成别的动画库。</p>
</blockquote>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"img.lazy"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">lazyload</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  effect<span class="token operator">:</span> <span class="token string">"fadeIn"</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<h3 id="34-如果-img-在一个-scroll-容器中（图片在带滚动条的容器里）" style="position:relative;"><a href="#34-%E5%A6%82%E6%9E%9C-img-%E5%9C%A8%E4%B8%80%E4%B8%AA-scroll-%E5%AE%B9%E5%99%A8%E4%B8%AD%EF%BC%88%E5%9B%BE%E7%89%87%E5%9C%A8%E5%B8%A6%E6%BB%9A%E5%8A%A8%E6%9D%A1%E7%9A%84%E5%AE%B9%E5%99%A8%E9%87%8C%EF%BC%89" aria-label="34 如果 img 在一个 scroll 容器中（图片在带滚动条的容器里） permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3.4 如果 img 在一个 scroll 容器中（图片在带滚动条的容器里）</h3>
<div class="gatsby-highlight" data-language="css"><pre class="language-css"><code class="language-css"><span class="token selector">#container</span> <span class="token punctuation">{</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 600px<span class="token punctuation">;</span>
  <span class="token property">overflow</span><span class="token punctuation">:</span> scroll<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"img.lazy"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">lazyload</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  container<span class="token operator">:</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#container"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<h3 id="35-如果-img-不是呈现队列的形式布局的" style="position:relative;"><a href="#35-%E5%A6%82%E6%9E%9C-img-%E4%B8%8D%E6%98%AF%E5%91%88%E7%8E%B0%E9%98%9F%E5%88%97%E7%9A%84%E5%BD%A2%E5%BC%8F%E5%B8%83%E5%B1%80%E7%9A%84" aria-label="35 如果 img 不是呈现队列的形式布局的 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3.5 如果 img 不是呈现队列的形式布局的</h3>
<blockquote>
<p>这句话的意思是，我们默认：图片的出现顺序是与 dom 的结构顺序是一致的。可是有些时髦的布局会将当前该出现的 img 放到很远的地方，所以这个插件为了保证这个图片能够显示出来，就会在后面去找（如果找不到这个图片就在页显示不出来了），看能不能找到这个图片，就是这个值“failure_limit”，如果你的布局非常奇葩，那么，将这个值设为 “所有使用 lazy 功能的图片的总和”，这样，这个奇葩的图片就跑不掉了！呵呵。理解了不？</p>
</blockquote>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"img.lazy"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">lazyload</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">//向后找10个单位img</span>
  failure_limit<span class="token operator">:</span> <span class="token number">10</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<h3 id="36-如果图片不可见怎么办" style="position:relative;"><a href="#36-%E5%A6%82%E6%9E%9C%E5%9B%BE%E7%89%87%E4%B8%8D%E5%8F%AF%E8%A7%81%E6%80%8E%E4%B9%88%E5%8A%9E" aria-label="36 如果图片不可见怎么办 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3.6 如果图片不可见怎么办</h3>
<blockquote>
<p>跳过不可见的图片（Invisible）</p>
</blockquote>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"img.lazy"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">lazyload</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  skip_invisible<span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>]]></description><link>https://xiangst0816.github.io/blog/imgLazyloadJS/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/imgLazyloadJS/</guid><category><![CDATA[JavaScript]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Thu, 10 Dec 2015 15:05:50 GMT</pubDate></item><item><title><![CDATA[RequireJS]]></title><description><![CDATA[<blockquote>
<p>第一次看官网的说明真是一头雾水,再次学习的时候感觉思路清晰很多,因此在这总结.</p>
</blockquote>
<h2 id="为什么使用-requirejs" style="position:relative;"><a href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BD%BF%E7%94%A8-requirejs" aria-label="为什么使用 requirejs permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>为什么使用 requirejs?</h2>
<p><strong>下面是我认为的原因:</strong></p>
<ol>
<li>代码逻辑复杂需要模块化管理;</li>
<li>在 js 文件中引入其他 js 文件的代码只能通过标签<code class="language-text">&lt;script&gt;</code></li>
<li>提升网页打开速度需要减少调用外部的 js 标签<code class="language-text">&lt;script&gt;</code></li>
</ol>
<p>接下来我就从怎么使用开始吧.</p>
<h2 id="需要在-html-代码中添加-requirejs-的code-classlanguage-textltscriptgtcode标签" style="position:relative;"><a href="#%E9%9C%80%E8%A6%81%E5%9C%A8-html-%E4%BB%A3%E7%A0%81%E4%B8%AD%E6%B7%BB%E5%8A%A0-requirejs-%E7%9A%84code-classlanguage-textltscriptgtcode%E6%A0%87%E7%AD%BE" aria-label="需要在 html 代码中添加 requirejs 的code classlanguage textltscriptgtcode标签 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>需要在 html 代码中添加 requirejs 的<code class="language-text">&lt;script&gt;</code>标签</h2>
<p><strong>两种方式都行:</strong><br>
<code class="language-text">&lt;script data-main=&quot;scripts/main.js&quot; src=&quot;scripts/require.js&quot;&gt;&lt;/script&gt;</code><br>
<code class="language-text">&lt;script data-main=&quot;scripts/main&quot; src=&quot;scripts/require.js&quot;&gt;&lt;/script&gt;</code></p>
<ol>
<li>将标签添加在<code class="language-text">&lt;body&gt;</code>的末尾</li>
<li>指定 js 文件的主入口位置<code class="language-text">main.js</code></li>
<li>指定<code class="language-text">require.js</code>文件位置</li>
</ol>
<h2 id="配置-mainjs-文件" style="position:relative;"><a href="#%E9%85%8D%E7%BD%AE-mainjs-%E6%96%87%E4%BB%B6" aria-label="配置 mainjs 文件 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>配置 main.js 文件</h2>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">**目录结构**
www/
----index.html
----js/
--------app/
------------sub.js
------------inventory.js
------------cart
--------lib/
------------jquery.js
------------canvas.js
--------main.js</code></pre></div>
<hr>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">requirejs.config({
	//默认路径
	baseUrl: &#39;js/lib&#39;,

	//在baseUrl默认路径的基础上,加载app.js文件,他现在
	//在lib文件夹的上级目录中(与js目录同级),不能再app后
	//加上js后缀!!!
	//在baseUrl目录下可以不用在paths中写明.例如canvas
	paths: {
    	main: &#39;../main&#39;,
    	jquery: &#39;jquery.1.1.min&#39;,
    	sub: &#39;../app/sub&#39;,
    	inventory.js: &#39;../app/inventory.js&#39;,
    	cart: &#39;../app/cart&#39;,

	}
});

// 主入口
//前面是依赖的模块数组(也可以是模块的位置url), 后面是对应的**调用名字**(已经对位)
requirejs([&#39;jquery&#39;, &#39;canvas&#39;, &#39;app/sub&#39;],
function     ($,      canvas,     sub) {
	//你的逻辑代码
	//sub.color;
	//sub(value);
	});</code></pre></div>
<h2 id="定义模块-subjs" style="position:relative;"><a href="#%E5%AE%9A%E4%B9%89%E6%A8%A1%E5%9D%97-subjs" aria-label="定义模块 subjs permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>定义模块 sub.js</h2>
<h3 id="1-如果只含有键值对的模块" style="position:relative;"><a href="#1-%E5%A6%82%E6%9E%9C%E5%8F%AA%E5%90%AB%E6%9C%89%E9%94%AE%E5%80%BC%E5%AF%B9%E7%9A%84%E6%A8%A1%E5%9D%97" aria-label="1 如果只含有键值对的模块 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. 如果只含有键值对的模块</h3>
<p><strong>from sub.js</strong>
define(function () {
//做一些初始设置
//return 出去的就是 sub 模块提供的信息
//此处为一个 object
return {
color: “black”,
size: “unisize”
}
});</p>
<h3 id="2-如果存在依赖的键值对的模块" style="position:relative;"><a href="#2-%E5%A6%82%E6%9E%9C%E5%AD%98%E5%9C%A8%E4%BE%9D%E8%B5%96%E7%9A%84%E9%94%AE%E5%80%BC%E5%AF%B9%E7%9A%84%E6%A8%A1%E5%9D%97" aria-label="2 如果存在依赖的键值对的模块 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 如果存在依赖的键值对的模块</h3>
<p><strong>from sub.js</strong>
//可 requirejs 一样,前面是*.js 的 path(前面已定义),后面是回调函数(传入
//对应的变量名)
define([“cart”, “inventory”], function(cart, inventory) {
//return 模块
return {
color: “blue”,
size: “large”,
addToCart: function() {
inventory.decrement(this);
cart.add(this);
}
}
}
);</p>
<h3 id="3-返回函数的模块" style="position:relative;"><a href="#3-%E8%BF%94%E5%9B%9E%E5%87%BD%E6%95%B0%E7%9A%84%E6%A8%A1%E5%9D%97" aria-label="3 返回函数的模块 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. 返回函数的模块</h3>
<p><strong>from sub.js</strong>
//和上面一样
define([“cart”, “inventory”], function(cart, inventory) {
//return 模块
return function(color){
color: “color”,
size: “large”,
addToCart: function() {
inventory.decrement(this);
cart.add(this);
}
}
}
}
);</p>
<h3 id="4-包装-commonjs-的代码" style="position:relative;"><a href="#4-%E5%8C%85%E8%A3%85-commonjs-%E7%9A%84%E4%BB%A3%E7%A0%81" aria-label="4 包装 commonjs 的代码 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>4. 包装 CommonJS 的代码</h3>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">**from sub.js**
//
define(function(require, exports, module) {
	//require需要的模块a和b,和上面一样的用法
    var a = require(&#39;a&#39;),
        b = require(&#39;b&#39;);

    //Return CommonJS的结果
    return function () {};
	}
);</code></pre></div>
<h3 id="5不建议在模块内部对模块直接命名" style="position:relative;"><a href="#5%E4%B8%8D%E5%BB%BA%E8%AE%AE%E5%9C%A8%E6%A8%A1%E5%9D%97%E5%86%85%E9%83%A8%E5%AF%B9%E6%A8%A1%E5%9D%97%E7%9B%B4%E6%8E%A5%E5%91%BD%E5%90%8D" aria-label="5不建议在模块内部对模块直接命名 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>5.不建议在模块内部对模块直接命名</h3>
<p>// “foo/title” 这样的命名不建议,
define(“foo/title”,
[“my/cart”, “my/inventory”],
function(cart, inventory) {
//Define foo/title object in here.
}
);</p>
<p>其他注意事项</p>
<hr>
<h4 id="1一个文件一个模块" style="position:relative;"><a href="#1%E4%B8%80%E4%B8%AA%E6%96%87%E4%BB%B6%E4%B8%80%E4%B8%AA%E6%A8%A1%E5%9D%97" aria-label="1一个文件一个模块 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1.一个文件一个模块</h4>
<h4 id="2-在-define-内部再次引用模块的情况" style="position:relative;"><a href="#2-%E5%9C%A8-define-%E5%86%85%E9%83%A8%E5%86%8D%E6%AC%A1%E5%BC%95%E7%94%A8%E6%A8%A1%E5%9D%97%E7%9A%84%E6%83%85%E5%86%B5" aria-label="2 在 define 内部再次引用模块的情况 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. 在 define 内部再次引用模块的情况</h4>
<p><strong>需要将”require”本身作为一个依赖注入到模块中</strong></p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">define([&quot;require&quot;, &quot;./relative/name&quot;], function(require) {
	var mod = require(&quot;./relative/name&quot;);
});</code></pre></div>
<h4 id="3-生成相对于模块的-url-地址" style="position:relative;"><a href="#3-%E7%94%9F%E6%88%90%E7%9B%B8%E5%AF%B9%E4%BA%8E%E6%A8%A1%E5%9D%97%E7%9A%84-url-%E5%9C%B0%E5%9D%80" aria-label="3 生成相对于模块的 url 地址 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. 生成相对于模块的 URL 地址</h4>
<p><strong>需要将”require”本身作为一个依赖注入到模块中</strong>, 结果的 url 不需要加.js 后缀</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">define([&quot;require&quot;], function(require) {
	var cssUrl = require.toUrl(&quot;./style.css&quot;);
});</code></pre></div>
<h2 id="循环依赖" style="position:relative;"><a href="#%E5%BE%AA%E7%8E%AF%E4%BE%9D%E8%B5%96" aria-label="循环依赖 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>循环依赖</h2>
<p>循环依赖(a 依赖 b，b 同时依赖 a),则在这种情形下当 b 调用 a 模块时，它会得到一个 undefined 的 a, 解决办法如下,将 require 作为依赖注入进来.</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">//Inside b.js:
define([&quot;require&quot;, &quot;a&quot;],
	function(require, a) {
    	//在这种情形下当b调用a模块时，它会得到一个undefined的a,
    	return function(title) {
    		//调用a中的doSomething()函数
        	return require(&quot;a&quot;).doSomething();
    	}
	}
);</code></pre></div>
<h2 id="jsonp-服务依赖-官网的翻译真烂" style="position:relative;"><a href="#jsonp-%E6%9C%8D%E5%8A%A1%E4%BE%9D%E8%B5%96-%E5%AE%98%E7%BD%91%E7%9A%84%E7%BF%BB%E8%AF%91%E7%9C%9F%E7%83%82" aria-label="jsonp 服务依赖 官网的翻译真烂 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>JSONP 服务依赖-官网的翻译真烂</h2>
<p>仅支持返回值类型为 JSON object 的 JSONP 服务，其他返回类型如数组、字串、数字等都不能支持。<br>
为了在 RequireJS 中使用 JSON 服务，需要指定一个 callback 参数,这里使用”defineFn”。这意味着你可将 JSONP URL 获取到的值看成是一个模块(返回的是一个函数 defineFn(jsonValue))。
require([“http://example.com/api/data.json?callback=defineFn”],
function (data) {
//这里的 data 就是返回的 defineFn(jsonValue)
console.log(data);
}
);</p>
<h2 id="requirejs-的机制" style="position:relative;"><a href="#requirejs-%E7%9A%84%E6%9C%BA%E5%88%B6" aria-label="requirejs 的机制 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>requirejs 的机制</h2>
<p>RequireJS 使用 head.appendChild()将每一个依赖加载为一个 script 标签。
RequireJS 等待所有的依赖加载完毕，计算出模块定义函数正确调用顺序，然后依次调用它们。</p>
<h2 id="requirejsconfig-的配置" style="position:relative;"><a href="#requirejsconfig-%E7%9A%84%E9%85%8D%E7%BD%AE" aria-label="requirejsconfig 的配置 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>requirejs.config 的配置</h2>
<ul>
<li><strong>baseUrl</strong> ：所有模块的查找根路径。</li>
<li><strong>paths</strong> ：path 映射那些不直接放置于 baseUrl 下的模块名。设置 path 时起始位置是相对于 baseUrl 的，除非该 path 设置以”/“开头或含有 URL 协议（如 http:）。</li>
<li>
<p><strong>shim</strong>: 将 shim 定义模块设置为全局可用(类似于 path 的作用),设定该模块的依赖项,但不加载该依赖, 只是到用到 shim 定义模块时才加载依赖项, 类似于插件而存在</p>
<p>  		requirejs.config({
path: {
jquery:“jquery”,
underscore:“underscore”
},
shim: {
‘backbone’: {
deps: [‘underscore’, ‘jquery’],
exports: ‘Backbone’
},
‘underscore’: {
exports: ’_’
},
‘foo’: {
deps: [‘bar’],
exports: ‘Foo’,
init: function (bar) {
return this.Foo.noConflict();
}
}</p>
<p>}
});
define([‘backbone’], function (Backbone) {
return Backbone.Model.extend({});
});
**Backbone 强制依赖于 Underscore.js,非强制依赖于 jQuery/Zepto.故 **</p>
</li>
<li>shim 配置<strong>仅设置了代码的依赖关系</strong>，想要实际加载 shim 指定的或涉及的模块，仍然需要一个常规的 require/define 调用。设置 shim 本身不会触发代码的加载。</li>
<li>成为 shim 脚本依赖的三个可选条件: - 使用其他”shim”模块作为 shim 脚本的依赖， - 在调用 define()之前定义了全局变量(如 jQuery 或 lodash)的 AMD 库, 这样调用不会出错(例如将 jquery 先在 path 中声明)。 - CMD 库</li>
<li>
<p><strong>map</strong>:对于给定的模块前缀，使用一个不同的模块 ID 来加载该模块。<br>
该手段对于某些大型项目很重要：如有两类模块需要使用不同版本的”foo”，但它们之间仍需要一定的协同。 在那些基于上下文的多版本实现中很难做到这一点。而且，paths 配置仅用于为模块 ID 设置 root paths，而不是为了将一个模块 ID 映射到另一个。</p>
<p>  	requirejs.config({
map: {
‘some/newmodule’: {
‘foo’: ‘foo1.2’
},
‘some/oldmodule’: {
‘foo’: ‘foo1.0’
}
}
});</p>
</li>
</ul>
<p>当“some/newmodule”调用了“require(‘foo’)”，它将获取到 foo1.2.js 文件；<br>
而当“some/oldmodule”调用“`require(‘foo’)”时它将获取到 foo1.0.js。</p>
<ul>
<li>
<p><strong>config</strong>:<strong>将配置信息向下传给一个模块</strong>。这些配置往往是 application 级别的信息，需要一个手段将它们向下传递给模块。在 RequireJS 中，基于 requirejs.config()的 config 配置项来实现。要获取这些信息的模块可以<strong>加载特殊的依赖“module”</strong>，并调用<strong>module.config()</strong>。</p>
<p>  	requirejs.config({</p>
<p>config: {
‘bar’: {
size: ‘large’
},
‘baz’: {
color: ‘blue’
}
}
});
//调用 config 的内容
define([‘module’], function (module) {
//Will be the value ‘blue’
var color = module.config().color;
});
//commonJS 模式
define(function (require, exports, module) {
//Will be the value ‘large’
var color = module.config().size;
});</p>
</li>
</ul>
<p>版本支持, requirejs 延迟加载, 依赖注入!!!</p>
<hr>
<blockquote>
<p><strong>require 函数</strong>的变态用法,直接上代码, 记住 require(或者 requirejs, 两个一样)是个函数.</p>
</blockquote>
<p>var reqOne = require.config({
context: “version1”,
baseUrl: “version1”
});</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">	reqOne([&quot;require&quot;, &quot;alpha&quot;, &quot;beta&quot;,],function(require,   alpha,   beta) {</code></pre></div>
<p>log(“alpha version is: ” + alpha.version); //prints 1
log(“beta version is: ” + beta.version); //prints 1</p>
<p>setTimeout(function() {
//延迟加载,需要在前面依赖’require’
require([“omega”],function(omega) {
log(“version1 omega loaded with version: ” +omega.version);
//prints 1
}
);
}, 100);
});</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">	var reqTwo = require.config({
  		context: &quot;version2&quot;,
  		baseUrl: &quot;version2&quot;
	});

	reqTwo([&quot;require&quot;, &quot;alpha&quot;, &quot;beta&quot;],function(require,   alpha,   beta) {</code></pre></div>
<p>log(“alpha version is: ” + alpha.version); //prints 2
log(“beta version is: ” + beta.version); //prints 2</p>
<p>setTimeout(function() {
//延迟加载,需要在前面依赖’require’
require([“omega”],function(omega) {
log(“version2 omega loaded with version: ” +omega.version);
//prints 2
}
);
}, 100);
});</p>
<p>如果没有指定“require”依赖，则很可能会出现错误。</p>
<p>paths 备错配置</p>
<hr>
<p>paths 配置如下:</p>
<p>paths: {
jquery: [
‘http://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min’,
/如果没找到 CDN 则加载下面位置的 jquery
‘lib/jquery’
]
}</p>
<p>页面加载控制及 DOM Ready 事件监听</p>
<hr>
<p>需要与 DOM 交互的工作应等待 DOM Ready。现代的浏览器通过 DOMContentLoaded 事件来知会。但是，不是所有的浏览器都支持 DOMContentLoaded。<strong>domReady 模块</strong>实现了一个跨浏览器的方法来判定何时 DOM 已经 ready。下载并在你的项目中如此用它：</p>
<p>require([‘domReady’], function (domReady) {
domReady(function () {
//Dom ready 后调才执行这里的函数
//需要操作 DOM 的代码放置在这里
});
});
//ps,可以用下面的结构,与主结构分开,避免耗时导致其他 js 不执行
var reqDOM = requirejs.config({…});
reqDOM([‘domReady’],function(domReady){
domReady(function () {
//Dom ready 后调才执行这里的函数
//需要操作 DOM 的代码放置在这里
});
});</p>
<h2 id="requirejs-require-define-的区别" style="position:relative;"><a href="#requirejs-require-define-%E7%9A%84%E5%8C%BA%E5%88%AB" aria-label="requirejs require define 的区别 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>requirejs, require, define 的区别</h2>
<blockquote>
<p>requirejs, require 两个使用起来完全一样, 也找不到区别的方法…<br>
requirejs.config()或者 require.config()</p>
</blockquote>
<p>define 和 require 在依赖处理和回调执行上都是一样的，不一样的地方是<strong>define 的回调函数需要有 return 语句返回模块对象</strong>，这样 define 定义的模块才能被其他模块引用；<strong>require 的回调函数不需要 return 语句</strong>。</p>
<blockquote>
<p>著作权归作者所有。<br>
商业转载请联系作者获得授权，非商业转载请注明出处。<br>
作者：Xin You<br>
链接：<a href="http://www.zhihu.com/question/21260764/answer/50194362" target="_target" rel="nofollow">http://www.zhihu.com/question/21260764/answer/50194362</a><br>
来源：知乎</p>
</blockquote>
<p>所以,<strong>define 定义 require 加载使用，这个理解是对的。</strong></p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">define([require,path/myMod1,path/moMod2], function(require){
	var mod1 = require(&#39;path/myMod1&#39;), mod2 = require(&#39;path/myMod2&#39;);
})

其实逻辑上类似于

define([require], function(require){
	var mod1 = require(&#39;path/myMod1&#39;), mod2 = require(&#39;path/myMod2&#39;);
})

你只是把参数丢了而已，所以这样也行

define([require,path/myMod1,path/moMod2], function(require){
	var mod1 = arguments[1], mod2 = arguments[2];
})

所以，可以这么用

define([require,path/myMod1,path/moMod2], function(require,mod1,mod2){
	// 这里 mod1 和 mod2 都准备好了，还可以用require继续加载别的
})

或者，改成你看到的那些例子

define([path/myMod1,path/moMod2], function(mod1,mod2){
})



所以

define([&#39;jquery.validate&#39;], function(validate){
	// 这里可以用validate，但是用不了jquery了？
})

这样本质上并没有问题，只不过你引用了这个插件，必然也是想用jquery的而不只是validate，

所以

define([&#39;jquery&#39;, &#39;jquery.validate&#39;], function(jquery, validate){
	// 这样才有jquery
})

像你一开始那样使用也行

define([&#39;require&#39;, &#39;jquery.validate&#39;], function(require, validate){
	var jquery = require(&#39;jquery&#39;);
})</code></pre></div>]]></description><link>https://xiangst0816.github.io/blog/RequireJS/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/RequireJS/</guid><category><![CDATA[RequireJS]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Thu, 10 Dec 2015 15:05:50 GMT</pubDate></item><item><title><![CDATA[进度显示]]></title><description><![CDATA[<h2 id="1spanjs-插件使用菊花" style="position:relative;"><a href="#1spanjs-%E6%8F%92%E4%BB%B6%E4%BD%BF%E7%94%A8%E8%8F%8A%E8%8A%B1" aria-label="1spanjs 插件使用菊花 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1.spanjs 插件使用(菊花)</h2>
<h3 id="显示效果（无限菊花）：" style="position:relative;"><a href="#%E6%98%BE%E7%A4%BA%E6%95%88%E6%9E%9C%EF%BC%88%E6%97%A0%E9%99%90%E8%8F%8A%E8%8A%B1%EF%BC%89%EF%BC%9A" aria-label="显示效果（无限菊花）： permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>显示效果（无限菊花）：</h3>
<p><img src="http://pic002.cnblogs.com/images/2012/263737/2012110210275693.png" alt="菊花状"></p>
<h3 id="快速开始：" style="position:relative;"><a href="#%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B%EF%BC%9A" aria-label="快速开始： permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>快速开始：</h3>
<p>-. HTML 页面插入代码</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">    /*spin为承载进度条的块*/
    &lt;div id=&quot;spin&quot;&gt;&lt;/div&gt;
    &lt;script src=&quot;spin.js&quot;&gt;&lt;/script&gt;</code></pre></div>
<p>-. 设置<strong>菊花</strong>的参数</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">    var opts = {
      	lines: 12             // The number of lines to draw
    	, length: 7             // The length of each line
    	, width: 5              // The line thickness
    	, radius: 10            // The radius of the inner circle
    	, scale: 1.0            // Scales overall size of the spinner
    	, corners: 1            // Roundness (0..1)
    	, color: &#39;#000&#39;         // #rgb or #rrggbb
    	, opacity: 1/4          // Opacity of the lines
    	, rotate: 0             // Rotation offset
    	, direction: 1          // 1: clockwise, -1: counterclockwise
    	, speed: 1              // Rounds per second
    	, trail: 100            // Afterglow percentage
    	, fps: 20               // Frames per second when using setTimeout()
    	, zIndex: 2e9           // Use a high z-index by default
    	, className: &#39;spinner&#39;  // CSS class to assign to the element
    	, top: &#39;50%&#39;            // center vertically
    	, left: &#39;50%&#39;           // center horizontally
    	, shadow: false         // Whether to render a shadow
    	, hwaccel: false        // Whether to use hardware acceleration (might be buggy)
    	, position: &#39;absolute&#39;  // Element positioning
    }</code></pre></div>
<p>-. 调用函数</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text"> var target = document.getElementById(&#39;spin&#39;);
 //定义opts参数下的样式
 var spinner = new Spinner(opts);
 //启动target
 spinner.spin(target);</code></pre></div>
<p>-. 停止</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">spinner.stop(target);</code></pre></div>
<p>-. 再开始</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">spinner.spin(target);</code></pre></div>
<h2 id="2cprogressjs-插件菊花进度值" style="position:relative;"><a href="#2cprogressjs-%E6%8F%92%E4%BB%B6%E8%8F%8A%E8%8A%B1%E8%BF%9B%E5%BA%A6%E5%80%BC" aria-label="2cprogressjs 插件菊花进度值 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2.CProgressjs 插件(菊花+进度值)</h2>
<h3 id="显示效果" style="position:relative;"><a href="#%E6%98%BE%E7%A4%BA%E6%95%88%E6%9E%9C" aria-label="显示效果 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>显示效果:</h3>
<p><img src="http://pic002.cnblogs.com/images/2012/36987/2012102316464528.jpg" alt="菊花+进度值"></p>
<blockquote>
<p><strong>可固定值,也可修改 limit value(终点值).</strong></p>
</blockquote>
<h3 id="快速开始" style="position:relative;"><a href="#%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B" aria-label="快速开始 permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>快速开始</h3>
<p>-. HTML 页面插入代码</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">/*承载进度条的块*/
&lt;div id=&quot;p1&quot;&gt;&lt;/div&gt;
/*在上面目录下自动创建的内容,105是图片的大小*/
&lt;div class=&quot;jCProgress&quot; style=&quot;opacity: 1;&quot;&gt;
	&lt;div class=&quot;percent&quot;&gt;50&lt;/div&gt;
	&lt;canvas width=&quot;105&quot; height=&quot;105&quot;&gt;&lt;/canvas&gt;
&lt;/div&gt;</code></pre></div>
<p>-. 设置<strong>菊花</strong>的参数并启动</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">$(document).ready(function() {
		//变量承载
        var myplugin;
        //设置延迟,因为图片加载慢的问题
        setTimeout(function() {
            if (!myplugin) {
            	//**option设置**
                opt = {
                    percent: 0, // starting position
                    img1: &#39;http://p.ar2oor.pl/cprogress/c1.png&#39;, // background
                    img2: &#39;http://p.ar2oor.pl/cprogress/c3.png&#39;, // foreground
                    speed: 10, // speed (timeout)
                    PIStep: 0.05, // every step foreground area is bigger about this val
                    //limit: 20, // end value
                    loop: false, //if true, no matter if limit is set, progressbar will be running
                    showPercent: true, //show hide percent
                    onInit: function() {
                        console.log(&#39;onInit&#39;);
                    },
                    onProgress: function(p) {
                    //用于提示进度在0-100之间的信息展示
                        console.log(&#39;onProgress&#39;, p);
                    }, //p=current percent
                    onComplete: function(p) {
                    //如果进度完成
                        console.log(&#39;onComplete&#39;, p);
                    }
                };
                //手动更改当前的终点值
                opt.limit = 40;
                //在p1内添加元素,传入参数opt
                myplugin = $(&#39;#p1&#39;).cprogress(opt);

                //更改值后自动动画,可用于组件加载时调用
                //设置myplugin中的属性
                myplugin.options({
                    limit: 50
                });


            }
        }, 1000);
    });</code></pre></div>
<p>-. myplugin 的其余方法</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">// 创建参数
options = {
 	img1: &#39;v1.png&#39;,
 	img2: &#39;v2.png&#39;,
 	speed: 50,
 	limit: 70,
};
//创建cprogress
myplugin = $(&#39;#p1&#39;).cprogress(options);

//通过事件创建cprogress
$(&#39;#create&#39;).click(function(){
    if(!myplugin){
  	myplugin = $(&#39;#p1&#39;).cprogress(options);
 	}
});

// 销毁
$(&#39;#destroy&#39;).click(function(){
 	if(myplugin){
  	myplugin=myplugin.destroy();
 	}
});

// 开始
$(&#39;#play&#39;).click(function(){
 	if(myplugin){
  	myplugin.start();
 	}
});

// 停止
$(&#39;#pause&#39;).click(function(){
 	if(myplugin){
  	myplugin.stop();
 	}
});

// 重置,从头开始再走一遍
$(&#39;#reset&#39;).click(function(){
 	if(myplugin){
  	myplugin.reset();
 	}
});

// 更改配置 (可以更改所有的配置)
$(&#39;#speed10&#39;).click(function(){
 	if(myplugin){
 	//这里更改的是速度
  	myplugin.options({speed: 10});
 	}
});</code></pre></div>
<p>-. CSS 配置
/<em>显示圆形进度的外层 div,自动创建的 div</em>/
.jCProgress {
position: absolute;
z-index: 9999999;
/_ margin-top:-15px; /_ offset from the center <em>/
}
/</em>内部百分比进度数字 div*/</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">.jCProgress &gt; div.percent {
 	font: 18px/27px &#39;BebasRegular&#39;, Arial, sans-serif;
 	color:#ebebeb;
 	text-shadow: 1px 1px 1px #1f1f1f;

 	position:absolute;
 	margin-top:40px;
 	margin-left:22px;
 	text-align: center;
 	width:60px;
}</code></pre></div>]]></description><link>https://xiangst0816.github.io/blog/jin-du-duo-xian-shi/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/jin-du-duo-xian-shi/</guid><category><![CDATA[插件]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Wed, 11 Nov 2015 14:47:25 GMT</pubDate></item><item><title><![CDATA[JSONP跨域访问服务]]></title><description><![CDATA[<p><strong>跨域访问:</strong></p>
<blockquote>
<p>如果我们希望获取的数据和当前页面并不是一个域，著名的同源策略（不同域的客户端脚本在没明确授权的情况下，不能读写对方的资源）会因为安全原因决绝请求，也就是我们不能向其它域直接发送请求以获取资源。</p>
</blockquote>
<p><strong>iframe、img、style、script 等元素</strong>的 src 属性可以直接向不同域请求资源，jsonp 正是利用 script 标签跨域请求资源的</p>
<p><strong>异域服务器的 php 代码:</strong></p>
<div class="gatsby-highlight" data-language="php"><pre class="language-php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
  <span class="token variable">$path</span><span class="token operator">=</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token double-quoted-string string">"DOCUMENT_ROOT"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token single-quoted-string string">'/books.xml'</span><span class="token punctuation">;</span>
  <span class="token variable">$json</span><span class="token operator">=</span><span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token function">simplexml_load_file</span><span class="token punctuation">(</span><span class="token variable">$path</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token variable">$callbackFn</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'callback'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">echo</span> <span class="token double-quoted-string string">"<span class="token interpolation"><span class="token variable">$callbackFn</span></span>(<span class="token interpolation"><span class="token variable">$json</span></span>);"</span><span class="token punctuation">;</span>
<span class="token delimiter important">?></span></span></code></pre></div>
<p>将 xml 数据转化成 json,之后将传入的 callback 的值作为函数名传入 json 数据,之后 echo.</p>
<p><strong>本地 callback 函数</strong></p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">displayBooks</span><span class="token punctuation">(</span><span class="token parameter">books</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token operator">**</span><span class="token operator">**</span>
<span class="token punctuation">}</span></code></pre></div>
<p><strong>本地 jsonp 请求发送</strong></p>
<p>写一个<code class="language-text">&lt;script&gt;</code>标签用于跨域</p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">getBooks</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> script <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">"script"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  script<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"type"</span><span class="token punctuation">,</span> <span class="token string">"text/javascript"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  script<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span>
    <span class="token string">"src"</span><span class="token punctuation">,</span>
    <span class="token string">"http://test.com/bookservice.php?callback=displayBooks"</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>script<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">getBooks</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div>
<p><strong>jquery 实现</strong></p>
<div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">getBooks</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    type<span class="token operator">:</span> <span class="token string">"get"</span><span class="token punctuation">,</span>
    url<span class="token operator">:</span> <span class="token string">"http://test.com/bookservice.php"</span><span class="token punctuation">,</span>
    dataType<span class="token operator">:</span> <span class="token string">"jsonp"</span><span class="token punctuation">,</span>
    jsonp<span class="token operator">:</span> <span class="token string">"callback"</span><span class="token punctuation">,</span>
    jsonpCallback<span class="token operator">:</span> <span class="token string">"displayBooks"</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text"></code></pre></div>]]></description><link>https://xiangst0816.github.io/blog/JSONP-kua-yu-fang-wen-fu-wu/</link><guid isPermaLink="false">https://xiangst0816.github.io/blog/JSONP-kua-yu-fang-wen-fu-wu/</guid><category><![CDATA[JSONP]]></category><dc:creator><![CDATA[烈风裘]]></dc:creator><pubDate>Wed, 11 Nov 2015 09:42:55 GMT</pubDate></item></channel></rss>